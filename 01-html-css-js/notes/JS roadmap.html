<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JavaScript Mastery Roadmap</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0a0f;
      --bg-secondary: #12121a;
      --fg: #e8e8ed;
      --muted: #6b6b7a;
      --accent: #00d4aa;
      --accent-dim: #00d4aa22;
      --card: #16161f;
      --card-hover: #1c1c28;
      --border: #2a2a3a;
      --warning: #ff6b4a;
      --info: #4a9eff;
      --success: #4aff91;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Space Grotesk', sans-serif;
      background: var(--bg);
      color: var(--fg);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .font-mono {
      font-family: 'JetBrains Mono', monospace;
    }

    /* Background Effects */
    .bg-grid {
      background-image: 
        linear-gradient(rgba(0, 212, 170, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 212, 170, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    .glow-orb {
      position: fixed;
      width: 600px;
      height: 600px;
      border-radius: 50%;
      background: radial-gradient(circle, var(--accent-dim) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
    }
    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: var(--muted);
    }

    /* Progress Bar */
    .progress-track {
      height: 4px;
      background: var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #00ff88);
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Stage Cards */
    .stage-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .stage-card:hover {
      border-color: var(--accent);
      box-shadow: 0 0 40px var(--accent-dim);
    }

    .stage-header {
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .stage-header:hover {
      background: var(--card-hover);
    }

    .stage-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .stage-content.expanded {
      max-height: 5000px;
    }

    /* Topic Items */
    .topic-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
      transition: all 0.2s ease;
    }

    .topic-item:hover {
      border-color: var(--muted);
      transform: translateX(4px);
    }

    /* Custom Checkbox */
    .custom-checkbox {
      width: 22px;
      height: 22px;
      border: 2px solid var(--border);
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .custom-checkbox:hover {
      border-color: var(--accent);
    }

    .custom-checkbox.checked {
      background: var(--accent);
      border-color: var(--accent);
    }

    .custom-checkbox svg {
      opacity: 0;
      transform: scale(0.5);
      transition: all 0.2s ease;
    }

    .custom-checkbox.checked svg {
      opacity: 1;
      transform: scale(1);
    }

    /* Tabs */
    .tab-btn {
      padding: 12px 24px;
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
    }

    .tab-btn:first-child {
      border-radius: 8px 0 0 8px;
    }

    .tab-btn:last-child {
      border-radius: 0 8px 8px 0;
    }

    .tab-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--bg);
    }

    .tab-btn:hover:not(.active) {
      border-color: var(--accent);
      color: var(--fg);
    }

    /* Pitfall Card */
    .pitfall-card {
      background: linear-gradient(135deg, #1a0a0a 0%, var(--card) 100%);
      border: 1px solid #3a1a1a;
      border-radius: 12px;
      padding: 24px;
      transition: all 0.3s ease;
    }

    .pitfall-card:hover {
      border-color: var(--warning);
      box-shadow: 0 0 30px rgba(255, 107, 74, 0.1);
    }

    /* Tip Card */
    .tip-card {
      background: linear-gradient(135deg, #0a1a0a 0%, var(--card) 100%);
      border: 1px solid #1a3a1a;
      border-radius: 12px;
      padding: 24px;
      transition: all 0.3s ease;
    }

    .tip-card:hover {
      border-color: var(--success);
      box-shadow: 0 0 30px rgba(74, 255, 145, 0.1);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .animate-in {
      animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      opacity: 0;
    }

    .stagger-1 { animation-delay: 0.1s; }
    .stagger-2 { animation-delay: 0.2s; }
    .stagger-3 { animation-delay: 0.3s; }
    .stagger-4 { animation-delay: 0.4s; }

    /* Level Badge */
    .level-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .level-beginner { background: #1a2a1a; color: #4aff91; }
    .level-intermediate { background: #1a1a2a; color: #4a9eff; }
    .level-advanced { background: #2a1a2a; color: #9a4aff; }
    .level-expert { background: #2a1a1a; color: #ff6b4a; }

    /* Code Block */
    .code-block {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      overflow-x: auto;
      color: var(--muted);
    }

    .code-block .keyword { color: #ff79c6; }
    .code-block .string { color: #f1fa8c; }
    .code-block .function { color: #50fa7b; }
    .code-block .comment { color: #6272a4; }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus States */
    *:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
  </style>
</head>
<body class="min-h-screen bg-grid">
  <!-- Glow Orbs -->
  <div class="glow-orb" style="top: -200px; left: -200px;"></div>
  <div class="glow-orb" style="bottom: -200px; right: -200px;"></div>

  <!-- Progress Bar -->
  <div class="progress-track">
    <div class="progress-fill" id="progressBar" style="width: 0%"></div>
  </div>

  <!-- Header -->
  <header class="relative z-10 py-12 px-6">
    <div class="max-w-5xl mx-auto">
      <div class="animate-in">
        <p class="font-mono text-sm text-[var(--accent)] mb-4 tracking-wider">// FROM ZERO TO HERO</p>
        <h1 class="text-5xl md:text-7xl font-bold tracking-tight mb-4">
          JavaScript<br>
          <span class="text-[var(--muted)]">Mastery Roadmap</span>
        </h1>
        <p class="text-xl text-[var(--muted)] max-w-2xl">
          A structured path from fundamentals to senior-level expertise. 
          Track your progress, avoid common pitfalls, and accelerate your learning.
        </p>
      </div>

      <!-- Stats -->
      <div class="flex flex-wrap gap-6 mt-8 animate-in stagger-1">
        <div class="bg-[var(--card)] border border-[var(--border)] rounded-lg px-6 py-4">
          <p class="text-3xl font-bold font-mono text-[var(--accent)]" id="completedCount">0</p>
          <p class="text-sm text-[var(--muted)]">Topics Completed</p>
        </div>
        <div class="bg-[var(--card)] border border-[var(--border)] rounded-lg px-6 py-4">
          <p class="text-3xl font-bold font-mono text-[var(--fg)]" id="totalCount">0</p>
          <p class="text-sm text-[var(--muted)]">Total Topics</p>
        </div>
        <div class="bg-[var(--card)] border border-[var(--border)] rounded-lg px-6 py-4">
          <p class="text-3xl font-bold font-mono text-[var(--info)]" id="currentLevel">Beginner</p>
          <p class="text-sm text-[var(--muted)]">Current Level</p>
        </div>
      </div>
    </div>
  </header>

  <!-- Tab Navigation -->
  <nav class="sticky top-[4px] z-50 bg-[var(--bg)] bg-opacity-90 backdrop-blur-md py-4 px-6 border-b border-[var(--border)]">
    <div class="max-w-5xl mx-auto flex flex-wrap gap-2 justify-center">
      <button class="tab-btn active" data-tab="roadmap">Roadmap</button>
      <button class="tab-btn" data-tab="pitfalls">Pitfalls</button>
      <button class="tab-btn" data-tab="tips">Speed Tips</button>
      <button class="tab-btn" data-tab="resources">Resources</button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="relative z-10 py-12 px-6">
    <div class="max-w-5xl mx-auto">

      <!-- Roadmap Tab -->
      <section id="roadmap-tab" class="tab-content">
        <div class="space-y-6" id="stagesContainer">
          <!-- Stages will be rendered here -->
        </div>
      </section>

      <!-- Pitfalls Tab -->
      <section id="pitfalls-tab" class="tab-content hidden">
        <div class="space-y-6" id="pitfallsContainer">
          <!-- Pitfalls will be rendered here -->
        </div>
      </section>

      <!-- Tips Tab -->
      <section id="tips-tab" class="tab-content hidden">
        <div class="space-y-6" id="tipsContainer">
          <!-- Tips will be rendered here -->
        </div>
      </section>

      <!-- Resources Tab -->
      <section id="resources-tab" class="tab-content hidden">
        <div class="grid md:grid-cols-2 gap-6" id="resourcesContainer">
          <!-- Resources will be rendered here -->
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer class="relative z-10 py-12 px-6 border-t border-[var(--border)]">
    <div class="max-w-5xl mx-auto text-center">
      <p class="text-[var(--muted)] font-mono text-sm">
        Progress is saved locally. Keep building, keep learning.
      </p>
    </div>
  </footer>

  <script>
    // ========================================
    // DATA
    // ========================================
    
    const roadmapData = [
      {
        id: 'beginner',
        title: 'Foundation Stage',
        subtitle: 'Build rock-solid fundamentals',
        level: 'beginner',
        duration: '2-3 months',
        topics: [
          {
            title: 'Variables & Data Types',
            description: 'let, const, var differences, primitive types (string, number, boolean, null, undefined, symbol, bigint)',
            resources: ['MDN: Grammar and Types', 'JavaScript.info: Variables'],
            practice: 'Create a program that handles different data types and demonstrates type coercion'
          },
          {
            title: 'Operators & Expressions',
            description: 'Arithmetic, comparison, logical, assignment, ternary operator, operator precedence',
            resources: ['MDN: Expressions and Operators'],
            practice: 'Build a simple calculator using different operators'
          },
          {
            title: 'Control Flow',
            description: 'if/else, switch, for, while, do...while, break, continue, early returns',
            resources: ['MDN: Control Flow'],
            practice: 'Implement FizzBuzz without using modulo operator'
          },
          {
            title: 'Functions Basics',
            description: 'Function declarations, expressions, parameters, default parameters, return values',
            resources: ['JavaScript.info: Functions'],
            practice: 'Write functions that solve common math problems (factorial, fibonacci)'
          },
          {
            title: 'Arrays & Array Methods',
            description: 'push, pop, shift, unshift, splice, slice, indexOf, includes, forEach, map, filter, find, reduce, some, every',
            resources: ['MDN: Array Methods'],
            practice: 'Implement your own map, filter, and reduce from scratch'
          },
          {
            title: 'Objects Basics',
            description: 'Object literals, property access, methods, this keyword basics, Object.keys/values/entries',
            resources: ['JavaScript.info: Objects'],
            practice: 'Build a simple data model for a todo application'
          },
          {
            title: 'String Methods',
            description: 'toLowerCase, toUpperCase, trim, split, join, replace, includes, startsWith, endsWith, template literals',
            resources: ['MDN: String Methods'],
            practice: 'Build a text analyzer that counts words, characters, and sentences'
          },
          {
            title: 'DOM Manipulation',
            description: 'querySelector, getElementById, classList, innerHTML, textContent, createElement, appendChild, event listeners',
            resources: ['DOM Enlightenment'],
            practice: 'Build an interactive form with validation'
          },
          {
            title: 'Events & Event Handling',
            description: 'Event bubbling, capturing, delegation, preventDefault, stopPropagation, event object',
            resources: ['JavaScript.info: Events'],
            practice: 'Create a drag-and-drop interface'
          },
          {
            title: 'Error Handling Basics',
            description: 'try/catch/finally, throw, Error object, custom errors',
            resources: ['MDN: Control Flow - Exception Handling'],
            practice: 'Build a form validator with proper error messages'
          }
        ]
      },
      {
        id: 'intermediate',
        title: 'Intermediate Stage',
        subtitle: 'Deep dive into core mechanisms',
        level: 'intermediate',
        duration: '3-4 months',
        topics: [
          {
            title: 'Scope & Closures',
            description: 'Lexical scope, block scope, closure patterns, memory implications, practical use cases (module pattern, factories)',
            resources: ['You Don\'t Know JS: Scope & Closures', 'JavaScript.info: Closures'],
            practice: 'Implement a private counter and a memoization function using closures'
          },
          {
            title: 'this Keyword Deep Dive',
            description: 'Implicit binding, explicit binding (call, apply, bind), new binding, arrow functions, strict mode effects',
            resources: ['You Don\'t Know JS: this & Object Prototypes'],
            practice: 'Create a library that demonstrates all binding rules'
          },
          {
            title: 'Prototypes & Inheritance',
            description: 'Prototype chain, __proto__, Object.create, Object.getPrototypeOf, constructor functions, class syntax',
            resources: ['JavaScript.info: Prototypes', 'MDN: Inheritance'],
            practice: 'Build a small class hierarchy (Animal -> Dog -> Labrador) using both ES5 and ES6 syntax'
          },
          {
            title: 'ES6+ Features',
            description: 'Destructuring, spread/rest, default parameters, enhanced object literals, computed property names',
            resources: ['ES6 Features Guide', 'JavaScript.info: Modern Features'],
            practice: 'Refactor ES5 code to use modern ES6+ features'
          },
          {
            title: 'Arrow Functions & Lexical this',
            description: 'Syntax variations, when to use vs regular functions, lexical this, limitations',
            resources: ['MDN: Arrow Functions'],
            practice: 'Fix common mistakes in code that misuses arrow functions'
          },
          {
            title: 'Promises & Async Basics',
            description: 'Promise creation, then/catch/finally, Promise.all, Promise.race, Promise.allSettled, error handling',
            resources: ['JavaScript.info: Promises', 'MDN: Promise'],
            practice: 'Build a rate-limited API fetcher that handles errors gracefully'
          },
          {
            title: 'Async/Await',
            description: 'Async functions, await behavior, error handling with try/catch, parallel vs sequential execution',
            resources: ['JavaScript.info: Async/Await'],
            practice: 'Convert Promise chains to async/await and handle errors properly'
          },
          {
            title: 'Modules (ES Modules)',
            description: 'import/export, named vs default exports, dynamic imports, module patterns, bundling concepts',
            resources: ['JavaScript.info: Modules', 'MDN: Modules'],
            practice: 'Structure a project using proper module separation'
          },
          {
            title: 'JSON & Fetch API',
            description: 'JSON.parse/stringify, fetch API, Response object, headers, request options, CORS basics',
            resources: ['MDN: Fetch API', 'JavaScript.info: Fetch'],
            practice: 'Build a weather app that fetches and displays data from a public API'
          },
          {
            title: 'Local Storage & Session Storage',
            description: 'setItem, getItem, removeItem, clear, storage event, serialization, limits',
            resources: ['MDN: Web Storage API'],
            practice: 'Build a persistent todo list with local storage'
          }
        ]
      },
      {
        id: 'advanced',
        title: 'Advanced Stage',
        subtitle: 'Master complex patterns and internals',
        level: 'advanced',
        duration: '4-6 months',
        topics: [
          {
            title: 'Event Loop & Concurrency Model',
            description: 'Call stack, task queue, microtask queue, event loop visualization, rendering pipeline, requestAnimationFrame',
            resources: ['Jake Archibald: Event Loop', 'JavaScript.info: Event Loop'],
            practice: 'Predict output order of complex async code snippets, implement a task scheduler'
          },
          {
            title: 'Memory Management & Garbage Collection',
            description: 'Memory lifecycle, reachability, garbage collection algorithms, memory leaks, Chrome DevTools memory profiling',
            resources: ['MDN: Memory Management', 'Google DevTools Docs'],
            practice: 'Identify and fix memory leaks in a SPA, use heap snapshots'
          },
          {
            title: 'Design Patterns',
            description: 'Singleton, Factory, Observer, Pub/Sub, Module, Strategy, Command, State, Proxy pattern',
            resources: ['Learning JavaScript Design Patterns (Addy Osmani)', 'Refactoring Guru'],
            practice: 'Implement each pattern in a practical scenario'
          },
          {
            title: 'Functional Programming',
            description: 'Pure functions, immutability, composition, currying, partial application, point-free style, functor/monad basics',
            resources: ['Mostly Adequate Guide to FP', 'JavaScript Allong√©'],
            practice: 'Build a data processing pipeline using functional composition'
          },
          {
            title: 'Advanced Array Methods & Algorithms',
            description: 'Chaining methods, performance considerations, implementing sorts, searching algorithms, Big O basics',
            resources: ['JavaScript Algorithms (trekhleb)', 'Big O Cheat Sheet'],
            practice: 'Implement quicksort, merge sort, and binary search in JavaScript'
          },
          {
            title: 'Generators & Iterators',
            description: 'Generator functions, yield, yield*, iterator protocol, iterable protocol, for...of, async generators',
            resources: ['JavaScript.info: Generators', 'MDN: Iteration Protocols'],
            practice: 'Build a lazy infinite sequence generator and a tree traversal iterator'
          },
          {
            title: 'Proxies & Reflect API',
            description: 'Proxy traps, revocable proxies, Reflect methods, use cases (validation, logging, virtual properties)',
            resources: ['JavaScript.info: Proxy', 'MDN: Proxy'],
            practice: 'Implement object validation, two-way data binding, and negative array indices'
          },
          {
            title: 'Web APIs Deep Dive',
            description: 'IntersectionObserver, ResizeObserver, MutationObserver, Clipboard API, Notification API, Geolocation',
            resources: ['MDN: Web APIs', 'Web.Dev'],
            practice: 'Build an infinite scroll component with IntersectionObserver'
          },
          {
            title: 'Regular Expressions',
            description: 'Regex syntax, character classes, quantifiers, groups, lookaheads, lookbehinds, replace with callbacks',
            resources: ['JavaScript.info: RegExp', 'RegexOne'],
            practice: 'Build a markdown parser using regex'
          },
          {
            title: 'Web Workers & Service Workers',
            description: 'Worker creation, message passing, SharedArrayBuffer, service worker lifecycle, caching strategies, PWA basics',
            resources: ['MDN: Web Workers', 'Google: Service Workers'],
            practice: 'Build an offline-capable PWA with background sync'
          }
        ]
      },
      {
        id: 'expert',
        title: 'Expert Stage',
        subtitle: 'Senior-level mastery and architecture',
        level: 'expert',
        duration: '6-12 months',
        topics: [
          {
            title: 'JavaScript Engine Internals',
            description: 'V8 architecture, Ignition interpreter, TurboFan compiler, inline caches, hidden classes, JIT compilation',
            resources: ['V8 Blog', 'JS Engine Fundamentals (Benedikt Meurer)'],
            practice: 'Write code that demonstrates engine optimizations and deoptimizations'
          },
          {
            title: 'Performance Optimization',
            description: 'Critical rendering path, layout thrashing, paint optimization, compositing, RAIL model, performance budgets',
            resources: ['Google Web Performance', 'Frontend Masters: Performance'],
            practice: 'Optimize a slow app to achieve 60fps scrolling and <3s LCP'
          },
          {
            title: 'Build Tools & Bundlers',
            description: 'Webpack/ESbuild/Vite internals, tree shaking, code splitting, lazy loading, module federation',
            resources: ['Webpack Docs', 'Vite Guide', 'Rollup Guide'],
            practice: 'Create a custom webpack plugin and optimize bundle size'
          },
          {
            title: 'Testing Strategies',
            description: 'Unit testing, integration testing, E2E testing, TDD/BDD, mocking strategies, test coverage, CI/CD integration',
            resources: ['Testing JavaScript (Kent C. Dodds)', 'Jest Docs', 'Cypress Docs'],
            practice: 'Write comprehensive tests for a complex component with 90%+ coverage'
          },
          {
            title: 'TypeScript Integration',
            description: 'Type system, generics, conditional types, mapped types, declaration files, type guards, inference',
            resources: ['TypeScript Deep Dive', 'TypeScript Docs'],
            practice: 'Convert a medium-sized JS project to TypeScript with strict mode'
          },
          {
            title: 'Security',
            description: 'XSS prevention, CSRF, CSP, sanitization, HTTPS, secure coding practices, OWASP top 10 for JS',
            resources: ['OWASP Cheat Sheet Series', 'Web Security Academy'],
            practice: 'Audit a vulnerable app and fix all security issues'
          },
          {
            title: 'Architecture Patterns',
            description: 'MVC, MVVM, Flux, Redux pattern, Clean Architecture, hexagonal architecture, micro-frontends',
            resources: ['Clean Architecture (Robert Martin)', 'Martin Fowler Blog'],
            practice: 'Design and implement a scalable frontend architecture for a large app'
          },
          {
            title: 'Node.js & Backend JS',
            description: 'Event-driven architecture, streams, cluster module, worker threads, Express/Fastify, database integration',
            resources: ['Node.js Design Patterns', 'Node.js Best Practices'],
            practice: 'Build a REST API with authentication, rate limiting, and proper error handling'
          },
          {
            title: 'Open Source & Code Review',
            description: 'Contributing to OSS, reading complex codebases, code review best practices, documentation writing',
            resources: ['First Timers Only', 'Conventional Commits'],
            practice: 'Contribute a meaningful PR to a major open source project'
          },
          {
            title: 'Mentorship & Leadership',
            description: 'Technical writing, public speaking, mentoring juniors, architectural decision records, tech debt management',
            resources: ['Staff Engineer (Will Larson)', 'The Manager\'s Path'],
            practice: 'Write technical documentation and present a complex topic to a team'
          }
        ]
      }
    ];

    const pitfallsData = [
      {
        title: 'var Hoisting Confusion',
        description: 'Variables declared with var are hoisted to function scope, leading to undefined access before declaration.',
        badCode: `console.log(x); // undefined (not error!)
var x = 5;
// Function scope, not block scope`,
        goodCode: `// Use let/const for block scope
console.log(x); // ReferenceError (helps catch bugs)
let x = 5;`,
        level: 'beginner'
      },
      {
        title: 'this Context Gotcha',
        description: 'this is dynamically scoped, not lexically scoped. It depends on how a function is called, not where it\'s defined.',
        badCode: `const obj = {
  value: 42,
  getValue: function() {
    setTimeout(function() {
      console.log(this.value); // undefined!
    }, 100);
  }
};`,
        goodCode: `const obj = {
  value: 42,
  getValue: function() {
    setTimeout(() => {
      console.log(this.value); // 42
    }, 100);
  }
};`,
        level: 'intermediate'
      },
      {
        title: 'Async/Await Error Handling',
        description: 'Forgetting to wrap await in try/catch leads to unhandled promise rejections that can crash your app.',
        badCode: `async function fetchUser() {
  const user = await fetch('/api/user');
  return user.json(); // If fetch fails, app crashes
}`,
        goodCode: `async function fetchUser() {
  try {
    const response = await fetch('/api/user');
    if (!response.ok) throw new Error('Failed');
    return response.json();
  } catch (error) {
    console.error('Fetch failed:', error);
    return null;
  }
}`,
        level: 'intermediate'
      },
      {
        title: 'Mutable State Surprises',
        description: 'Objects and arrays are passed by reference. Mutating them affects all references.',
        badCode: `const original = { items: [1, 2, 3] };
const copy = original;
copy.items.push(4);
// original.items is now [1, 2, 3, 4]!`,
        goodCode: `const original = { items: [1, 2, 3] };
const copy = {
  ...original,
  items: [...original.items, 4]
};
// original.items is still [1, 2, 3]`,
        level: 'intermediate'
      },
      {
        title: 'Floating Point Precision',
        description: 'JavaScript uses IEEE 754 floating point, leading to precision issues with decimals.',
        badCode: `0.1 + 0.2 === 0.3 // false!
0.1 + 0.2 // 0.30000000000000004`,
        goodCode: `// Use integer math or a library
const result = (0.1 * 100 + 0.2 * 100) / 100;
// Or: Number((0.1 + 0.2).toFixed(2))`,
        level: 'beginner'
      },
      {
        title: 'Promise.all Fail-Fast',
        description: 'Promise.all rejects immediately when any promise rejects, losing other results.',
        badCode: `const results = await Promise.all([
  fetch('/api/a'), // Fails
  fetch('/api/b'), // Success but lost
  fetch('/api/c')  // Success but lost
]);`,
        goodCode: `// Use allSettled for independent operations
const results = await Promise.allSettled([
  fetch('/api/a'),
  fetch('/api/b'),
  fetch('/api/c')
]);
// All results captured, check status`,
        level: 'advanced'
      },
      {
        title: 'Memory Leaks in Closures',
        description: 'Closures can accidentally hold references to large objects, preventing garbage collection.',
        badCode: `function createHandler() {
  const hugeData = fetchHugeDataset();
  return function handler() {
    // hugeData never released!
    return hugeData[0];
  };
}`,
        goodCode: `function createHandler() {
  const hugeData = fetchHugeDataset();
  const firstItem = hugeData[0];
  // Allow hugeData to be GC'd
  return function handler() {
    return firstItem;
  };
}`,
        level: 'advanced'
      },
      {
        title: 'prototype Pollution',
        description: 'Modifying Object.prototype affects all objects and can cause security vulnerabilities.',
        badCode: `// NEVER do this
Object.prototype.isAdmin = false;
// Now every object has isAdmin
const user = {};
user.isAdmin // false - dangerous!`,
        goodCode: `// Use Object.create(null) for clean objects
const cleanMap = Object.create(null);
cleanMap.isAdmin = false;
// No prototype chain to pollute`,
        level: 'advanced'
      }
    ];

    const tipsData = [
      {
        title: 'Build Projects, Not Tutorials',
        description: 'Tutorial hell is real. After learning a concept, immediately build something that uses it. The struggle is where learning happens.',
        action: 'For each topic, build a mini-project that uses at least 3 concepts together.'
      },
      {
        title: 'Read Source Code',
        description: 'Reading well-written codebases teaches patterns and idioms you won\'t find in tutorials. Start with small libraries.',
        action: 'Clone a library like "lodash" or "express" and trace one function from input to output.'
      },
      {
        title: 'Explain It to a Rubber Duck',
        description: 'Verbalizing your understanding reveals gaps. If you can\'t explain it simply, you don\'t understand it well enough.',
        action: 'Write a blog post or create a code comment explaining each concept in your own words.'
      },
      {
        title: 'Embrace the MDN Documentation',
        description: 'MDN is the authoritative JavaScript reference. Learning to read specs and docs is a senior-level skill.',
        action: 'Before Googling for tutorials, read the MDN page for any method you\'re using.'
      },
      {
        title: 'Practice Code Review',
        description: 'Reviewing others\' code exposes you to different approaches and helps develop critical thinking.',
        action: 'Find open source PRs on GitHub and read through the review comments and discussions.'
      },
      {
        title: 'Time-Box Deep Dives',
        description: 'It\'s easy to fall down rabbit holes. Set time limits for exploring tangential topics.',
        action: 'Use the Pomodoro technique: 25 minutes focused, 5 minutes break. Track what you accomplish.'
      },
      {
        title: 'Write Tests for Your Code',
        description: 'Writing tests forces you to think about edge cases and API design. It\'s a multiplier for learning.',
        action: 'Write tests before or alongside your implementation (TDD approach).'
      },
      {
        title: 'Debug Before Searching',
        description: 'When you hit an error, spend 10-15 minutes debugging before searching for solutions. This builds problem-solving muscle.',
        action: 'Use debugger statements and browser DevTools to trace execution before asking for help.'
      },
      {
        title: 'Teach What You Learn',
        description: 'Teaching solidifies knowledge. Even if no one reads your content, the act of creating it reinforces learning.',
        action: 'Create GitHub gists, Stack Overflow answers, or mentor a fellow learner.'
      },
      {
        title: 'Learn the Browser DevTools',
        description: 'DevTools is your most powerful ally. Master console methods, the debugger, network tab, and performance profiler.',
        action: 'Spend one dedicated session exploring each DevTools panel with a real project.'
      }
    ];

    const resourcesData = [
      { category: 'Documentation', items: [
        { name: 'MDN Web Docs', url: 'https://developer.mozilla.org', description: 'The authoritative reference for JavaScript and web APIs' },
        { name: 'TC39 Proposals', url: 'https://tc39.es', description: 'Official JavaScript language proposals and specs' },
        { name: 'JavaScript.info', url: 'https://javascript.info', description: 'Modern JavaScript tutorial with deep explanations' }
      ]},
      { category: 'Books', items: [
        { name: "You Don't Know JS", url: 'https://github.com/getify/You-Dont-Know-JS', description: 'Deep dive into JS mechanisms (free online)' },
        { name: 'Eloquent JavaScript', url: 'https://eloquentjavascript.net', description: 'Comprehensive introduction (free online)' },
        { name: 'JavaScript: The Good Parts', url: 'https://www.oreilly.com/library/view/javascript-the-good/9780596517748/', description: 'Classic book on language philosophy' }
      ]},
      { category: 'Practice Platforms', items: [
        { name: 'LeetCode', url: 'https://leetcode.com', description: 'Algorithm challenges with JS support' },
        { name: 'Codewars', url: 'https://www.codewars.com', description: 'Kata-based learning with community solutions' },
        { name: 'Frontend Mentor', url: 'https://www.frontendmentor.io', description: 'Real-world frontend challenges' }
      ]},
      { category: 'Video Courses', items: [
        { name: 'Frontend Masters', url: 'https://frontendmasters.com', description: 'Professional-grade courses from experts' },
        { name: 'JavaScript30', url: 'https://javascript30.com', description: '30-day vanilla JS challenge (free)' },
        { name: 'Wes Bos Courses', url: 'https://wesbos.com/courses', description: 'Practical project-based learning' }
      ]},
      { category: 'Tools', items: [
        { name: 'JSFiddle', url: 'https://jsfiddle.net', description: 'Quick prototyping and sharing' },
        { name: 'Babel REPL', url: 'https://babeljs.io/repl', description: 'See how modern JS compiles' },
        { name: 'JSPerf', url: 'https://jsperf.app', description: 'JavaScript performance benchmarks' }
      ]}
    ];

    // ========================================
    // STATE & STORAGE
    // ========================================
    
    let completedTopics = new Set();
    
    function loadProgress() {
      try {
        const saved = localStorage.getItem('js-roadmap-progress');
        if (saved) {
          completedTopics = new Set(JSON.parse(saved));
        }
      } catch (e) {
        console.error('Failed to load progress:', e);
      }
    }
    
    function saveProgress() {
      try {
        localStorage.setItem('js-roadmap-progress', JSON.stringify([...completedTopics]));
      } catch (e) {
        console.error('Failed to save progress:', e);
      }
    }
    
    // ========================================
    // RENDER FUNCTIONS
    // ========================================
    
    function renderStages() {
      const container = document.getElementById('stagesContainer');
      if (!container) return;
      
      let html = '';
      
      roadmapData.forEach((stage, stageIndex) => {
        const completedCount = stage.topics.filter(t => completedTopics.has(`${stage.id}-${t.title}`)).length;
        const progress = Math.round((completedCount / stage.topics.length) * 100);
        
        html += `
          <div class="stage-card animate-in stagger-${Math.min(stageIndex + 1, 4)}" data-stage="${stage.id}">
            <div class="stage-header p-6" onclick="toggleStage('${stage.id}')" role="button" tabindex="0" aria-expanded="false">
              <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                  <div class="flex items-center gap-3 mb-2">
                    <span class="level-badge level-${stage.level}">${stage.level}</span>
                    <span class="text-[var(--muted)] text-sm font-mono">${stage.duration}</span>
                  </div>
                  <h2 class="text-2xl font-bold">${stage.title}</h2>
                  <p class="text-[var(--muted)]">${stage.subtitle}</p>
                </div>
                <div class="text-right">
                  <div class="text-3xl font-bold font-mono text-[var(--accent)]">${progress}%</div>
                  <div class="text-sm text-[var(--muted)]">${completedCount}/${stage.topics.length} topics</div>
                </div>
              </div>
              <div class="mt-4 h-2 bg-[var(--bg)] rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-[var(--accent)] to-[#00ff88] transition-all duration-500" style="width: ${progress}%"></div>
              </div>
            </div>
            <div class="stage-content" id="content-${stage.id}">
              <div class="p-6 pt-0">
                <div class="space-y-3">
                  ${stage.topics.map(topic => renderTopic(stage.id, topic)).join('')}
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    function renderTopic(stageId, topic) {
      const topicId = `${stageId}-${topic.title}`;
      const isCompleted = completedTopics.has(topicId);
      
      return `
        <div class="topic-item" data-topic="${topicId}">
          <div class="flex gap-4">
            <div class="custom-checkbox ${isCompleted ? 'checked' : ''}" 
                 onclick="toggleTopic('${topicId}')" 
                 role="checkbox" 
                 aria-checked="${isCompleted}"
                 tabindex="0">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="font-semibold ${isCompleted ? 'line-through text-[var(--muted)]' : ''}">${topic.title}</h3>
              <p class="text-sm text-[var(--muted)] mt-1">${topic.description}</p>
              <div class="mt-3 flex flex-wrap gap-2">
                ${topic.resources.map(r => `<span class="text-xs font-mono bg-[var(--bg)] px-2 py-1 rounded">${r}</span>`).join('')}
              </div>
              <div class="mt-3 p-3 bg-[var(--bg)] rounded-lg">
                <p class="text-xs text-[var(--info)] font-mono mb-1">// Practice Project:</p>
                <p class="text-sm">${topic.practice}</p>
              </div>
            </div>
          </div>
        </div>
      `;
    }
    
    function renderPitfalls() {
      const container = document.getElementById('pitfallsContainer');
      if (!container) return;
      
      let html = '<h2 class="text-3xl font-bold mb-2">Common Pitfalls</h2>';
      html += '<p class="text-[var(--muted)] mb-8">These traps catch developers at all levels. Learn to recognize and avoid them.</p>';
      
      pitfallsData.forEach((pitfall, index) => {
        html += `
          <div class="pitfall-card animate-in stagger-${Math.min(index + 1, 4)}">
            <div class="flex items-center gap-3 mb-4">
              <span class="level-badge level-${pitfall.level}">${pitfall.level}</span>
              <h3 class="text-xl font-bold">${pitfall.title}</h3>
            </div>
            <p class="text-[var(--muted)] mb-4">${pitfall.description}</p>
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <p class="text-xs text-[var(--warning)] font-mono mb-2">// Avoid This</p>
                <div class="code-block">${escapeHtml(pitfall.badCode)}</div>
              </div>
              <div>
                <p class="text-xs text-[var(--success)] font-mono mb-2">// Do This Instead</p>
                <div class="code-block">${escapeHtml(pitfall.goodCode)}</div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    function renderTips() {
      const container = document.getElementById('tipsContainer');
      if (!container) return;
      
      let html = '<h2 class="text-3xl font-bold mb-2">Accelerate Your Learning</h2>';
      html += '<p class="text-[var(--muted)] mb-8">Battle-tested strategies from senior developers who\'ve been where you are.</p>';
      
      tipsData.forEach((tip, index) => {
        html += `
          <div class="tip-card animate-in stagger-${Math.min(index + 1, 4)}">
            <h3 class="text-xl font-bold mb-2">${tip.title}</h3>
            <p class="text-[var(--muted)] mb-4">${tip.description}</p>
            <div class="bg-[var(--bg)] p-4 rounded-lg border-l-4 border-[var(--accent)]">
              <p class="text-xs text-[var(--accent)] font-mono mb-1">// Action Item:</p>
              <p class="text-sm">${tip.action}</p>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    function renderResources() {
      const container = document.getElementById('resourcesContainer');
      if (!container) return;
      
      let html = '';
      
      resourcesData.forEach(category => {
        html += `
          <div class="bg-[var(--card)] border border-[var(--border)] rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">${category.category}</h3>
            <div class="space-y-4">
              ${category.items.map(item => `
                <a href="${item.url}" target="_blank" rel="noopener noreferrer" 
                   class="block p-4 bg-[var(--bg)] rounded-lg hover:border-[var(--accent)] border border-[var(--border)] transition-all group">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="font-semibold group-hover:text-[var(--accent)] transition-colors">${item.name}</span>
                    <svg class="w-4 h-4 text-[var(--muted)] group-hover:text-[var(--accent)] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                  </div>
                  <p class="text-sm text-[var(--muted)]">${item.description}</p>
                </a>
              `).join('')}
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    // ========================================
    // INTERACTIONS
    // ========================================
    
    function toggleStage(stageId) {
      const content = document.getElementById(`content-${stageId}`);
      const header = content?.previousElementSibling;
      
      if (content) {
        content.classList.toggle('expanded');
        if (header) {
          header.setAttribute('aria-expanded', content.classList.contains('expanded'));
        }
      }
    }
    
    function toggleTopic(topicId) {
      if (completedTopics.has(topicId)) {
        completedTopics.delete(topicId);
      } else {
        completedTopics.add(topicId);
      }
      
      saveProgress();
      updateUI();
    }
    
    function updateUI() {
      // Update progress bar
      let total = 0;
      let completed = 0;
      
      roadmapData.forEach(stage => {
        stage.topics.forEach(topic => {
          total++;
          if (completedTopics.has(`${stage.id}-${topic.title}`)) {
            completed++;
          }
        });
      });
      
      const progressBar = document.getElementById('progressBar');
      const completedCountEl = document.getElementById('completedCount');
      const totalCountEl = document.getElementById('totalCount');
      const currentLevelEl = document.getElementById('currentLevel');
      
      const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
      
      if (progressBar) progressBar.style.width = `${percentage}%`;
      if (completedCountEl) completedCountEl.textContent = completed;
      if (totalCountEl) totalCountEl.textContent = total;
      
      // Determine current level
      let level = 'Beginner';
      if (percentage >= 25) level = 'Intermediate';
      if (percentage >= 50) level = 'Advanced';
      if (percentage >= 75) level = 'Expert';
      if (percentage >= 100) level = 'Master';
      
      if (currentLevelEl) currentLevelEl.textContent = level;
      
      // Re-render stages for progress updates
      renderStages();
      
      // Re-expand previously expanded stages
      document.querySelectorAll('.stage-content.expanded').forEach(el => {
        const newContent = document.getElementById(el.id);
        if (newContent && !newContent.classList.contains('expanded')) {
          newContent.classList.add('expanded');
        }
      });
    }
    
    function switchTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tabName);
      });
      
      // Update tab content
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
      });
      
      const activeContent = document.getElementById(`${tabName}-tab`);
      if (activeContent) {
        activeContent.classList.remove('hidden');
      }
    }
    
    // ========================================
    // UTILITIES
    // ========================================
    
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }
    
    // ========================================
    // EVENT LISTENERS
    // ========================================
    
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => switchTab(btn.dataset.tab));
    });
    
    // Keyboard support for checkboxes
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        const target = e.target;
        if (target.classList.contains('custom-checkbox')) {
          e.preventDefault();
          target.click();
        }
        if (target.classList.contains('stage-header')) {
          e.preventDefault();
          target.click();
        }
      }
    });
    
    // Intersection Observer for scroll animations
    const observerOptions = {
      root: null,
      rootMargin: '0px',
      threshold: 0.1
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);
    
    // ========================================
    // INITIALIZATION
    // ========================================
    
    function init() {
      loadProgress();
      renderStages();
      renderPitfalls();
      renderTips();
      renderResources();
      updateUI();
      
      // Observe animated elements
      setTimeout(() => {
        document.querySelectorAll('.animate-in').forEach(el => {
          observer.observe(el);
        });
      }, 100);
    }
    
    // Run on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>