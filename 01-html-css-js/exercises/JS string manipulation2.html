<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS String Manipulation Masterclass</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6c63ff;
            --secondary: #ff6584;
            --accent: #43e97b;
            --dark: #1a1a2e;
            --darker: #16213e;
            --card: #0f3460;
            --text: #e0e0e0;
            --yellow: #ffd700;
            --orange: #ff8c00;
            --cyan: #00bcd4;
            --pink: #e91e63;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--dark);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background: linear-gradient(135deg, #6c63ff 0%, #e91e63 100%);
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 8px;
            position: relative;
            z-index: 1;
        }

        .emoji-row {
            font-size: 2rem;
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }

        /* NAVIGATION */
        nav {
            background: var(--darker);
            padding: 0;
            display: flex;
            overflow-x: auto;
            border-bottom: 3px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
            scrollbar-width: none;
        }

        nav::-webkit-scrollbar { display: none; }

        .nav-btn {
            padding: 14px 20px;
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -3px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-btn:hover {
            background: rgba(108, 99, 255, 0.2);
            color: var(--primary);
        }

        .nav-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(108, 99, 255, 0.1);
        }

        /* PROGRESS BAR */
        .progress-bar {
            background: var(--darker);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(108,99,255,0.2);
        }

        .progress-track {
            flex: 1;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            font-size: 0.8rem;
            color: var(--accent);
            font-weight: 600;
            min-width: 80px;
        }

        .xp-badge {
            background: linear-gradient(135deg, var(--yellow), var(--orange));
            color: #000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* SECTIONS */
        .section {
            display: none;
            padding: 20px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .section.active {
            display: block;
        }

        /* CARDS */
        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* CODE BLOCKS */
        .code-block {
            background: #0d1117;
            border-radius: 10px;
            padding: 16px;
            margin: 12px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid rgba(108,99,255,0.3);
            position: relative;
        }

        .code-block .comment { color: #6a9955; }
        .code-block .string { color: #ce9178; }
        .code-block .keyword { color: #569cd6; }
        .code-block .variable { color: #9cdcfe; }
        .code-block .method { color: #dcdcaa; }
        .code-block .number { color: #b5cea8; }
        .code-block .output { color: var(--accent); }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(108,99,255,0.3);
            border: none;
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s;
        }

        .copy-btn:hover { background: var(--primary); }

        /* LIVE EDITOR */
        .live-editor {
            background: #0d1117;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid var(--primary);
            margin: 16px 0;
        }

        .editor-header {
            background: #161b22;
            padding: 10px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(108,99,255,0.3);
        }

        .editor-dots {
            display: flex;
            gap: 6px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot-red { background: #ff5f57; }
        .dot-yellow { background: #febc2e; }
        .dot-green { background: #28c840; }

        .editor-label {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
        }

        .run-btn {
            background: linear-gradient(135deg, var(--accent), #00a86b);
            border: none;
            color: #000;
            padding: 6px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 700;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .run-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(67,233,123,0.4); }

        textarea.code-input {
            width: 100%;
            min-height: 120px;
            background: #0d1117;
            border: none;
            color: #e6edf3;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            padding: 16px;
            resize: vertical;
            outline: none;
        }

        .output-panel {
            background: #0a0f1a;
            padding: 12px 16px;
            border-top: 1px solid rgba(108,99,255,0.3);
            min-height: 50px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .output-label {
            color: rgba(255,255,255,0.4);
            font-size: 0.75rem;
            margin-bottom: 5px;
        }

        .output-result {
            color: var(--accent);
        }

        .output-error {
            color: var(--secondary);
        }

        /* VISUAL STRING DISPLAY */
        .string-visual {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
        }

        .char-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .char-cell {
            width: 42px;
            height: 42px;
            background: var(--primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            transition: all 0.3s;
            cursor: default;
        }

        .char-cell:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 5px 15px rgba(108,99,255,0.5);
        }

        .char-cell.space-char {
            background: rgba(108,99,255,0.3);
            border: 2px dashed rgba(108,99,255,0.5);
        }

        .char-index {
            font-size: 0.65rem;
            color: var(--yellow);
            font-family: 'Courier New', monospace;
        }

        .char-neg-index {
            font-size: 0.6rem;
            color: var(--secondary);
            font-family: 'Courier New', monospace;
        }

        /* METHOD CARDS */
        .methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }

        .method-card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid rgba(108,99,255,0.2);
            transition: all 0.3s;
            cursor: pointer;
        }

        .method-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(108,99,255,0.2);
        }

        .method-name {
            color: var(--yellow);
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .method-desc {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 10px;
        }

        .method-example {
            background: rgba(0,0,0,0.4);
            padding: 8px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: var(--accent);
        }

        /* TAGS */
        .tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin: 3px;
        }

        .tag-blue { background: rgba(108,99,255,0.2); color: var(--primary); border: 1px solid var(--primary); }
        .tag-green { background: rgba(67,233,123,0.2); color: var(--accent); border: 1px solid var(--accent); }
        .tag-red { background: rgba(255,101,132,0.2); color: var(--secondary); border: 1px solid var(--secondary); }
        .tag-yellow { background: rgba(255,215,0,0.2); color: var(--yellow); border: 1px solid var(--yellow); }

        /* QUIZ */
        .quiz-card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            border: 2px solid rgba(108,99,255,0.3);
        }

        .quiz-question {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .quiz-code {
            background: #0d1117;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-bottom: 16px;
            color: #e6edf3;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px 16px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(108,99,255,0.2);
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            text-align: left;
            color: var(--text);
            font-family: 'Courier New', monospace;
        }

        .quiz-option:hover:not(:disabled) {
            border-color: var(--primary);
            background: rgba(108,99,255,0.1);
        }

        .quiz-option.correct {
            border-color: var(--accent);
            background: rgba(67,233,123,0.15);
            color: var(--accent);
        }

        .quiz-option.wrong {
            border-color: var(--secondary);
            background: rgba(255,101,132,0.15);
            color: var(--secondary);
        }

        .quiz-feedback {
            margin-top: 12px;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            display: none;
        }

        .quiz-feedback.show { display: block; }
        .quiz-feedback.correct-fb { background: rgba(67,233,123,0.1); border: 1px solid var(--accent); color: var(--accent); }
        .quiz-feedback.wrong-fb { background: rgba(255,101,132,0.1); border: 1px solid var(--secondary); color: var(--secondary); }

        /* EXERCISES */
        .exercise-card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            border: 2px solid rgba(67,233,123,0.2);
        }

        .exercise-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--cyan));
        }

        .exercise-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--accent);
        }

        .exercise-desc {
            color: rgba(255,255,255,0.7);
            margin-bottom: 16px;
            line-height: 1.6;
        }

        .hint-btn {
            background: rgba(255,215,0,0.1);
            border: 1px solid var(--yellow);
            color: var(--yellow);
            padding: 6px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
            margin-bottom: 10px;
        }

        .hint-btn:hover { background: rgba(255,215,0,0.2); }

        .hint-box {
            background: rgba(255,215,0,0.05);
            border: 1px solid rgba(255,215,0,0.3);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.85rem;
            color: var(--yellow);
            display: none;
            margin-bottom: 10px;
        }

        .hint-box.show { display: block; }

        .check-btn {
            background: linear-gradient(135deg, var(--primary), #a78bfa);
            border: none;
            color: white;
            padding: 10px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 700;
            transition: all 0.2s;
            margin-top: 10px;
        }

        .check-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(108,99,255,0.4); }

        /* MISTAKE CARDS */
        .mistake-card {
            background: rgba(255,101,132,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid rgba(255,101,132,0.3);
            position: relative;
        }

        .mistake-title {
            color: var(--secondary);
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .vs-split {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 10px;
        }

        .wrong-code {
            background: rgba(255,101,132,0.1);
            border: 1px solid rgba(255,101,132,0.4);
            border-radius: 8px;
            padding: 12px;
        }

        .right-code {
            background: rgba(67,233,123,0.1);
            border: 1px solid rgba(67,233,123,0.4);
            border-radius: 8px;
            padding: 12px;
        }

        .wrong-code h4 { color: var(--secondary); margin-bottom: 8px; font-size: 0.85rem; }
        .right-code h4 { color: var(--accent); margin-bottom: 8px; font-size: 0.85rem; }

        /* REGEX SECTION */
        .regex-tester {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .regex-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .regex-input {
            flex: 1;
            min-width: 200px;
            background: #0d1117;
            border: 2px solid rgba(108,99,255,0.3);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
        }

        .regex-input:focus { border-color: var(--primary); }

        .test-text-area {
            width: 100%;
            min-height: 80px;
            background: #0d1117;
            border: 2px solid rgba(108,99,255,0.2);
            color: var(--text);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            outline: none;
            resize: vertical;
            transition: border-color 0.2s;
        }

        .test-text-area:focus { border-color: var(--primary); }

        .regex-result {
            margin-top: 12px;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            min-height: 50px;
        }

        .match-highlight {
            background: rgba(255,215,0,0.3);
            color: var(--yellow);
            padding: 2px 4px;
            border-radius: 3px;
            border-bottom: 2px solid var(--yellow);
        }

        /* TEMPLATE LITERAL VISUAL */
        .template-visual {
            background: #0d1117;
            border-radius: 12px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            line-height: 2;
            margin: 16px 0;
        }

        .tl-backtick { color: #569cd6; font-size: 1.3em; }
        .tl-text { color: #ce9178; }
        .tl-expression { color: var(--accent); }
        .tl-dollar-brace { color: var(--yellow); font-weight: 700; }
        .tl-brace-close { color: var(--yellow); font-weight: 700; }

        /* INTERACTIVE DEMOS */
        .demo-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 12px 0;
        }

        .demo-input {
            flex: 1;
            min-width: 150px;
            background: #0d1117;
            border: 2px solid rgba(108,99,255,0.3);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            outline: none;
        }

        .demo-input:focus { border-color: var(--primary); }

        .demo-output {
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 8px;
            min-height: 45px;
            border: 1px solid rgba(67,233,123,0.2);
        }

        /* SCORE DISPLAY */
        .score-display {
            background: linear-gradient(135deg, rgba(108,99,255,0.2), rgba(233,30,99,0.2));
            border: 1px solid rgba(108,99,255,0.4);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            margin-bottom: 20px;
        }

        .score-number {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ANIMATIONS */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px var(--primary); }
            50% { box-shadow: 0 0 20px var(--primary), 0 0 40px rgba(108,99,255,0.3); }
        }

        .animate-in {
            animation: slideIn 0.4s ease forwards;
        }

        .bounce { animation: bounce 1s ease infinite; }

        /* CONFETTI */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 2px;
            animation: confettiFall 3s ease-in forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* CHEATSHEET */
        .cheatsheet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
        }

        .cheat-item {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 12px;
            border-left: 3px solid var(--primary);
        }

        .cheat-method {
            color: var(--yellow);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .cheat-desc {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            margin-top: 4px;
        }

        .cheat-ex {
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: var(--accent);
            margin-top: 4px;
        }

        /* TOOLTIP */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.9);
            color: var(--text);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
            border: 1px solid rgba(108,99,255,0.4);
        }

        .tooltip:hover::after { opacity: 1; }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            header h1 { font-size: 1.6rem; }
            .quiz-options { grid-template-columns: 1fr; }
            .vs-split { grid-template-columns: 1fr; }
            .methods-grid { grid-template-columns: 1fr; }
            .char-cell { width: 34px; height: 34px; font-size: 0.9rem; }
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--darker); }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 3px; }

        /* SECTION INTRO */
        .section-intro {
            text-align: center;
            padding: 30px 0;
        }

        .section-intro h2 {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .section-intro p {
            color: rgba(255,255,255,0.6);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* NEXT SECTION BTN */
        .next-btn {
            display: block;
            width: fit-content;
            margin: 30px auto;
            padding: 14px 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50px;
            color: white;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(108,99,255,0.4);
        }

        .callout {
            background: rgba(108,99,255,0.1);
            border-left: 4px solid var(--primary);
            padding: 14px 18px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .callout-warning {
            background: rgba(255,140,0,0.1);
            border-left-color: var(--orange);
        }

        .callout-tip {
            background: rgba(67,233,123,0.1);
            border-left-color: var(--accent);
        }
    </style>
</head>
<body>

<!-- CONFETTI CONTAINER -->
<div class="confetti-container" id="confettiContainer"></div>

<!-- HEADER -->
<header>
    <h1>üé∏ JS String Masterclass</h1>
    <p>Master JavaScript Strings from Zero to Hero!</p>
    <div class="emoji-row">üî§ ‚ú® üí° üöÄ üéØ</div>
</header>

<!-- NAV -->
<nav>
    <button class="nav-btn active" onclick="showSection('basics', this)">üè† Basics</button>
    <button class="nav-btn" onclick="showSection('creation', this)">‚úèÔ∏è Creation</button>
    <button class="nav-btn" onclick="showSection('template', this)">üîß Template Literals</button>
    <button class="nav-btn" onclick="showSection('methods', this)">‚ö° Methods</button>
    <button class="nav-btn" onclick="showSection('regex', this)">üîç Regex</button>
    <button class="nav-btn" onclick="showSection('mistakes', this)">‚ö†Ô∏è Mistakes</button>
    <button class="nav-btn" onclick="showSection('exercises', this)">üí™ Exercises</button>
    <button class="nav-btn" onclick="showSection('quiz', this)">üß† Quiz</button>
    <button class="nav-btn" onclick="showSection('cheatsheet', this)">üìã Cheatsheet</button>
</nav>

<!-- PROGRESS -->
<div class="progress-bar">
    <span style="font-size:0.8rem; color:rgba(255,255,255,0.5);">Progress:</span>
    <div class="progress-track">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <span class="progress-text" id="progressText">0% Complete</span>
    <span class="xp-badge" id="xpBadge">‚≠ê 0 XP</span>
</div>

<!-- ===== SECTION: BASICS ===== -->
<section class="section active" id="basics">
    <div class="section-intro animate-in">
        <h2>üéØ What is a String?</h2>
        <p>A string is a sequence of characters ‚Äî letters, numbers, symbols, spaces ‚Äî wrapped in quotes. Think of it as a necklace of characters! üìø</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">üî§ Strings are Characters in a Row</div>
        <p style="margin-bottom:15px; color:rgba(255,255,255,0.7);">Hover over each character box to see its index!</p>
        
        <div style="margin-bottom:10px;">
            <label style="font-size:0.85rem; color:rgba(255,255,255,0.6);">Type a string to visualize it:</label>
            <div class="demo-row">
                <input class="demo-input" id="visualInput" value="Hello!" oninput="updateVisual()" placeholder="Type here...">
            </div>
        </div>

        <div class="string-visual" id="stringVisual"></div>

        <div class="callout">
            üí° <strong>Key fact:</strong> JavaScript strings are <strong>zero-indexed</strong> ‚Äî the first character is at index <strong>0</strong>, not 1! The yellow numbers show positive indexes, the red numbers show negative indexes (count from the end).
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üìè String Properties</div>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">let</span> <span class="variable">str</span> = <span class="string">"JavaScript"</span>;<br><br>
            <span class="comment">// Length - how many characters?</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">str</span>.length);  <span class="output">// 10</span><br><br>
            <span class="comment">// Access a character by index</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">str</span>[<span class="number">0</span>]);       <span class="output">// "J"</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">str</span>[<span class="number">4</span>]);       <span class="output">// "S"</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">str</span>[<span class="number">9</span>]);       <span class="output">// "t"</span>
        </div>

        <div class="demo-row">
            <input class="demo-input" id="lengthInput" value="JavaScript" oninput="updateLength()" placeholder="Type to check length...">
        </div>
        <div class="demo-output" id="lengthOutput">
            <span style="color:rgba(255,255,255,0.5);">‚Üí </span>
            <span id="lengthResult" style="color:var(--accent);">Length: 10</span>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üßä Strings are Immutable</div>
        <div class="callout callout-warning">
            ‚ö†Ô∏è <strong>Important!</strong> You CANNOT change individual characters of a string directly. Strings are <strong>immutable</strong> (unchangeable). You must create a NEW string instead!
        </div>
        <div class="code-block">
            <span class="keyword">let</span> <span class="variable">name</span> = <span class="string">"Jack"</span>;<br><br>
            <span class="comment">// ‚ùå This does NOTHING (no error, just silently fails)</span><br>
            <span class="variable">name</span>[<span class="number">0</span>] = <span class="string">"M"</span>;<br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">name</span>);  <span class="output">// "Jack"  ‚Üê didn't change!</span><br><br>
            <span class="comment">// ‚úÖ Correct way ‚Äî create a NEW string</span><br>
            <span class="variable">name</span> = <span class="string">"M"</span> + <span class="variable">name</span>.<span class="method">slice</span>(<span class="number">1</span>);<br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">name</span>);  <span class="output">// "Mack"</span>
        </div>
    </div>

    <button class="next-btn" onclick="goToSection('creation')">Next: String Creation ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: CREATION ===== -->
<section class="section" id="creation">
    <div class="section-intro animate-in">
        <h2>‚úèÔ∏è Creating Strings</h2>
        <p>There are three ways to create strings in JavaScript. Let's explore each one!</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">3Ô∏è‚É£ Three Quote Types</div>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="comment">// 1. Single quotes</span><br>
            <span class="keyword">let</span> <span class="variable">a</span> = <span class="string">'Hello World'</span>;<br><br>
            <span class="comment">// 2. Double quotes</span><br>
            <span class="keyword">let</span> <span class="variable">b</span> = <span class="string">"Hello World"</span>;<br><br>
            <span class="comment">// 3. Backticks (template literals) - most powerful!</span><br>
            <span class="keyword">let</span> <span class="variable">c</span> = <span class="string">`Hello World`</span>;<br><br>
            <span class="comment">// They all create the SAME result</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">a</span> === <span class="variable">b</span>);  <span class="output">// true</span>
        </div>

        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:12px; margin-top:15px;">
            <div style="background:rgba(108,99,255,0.1); border:1px solid var(--primary); border-radius:10px; padding:14px; text-align:center;">
                <div style="font-size:2rem;">&#x27;</div>
                <div style="font-weight:700; color:var(--primary);">Single Quotes</div>
                <div style="font-size:0.8rem; color:rgba(255,255,255,0.6); margin-top:5px;">Simple, traditional<br>Can't use apostrophe easily</div>
            </div>
            <div style="background:rgba(233,30,99,0.1); border:1px solid var(--secondary); border-radius:10px; padding:14px; text-align:center;">
                <div style="font-size:2rem;">"</div>
                <div style="font-weight:700; color:var(--secondary);">Double Quotes</div>
                <div style="font-size:0.8rem; color:rgba(255,255,255,0.6); margin-top:5px;">Popular, clean<br>Good for HTML attributes</div>
            </div>
            <div style="background:rgba(67,233,123,0.1); border:1px solid var(--accent); border-radius:10px; padding:14px; text-align:center;">
                <div style="font-size:2rem;">&#96;</div>
                <div style="font-weight:700; color:var(--accent);">Backticks</div>
                <div style="font-size:0.8rem; color:rgba(255,255,255,0.6); margin-top:5px;">Modern & powerful<br>Supports expressions!</div>
            </div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üîó String Concatenation</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Joining strings together using the <code style="color:var(--yellow);">+</code> operator.</p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">let</span> <span class="variable">firstName</span> = <span class="string">"Ada"</span>;<br>
            <span class="keyword">let</span> <span class="variable">lastName</span> = <span class="string">"Lovelace"</span>;<br><br>
            <span class="comment">// Concatenation with +</span><br>
            <span class="keyword">let</span> <span class="variable">fullName</span> = <span class="variable">firstName</span> + <span class="string">" "</span> + <span class="variable">lastName</span>;<br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">fullName</span>);  <span class="output">// "Ada Lovelace"</span><br><br>
            <span class="comment">// += shorthand</span><br>
            <span class="keyword">let</span> <span class="variable">greeting</span> = <span class="string">"Hello, "</span>;<br>
            <span class="variable">greeting</span> += <span class="variable">fullName</span>;<br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">greeting</span>);  <span class="output">// "Hello, Ada Lovelace"</span>
        </div>

        <div class="callout callout-warning">
            ‚ö†Ô∏è <strong>Watch out!</strong> When you use <code style="color:var(--yellow);">+</code> with a number and string, JS converts the number to a string first!<br>
            <code style="color:var(--secondary);">"5" + 3 = "53"</code> (string!) not <code style="color:var(--accent);">8</code> (number!)
        </div>

        <div class="live-editor" id="concatEditor">
            <div class="editor-header">
                <div class="editor-dots"><div class="dot dot-red"></div><div class="dot dot-yellow"></div><div class="dot dot-green"></div></div>
                <span class="editor-label">Try it yourself! ‚úèÔ∏è</span>
                <button class="run-btn" onclick="runCode('concatInput', 'concatOutput')">‚ñ∂ Run</button>
            </div>
            <textarea class="code-input" id="concatInput">let first = "Your";
let second = "Name";
let result = first + " " + second;
console.log(result);
console.log("Length: " + result.length);
console.log("Number + String: " + (5 + " apples"));</textarea>
            <div class="output-panel">
                <div class="output-label">Output:</div>
                <div class="output-result" id="concatOutput"></div>
            </div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üö™ Escape Characters</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Special characters that need a backslash <code style="color:var(--yellow);">\</code> to work inside strings.</p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"She said \"Hello!\""</span>);   <span class="output">// She said "Hello!"</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">'It\'s a great day'</span>);    <span class="output">// It's a great day</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"Line 1\nLine 2"</span>);          <span class="output">// Line 1</span><br>
                                                                                 <span class="output">// Line 2</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"Tab\there"</span>);             <span class="output">// Tab   here</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"Back\\slash"</span>);          <span class="output">// Back\slash</span>
        </div>

        <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:8px; margin-top:15px;">
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\n</div>
                <div class="cheat-desc">New line</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\t</div>
                <div class="cheat-desc">Tab space</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\"</div>
                <div class="cheat-desc">Double quote</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\'</div>
                <div class="cheat-desc">Single quote</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\\\</div>
                <div class="cheat-desc">Backslash</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--yellow);">
                <div class="cheat-method">\\0</div>
                <div class="cheat-desc">Null character</div>
            </div>
        </div>
    </div>

    <button class="next-btn" onclick="goToSection('template')">Next: Template Literals ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: TEMPLATE LITERALS ===== -->
<section class="section" id="template">
    <div class="section-intro animate-in">
        <h2>üîß Template Literals</h2>
        <p>The modern, powerful way to work with strings. Use backticks ` ` and embed any JavaScript expression with ${`...`}!</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">‚ú® The Magic of Template Literals</div>
        
        <div class="template-visual">
            <span class="tl-backtick">`</span><span class="tl-text">Hello, </span><span class="tl-dollar-brace">${</span><span class="tl-expression">name</span><span class="tl-brace-close">}</span><span class="tl-text">! You are </span><span class="tl-dollar-brace">${</span><span class="tl-expression">age</span><span class="tl-brace-close">}</span><span class="tl-text"> years old.</span><span class="tl-backtick">`</span>
            <div style="margin-top:15px; font-size:0.85rem;">
                <span style="color:rgba(255,255,255,0.4);">‚Üë backtick opens/closes the template</span><br>
                <span style="color:var(--yellow);">‚Üë ${`...`} embeds any JavaScript expression</span><br>
                <span style="color:var(--secondary);">‚Üë anything inside ${`...`} is executed as JS!</span>
            </div>
        </div>

        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">const</span> <span class="variable">name</span> = <span class="string">"Ada"</span>;<br>
            <span class="keyword">const</span> <span class="variable">age</span> = <span class="number">35</span>;<br>
            <span class="keyword">const</span> <span class="variable">language</span> = <span class="string">"JavaScript"</span>;<br><br>
            <span class="comment">// Old way (concatenation) üò©</span><br>
            <span class="keyword">const</span> <span class="variable">old</span> = <span class="string">"Hi, I'm "</span> + <span class="variable">name</span> + <span class="string">", I'm "</span> + <span class="variable">age</span> + <span class="string">" and I love "</span> + <span class="variable">language</span>;<br><br>
            <span class="comment">// New way (template literal) üéâ</span><br>
            <span class="keyword">const</span> <span class="variable">modern</span> = <span class="string">`Hi, I'm ${<span class="variable">name</span>}, I'm ${<span class="variable">age</span>} and I love ${<span class="variable">language</span>}`</span>;<br><br>
            <span class="comment">// Both produce the same result but modern is easier to read!</span>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üßÆ Expressions Inside Templates</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">You can put ANY JavaScript expression inside <code style="color:var(--yellow);">${ }</code>!</p>

        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">const</span> <span class="variable">a</span> = <span class="number">10</span>;<br>
            <span class="keyword">const</span> <span class="variable">b</span> = <span class="number">5</span>;<br><br>
            <span class="comment">// Math expressions</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">a</span>} + ${<span class="variable">b</span>} = ${<span class="variable">a</span> + <span class="variable">b</span>}`</span>);     <span class="output">// "10 + 5 = 15"</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`${<span class="variable">a</span>} * ${<span class="variable">b</span>} = ${<span class="variable">a</span> * <span class="variable">b</span>}`</span>);     <span class="output">// "10 * 5 = 50"</span><br><br>
            <span class="comment">// Function calls</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`Uppercase: ${"hello".<span class="method">toUpperCase</span>()}`</span>);  <span class="output">// "Uppercase: HELLO"</span><br><br>
            <span class="comment">// Ternary (condition ? yes : no)</span><br>
            <span class="keyword">const</span> <span class="variable">score</span> = <span class="number">85</span>;<br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">`Result: ${<span class="variable">score</span> >= <span class="number">60</span> ? <span class="string">"PASS"</span> : <span class="string">"FAIL"</span>}`</span>);  <span class="output">// "Result: PASS"</span>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üìú Multi-line Strings</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Template literals make multi-line strings super easy!</p>

        <div class="vs-split">
            <div class="wrong-code">
                <h4>‚ùå Old painful way:</h4>
                <div style="font-family:'Courier New', monospace; font-size:0.8rem; color:var(--secondary);">
                    const poem = "Roses are red,\n" +<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Violets are blue,\n" +<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"JavaScript is fun,\n" +<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"And so are you!";
                </div>
            </div>
            <div class="right-code">
                <h4>‚úÖ Template literal way:</h4>
                <div style="font-family:'Courier New', monospace; font-size:0.8rem; color:var(--accent);">
                    const poem = `Roses are red,<br>
Violets are blue,<br>
JavaScript is fun,<br>
And so are you!`;<br>
                </div>
            </div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üéÆ Interactive Template Builder</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Fill in the fields and watch the template literal update live!</p>
        
        <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:10px; margin-bottom:15px;">
            <div>
                <label style="font-size:0.8rem; color:rgba(255,255,255,0.5);">Your Name:</label>
                <input class="demo-input" id="tlName" value="Ada" oninput="updateTemplate()" style="margin-top:5px; width:100%;">
            </div>
            <div>
                <label style="font-size:0.8rem; color:rgba(255,255,255,0.5);">Your Age:</label>
                <input class="demo-input" id="tlAge" value="25" oninput="updateTemplate()" style="margin-top:5px; width:100%;" type="number">
            </div>
            <div>
                <label style="font-size:0.8rem; color:rgba(255,255,255,0.5);">Favorite Language:</label>
                <input class="demo-input" id="tlLang" value="JavaScript" oninput="updateTemplate()" style="margin-top:5px; width:100%;">
            </div>
        </div>

        <div class="code-block" id="templateCode">
            Loading...
        </div>

        <div style="background:rgba(67,233,123,0.1); border:1px solid rgba(67,233,123,0.3); padding:12px; border-radius:8px; font-family:'Courier New',monospace;">
            <span style="color:rgba(255,255,255,0.5);">Output: </span>
            <span id="templateOutput" style="color:var(--accent);"></span>
        </div>
    </div>

    <div class="live-editor">
        <div class="editor-header">
            <div class="editor-dots"><div class="dot dot-red"></div><div class="dot dot-yellow"></div><div class="dot dot-green"></div></div>
            <span class="editor-label">Practice Template Literals ‚úèÔ∏è</span>
            <button class="run-btn" onclick="runCode('templateInput', 'templateRunOutput')">‚ñ∂ Run</button>
        </div>
        <textarea class="code-input" id="templateInput">const product = "Laptop";
const price = 999;
const discount = 0.1;
const finalPrice = price * (1 - discount);

console.log(`Product: ${product}`);
console.log(`Original Price: $${price}`);
console.log(`After ${discount * 100}% discount: $${finalPrice}`);
console.log(`Buy now and save $${price - finalPrice}!`);</textarea>
        <div class="output-panel">
            <div class="output-label">Output:</div>
            <div class="output-result" id="templateRunOutput"></div>
        </div>
    </div>

    <button class="next-btn" onclick="goToSection('methods')">Next: String Methods ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: METHODS ===== -->
<section class="section" id="methods">
    <div class="section-intro animate-in">
        <h2>‚ö° String Methods</h2>
        <p>JavaScript gives you 30+ powerful methods to search, transform, slice, and manipulate strings. Let's master the most important ones!</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">üîç Finding & Searching</div>
        <div class="methods-grid" id="searchMethodsGrid"></div>
    </div>

    <div class="card animate-in">
        <div class="card-title">‚úÇÔ∏è Extracting & Slicing</div>
        <div class="methods-grid" id="sliceMethodsGrid"></div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üîÑ Transforming</div>
        <div class="methods-grid" id="transformMethodsGrid"></div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üéÆ Interactive Method Playground</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Type a string and pick a method to see it in action!</p>

        <div class="demo-row">
            <input class="demo-input" id="methodPlayInput" value="  Hello, World!  " placeholder="Enter a string..." style="flex:2;" oninput="runMethodPlay()">
            <select id="methodSelect" onchange="runMethodPlay()" style="background:#0d1117; border:2px solid rgba(108,99,255,0.3); color:var(--text); padding:10px; border-radius:8px; font-size:0.9rem; min-width:200px;">
                <optgroup label="Case">
                    <option value="toUpperCase">toUpperCase()</option>
                    <option value="toLowerCase">toLowerCase()</option>
                </optgroup>
                <optgroup label="Trim">
                    <option value="trim">trim()</option>
                    <option value="trimStart">trimStart()</option>
                    <option value="trimEnd">trimEnd()</option>
                </optgroup>
                <optgroup label="Search">
                    <option value="length">.length</option>
                    <option value="indexOf_Hello">indexOf('Hello')</option>
                    <option value="includes_World">includes('World')</option>
                    <option value="startsWith_Hello">startsWith(' ')</option>
                    <option value="endsWith_!">endsWith('!')</option>
                </optgroup>
                <optgroup label="Slice">
                    <option value="slice_0_5">slice(0, 5)</option>
                    <option value="slice_-6">slice(-6)</option>
                    <option value="charAt_0">charAt(0)</option>
                </optgroup>
                <optgroup label="Replace">
                    <option value="replace_Hello_Hi">replace('Hello', 'Hi')</option>
                    <option value="replaceAll">replaceAll('l', 'L')</option>
                </optgroup>
                <optgroup label="Split">
                    <option value="split_comma">split(',')</option>
                    <option value="split_chars">split('')</option>
                </optgroup>
                <optgroup label="Repeat/Pad">
                    <option value="repeat_3">repeat(3)</option>
                    <option value="padStart">padStart(20, '*')</option>
                    <option value="padEnd">padEnd(20, '-')</option>
                </optgroup>
            </select>
        </div>

        <div style="background:rgba(0,0,0,0.4); border-radius:10px; padding:15px; margin-top:10px;">
            <div style="font-family:'Courier New',monospace; font-size:0.85rem; color:rgba(255,255,255,0.5); margin-bottom:8px;">Code:</div>
            <div id="methodCode" style="font-family:'Courier New',monospace; font-size:0.95rem; color:var(--yellow);"></div>
            <div style="border-top:1px solid rgba(255,255,255,0.1); margin:10px 0;"></div>
            <div style="font-family:'Courier New',monospace; font-size:0.85rem; color:rgba(255,255,255,0.5); margin-bottom:8px;">Result:</div>
            <div id="methodResult" style="font-family:'Courier New',monospace; font-size:1rem; color:var(--accent);"></div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üîó Chaining Methods</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Chain multiple methods together ‚Äî one after another!</p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">const</span> <span class="variable">messy</span> = <span class="string">"  hello, world!  "</span>;<br><br>
            <span class="comment">// Chain trim ‚Üí uppercase ‚Üí replace</span><br>
            <span class="keyword">const</span> <span class="variable">clean</span> = <span class="variable">messy</span><br>
            &nbsp;&nbsp;.<span class="method">trim</span>()          <span class="comment">// "hello, world!"</span><br>
            &nbsp;&nbsp;.<span class="method">toUpperCase</span>()  <span class="comment">// "HELLO, WORLD!"</span><br>
            &nbsp;&nbsp;.<span class="method">replace</span>(<span class="string">","</span>, <span class="string">"!"</span>); <span class="comment">// "HELLO! WORLD!"</span><br><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">clean</span>);  <span class="output">// "HELLO! WORLD!"</span>
        </div>

        <div class="live-editor">
            <div class="editor-header">
                <div class="editor-dots"><div class="dot dot-red"></div><div class="dot dot-yellow"></div><div class="dot dot-green"></div></div>
                <span class="editor-label">Practice Method Chaining ‚úèÔ∏è</span>
                <button class="run-btn" onclick="runCode('chainingInput', 'chainingOutput')">‚ñ∂ Run</button>
            </div>
            <textarea class="code-input" id="chainingInput">const email = "  USER@EXAMPLE.COM  ";

// Clean it up with method chaining!
const cleanEmail = email
  .trim()
  .toLowerCase();

console.log("Original:", JSON.stringify(email));
console.log("Cleaned:", cleanEmail);

// More chaining examples
const sentence = "the quick brown fox";
const titleCase = sentence
  .split(' ')
  .map(word => word.charAt(0).toUpperCase() + word.slice(1))
  .join(' ');
  
console.log("Title case:", titleCase);</textarea>
            <div class="output-panel">
                <div class="output-label">Output:</div>
                <div class="output-result" id="chainingOutput"></div>
            </div>
        </div>
    </div>

    <button class="next-btn" onclick="goToSection('regex')">Next: Regular Expressions ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: REGEX ===== -->
<section class="section" id="regex">
    <div class="section-intro animate-in">
        <h2>üîç Regular Expressions</h2>
        <p>RegEx are powerful patterns for searching and matching text. They look scary at first but become your superpower once you learn them!</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">üéØ What is a RegEx?</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">A regular expression is a pattern between two forward slashes: <code style="color:var(--yellow);">/pattern/flags</code></p>
        
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="comment">// Two ways to create a RegEx</span><br>
            <span class="keyword">const</span> <span class="variable">regex1</span> = <span class="string">/hello/</span>;           <span class="comment">// literal (preferred)</span><br>
            <span class="keyword">const</span> <span class="variable">regex2</span> = <span class="keyword">new</span> <span class="method">RegExp</span>(<span class="string">"hello"</span>);  <span class="comment">// constructor</span><br><br>
            <span class="comment">// Test if a string matches</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">/hello/</span>.<span class="method">test</span>(<span class="string">"say hello world"</span>));  <span class="output">// true</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">/hello/</span>.<span class="method">test</span>(<span class="string">"goodbye world"</span>));    <span class="output">// false</span>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üö© Flags</div>
        <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:10px; margin:15px 0;">
            <div class="cheat-item" style="border-left-color:var(--cyan);">
                <div class="cheat-method">/pattern/g</div>
                <div class="cheat-desc"><strong>g</strong>lobal ‚Äî find ALL matches</div>
                <div class="cheat-ex">/a/g ‚Üí finds every "a"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--cyan);">
                <div class="cheat-method">/pattern/i</div>
                <div class="cheat-desc"><strong>i</strong>nsensitive ‚Äî ignore case</div>
                <div class="cheat-ex">/hello/i ‚Üí "Hello", "HELLO"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--cyan);">
                <div class="cheat-method">/pattern/m</div>
                <div class="cheat-desc"><strong>m</strong>ultiline mode</div>
                <div class="cheat-ex">^ and $ match each line</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--cyan);">
                <div class="cheat-method">/pattern/gi</div>
                <div class="cheat-desc">Combine flags!</div>
                <div class="cheat-ex">global + case insensitive</div>
            </div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üî° Common Patterns (Character Classes)</div>
        <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:10px; margin:15px 0;">
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">\\d</div>
                <div class="cheat-desc">Any digit (0-9)</div>
                <div class="cheat-ex">/\d/ matches "5" in "abc5"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">\\w</div>
                <div class="cheat-desc">Word char (a-z, A-Z, 0-9, _)</div>
                <div class="cheat-ex">/\w+/ matches "hello"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">\\s</div>
                <div class="cheat-desc">Any whitespace</div>
                <div class="cheat-ex">/\s/ matches " ", "\t", "\n"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">.</div>
                <div class="cheat-desc">Any character (except newline)</div>
                <div class="cheat-ex">/h.t/ matches "hot","hit","hat"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">^</div>
                <div class="cheat-desc">Start of string</div>
                <div class="cheat-ex">/^Hello/ ‚Üí starts with Hello</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">$</div>
                <div class="cheat-desc">End of string</div>
                <div class="cheat-ex">/world$/ ‚Üí ends with world</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">+</div>
                <div class="cheat-desc">One or MORE of previous</div>
                <div class="cheat-ex">/a+/ matches "a", "aa", "aaa"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">*</div>
                <div class="cheat-desc">Zero or MORE of previous</div>
                <div class="cheat-ex">/a*/ matches "", "a", "aa"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">?</div>
                <div class="cheat-desc">Zero or ONE (optional)</div>
                <div class="cheat-ex">/colou?r/ ‚Üí "color","colour"</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">[abc]</div>
                <div class="cheat-desc">Any of these characters</div>
                <div class="cheat-ex">/[aeiou]/ matches vowels</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">[^abc]</div>
                <div class="cheat-desc">NOT any of these</div>
                <div class="cheat-ex">/[^0-9]/ matches non-digits</div>
            </div>
            <div class="cheat-item" style="border-left-color:var(--pink);">
                <div class="cheat-method">{3}</div>
                <div class="cheat-desc">Exactly N times</div>
                <div class="cheat-ex">/\d{3}/ matches "123"</div>
            </div>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">‚ö° Using RegEx with String Methods</div>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <span class="keyword">const</span> <span class="variable">text</span> = <span class="string">"My phone: 555-1234, backup: 555-5678"</span>;<br><br>
            <span class="comment">// .match() ‚Äî find matches</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">text</span>.<span class="method">match</span>(<span class="string">/\d{3}-\d{4}/g</span>));<br>
            <span class="output">// ["555-1234", "555-5678"]</span><br><br>
            <span class="comment">// .test() ‚Äî returns true/false</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">/\d{3}-\d{4}/</span>.<span class="method">test</span>(<span class="variable">text</span>));  <span class="output">// true</span><br><br>
            <span class="comment">// .replace() with regex</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="variable">text</span>.<span class="method">replace</span>(<span class="string">/\d{3}-\d{4}/g</span>, <span class="string">"XXX-XXXX"</span>));<br>
            <span class="output">// "My phone: XXX-XXXX, backup: XXX-XXXX"</span><br><br>
            <span class="comment">// .split() with regex</span><br>
            <span class="variable">console</span>.<span class="method">log</span>(<span class="string">"one1two2three"</span>.<span class="method">split</span>(<span class="string">/\d/</span>));<br>
            <span class="output">// ["one", "two", "three"]</span>
        </div>
    </div>

    <div class="card animate-in">
        <div class="card-title">üß™ Live Regex Tester</div>
        <p style="color:rgba(255,255,255,0.7); margin-bottom:15px;">Test your regex patterns in real time! Matches are highlighted in yellow.</p>

        <div class="regex-tester">
            <div class="regex-input-row">
                <div style="display:flex; align-items:center; gap:5px; font-size:1.2rem; color:var(--primary);">/</div>
                <input class="regex-input" id="regexPattern" placeholder="Enter pattern (e.g. \d+)" value="\d+" oninput="testRegex()">
                <div style="display:flex; align-items:center; gap:5px; font-size:1.2rem; color:var(--primary);">/</div>
                <input class="regex-input" id="regexFlags" placeholder="flags (g,i,m)" value="g" oninput="testRegex()" style="max-width:80px;">
            </div>
            <textarea class="test-text-area" id="regexTestText" oninput="testRegex()">
I have 3 cats and 12 dogs. My phone is 555-1234.
Emails: user@test.com and admin@site.org
ZIP codes: 12345 and 90210</textarea>
            <div class="regex-result" id="regexResultDisplay">Type a pattern above to see matches highlighted...</div>
            <div style="margin-top:10px; font-family:'Courier New',monospace; font-size:0.85rem; color:rgba(255,255,255,0.5);">
                Matches found: <span id="matchCount" style="color:var(--yellow);">0</span>
            </div>
        </div>

        <div style="margin-top:15px;">
            <div style="font-size:0.85rem; color:rgba(255,255,255,0.5); margin-bottom:10px;">Click a pattern to try it:</div>
            <div style="display:flex; flex-wrap:wrap; gap:8px;">
                <button class="tag tag-blue" style="cursor:pointer;" onclick="setRegexPattern('\\d+', 'g')">Numbers (\d+)</button>
                <button class="tag tag-green" style="cursor:pointer;" onclick="setRegexPattern('[a-zA-Z]+', 'g')">Words</button>
                <button class="tag tag-yellow" style="cursor:pointer;" onclick="setRegexPattern('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}', 'g')">Email</button>
                <button class="tag tag-red" style="cursor:pointer;" onclick="setRegexPattern('\\d{3}-\\d{4}', 'g')">Phone</button>
                <button class="tag tag-blue" style="cursor:pointer;" onclick="setRegexPattern('\\d{5}', 'g')">ZIP Code</button>
                <button class="tag tag-green" style="cursor:pointer;" onclick="setRegexPattern('[aeiou]', 'gi')">Vowels</button>
            </div>
        </div>
    </div>

    <button class="next-btn" onclick="goToSection('mistakes')">Next: Common Mistakes ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: MISTAKES ===== -->
<section class="section" id="mistakes">
    <div class="section-intro animate-in">
        <h2>‚ö†Ô∏è Common Mistakes & Pitfalls</h2>
        <p>Learn from others' mistakes! These are the most common traps JavaScript beginners fall into with strings.</p>
    </div>

    <div id="mistakesContainer"></div>

    <button class="next-btn" onclick="goToSection('exercises')">Next: Exercises ‚û°Ô∏è</button>
</section>

<!-- ===== SECTION: EXERCISES ===== -->
<section class="section" id="exercises">
    <div class="section-intro animate-in">
        <h2>üí™ Coding Exercises</h2>
        <p>Practice makes perfect! Complete these exercises to solidify your string knowledge.</p>
    </div>

    <div class="score-display">
        <div>Exercises Completed</div>
        <div class="score-number" id="exerciseScore">0/6</div>
        <div style="font-size:0.85rem; color:rgba(255,255,255,0.5);">Keep going! Each completed exercise earns XP</div>
    </div>

    <div id="exercisesContainer"></div>
</section>

<!-- ===== SECTION: QUIZ ===== -->
<section class="section" id="quiz">
    <div class="section-intro animate-in">
        <h2>üß† Knowledge Quiz</h2>
        <p>Test what you've learned! 10 questions covering all string topics.</p>
    </div>

    <div class="score-display">
        <div>Quiz Score</div>
        <div class="score-number" id="quizScore">0/10</div>
        <div style="font-size:0.85rem; color:rgba(255,255,255,0.5);">Answer all questions to see your final score!</div>
    </div>

    <div id="quizContainer"></div>
</section>

<!-- ===== SECTION: CHEATSHEET ===== -->
<section class="section" id="cheatsheet">
    <div class="section-intro animate-in">
        <h2>üìã String Methods Cheatsheet</h2>
        <p>Your quick reference guide for all essential string methods!</p>
    </div>

    <div class="card animate-in">
        <div class="card-title">üîç Search & Check</div>
        <div class="cheatsheet-grid" id="cheatSearch"></div>
    </div>
    <div class="card animate-in" style="margin-top:16px;">
        <div class="card-title">‚úÇÔ∏è Extract & Slice</div>
        <div class="cheatsheet-grid" id="cheatExtract"></div>
    </div>
    <div class="card animate-in" style="margin-top:16px;">
        <div class="card-title">üîÑ Transform & Modify</div>
        <div class="cheatsheet-grid" id="cheatTransform"></div>
    </div>
    <div class="card animate-in" style="margin-top:16px;">
        <div class="card-title">üîç Regular Expressions Quick Reference</div>
        <div class="cheatsheet-grid" id="cheatRegex"></div>
    </div>
</section>

<script>
// ============================================================
// STATE
// ============================================================
let xp = 0;
let quizAnswered = new Set();
let exercisesCompleted = new Set();

// ============================================================
// NAVIGATION
// ============================================================
function showSection(id, btn) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    if (btn) btn.classList.add('active');
    window.scrollTo(0, 0);
    addXP(10);
}

function goToSection(id) {
    const navBtns = document.querySelectorAll('.nav-btn');
    const sections = ['basics','creation','template','methods','regex','mistakes','exercises','quiz','cheatsheet'];
    const idx = sections.indexOf(id);
    if (idx >= 0 && navBtns[idx]) {
        showSection(id, navBtns[idx]);
    }
}

// ============================================================
// XP & PROGRESS
// ============================================================
function addXP(amount) {
    xp += amount;
    document.getElementById('xpBadge').textContent = `‚≠ê ${xp} XP`;
    updateProgress();
}

function updateProgress() {
    const total = quizAnswered.size + exercisesCompleted.size;
    const max = 10 + 6;
    const pct = Math.min(100, Math.round((total / max) * 100));
    document.getElementById('progressFill').style.width = pct + '%';
    document.getElementById('progressText').textContent = pct + '% Complete';
}

// ============================================================
// CODE RUNNER
// ============================================================
function runCode(inputId, outputId) {
    const code = document.getElementById(inputId).value;
    const output = document.getElementById(outputId);
    const logs = [];
    
    const origConsole = window.console.log.bind(window.console);
    const tempLog = (...args) => {
        logs.push(args.map(a => {
            if (Array.isArray(a)) return JSON.stringify(a);
            return String(a);
        }).join(' '));
        origConsole(...args);
    };
    
    const savedLog = console.log;
    console.log = tempLog;
    
    try {
        eval(code);
        output.innerHTML = logs.map(l => `<div>‚Üí ${escapeHtml(l)}</div>`).join('');
        output.className = 'output-result';
    } catch(e) {
        output.innerHTML = `<div style="color:var(--secondary);">‚ùå Error: ${escapeHtml(e.message)}</div>`;
        output.className = 'output-error';
    }
    console.log = savedLog;
}

function escapeHtml(str) {
    return String(str)
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;');
}

// ============================================================
// COPY CODE
// ============================================================
function copyCode(btn) {
    const block = btn.parentElement;
    const text = block.innerText.replace('Copy\n','').replace('Copy','');
    navigator.clipboard.writeText(text).then(() => {
        btn.textContent = '‚úì Copied!';
        setTimeout(() => btn.textContent = 'Copy', 2000);
    });
}

// ============================================================
// SECTION: BASICS - String Visual
// ============================================================
function updateVisual() {
    const str = document.getElementById('visualInput').value;
    const container = document.getElementById('stringVisual');
    
    if (str.length === 0) {
        container.innerHTML = '<span style="color:rgba(255,255,255,0.3);">Type something to visualize...</span>';
        return;
    }

    if (str.length > 30) {
        container.innerHTML = '<span style="color:var(--secondary);">String too long to display (max 30 chars)</span>';
        return;
    }

    const colors = ['#6c63ff','#e91e63','#ff8c00','#43e97b','#00bcd4','#ffd700'];
    container.innerHTML = Array.from(str).map((ch, i) => {
        const color = colors[i % colors.length];
        const display = ch === ' ' ? '¬∑' : escapeHtml(ch);
        const isSpace = ch === ' ';
        const negIndex = i - str.length;
        return `
            <div class="char-box">
                <div class="char-neg-index">${negIndex}</div>
                <div class="char-cell ${isSpace ? 'space-char' : ''}" style="background:${isSpace ? 'rgba(108,99,255,0.2)' : color};" title="Char: '${ch}' | Index: ${i} | Neg: ${negIndex}">${display}</div>
                <div class="char-index">${i}</div>
            </div>`;
    }).join('');
}

function updateLength() {
    const val = document.getElementById('lengthInput').value;
    document.getElementById('lengthResult').textContent = `Length: ${val.length} | First char: "${val[0] || ''}" | Last char: "${val[val.length-1] || ''}"`;
}

// ============================================================
// SECTION: TEMPLATE LITERALS
// ============================================================
function updateTemplate() {
    const name = document.getElementById('tlName').value || 'Name';
    const age = document.getElementById('tlAge').value || '0';
    const lang = document.getElementById('tlLang').value || 'JavaScript';
    
    document.getElementById('templateCode').innerHTML = `
        <span style="color:#569cd6;">const</span> <span style="color:#9cdcfe;">name</span> = <span style="color:#ce9178;">"${escapeHtml(name)}"</span>;<br>
        <span style="color:#569cd6;">const</span> <span style="color:#9cdcfe;">age</span> = <span style="color:#b5cea8;">${escapeHtml(age)}</span>;<br>
        <span style="color:#569cd6;">const</span> <span style="color:#9cdcfe;">lang</span> = <span style="color:#ce9178;">"${escapeHtml(lang)}"</span>;<br><br>
        <span style="color:#569cd6;">const</span> <span style="color:#9cdcfe;">msg</span> = <span style="color:#ce9178;">\`Hi, I'm <span style="color:#ffd700;">\${</span><span style="color:#43e97b;">name</span><span style="color:#ffd700;">}</span>! I'm <span style="color:#ffd700;">\${</span><span style="color:#43e97b;">age</span><span style="color:#ffd700;">}</span> years old and I love <span style="color:#ffd700;">\${</span><span style="color:#43e97b;">lang</span><span style="color:#ffd700;">}</span>.\`</span>;
    `;
    
    document.getElementById('templateOutput').textContent = `Hi, I'm ${name}! I'm ${age} years old and I love ${lang}.`;
}

// ============================================================
// SECTION: METHODS - Grid Data
// ============================================================
const searchMethods = [
    { name: '.indexOf(search)', desc: 'Returns index of first match, or -1 if not found', ex: '"hello".indexOf("l")  ‚Üí 2' },
    { name: '.lastIndexOf(search)', desc: 'Returns index of LAST match', ex: '"hello".lastIndexOf("l")  ‚Üí 3' },
    { name: '.includes(search)', desc: 'Returns true/false if string contains search', ex: '"hello".includes("ell")  ‚Üí true' },
    { name: '.startsWith(str)', desc: 'Checks if string starts with given text', ex: '"Hello".startsWith("He")  ‚Üí true' },
    { name: '.endsWith(str)', desc: 'Checks if string ends with given text', ex: '"Hello!".endsWith("!")  ‚Üí true' },
    { name: '.match(regex)', desc: 'Returns array of regex matches', ex: '"abc123".match(/\\d+/)  ‚Üí ["123"]' },
    { name: '.search(regex)', desc: 'Returns index of first regex match', ex: '"abc123".search(/\\d/)  ‚Üí 3' },
];

const sliceMethods = [
    { name: '.slice(start, end)', desc: 'Extract part of string. Supports negative indexes!', ex: '"Hello!".slice(1, 4)  ‚Üí "ell"' },
    { name: '.substring(start, end)', desc: 'Like slice but no negative indexes', ex: '"Hello!".substring(0, 5)  ‚Üí "Hello"' },
    { name: '.charAt(index)', desc: 'Returns character at given index', ex: '"Hello".charAt(0)  ‚Üí "H"' },
    { name: '.charCodeAt(index)', desc: 'Returns Unicode number of character', ex: '"A".charCodeAt(0)  ‚Üí 65' },
    { name: '.split(sep)', desc: 'Splits string into an array', ex: '"a,b,c".split(",")  ‚Üí ["a","b","c"]' },
    { name: '.at(index)', desc: 'New! Supports negative indexing', ex: '"Hello".at(-1)  ‚Üí "o"' },
];

const transformMethods = [
    { name: '.toUpperCase()', desc: 'Converts all chars to uppercase', ex: '"hello".toUpperCase()  ‚Üí "HELLO"' },
    { name: '.toLowerCase()', desc: 'Converts all chars to lowercase', ex: '"HELLO".toLowerCase()  ‚Üí "hello"' },
    { name: '.trim()', desc: 'Removes whitespace from both ends', ex: '"  hi  ".trim()  ‚Üí "hi"' },
    { name: '.trimStart()', desc: 'Removes whitespace from start only', ex: '"  hi  ".trimStart()  ‚Üí "hi  "' },
    { name: '.trimEnd()', desc: 'Removes whitespace from end only', ex: '"  hi  ".trimEnd()  ‚Üí "  hi"' },
    { name: '.replace(old, new)', desc: 'Replaces FIRST occurrence of old with new', ex: '"hello".replace("l","L")  ‚Üí "heLlo"' },
    { name: '.replaceAll(old, new)', desc: 'Replaces ALL occurrences', ex: '"hello".replaceAll("l","L")  ‚Üí "heLLo"' },
    { name: '.repeat(n)', desc: 'Repeats string n times', ex: '"ha".repeat(3)  ‚Üí "hahaha"' },
    { name: '.padStart(len, char)', desc: 'Pads string at start to reach length', ex: '"5".padStart(3,"0")  ‚Üí "005"' },
    { name: '.padEnd(len, char)', desc: 'Pads string at end to reach length', ex: '"5".padEnd(3,"0")  ‚Üí "500"' },
    { name: '.concat(str)', desc: 'Joins two or more strings', ex: '"Hi".concat(" ", "World")  ‚Üí "Hi World"' },
    { name: 'String.fromCharCode(n)', desc: 'Creates char from Unicode number', ex: 'String.fromCharCode(65)  ‚Üí "A"' },
];

function buildMethodsGrid() {
    buildGrid('searchMethodsGrid', searchMethods);
    buildGrid('sliceMethodsGrid', sliceMethods);
    buildGrid('transformMethodsGrid', transformMethods);
}

function buildGrid(containerId, methods) {
    const grid = document.getElementById(containerId);
    if (!grid) return;
    grid.innerHTML = methods.map(m => `
        <div class="method-card">
            <div class="method-name">${escapeHtml(m.name)}</div>
            <div class="method-desc">${m.desc}</div>
            <div class="method-example">${escapeHtml(m.ex)}</div>
        </div>
    `).join('');
}

// ============================================================
// METHOD PLAYGROUND
// ============================================================
function runMethodPlay() {
    const input = document.getElementById('methodPlayInput').value;
    const method = document.getElementById('methodSelect').value;
    const codeEl = document.getElementById('methodCode');
    const resultEl = document.getElementById('methodResult');

    let code = '', result = '';
    try {
        switch(method) {
            case 'toUpperCase':
                code = `"${input}".toUpperCase()`;
                result = input.toUpperCase(); break;
            case 'toLowerCase':
                code = `"${input}".toLowerCase()`;
                result = input.toLowerCase(); break;
            case 'trim':
                code = `"${input}".trim()`;
                result = JSON.stringify(input.trim()); break;
            case 'trimStart':
                code = `"${input}".trimStart()`;
                result = JSON.stringify(input.trimStart()); break;
            case 'trimEnd':
                code = `"${input}".trimEnd()`;
                result = JSON.stringify(input.trimEnd()); break;
            case 'length':
                code = `"${input}".length`;
                result = input.length; break;
            case 'indexOf_Hello':
                code = `"${input}".indexOf('Hello')`;
                result = input.indexOf('Hello'); break;
            case 'includes_World':
                code = `"${input}".includes('World')`;
                result = input.includes('World'); break;
            case 'startsWith_Hello':
                code = `"${input}".startsWith(' ')`;
                result = input.startsWith(' '); break;
            case 'endsWith_!':
                code = `"${input}".endsWith('!')`;
                result = input.endsWith('!'); break;
            case 'slice_0_5':
                code = `"${input}".slice(0, 5)`;
                result = JSON.stringify(input.slice(0, 5)); break;
            case 'slice_-6':
                code = `"${input}".slice(-6)`;
                result = JSON.stringify(input.slice(-6)); break;
            case 'charAt_0':
                code = `"${input}".charAt(0)`;
                result = JSON.stringify(input.charAt(0)); break;
            case 'replace_Hello_Hi':
                code = `"${input}".replace('Hello', 'Hi')`;
                result = JSON.stringify(input.replace('Hello', 'Hi')); break;
            case 'replaceAll':
                code = `"${input}".replaceAll('l', 'L')`;
                result = JSON.stringify(input.replaceAll('l', 'L')); break;
            case 'split_comma':
                code = `"${input}".split(',')`;
                result = JSON.stringify(input.split(',')); break;
            case 'split_chars':
                code = `"${input}".split('')`;
                result = JSON.stringify(input.split('')); break;
            case 'repeat_3':
                code = `"${input}".repeat(3)`;
                result = input.length < 10 ? JSON.stringify(input.repeat(3)) : '"(string too long to repeat)"'; break;
            case 'padStart':
                code = `"${input}".padStart(20, '*')`;
                result = JSON.stringify(input.padStart(20, '*')); break;
            case 'padEnd':
                code = `"${input}".padEnd(20, '-')`;
                result = JSON.stringify(input.padEnd(20, '-')); break;
        }
        codeEl.textContent = `str.${code.split('.').slice(1).join('.')}`;
        resultEl.textContent = `‚Üí ${result}`;
    } catch(e) {
        resultEl.textContent = `Error: ${e.message}`;
    }
}

// ============================================================
// REGEX TESTER
// ============================================================
function testRegex() {
    const pattern = document.getElementById('regexPattern').value;
    const flags = document.getElementById('regexFlags').value;
    const text = document.getElementById('regexTestText').value;
    const display = document.getElementById('regexResultDisplay');
    const countEl = document.getElementById('matchCount');

    if (!pattern) {
        display.innerHTML = escapeHtml(text);
        countEl.textContent = '0';
        return;
    }

    try {
        const regex = new RegExp(pattern, flags);
        const matches = text.match(regex) || [];
        countEl.textContent = matches.length;

        const highlighted = escapeHtml(text).replace(
            new RegExp(escapeRegex(pattern), flags),
            match => `<span class="match-highlight">${escapeHtml(match)}</span>`
        );
        display.innerHTML = highlighted.replace(/\n/g, '<br>');
    } catch(e) {
        display.innerHTML = `<span style="color:var(--secondary);">Invalid regex: ${escapeHtml(e.message)}</span>`;
        countEl.textContent = '0';
    }
}

function escapeRegex(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

function setRegexPattern(pattern, flags) {
    document.getElementById('regexPattern').value = pattern;
    document.getElementById('regexFlags').value = flags;
    testRegex();
}

// ============================================================
// MISTAKES
// ============================================================
const mistakes = [
    {
        title: "‚ùå Comparing Strings with == vs ===",
        wrong: `// Tricky! == does type coercion
"5" == 5  // true! (bad)
"" == 0   // true! (very bad)
" " == 0  // true! (what!?)`,
        right: `// Always use === for strict comparison
"5" === 5  // false ‚úì (correct!)
"5" === "5" // true ‚úì
// Use === to avoid type surprises`,
        tip: "üí° Always use === (triple equals) when comparing. Never use == with strings!"
    },
    {
        title: "‚ùå Forgetting Strings are Zero-Indexed",
        wrong: `const str = "Hello";
// Trying to get "H" (first char)
const first = str[1]; // ‚ùå This is "e"!
const last = str[5];  // ‚ùå undefined!`,
        right: `const str = "Hello";
// Correct indexing
const first = str[0];           // ‚úÖ "H"
const last = str[str.length-1]; // ‚úÖ "o"
const last2 = str.at(-1);       // ‚úÖ "o" (modern)`,
        tip: "üí° First index = 0, last index = length-1. Use .at(-1) for last character easily!"
    },
    {
        title: "‚ùå Trying to Mutate (Change) a String",
        wrong: `let name = "John";
// These do NOTHING silently!
name[0] = "B";  // ‚ùå No error but won't work
name.length = 3; // ‚ùå Also does nothing
console.log(name); // Still "John"`,
        right: `let name = "John";
// Create a NEW string instead
name = "B" + name.slice(1); // ‚úÖ "Bohn"
// Or replace
name = name.replace("J", "B"); // ‚úÖ "Bohn"`,
        tip: "üí° Strings are immutable! Always create a new string instead of modifying in place."
    },
    {
        title: "‚ùå Number + String Gotcha with +",
        wrong: `// + with mixed types is tricky!
console.log("5" + 3);   // "53" (string!)
console.log(5 + 3 + "px"); // "8px" ‚úì 
console.log("px" + 5 + 3); // "px53" ‚ùå`,
        right: `// Convert first when needed
const num = Number("5") + 3;   // 8 ‚úì
const sum = parseInt("5") + 3; // 8 ‚úì
// Or use template literals!
const result = \`\${5 + 3}px\`;   // "8px" ‚úì`,
        tip: "üí° Use Number(), parseInt(), or parseFloat() to convert strings to numbers before math!"
    },
    {
        title: "‚ùå Using .replace() and Expecting All Replacements",
        wrong: `const str = "banana";
// Expecting all 'a' to be replaced
const result = str.replace("a", "o");
console.log(result); // "bonana" ‚ùå
// Only replaces the FIRST one!`,
        right: `const str = "banana";
// Use replaceAll() for all occurrences
const result1 = str.replaceAll("a", "o");
console.log(result1); // "bonono" ‚úÖ
// Or use regex with /g flag
const result2 = str.replace(/a/g, "o");
console.log(result2); // "bonono" ‚úÖ`,
        tip: "üí° .replace() only replaces the FIRST match! Use .replaceAll() or /regex/g for all matches."
    },
    {
        title: "‚ùå Case Sensitivity in Search Methods",
        wrong: `const text = "Hello World";
// Forgetting strings are case-sensitive
text.includes("hello"); // false ‚ùå
text.indexOf("world");  // -1 ‚ùå
text.startsWith("hello"); // false ‚ùå`,
        right: `const text = "Hello World";
// Convert both to same case first
text.toLowerCase().includes("hello"); // true ‚úÖ
text.toLowerCase().indexOf("world");  // 6 ‚úÖ
// Or use case-insensitive regex
/hello/i.test(text); // true ‚úÖ`,
        tip: "üí° Always normalize case (toLowerCase/toUpperCase) before searching, or use the /i regex flag!"
    },
    {
        title: "‚ùå Wrong use of slice() vs substring()",
        wrong: `// substring ignores negative numbers!
"Hello".substring(-2, 4); // same as (0,4)
"Hello".substring(3, 1);  // reverses! = "el"
// This surprises most beginners`,
        right: `// slice is more predictable!
"Hello".slice(-2);    // "lo" ‚úÖ (last 2)
"Hello".slice(1, 3);  // "el" ‚úÖ
"Hello".slice(-4, -1); // "ell" ‚úÖ
// Use slice() for negative index support`,
        tip: "üí° Prefer .slice() over .substring() ‚Äî it supports negative indexes and is more consistent!"
    },
];

function buildMistakes() {
    const container = document.getElementById('mistakesContainer');
    if (!container) return;
    container.innerHTML = mistakes.map((m, i) => `
        <div class="card mistake-card animate-in" style="position:relative;">
            <div class="mistake-title">${m.title}</div>
            <div class="vs-split">
                <div class="wrong-code">
                    <h4>‚ùå Common Mistake:</h4>
                    <pre style="font-family:'Courier New',monospace; font-size:0.8rem; color:var(--secondary); white-space:pre-wrap;">${escapeHtml(m.wrong)}</pre>
                </div>
                <div class="right-code">
                    <h4>‚úÖ Correct Way:</h4>
                    <pre style="font-family:'Courier New',monospace; font-size:0.8rem; color:var(--accent); white-space:pre-wrap;">${escapeHtml(m.right)}</pre>
                </div>
            </div>
            <div class="callout callout-tip" style="margin-top:12px;">${m.tip}</div>
        </div>
    `).join('');
}

// ============================================================
// EXERCISES
// ============================================================
const exercises = [
    {
        id: 'ex1',
        title: 'üî§ Exercise 1: Greeting Generator',
        desc: 'Write a function that takes a name and age, and returns a greeting using a template literal. Example: greet("Alice", 30) ‚Üí "Hello, Alice! You are 30 years old."',
        starter: `function greet(name, age) {
  // Your code here using template literals!
  return \`\`;
}

// Test it:
console.log(greet("Alice", 30));
console.log(greet("Bob", 25));`,
        solution: `function greet(name, age) {
  return \`Hello, \${name}! You are \${age} years old.\`;
}`,
        hint: 'Use backticks and ${name} and ${age} inside the template literal!',
        check: (code) => {
            try {
                const fn = new Function('return ' + code.match(/function greet[\s\S]*?\n}/)[0])();
                return fn("Alice", 30) === "Hello, Alice! You are 30 years old.";
            } catch { return false; }
        }
    },
    {
        id: 'ex2',
        title: 'üîÅ Exercise 2: Reverse a String',
        desc: 'Write a function that reverses a string. Hint: split it into characters, reverse the array, then join it back! reverseStr("hello") ‚Üí "olleh"',
        starter: `function reverseStr(str) {
  // Hint: use .split(''), .reverse(), .join('')
  
}

console.log(reverseStr("hello"));   // "olleh"
console.log(reverseStr("JavaScript")); // "tpircSavaJ"`,
        solution: `function reverseStr(str) {
  return str.split('').reverse().join('');
}`,
        hint: 'Split into array with .split(""), reverse it, then join back with .join("")',
        check: (code) => {
            try {
                const fn = eval(`(${code.match(/function reverseStr[\s\S]*?\n}/)[0]})`);
                return fn("hello") === "olleh" && fn("world") === "dlrow";
            } catch { return false; }
        }
    },
    {
        id: 'ex3',
        title: 'üìß Exercise 3: Email Validator',
        desc: 'Write a function that returns true if an email looks valid (has "@" and a "." after the "@"). isValidEmail("user@test.com") ‚Üí true, isValidEmail("notanemail") ‚Üí false',
        starter: `function isValidEmail(email) {
  // Use includes(), indexOf(), or regex!
  
}

console.log(isValidEmail("user@test.com")); // true
console.log(isValidEmail("notanemail"));    // false
console.log(isValidEmail("missing@dot"));   // false`,
        solution: `function isValidEmail(email) {
  return /^[^@]+@[^@]+\.[^@]+$/.test(email);
}`,
        hint: 'Use .includes("@") to check for @ sign, then check if there\'s a . after the @',
        check: (code) => {
            try {
                const fn = eval(`(${code.match(/function isValidEmail[\s\S]*?\n}/)[0]})`);
                return fn("user@test.com") === true && fn("notanemail") === false;
            } catch { return false; }
        }
    },
    {
        id: 'ex4',
        title: 'üìù Exercise 4: Title Case',
        desc: 'Write a function that converts a string to Title Case (first letter of each word capitalized). titleCase("the quick brown fox") ‚Üí "The Quick Brown Fox"',
        starter: `function titleCase(str) {
  // Hint: split by space, then capitalize first letter of each word
  
}

console.log(titleCase("the quick brown fox")); 
// "The Quick Brown Fox"
console.log(titleCase("hello world")); 
// "Hello World"`,
        solution: `function titleCase(str) {
  return str.split(' ')
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
}`,
        hint: 'Split by " ", map each word, capitalize first char with charAt(0).toUpperCase() + slice(1), then join!',
        check: (code) => {
            try {
                const fn = eval(`(${code.match(/function titleCase[\s\S]*?\n}/)[0]})`);
                return fn("hello world") === "Hello World";
            } catch { return false; }
        }
    },
    {
        id: 'ex5',
        title: 'üî¢ Exercise 5: Count Vowels',
        desc: 'Write a function that counts the number of vowels (a,e,i,o,u) in a string. countVowels("hello") ‚Üí 2, countVowels("javascript") ‚Üí 3',
        starter: `function countVowels(str) {
  // Hint: use match() with a regex for vowels!
  
}

console.log(countVowels("hello"));      // 2
console.log(countVowels("javascript")); // 3
console.log(countVowels("rhythm"));     // 0`,
        solution: `function countVowels(str) {
  const matches = str.toLowerCase().match(/[aeiou]/g);
  return matches ? matches.length : 0;
}`,
        hint: 'Use .match(/[aeiou]/gi) to find all vowels, then check the array length. Handle null if no matches!',
        check: (code) => {
            try {
                const fn = eval(`(${code.match(/function countVowels[\s\S]*?\n}/)[0]})`);
                return fn("hello") === 2 && fn("javascript") === 3;
            } catch { return false; }
        }
    },
    {
        id: 'ex6',
        title: 'üîê Exercise 6: Password Strength Checker',
        desc: 'Write a function that checks if a password is "strong" (at least 8 chars, has uppercase, lowercase, and a number). Returns "Weak", "Medium", or "Strong".',
        starter: `function checkPassword(pwd) {
  // Check: length >= 8, has uppercase, has lowercase, has digit
  const hasUpper = /[A-Z]/.test(pwd);
  const hasLower = /[a-z]/.test(pwd);
  const hasDigit = /[0-9]/.test(pwd);
  const isLong = pwd.length >= 8;
  
  // Return "Weak", "Medium", or "Strong"
  
}

console.log(checkPassword("abc"));          // "Weak"
console.log(checkPassword("password"));     // "Medium"  
console.log(checkPassword("Password1"));    // "Strong"`,
        solution: `function checkPassword(pwd) {
  const hasUpper = /[A-Z]/.test(pwd);
  const hasLower = /[a-z]/.test(pwd);
  const hasDigit = /[0-9]/.test(pwd);
  const isLong = pwd.length >= 8;
  
  if (isLong && hasUpper && hasLower && hasDigit) return "Strong";
  if (isLong || (hasUpper && hasLower)) return "Medium";
  return "Weak";
}`,
        hint: 'Count how many conditions pass. All 4 = Strong, some = Medium, few = Weak.',
        check: (code) => {
            try {
                const fn = eval(`(${code.match(/function checkPassword[\s\S]*?\n}/)[0]})`);
                return fn("abc") === "Weak" && fn("Password1") === "Strong";
            } catch { return false; }
        }
    }
];

let exerciseCompleteCount = 0;

function buildExercises() {
    const container = document.getElementById('exercisesContainer');
    if (!container) return;
    container.innerHTML = exercises.map((ex, i) => `
        <div class="exercise-card card animate-in" id="exercise_${ex.id}">
            <div class="exercise-title">${ex.title}</div>
            <div class="exercise-desc">${ex.desc}</div>
            <button class="hint-btn" onclick="toggleHint('hint_${ex.id}', this)">üí° Show Hint</button>
            <div class="hint-box" id="hint_${ex.id}">${ex.hint}</div>
            <div class="live-editor">
                <div class="editor-header">
                    <div class="editor-dots"><div class="dot dot-red"></div><div class="dot dot-yellow"></div><div class="dot dot-green"></div></div>
                    <span class="editor-label">Write your solution ‚úèÔ∏è</span>
                    <button class="run-btn" onclick="runCode('code_${ex.id}', 'out_${ex.id}')">‚ñ∂ Run</button>
                </div>
                <textarea class="code-input" id="code_${ex.id}" style="min-height:180px;">${ex.starter}</textarea>
                <div class="output-panel">
                    <div class="output-label">Output:</div>
                    <div class="output-result" id="out_${ex.id}"></div>
                </div>
            </div>
            <button class="check-btn" onclick="checkExercise('${ex.id}', ${i})">‚úÖ Check My Solution</button>
            <div id="feedback_${ex.id}" style="margin-top:10px; display:none;"></div>
        </div>
    `).join('');
}

function toggleHint(id, btn) {
    const hint = document.getElementById(id);
    if (hint.classList.contains('show')) {
        hint.classList.remove('show');
        btn.textContent = 'üí° Show Hint';
    } else {
        hint.classList.add('show');
        btn.textContent = 'üí° Hide Hint';
    }
}

function checkExercise(id, idx) {
    const code = document.getElementById(`code_${id}`).value;
    const fb = document.getElementById(`feedback_${id}`);
    const ex = exercises[idx];

    const passed = ex.check(code);
    fb.style.display = 'block';

    if (passed) {
        fb.innerHTML = `<div style="background:rgba(67,233,123,0.15); border:1px solid var(--accent); border-radius:8px; padding:12px; color:var(--accent);">üéâ <strong>Excellent!</strong> Your solution is correct! +50 XP</div>`;
        if (!exercisesCompleted.has(id)) {
            exercisesCompleted.add(id);
            exerciseCompleteCount++;
            addXP(50);
            launchConfetti();
            document.getElementById('exerciseScore').textContent = `${exercisesCompleted.size}/6`;
            updateProgress();
        }
    } else {
        fb.innerHTML = `<div style="background:rgba(255,101,132,0.15); border:1px solid var(--secondary); border-radius:8px; padding:12px; color:var(--secondary);">‚ùå Not quite right. Try again! Check the hint if you're stuck.<br><br><strong>Tip:</strong> Click ‚ñ∂ Run first to see what your code outputs.</div>`;
    }
}

// ============================================================
// QUIZ
// ============================================================
const quizData = [
    {
        q: "What does the following code output?",
        code: 'console.log("Hello".length);',
        options: ["4", "5", "6", "undefined"],
        correct: 1,
        explain: '"Hello" has 5 characters: H-e-l-l-o. The .length property returns 5.'
    },
    {
        q: "What is the index of 'J' in \"JavaScript\"?",
        code: 'let str = "JavaScript";\nconsole.log(str.indexOf("J"));',
        options: ["0", "1", "-1", "10"],
        correct: 0,
        explain: 'Strings are zero-indexed! "J" is the first character, so its index is 0.'
    },
    {
        q: "What does this output?",
        code: 'console.log("5" + 3);',
        options: ["8", "53", '"53"', "Error"],
        correct: 1,
        explain: 'When you use + with a string and number, JS converts the number to a string and concatenates! "5" + 3 = "53" (a string, not a number).'
    },
    {
        q: "Which method removes whitespace from both ends?",
        code: 'let str = "  hello  ";',
        options: [".strip()", ".clean()", ".trim()", ".trimAll()"],
        correct: 2,
        explain: '.trim() removes whitespace from both start and end of a string. .trimStart() and .trimEnd() do one side each.'
    },
    {
        q: "What does slice(-3) return for \"JavaScript\"?",
        code: 'console.log("JavaScript".slice(-3));',
        options: ['"Jav"', '"rip"', '"ipt"', '"pt"'],
        correct: 2,
        explain: 'Negative slice(-3) starts from the 3rd character from the END. "JavaScript" ends in ...ipt, so it returns "ipt".'
    },
    {
        q: "What does this template literal output?",
        code: 'const x = 10;\nconsole.log(`${x * 2} items`);',
        options: ['"x * 2 items"', '"20 items"', '"10 * 2 items"', "Error"],
        correct: 1,
        explain: 'Inside ${}, any JavaScript expression is evaluated! x * 2 = 20, so the result is "20 items".'
    },
    {
        q: "What does .replace() do without a regex /g flag?",
        code: 'console.log("banana".replace("a", "o"));',
        options: ['"bonono"', '"bonana"', '"bonona"', '"banana"'],
        correct: 1,
        explain: '.replace() without a /g flag only replaces the FIRST occurrence. Use .replaceAll() or /a/g to replace all.'
    },
    {
        q: "What does this code return?",
        code: '"hello".includes("HELLO")',
        options: ["true", "false", "undefined", "Error"],
        correct: 1,
        explain: 'String methods are case-sensitive! "HELLO" !== "hello". Use .toLowerCase() first or a regex with /i flag for case-insensitive search.'
    },
    {
        q: "Which correctly creates a multi-line string?",
        code: '// Which is correct?',
        options: [
            '"Line1\\nLine2"',
            "`Line1\nLine2`",
            'Both A and B',
            '"Line1" + "Line2"'
        ],
        correct: 2,
        explain: 'Both work! \\n in a regular string creates a newline. Template literals (backticks) can span actual multiple lines.'
    },
    {
        q: "What regex matches one or more digits?",
        code: '// Which regex matches "123" in "abc123def"?',
        options: ["/d+/", "/\\d*/", "/\\d+/", "/[0-9]/"],
        correct: 2,
        explain: '/\\d+/ matches one or more digits. \\d means digit, + means "one or more". /\\d*/ would also match empty strings (zero or more).'
    }
];

let quizScore = 0;

function buildQuiz() {
    const container = document.getElementById('quizContainer');
    if (!container) return;
    container.innerHTML = quizData.map((q, i) => `
        <div class="quiz-card animate-in" id="quiz_${i}">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <span class="tag tag-blue">Question ${i+1}/10</span>
                <span id="quiz_check_${i}" style="font-size:1.2rem;"></span>
            </div>
            <div class="quiz-question">${q.q}</div>
            ${q.code && q.code !== '// Which is correct?' && q.code !== '// Which regex matches "123" in "abc123def"?' 
                ? `<div class="quiz-code">${escapeHtml(q.code)}</div>` 
                : q.code ? `<div class="quiz-code" style="color:rgba(255,255,255,0.5); font-style:italic;">${escapeHtml(q.code)}</div>` : ''}
            <div class="quiz-options">
                ${q.options.map((opt, j) => `
                    <button class="quiz-option" id="qopt_${i}_${j}" onclick="answerQuiz(${i}, ${j}, ${q.correct})">
                        ${String.fromCharCode(65+j)}. ${escapeHtml(opt)}
                    </button>
                `).join('')}
            </div>
            <div class="quiz-feedback" id="qfb_${i}">
                <strong>${i === q.correct ? 'üéâ' : 'üí°'}</strong> ${q.explain}
            </div>
        </div>
    `).join('');
}

function answerQuiz(questionIdx, selectedIdx, correctIdx) {
    if (quizAnswered.has(questionIdx)) return;
    quizAnswered.add(questionIdx);

    const opts = document.querySelectorAll(`[id^="qopt_${questionIdx}_"]`);
    opts.forEach(o => o.disabled = true);

    const selectedBtn = document.getElementById(`qopt_${questionIdx}_${selectedIdx}`);
    const correctBtn = document.getElementById(`qopt_${questionIdx}_${correctIdx}`);
    const feedback = document.getElementById(`qfb_${questionIdx}`);
    const checkmark = document.getElementById(`quiz_check_${questionIdx}`);

    correctBtn.classList.add('correct');
    feedback.classList.add('show');

    if (selectedIdx === correctIdx) {
        checkmark.textContent = '‚úÖ';
        feedback.classList.add('correct-fb');
        quizScore++;
        addXP(20);
        document.getElementById('quizScore').textContent = `${quizScore}/10`;
        if (quizScore === 10) launchConfetti();
    } else {
        selectedBtn.classList.add('wrong');
        checkmark.textContent = '‚ùå';
        feedback.classList.add('wrong-fb');
        document.getElementById('quizScore').textContent = `${quizScore}/10`;
    }
    updateProgress();
}

// ============================================================
// CHEATSHEET
// ============================================================
const cheatData = {
    search: [
        { m: 'str.length', d: 'Number of characters', ex: '"hello".length ‚Üí 5' },
        { m: 'str.indexOf(x)', d: 'First index of x (-1 if not found)', ex: '"hello".indexOf("l") ‚Üí 2' },
        { m: 'str.lastIndexOf(x)', d: 'Last index of x', ex: '"hello".lastIndexOf("l") ‚Üí 3' },
        { m: 'str.includes(x)', d: 'true if str contains x', ex: '"hello".includes("ell") ‚Üí true' },
        { m: 'str.startsWith(x)', d: 'true if str starts with x', ex: '"hello".startsWith("he") ‚Üí true' },
        { m: 'str.endsWith(x)', d: 'true if str ends with x', ex: '"hello!".endsWith("!") ‚Üí true' },
        { m: 'str.match(regex)', d: 'Returns array of matches', ex: '"abc123".match(/\\d+/) ‚Üí ["123"]' },
        { m: 'str.search(regex)', d: 'Index of regex match', ex: '"abc123".search(/\\d/) ‚Üí 3' },
    ],
    extract: [
        { m: 'str.slice(start, end)', d: 'Extract from start to end. Negative ok!', ex: '"hello".slice(1,3) ‚Üí "el"' },
        { m: 'str.substring(s, e)', d: 'Like slice but no negative indexes', ex: '"hello".substring(1,3) ‚Üí "el"' },
        { m: 'str.charAt(i)', d: 'Character at index i', ex: '"hello".charAt(1) ‚Üí "e"' },
        { m: 'str.at(i)', d: 'Like charAt but supports negatives', ex: '"hello".at(-1) ‚Üí "o"' },
        { m: 'str.split(sep)', d: 'Split into array by separator', ex: '"a,b".split(",") ‚Üí ["a","b"]' },
        { m: 'str.charCodeAt(i)', d: 'Unicode of char at i', ex: '"A".charCodeAt(0) ‚Üí 65' },
        { m: 'str[index]', d: 'Access character by index', ex: '"hello"[0] ‚Üí "h"' },
    ],
    transform: [
        { m: 'str.toUpperCase()', d: 'ALL CAPS', ex: '"hi".toUpperCase() ‚Üí "HI"' },
        { m: 'str.toLowerCase()', d: 'all lowercase', ex: '"HI".toLowerCase() ‚Üí "hi"' },
        { m: 'str.trim()', d: 'Remove whitespace both ends', ex: '" hi ".trim() ‚Üí "hi"' },
        { m: 'str.trimStart()', d: 'Remove start whitespace', ex: '" hi ".trimStart() ‚Üí "hi "' },
        { m: 'str.trimEnd()', d: 'Remove end whitespace', ex: '" hi ".trimEnd() ‚Üí " hi"' },
        { m: 'str.replace(x, y)', d: 'Replace FIRST x with y', ex: '"hello".replace("l","L") ‚Üí "heLlo"' },
        { m: 'str.replaceAll(x, y)', d: 'Replace ALL x with y', ex: '"hello".replaceAll("l","L") ‚Üí "heLLo"' },
        { m: 'str.repeat(n)', d: 'Repeat string n times', ex: '"ha".repeat(3) ‚Üí "hahaha"' },
        { m: 'str.padStart(len, c)', d: 'Pad start with char c to length', ex: '"5".padStart(3,"0") ‚Üí "005"' },
        { m: 'str.padEnd(len, c)', d: 'Pad end with char c to length', ex: '"5".padEnd(3,"0") ‚Üí "500"' },
        { m: 'str.concat(...strs)', d: 'Join strings together', ex: '"hi".concat(" ","world") ‚Üí "hi world"' },
        { m: 'String.fromCharCode(n)', d: 'Create string from Unicode', ex: 'String.fromCharCode(65) ‚Üí "A"' },
    ],
    regex: [
        { m: '\\d', d: 'Any digit 0-9', ex: '/\\d+/ matches "123"' },
        { m: '\\D', d: 'Any non-digit', ex: '/\\D+/ matches "abc"' },
        { m: '\\w', d: 'Word char (a-z,A-Z,0-9,_)', ex: '/\\w+/ matches "hello_1"' },
        { m: '\\s', d: 'Any whitespace', ex: '/\\s+/ matches " \\t\\n"' },
        { m: '.', d: 'Any char (not newline)', ex: '/h.t/ matches "hot","hat"' },
        { m: '^', d: 'Start of string', ex: '/^Hi/ matches "Hi there"' },
        { m: '$', d: 'End of string', ex: '/bye$/ matches "goodbye"' },
        { m: '+', d: 'One or more', ex: '/a+/ ‚Üí "a","aa","aaa"' },
        { m: '*', d: 'Zero or more', ex: '/a*/ ‚Üí "","a","aa"' },
        { m: '?', d: 'Optional (0 or 1)', ex: '/colou?r/ ‚Üí "color","colour"' },
        { m: '{n}', d: 'Exactly n times', ex: '/\\d{3}/ ‚Üí "123"' },
        { m: '{n,m}', d: 'Between n and m times', ex: '/\\d{2,4}/ ‚Üí "12","123"' },
        { m: '[abc]', d: 'Any of these chars', ex: '/[aeiou]/ ‚Üí vowels' },
        { m: '[^abc]', d: 'Not these chars', ex: '/[^aeiou]/ ‚Üí consonants' },
        { m: '(a|b)', d: 'a OR b', ex: '/(cat|dog)/ ‚Üí "cat" or "dog"' },
        { m: '/pattern/g', d: 'Global: find all matches', ex: '/"hello"/g ‚Üí all "hello"s' },
        { m: '/pattern/i', d: 'Case insensitive', ex: '/hello/i ‚Üí "Hello","HELLO"' },
    ]
};

function buildCheatsheet() {
    buildCheatGrid('cheatSearch', cheatData.search);
    buildCheatGrid('cheatExtract', cheatData.extract);
    buildCheatGrid('cheatTransform', cheatData.transform);
    buildCheatGrid('cheatRegex', cheatData.regex);
}

function buildCheatGrid(id, data) {
    const el = document.getElementById(id);
    if (!el) return;
    el.innerHTML = data.map(item => `
        <div class="cheat-item">
            <div class="cheat-method">${escapeHtml(item.m)}</div>
            <div class="cheat-desc">${item.d}</div>
            <div class="cheat-ex">${escapeHtml(item.ex)}</div>
        </div>
    `).join('');
}

// ============================================================
// CONFETTI
// ============================================================
function launchConfetti() {
    const container = document.getElementById('confettiContainer');
    const colors = ['#6c63ff','#ff6584','#43e97b','#ffd700','#00bcd4','#ff8c00'];
    for (let i = 0; i < 80; i++) {
        const piece = document.createElement('div');
        piece.classList.add('confetti-piece');
        piece.style.left = Math.random() * 100 + 'vw';
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDuration = (Math.random() * 2 + 1.5) + 's';
        piece.style.animationDelay = Math.random() * 0.5 + 's';
        piece.style.width = Math.random() * 12 + 6 + 'px';
        piece.style.height = Math.random() * 12 + 6 + 'px';
        piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        container.appendChild(piece);
        setTimeout(() => piece.remove(), 4000);
    }
}

// ============================================================
// INIT
// ============================================================
window.addEventListener('load', () => {
    updateVisual();
    updateLength();
    updateTemplate();
    buildMethodsGrid();
    runMethodPlay();
    buildMistakes();
    buildExercises();
    buildQuiz();
    buildCheatsheet();
    setTimeout(() => testRegex(), 100);
});
    </script>
</body>
</html>