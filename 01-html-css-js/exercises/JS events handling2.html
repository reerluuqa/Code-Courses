<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Events Mastery Hub</title>
    <style>
        /* ============================================
           ROOT VARIABLES & RESET
        ============================================ */
        :root {
            --bg-primary: #0a0a1a;
            --bg-secondary: #111128;
            --bg-card: #1a1a35;
            --bg-card-hover: #222245;
            --accent-purple: #7c3aed;
            --accent-blue: #2563eb;
            --accent-cyan: #06b6d4;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --accent-pink: #ec4899;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #2d2d5e;
            --code-bg: #0d0d1f;
            --gradient-1: linear-gradient(135deg, #7c3aed, #2563eb);
            --gradient-2: linear-gradient(135deg, #06b6d4, #10b981);
            --gradient-3: linear-gradient(135deg, #f59e0b, #ef4444);
            --gradient-4: linear-gradient(135deg, #ec4899, #7c3aed);
            --shadow: 0 4px 24px rgba(124, 58, 237, 0.15);
            --shadow-lg: 0 8px 40px rgba(124, 58, 237, 0.25);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* ============================================
           SCROLLBAR
        ============================================ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { background: var(--accent-purple); border-radius: 3px; }

        /* ============================================
           NAVIGATION
        ============================================ */
        nav {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(10, 10, 26, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            padding: 0 2rem;
        }

        .nav-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .nav-logo {
            font-size: 1.3rem;
            font-weight: 800;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: 0.25rem;
            list-style: none;
            overflow-x: auto;
        }

        .nav-tabs li a {
            display: block;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .nav-tabs li a:hover,
        .nav-tabs li a.active {
            background: var(--accent-purple);
            color: white;
        }

        .progress-bar-nav {
            height: 2px;
            background: var(--gradient-1);
            position: fixed;
            top: 64px;
            left: 0;
            z-index: 1001;
            transition: width 0.1s;
        }

        /* ============================================
           MAIN LAYOUT
        ============================================ */
        main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 2rem 4rem;
        }

        section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        section.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ============================================
           HERO SECTION
        ============================================ */
        .hero {
            text-align: center;
            padding: 4rem 0 3rem;
        }

        .hero-badge {
            display: inline-block;
            background: rgba(124, 58, 237, 0.2);
            border: 1px solid var(--accent-purple);
            color: var(--accent-purple);
            padding: 0.4rem 1.2rem;
            border-radius: 100px;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 1.5rem;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 1.5rem;
        }

        .hero h1 .gradient-text {
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2.5rem;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-num {
            font-size: 2rem;
            font-weight: 900;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* ============================================
           TOPIC CARDS GRID
        ============================================ */
        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .topic-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.75rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            border-radius: 16px 16px 0 0;
        }

        .topic-card:nth-child(1)::before { background: var(--gradient-1); }
        .topic-card:nth-child(2)::before { background: var(--gradient-2); }
        .topic-card:nth-child(3)::before { background: var(--gradient-3); }
        .topic-card:nth-child(4)::before { background: var(--gradient-4); }

        .topic-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--accent-purple);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .topic-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .topic-card h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .topic-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1.25rem;
        }

        .topic-tag {
            display: inline-block;
            background: rgba(124, 58, 237, 0.15);
            color: var(--accent-purple);
            padding: 0.2rem 0.75rem;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* ============================================
           SECTION HEADERS
        ============================================ */
        .section-header {
            margin-bottom: 2.5rem;
        }

        .section-header .breadcrumb {
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .section-header h2 {
            font-size: clamp(1.8rem, 4vw, 3rem);
            font-weight: 900;
            margin-bottom: 0.75rem;
        }

        .section-header p {
            color: var(--text-secondary);
            font-size: 1.05rem;
            max-width: 700px;
        }

        /* ============================================
           CARDS & LAYOUTS
        ============================================ */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.75rem;
            margin-bottom: 1.5rem;
        }

        .card h3 {
            font-size: 1.15rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .three-col {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 900px) {
            .two-col, .three-col { grid-template-columns: 1fr; }
        }

        /* ============================================
           CODE BLOCKS
        ============================================ */
        .code-block {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .code-header {
            background: rgba(124, 58, 237, 0.1);
            border-bottom: 1px solid var(--border);
            padding: 0.6rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .code-header .dots {
            display: flex;
            gap: 0.4rem;
        }

        .code-header .dots span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot-red { background: #ff5f57; }
        .dot-yellow { background: #febc2e; }
        .dot-green { background: #28c840; }

        .code-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .copy-btn {
            background: rgba(124, 58, 237, 0.2);
            border: 1px solid var(--accent-purple);
            color: var(--accent-purple);
            padding: 0.2rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover { background: var(--accent-purple); color: white; }

        pre {
            padding: 1.25rem;
            overflow-x: auto;
            font-size: 0.88rem;
            line-height: 1.7;
        }

        code {
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
        }

        /* Syntax highlighting */
        .kw { color: #c792ea; }    /* keywords */
        .fn { color: #82aaff; }    /* functions */
        .str { color: #c3e88d; }   /* strings */
        .num { color: #f78c6c; }   /* numbers */
        .cm { color: #546e7a; }    /* comments */
        .var { color: #f07178; }   /* variables */
        .prop { color: #ffcb6b; }  /* properties */
        .bool { color: #ff9cac; }  /* booleans */

        /* ============================================
           VISUAL DIAGRAM
        ============================================ */
        .diagram {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .flow-box {
            background: var(--bg-card);
            border: 2px solid;
            border-radius: 10px;
            padding: 0.75rem 1.25rem;
            font-size: 0.85rem;
            font-weight: 700;
            text-align: center;
        }

        .flow-box.purple { border-color: var(--accent-purple); color: var(--accent-purple); }
        .flow-box.blue { border-color: var(--accent-blue); color: var(--accent-blue); }
        .flow-box.cyan { border-color: var(--accent-cyan); color: var(--accent-cyan); }
        .flow-box.green { border-color: var(--accent-green); color: var(--accent-green); }
        .flow-box.orange { border-color: var(--accent-orange); color: var(--accent-orange); }

        .flow-arrow {
            color: var(--text-muted);
            font-size: 1.5rem;
            font-weight: 900;
        }

        /* ============================================
           INTERACTIVE DEMOS
        ============================================ */
        .demo-area {
            background: var(--code-bg);
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1rem;
            transition: border-color 0.3s;
        }

        .demo-area:hover { border-color: var(--accent-purple); }

        .demo-output {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-family: monospace;
            font-size: 0.85rem;
            color: var(--accent-green);
            min-height: 40px;
            width: 100%;
            text-align: left;
            white-space: pre-wrap;
            word-break: break-all;
        }

        /* ============================================
           BUTTONS
        ============================================ */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.65rem 1.5rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: white;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.6);
        }

        .btn-secondary {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover { border-color: var(--accent-purple); }

        .btn-success {
            background: var(--accent-green);
            color: white;
        }

        .btn-danger {
            background: var(--accent-red);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--accent-purple);
            color: var(--accent-purple);
        }

        .btn-outline:hover { background: var(--accent-purple); color: white; }

        /* ============================================
           ALERTS & CALLOUTS
        ============================================ */
        .callout {
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin: 1rem 0;
            border-left: 4px solid;
            display: flex;
            gap: 0.75rem;
            align-items: flex-start;
        }

        .callout-icon { font-size: 1.25rem; flex-shrink: 0; }
        .callout-content { flex: 1; }
        .callout-content strong { display: block; margin-bottom: 0.25rem; }
        .callout-content p { font-size: 0.9rem; color: var(--text-secondary); }

        .callout.info {
            background: rgba(6, 182, 212, 0.08);
            border-color: var(--accent-cyan);
        }

        .callout.warning {
            background: rgba(245, 158, 11, 0.08);
            border-color: var(--accent-orange);
        }

        .callout.danger {
            background: rgba(239, 68, 68, 0.08);
            border-color: var(--accent-red);
        }

        .callout.success {
            background: rgba(16, 185, 129, 0.08);
            border-color: var(--accent-green);
        }

        .callout.tip {
            background: rgba(124, 58, 237, 0.08);
            border-color: var(--accent-purple);
        }

        /* ============================================
           BADGES & PILLS
        ============================================ */
        .badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-purple { background: rgba(124,58,237,0.2); color: var(--accent-purple); }
        .badge-green { background: rgba(16,185,129,0.2); color: var(--accent-green); }
        .badge-red { background: rgba(239,68,68,0.2); color: var(--accent-red); }
        .badge-orange { background: rgba(245,158,11,0.2); color: var(--accent-orange); }
        .badge-cyan { background: rgba(6,182,212,0.2); color: var(--accent-cyan); }

        /* ============================================
           TABS WITHIN SECTIONS
        ============================================ */
        .inner-tabs {
            display: flex;
            gap: 0.5rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .inner-tab {
            padding: 0.5rem 1rem;
            border-radius: 8px 8px 0 0;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .inner-tab.active {
            background: var(--accent-purple);
            color: white;
        }

        .inner-tab:hover:not(.active) { color: var(--text-primary); }

        .inner-tab-content { display: none; }
        .inner-tab-content.active { display: block; }

        /* ============================================
           QUIZ STYLES
        ============================================ */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-card);
            border-radius: 100px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-1);
            border-radius: 100px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quiz-score {
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .question-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .question-num {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .question-text {
            font-size: 1.15rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .question-code {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 1.25rem;
            font-family: monospace;
            font-size: 0.85rem;
            margin-bottom: 1.5rem;
            white-space: pre-wrap;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        @media (max-width: 600px) {
            .options-grid { grid-template-columns: 1fr; }
        }

        .option-btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            text-align: left;
            cursor: pointer;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.2s;
            font-family: inherit;
            line-height: 1.4;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--accent-purple);
            background: var(--bg-card-hover);
        }

        .option-btn.correct {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        .option-btn.wrong {
            border-color: var(--accent-red);
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
        }

        .explanation {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(124, 58, 237, 0.08);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 10px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: none;
        }

        .explanation.show { display: block; }
        .explanation strong { color: var(--text-primary); }

        /* ============================================
           PRACTICE EXERCISES
        ============================================ */
        .exercise-container {
            display: grid;
            gap: 1.5rem;
        }

        .exercise-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .exercise-header {
            padding: 1.25rem 1.75rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .exercise-header h3 {
            font-size: 1rem;
            font-weight: 700;
        }

        .exercise-body {
            padding: 1.75rem;
        }

        .exercise-body p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .sandbox {
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .sandbox-tabs {
            display: flex;
            background: var(--code-bg);
            border-bottom: 1px solid var(--border);
        }

        .sandbox-tab {
            padding: 0.6rem 1.25rem;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            color: var(--text-muted);
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .sandbox-tab.active {
            color: var(--accent-purple);
            border-bottom-color: var(--accent-purple);
        }

        textarea.code-editor {
            width: 100%;
            background: var(--code-bg);
            border: none;
            color: #c3e88d;
            font-family: 'Fira Code', 'Cascadia Code', monospace;
            font-size: 0.85rem;
            padding: 1rem;
            resize: vertical;
            min-height: 180px;
            outline: none;
            line-height: 1.7;
        }

        .sandbox-actions {
            background: var(--code-bg);
            border-top: 1px solid var(--border);
            padding: 0.75rem 1rem;
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .sandbox-output {
            background: var(--bg-primary);
            border-top: 1px solid var(--border);
            padding: 1rem;
            font-family: monospace;
            font-size: 0.85rem;
            color: var(--accent-green);
            min-height: 60px;
            white-space: pre-wrap;
        }

        /* ============================================
           MISTAKES & PITFALLS
        ============================================ */
        .mistake-card {
            background: var(--bg-card);
            border: 1px solid var(--accent-red);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .mistake-header {
            background: rgba(239, 68, 68, 0.1);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .mistake-header h3 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--accent-red);
        }

        .fix-header {
            background: rgba(16, 185, 129, 0.1);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border-top: 1px solid var(--border);
        }

        .fix-header h3 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--accent-green);
        }

        .mistake-body {
            padding: 1.25rem 1.5rem;
        }

        /* ============================================
           EVENT TYPES TABLE
        ============================================ */
        .event-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .event-type-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.25rem;
            transition: all 0.2s;
        }

        .event-type-card:hover {
            border-color: var(--accent-cyan);
            transform: translateY(-2px);
        }

        .event-type-card .event-icon {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .event-type-card h4 {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            color: var(--accent-cyan);
        }

        .event-type-card p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .event-list {
            list-style: none;
            margin-top: 0.5rem;
        }

        .event-list li {
            font-size: 0.78rem;
            color: var(--text-secondary);
            padding: 0.15rem 0;
        }

        .event-list li::before {
            content: '‚ñ∏ ';
            color: var(--accent-cyan);
        }

        /* ============================================
           INTERACTIVE PLAYGROUND - ADDEVENTLISTENER
        ============================================ */
        .playground {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            overflow: hidden;
        }

        .playground-header {
            background: rgba(124, 58, 237, 0.1);
            border-bottom: 1px solid var(--border);
            padding: 1.25rem 1.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .playground-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .playground-body {
            padding: 1.75rem;
        }

        #event-target-box {
            background: var(--bg-secondary);
            border: 3px dashed var(--accent-purple);
            border-radius: 16px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
            font-size: 1.1rem;
            font-weight: 700;
            position: relative;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        #event-target-box:hover {
            background: rgba(124, 58, 237, 0.1);
        }

        .event-log {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.8rem;
            height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .log-entry {
            padding: 0.2rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            display: flex;
            gap: 0.75rem;
        }

        .log-time { color: var(--text-muted); }
        .log-type { color: var(--accent-cyan); font-weight: 700; }
        .log-msg { color: var(--accent-green); }

        /* ============================================
           EVENT PROPAGATION DIAGRAM
        ============================================ */
        .propagation-demo {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .prop-element {
            border: 2px solid;
            border-radius: 12px;
            padding: 0.75rem 2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 700;
            font-size: 0.9rem;
            width: 100%;
            text-align: center;
        }

        .prop-element.window { border-color: var(--accent-red); color: var(--accent-red); max-width: 500px; }
        .prop-element.document { border-color: var(--accent-orange); color: var(--accent-orange); max-width: 430px; }
        .prop-element.body { border-color: var(--accent-yellow); color: #fbbf24; max-width: 360px; }
        .prop-element.div { border-color: var(--accent-green); color: var(--accent-green); max-width: 290px; }
        .prop-element.btn-el { border-color: var(--accent-cyan); color: var(--accent-cyan); max-width: 220px; }

        .prop-element.pulse {
            animation: pulseEffect 0.6s ease;
        }

        @keyframes pulseEffect {
            0% { transform: scale(1); }
            50% { transform: scale(1.04); box-shadow: 0 0 20px currentColor; }
            100% { transform: scale(1); }
        }

        .prop-phase {
            display: inline-block;
            padding: 0.15rem 0.6rem;
            border-radius: 100px;
            font-size: 0.65rem;
            font-weight: 700;
            margin-left: 0.5rem;
            text-transform: uppercase;
        }

        .phase-capture { background: rgba(6,182,212,0.2); color: var(--accent-cyan); }
        .phase-target { background: rgba(16,185,129,0.2); color: var(--accent-green); }
        .phase-bubble { background: rgba(245,158,11,0.2); color: var(--accent-orange); }

        /* ============================================
           DELEGATION VISUAL
        ============================================ */
        .delegation-demo {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .delegation-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .delegation-list li {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.2s;
        }

        .delegation-list li:hover { border-color: var(--accent-purple); }

        .del-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 700;
            background: rgba(124,58,237,0.2);
            color: var(--accent-purple);
        }

        /* ============================================
           OBJECT EXPLORER
        ============================================ */
        .obj-explorer {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.82rem;
        }

        .obj-prop {
            display: flex;
            gap: 0.75rem;
            padding: 0.3rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.04);
            align-items: flex-start;
        }

        .obj-key { color: var(--accent-orange); flex-shrink: 0; min-width: 180px; }
        .obj-val { color: var(--accent-green); }
        .obj-type { color: var(--text-muted); font-size: 0.7rem; }
        .obj-desc { color: var(--text-muted); font-size: 0.75rem; margin-left: auto; font-style: italic; }

        /* ============================================
           SCORE DISPLAY
        ============================================ */
        .score-display {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--gradient-1);
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 900;
        }

        /* ============================================
           UTILITY CLASSES
        ============================================ */
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .text-sm { font-size: 0.85rem; }
        .text-muted { color: var(--text-muted); }
        .text-green { color: var(--accent-green); }
        .text-red { color: var(--accent-red); }
        .text-cyan { color: var(--accent-cyan); }
        .text-purple { color: var(--accent-purple); }
        .font-bold { font-weight: 700; }
        .w-full { width: 100%; }
        .hidden { display: none; }

        /* ============================================
           CHEATSHEET TABLE
        ============================================ */
        .cheat-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .cheat-table th {
            background: rgba(124,58,237,0.2);
            color: var(--accent-purple);
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 700;
            border-bottom: 2px solid var(--border);
        }

        .cheat-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            color: var(--text-secondary);
            vertical-align: top;
        }

        .cheat-table tr:hover td { background: rgba(124,58,237,0.05); }

        .cheat-table td:first-child {
            font-family: monospace;
            color: var(--accent-cyan);
        }

        /* ============================================
           CONFETTI ANIMATION
        ============================================ */
        .confetti-piece {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 2px;
            animation: confettiFall 3s linear forwards;
            pointer-events: none;
            z-index: 9999;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* Ripple effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            animation: rippleAnim 0.6s linear;
            pointer-events: none;
        }

        @keyframes rippleAnim {
            from { width: 0; height: 0; opacity: 0.8; }
            to { width: 200px; height: 200px; opacity: 0; margin: -100px; }
        }

        /* ============================================
           RESPONSIVE
        ============================================ */
        @media (max-width: 768px) {
            main { padding: 80px 1rem 2rem; }
            nav { padding: 0 1rem; }
            .nav-logo { font-size: 1rem; }
            .hero h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>

<!-- PROGRESS BAR -->
<div class="progress-bar-nav" id="readingProgress"></div>

<!-- NAVIGATION -->
<nav>
    <div class="nav-inner">
        <div class="nav-logo">‚ö° JS Events Mastery</div>
        <ul class="nav-tabs">
            <li><a href="#" onclick="showSection('home')" class="active" id="tab-home">üè† Home</a></li>
            <li><a href="#" onclick="showSection('addeventlistener')" id="tab-addeventlistener">üìå addEventListener</a></li>
            <li><a href="#" onclick="showSection('eventobject')" id="tab-eventobject">üîç Event Object</a></li>
            <li><a href="#" onclick="showSection('eventtypes')" id="tab-eventtypes">üéØ Event Types</a></li>
            <li><a href="#" onclick="showSection('delegation')" id="tab-delegation">üå≥ Delegation</a></li>
            <li><a href="#" onclick="showSection('mistakes')" id="tab-mistakes">‚ö†Ô∏è Mistakes</a></li>
            <li><a href="#" onclick="showSection('practice')" id="tab-practice">üèãÔ∏è Practice</a></li>
            <li><a href="#" onclick="showSection('quiz')" id="tab-quiz">üß† Quiz</a></li>
            <li><a href="#" onclick="showSection('cheatsheet')" id="tab-cheatsheet">üìã Cheatsheet</a></li>
        </ul>
    </div>
</nav>

<main>

<!-- ============================================
     HOME SECTION
============================================ -->
<section id="home" class="active">
    <div class="hero">
        <div class="hero-badge">üéØ Complete Mastery Guide</div>
        <h1>JavaScript <span class="gradient-text">Events & Event Handling</span></h1>
        <p>Your ultimate interactive reference to master user interaction ‚Äî from addEventListener to event delegation. Learn, practice, get tested.</p>
        <div class="hero-stats">
            <div class="stat">
                <div class="stat-num">4</div>
                <div class="stat-label">Core Topics</div>
            </div>
            <div class="stat">
                <div class="stat-num">12+</div>
                <div class="stat-label">Live Demos</div>
            </div>
            <div class="stat">
                <div class="stat-num">15</div>
                <div class="stat-label">Quiz Questions</div>
            </div>
            <div class="stat">
                <div class="stat-num">8</div>
                <div class="stat-label">Pitfalls Covered</div>
            </div>
        </div>
    </div>

    <div class="topics-grid">
        <div class="topic-card" onclick="showSection('addeventlistener')">
            <div class="topic-icon">üìå</div>
            <h3>addEventListener</h3>
            <p>Learn the anatomy, syntax, options (capture, once, passive), and how to properly remove listeners.</p>
            <span class="topic-tag">Foundation</span>
        </div>
        <div class="topic-card" onclick="showSection('eventobject')">
            <div class="topic-icon">üîç</div>
            <h3>Event Object</h3>
            <p>Explore every property and method of the event object ‚Äî target, currentTarget, preventDefault, stopPropagation & more.</p>
            <span class="topic-tag">Core API</span>
        </div>
        <div class="topic-card" onclick="showSection('eventtypes')">
            <div class="topic-icon">üéØ</div>
            <h3>Event Types</h3>
            <p>Deep dive into click, input, submit, mouse, keyboard, focus, drag events with live interactive demos.</p>
            <span class="topic-tag">Event Types</span>
        </div>
        <div class="topic-card" onclick="showSection('delegation')">
            <div class="topic-icon">üå≥</div>
            <h3>Event Delegation</h3>
            <p>Master the pattern of using a single parent listener to handle events from multiple children ‚Äî the right way.</p>
            <span class="topic-tag">Pattern</span>
        </div>
    </div>

    <div class="card mt-3">
        <div class="flow-diagram" style="flex-direction: column; align-items: center; gap: 0">
            <p class="font-bold mb-2" style="color: var(--text-secondary);">üîÅ How Events Flow in the DOM</p>
            <div style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; width: 100%; max-width: 500px;">
                <div class="flow-box blue" style="width: 100%; padding: 0.75rem;">
                    üëÜ User Interaction (click, type, hover...)
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-box purple" style="width: 90%; padding: 0.75rem;">
                    üì£ Browser Creates Event Object
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-box cyan" style="width: 80%; padding: 0.75rem;">
                    üåä Capture Phase (window ‚Üí target)
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-box green" style="width: 70%; padding: 0.75rem;">
                    üéØ Target Phase (exact element)
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-box orange" style="width: 60%; padding: 0.75rem;">
                    ü´ß Bubbling Phase (target ‚Üí window)
                </div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-box purple" style="width: 50%; padding: 0.75rem;">
                    üéâ Your Handler Runs!
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     ADDEVENTLISTENER SECTION
============================================ -->
<section id="addeventlistener">
    <div class="section-header">
        <div class="breadcrumb">Foundation Topic</div>
        <h2>üìå addEventListener</h2>
        <p>The modern, preferred way to attach event handlers. It's powerful, flexible, and allows multiple listeners on one element.</p>
    </div>

    <!-- SYNTAX BREAKDOWN -->
    <div class="card">
        <h3>‚öôÔ∏è Complete Syntax</h3>
        <div class="code-block">
            <div class="code-header">
                <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                <span class="code-label">Full Signature</span>
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            </div>
            <pre><code><span class="var">element</span>.<span class="fn">addEventListener</span>(
  <span class="str">type</span>,        <span class="cm">// string: 'click', 'input', 'submit', etc.</span>
  <span class="var">listener</span>,   <span class="cm">// function: the callback to run</span>
  <span class="var">options</span>     <span class="cm">// optional: object OR boolean (useCapture)</span>
)

<span class="cm">// Options Object:</span>
{
  <span class="prop">capture</span>: <span class="bool">false</span>,   <span class="cm">// true = capture phase, false = bubble (default)</span>
  <span class="prop">once</span>: <span class="bool">false</span>,      <span class="cm">// true = auto-removes after first fire</span>
  <span class="prop">passive</span>: <span class="bool">false</span>,   <span class="cm">// true = won't call preventDefault (perf boost)</span>
  <span class="prop">signal</span>: <span class="var">controller</span>.<span class="prop">signal</span>  <span class="cm">// AbortSignal to remove listener</span>
}</code></pre>
        </div>
    </div>

    <!-- THREE WAYS COMPARISON -->
    <div class="card">
        <h3>‚ö° 3 Ways to Attach Events ‚Äî Which to Use?</h3>
        <div class="three-col">
            <div style="border: 2px solid var(--accent-red); border-radius: 12px; padding: 1.25rem;">
                <div class="badge badge-red mb-2">‚ùå Avoid</div>
                <h4 style="color: var(--accent-red); margin-bottom: 0.5rem;">HTML Inline</h4>
                <div class="code-block">
                    <pre><code><span class="cm">/* HTML */</span>
<span class="kw">&lt;button</span> 
  <span class="prop">onclick</span>=<span class="str">"doSomething()"</span>
<span class="kw">&gt;</span>Click<span class="kw">&lt;/button&gt;</span>

<span class="cm">// Problems:
// - Mixes JS in HTML
// - Global scope only
// - Hard to maintain
// - Can't removeEventListener</span></code></pre>
                </div>
            </div>

            <div style="border: 2px solid var(--accent-orange); border-radius: 12px; padding: 1.25rem;">
                <div class="badge badge-orange mb-2">‚ö†Ô∏è Limited</div>
                <h4 style="color: var(--accent-orange); margin-bottom: 0.5rem;">DOM Property</h4>
                <div class="code-block">
                    <pre><code><span class="var">btn</span>.<span class="prop">onclick</span> = <span class="kw">function</span>() {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'clicked'</span>);
};

<span class="cm">// Problems:
// - Only ONE handler
// - Second assignment
//   overwrites first!
// - Can't use options</span></code></pre>
                </div>
            </div>

            <div style="border: 2px solid var(--accent-green); border-radius: 12px; padding: 1.25rem;">
                <div class="badge badge-green mb-2">‚úÖ Best</div>
                <h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">addEventListener</h4>
                <div class="code-block">
                    <pre><code><span class="var">btn</span>.<span class="fn">addEventListener</span>(
  <span class="str">'click'</span>,
  <span class="var">handler</span>
);

<span class="cm">// Benefits:
// - Multiple listeners
// - Options support
// - Can removeEventListener
// - Works everywhere</span></code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- COMMON PATTERNS -->
    <div class="card">
        <h3>üß© Common Patterns You Must Know</h3>
        <div class="inner-tabs">
            <button class="inner-tab active" onclick="switchInnerTab(this, 'tab-named')">Named Function</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'tab-arrow')">Arrow Function</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'tab-remove')">Removing Listener</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'tab-once')">{ once: true }</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'tab-abort')">AbortController</button>
        </div>

        <div class="inner-tab-content active" id="tab-named">
            <div class="code-block">
                <div class="code-header">
                    <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                    <span class="code-label">Named Function ‚Äî Best for removable listeners</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code><span class="cm">// ‚úÖ Named function = can be removed later</span>
<span class="kw">function</span> <span class="fn">handleClick</span>(<span class="var">event</span>) {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Button clicked!'</span>, <span class="var">event</span>);
}

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// Later, remove it:</span>
<span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// ‚ö†Ô∏è MUST be the EXACT same function reference!</span></code></pre>
            </div>
            <div class="callout info">
                <span class="callout-icon">üí°</span>
                <div class="callout-content">
                    <strong>Why named functions matter</strong>
                    <p>Anonymous functions create a new reference each time, making them impossible to remove with <code>removeEventListener</code>. Always name your handler if you need to remove it.</p>
                </div>
            </div>
        </div>

        <div class="inner-tab-content" id="tab-arrow">
            <div class="code-block">
                <div class="code-header">
                    <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                    <span class="code-label">Arrow Functions ‚Äî Great for inline logic</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code><span class="cm">// ‚úÖ Arrow function ‚Äî short, inline</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Clicked! Target:'</span>, <span class="var">e</span>.<span class="prop">target</span>);
});

<span class="cm">// ‚ö†Ô∏è IMPORTANT: 'this' behaves differently!</span>
<span class="cm">// Arrow function 'this' = outer scope (lexical)</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="kw">function</span>() {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="kw">this</span>); <span class="cm">// = the button element ‚úÖ</span>
});

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="kw">this</span>); <span class="cm">// = window (NOT button!) ‚ö†Ô∏è</span>
});</code></pre>
            </div>
        </div>

        <div class="inner-tab-content" id="tab-remove">
            <div class="code-block">
                <div class="code-header">
                    <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                    <span class="code-label">removeEventListener ‚Äî Clean up after yourself!</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code><span class="kw">const</span> <span class="var">btn</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#myBtn'</span>);

<span class="kw">function</span> <span class="fn">handleClick</span>(<span class="var">e</span>) {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'clicked'</span>);
}

<span class="cm">// Add the listener</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// Remove it ‚Äî MUST match: same type, same reference, same capture flag</span>
<span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// ‚ùå This WON'T work ‚Äî different function reference!</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'hi'</span>));
<span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, () => <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'hi'</span>)); <span class="cm">// ‚ùå Fails!</span></code></pre>
            </div>
            <div class="callout warning">
                <span class="callout-icon">‚ö†Ô∏è</span>
                <div class="callout-content">
                    <strong>Memory Leaks!</strong>
                    <p>Not removing event listeners when components/elements are removed causes memory leaks. Always clean up in SPA frameworks, modals, and dynamic UI.</p>
                </div>
            </div>
        </div>

        <div class="inner-tab-content" id="tab-once">
            <div class="code-block">
                <div class="code-header">
                    <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                    <span class="code-label">{ once: true } ‚Äî Auto-removes after first fire</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code><span class="cm">// Perfect for: one-time UI actions, first-visit popups, etc.</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'This fires only ONCE, then auto-removes!'</span>);
}, { <span class="prop">once</span>: <span class="bool">true</span> });

<span class="cm">// Equivalent to:</span>
<span class="kw">function</span> <span class="fn">handleOnce</span>(<span class="var">e</span>) {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Only once!'</span>);
  <span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, <span class="var">handleOnce</span>);
}
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleOnce</span>);

<span class="cm">// Real use case: initialize something only once</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'DOMContentLoaded'</span>, <span class="var">init</span>, { <span class="prop">once</span>: <span class="bool">true</span> });</code></pre>
            </div>
        </div>

        <div class="inner-tab-content" id="tab-abort">
            <div class="code-block">
                <div class="code-header">
                    <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                    <span class="code-label">AbortController ‚Äî Remove multiple listeners at once</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <pre><code><span class="cm">// Modern way to remove multiple listeners at once!</span>
<span class="kw">const</span> <span class="var">controller</span> = <span class="kw">new</span> <span class="fn">AbortController</span>();
<span class="kw">const</span> { <span class="var">signal</span> } = <span class="var">controller</span>;

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>, { <span class="var">signal</span> });
<span class="var">input</span>.<span class="fn">addEventListener</span>(<span class="str">'input'</span>, <span class="var">handleInput</span>, { <span class="var">signal</span> });
<span class="var">form</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, <span class="var">handleSubmit</span>, { <span class="var">signal</span> });

<span class="cm">// Remove ALL of them with ONE call!</span>
<span class="var">controller</span>.<span class="fn">abort</span>(); <span class="cm">// ‚úÖ All three listeners removed!</span>

<span class="cm">// Great for: component cleanup, route changes, modal close</span></code></pre>
            </div>
            <div class="callout success">
                <span class="callout-icon">üöÄ</span>
                <div class="callout-content">
                    <strong>Pro tip: AbortController is the modern solution</strong>
                    <p>Instead of tracking multiple listener references, use one AbortController. When you want to clean up (e.g., component unmounts), just call <code>controller.abort()</code>.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- INTERACTIVE PLAYGROUND -->
    <div class="playground">
        <div class="playground-header">
            <h3>üéÆ Live Playground ‚Äî Try It!</h3>
            <span class="badge badge-green">Interactive</span>
        </div>
        <div class="playground-body">
            <div class="two-col">
                <div>
                    <p class="text-sm text-muted mb-2">Interact with the target box and watch events fire:</p>
                    <div id="event-target-box">
                        <span style="font-size: 2rem">üéØ</span>
                        <span>Click, Hover, or Right-click me!</span>
                        <span class="text-sm text-muted">Events will appear in the log ‚Üí</span>
                    </div>
                    <div style="display: flex; gap: 0.75rem; margin-top: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-secondary text-sm" onclick="clearEventLog()">üóëÔ∏è Clear Log</button>
                        <button class="btn btn-secondary text-sm" onclick="toggleCapture()">üì∏ Toggle Capture: <span id="captureStatus">OFF</span></button>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <p class="text-sm font-bold">üìã Event Log</p>
                        <span class="badge badge-cyan" id="logCount">0 events</span>
                    </div>
                    <div class="event-log" id="eventLog">
                        <div class="log-entry" style="opacity: 0.4">
                            <span class="log-time">00:00:00</span>
                            <span class="log-type">READY</span>
                            <span class="log-msg">Interact with the box to see events...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     EVENT OBJECT SECTION
============================================ -->
<section id="eventobject">
    <div class="section-header">
        <div class="breadcrumb">Core API</div>
        <h2>üîç The Event Object</h2>
        <p>Every event handler receives a magical event object packed with information about what happened, where, and how to control it.</p>
    </div>

    <div class="callout info">
        <span class="callout-icon">üí°</span>
        <div class="callout-content">
            <strong>What is the Event Object?</strong>
            <p>When an event fires, the browser automatically creates an Event object and passes it to your handler as the first argument. It contains everything about the event ‚Äî target element, mouse position, key pressed, and methods to control behavior.</p>
        </div>
    </div>

    <!-- EVENT OBJECT PROPERTIES -->
    <div class="card">
        <h3>üóÇÔ∏è Event Object ‚Äî Key Properties Explorer</h3>
        <div class="obj-explorer">
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">type</span></span>
                <span class="obj-val">"click"</span>
                <span class="obj-desc">‚Üí What type of event fired</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">target</span></span>
                <span class="obj-val">&lt;button id="myBtn"&gt;</span>
                <span class="obj-desc">‚Üí Element that TRIGGERED the event</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">currentTarget</span></span>
                <span class="obj-val">&lt;div id="container"&gt;</span>
                <span class="obj-desc">‚Üí Element with the listener attached</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">bubbles</span></span>
                <span class="obj-val">true</span>
                <span class="obj-desc">‚Üí Does this event bubble up?</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">cancelable</span></span>
                <span class="obj-val">true</span>
                <span class="obj-desc">‚Üí Can default behavior be prevented?</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">timeStamp</span></span>
                <span class="obj-val">1234.56</span>
                <span class="obj-desc">‚Üí When the event was created (ms)</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">defaultPrevented</span></span>
                <span class="obj-val">false</span>
                <span class="obj-desc">‚Üí Was preventDefault() called?</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">isTrusted</span></span>
                <span class="obj-val">true</span>
                <span class="obj-desc">‚Üí Real user action (not synthetic)?</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key" style="color: var(--accent-green)">‚ü∂ Mouse Events Only</span>
                <span class="obj-val"></span>
                <span class="obj-desc"></span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">clientX / clientY</span></span>
                <span class="obj-val">245 / 380</span>
                <span class="obj-desc">‚Üí Position relative to viewport</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">pageX / pageY</span></span>
                <span class="obj-val">245 / 1480</span>
                <span class="obj-desc">‚Üí Position relative to document</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">button</span></span>
                <span class="obj-val">0 / 1 / 2</span>
                <span class="obj-desc">‚Üí Left / Middle / Right mouse button</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key" style="color: var(--accent-green)">‚ü∂ Keyboard Events Only</span>
                <span class="obj-val"></span>
                <span class="obj-desc"></span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">key</span></span>
                <span class="obj-val">"Enter"</span>
                <span class="obj-desc">‚Üí Readable key name (use this!)</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">code</span></span>
                <span class="obj-val">"KeyA"</span>
                <span class="obj-desc">‚Üí Physical key code (layout-independent)</span>
            </div>
            <div class="obj-prop">
                <span class="obj-key">event.<span style="color:var(--accent-cyan)">ctrlKey / shiftKey / altKey</span></span>
                <span class="obj-val">true / false</span>
                <span class="obj-desc">‚Üí Was modifier held?</span>
            </div>
        </div>
    </div>

    <!-- METHODS -->
    <div class="two-col">
        <div class="card">
            <h3>üõë preventDefault()</h3>
            <p class="text-sm text-muted mb-2">Stops the browser's default behavior for the event.</p>
            <div class="code-block">
                <pre><code><span class="cm">// Stop form submission</span>
<span class="var">form</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// No page reload!</span>
  <span class="cm">// Handle with JS</span>
});

<span class="cm">// Stop link navigation</span>
<span class="var">link</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// Won't navigate</span>
});

<span class="cm">// Stop right-click menu</span>
<span class="var">el</span>.<span class="fn">addEventListener</span>(<span class="str">'contextmenu'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// No browser menu</span>
});</code></pre>
            </div>
            <div class="callout warning mt-2">
                <span class="callout-icon">‚ö†Ô∏è</span>
                <div class="callout-content">
                    <strong>Only works if cancelable = true</strong>
                    <p>Check <code>event.cancelable</code> first if unsure.</p>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>‚õî stopPropagation()</h3>
            <p class="text-sm text-muted mb-2">Stops the event from bubbling up (or capturing down) the DOM.</p>
            <div class="code-block">
                <pre><code><span class="cm">// Stop bubbling to parent</span>
<span class="var">child</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">stopPropagation</span>(); <span class="cm">// Won't reach parent!</span>
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Child only'</span>);
});

<span class="var">parent</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Never runs!'</span>); <span class="cm">// ‚Üê blocked</span>
});

<span class="cm">// Nuclear option: stopImmediatePropagation()</span>
<span class="cm">// Stops OTHER listeners on SAME element too!</span>
<span class="var">el</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">stopImmediatePropagation</span>();
});</code></pre>
            </div>
            <div class="callout warning mt-2">
                <span class="callout-icon">‚ö†Ô∏è</span>
                <div class="callout-content">
                    <strong>Use sparingly!</strong>
                    <p>Stopping propagation can break event delegation patterns. Only stop bubbling when truly necessary.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- TARGET vs CURRENTTARGET VISUAL -->
    <div class="card">
        <h3>üéØ target vs currentTarget ‚Äî The Most Confused Property</h3>
        <div class="two-col">
            <div>
                <div class="code-block">
                    <pre><code><span class="cm">// HTML Structure:</span>
<span class="cm">// &lt;div id="parent"&gt;</span>
<span class="cm">//   &lt;button id="child"&gt;Click&lt;/button&gt;</span>
<span class="cm">// &lt;/div&gt;</span>

<span class="kw">const</span> <span class="var">parent</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#parent'</span>);

<span class="var">parent</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="cm">// User clicked the BUTTON</span>
  <span class="var">e</span>.<span class="prop">target</span>         <span class="cm">// = &lt;button&gt; ‚Üê WHAT was clicked</span>
  <span class="var">e</span>.<span class="prop">currentTarget</span>  <span class="cm">// = &lt;div&gt; ‚Üê WHERE listener IS</span>
  <span class="kw">this</span>              <span class="cm">// = &lt;div&gt; ‚Üê same as currentTarget</span>
});

<span class="cm">// KEY RULE:</span>
<span class="cm">// target = source of the event</span>
<span class="cm">// currentTarget = element with the listener</span>
<span class="cm">// They're SAME only when event is on exact element</span></code></pre>
                </div>
            </div>
            <div>
                <div style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem;">
                    <p class="text-sm font-bold mb-2" style="color: var(--text-secondary);">Visual representation:</p>
                    <div style="border: 2px solid var(--accent-orange); border-radius: 12px; padding: 1rem; margin-bottom: 0.75rem;">
                        <div class="text-sm" style="color: var(--accent-orange);">div#parent</div>
                        <div class="text-sm text-muted">‚Üê currentTarget (listener here)</div>
                        <div style="border: 2px solid var(--accent-cyan); border-radius: 8px; padding: 0.75rem; margin-top: 0.75rem; display: inline-block;">
                            <div class="text-sm" style="color: var(--accent-cyan);">button#child</div>
                            <div class="text-sm text-muted">‚Üê target (click here)</div>
                        </div>
                    </div>
                    <div class="obj-explorer">
                        <div class="obj-prop">
                            <span class="obj-key">e.target</span>
                            <span class="obj-val" style="color: var(--accent-cyan)">button#child</span>
                        </div>
                        <div class="obj-prop">
                            <span class="obj-key">e.currentTarget</span>
                            <span class="obj-val" style="color: var(--accent-orange)">div#parent</span>
                        </div>
                    </div>
                </div>

                <!-- LIVE DEMO -->
                <div id="target-demo-parent" style="background: rgba(245,158,11,0.1); border: 2px solid var(--accent-orange); border-radius: 12px; padding: 1rem; margin-top: 1rem; cursor: pointer;">
                    <p class="text-sm" style="color: var(--accent-orange);">div#parent (click anywhere)</p>
                    <button id="target-demo-child" style="background: rgba(6,182,212,0.2); border: 2px solid var(--accent-cyan); border-radius: 8px; padding: 0.5rem 1rem; color: var(--accent-cyan); cursor: pointer; margin-top: 0.5rem; font-weight: 700;">
                        button#child
                    </button>
                </div>
                <div class="demo-output mt-1" id="targetOutput">Click the box above...</div>
            </div>
        </div>
    </div>

    <!-- EVENT PROPAGATION INTERACTIVE -->
    <div class="card">
        <h3>üåä Event Propagation ‚Äî Visual Demo</h3>
        <p class="text-sm text-muted mb-3">Click the innermost button and watch propagation animate through the DOM layers. Use stopPropagation to see the difference.</p>

        <div class="two-col">
            <div>
                <div class="propagation-demo" id="propDemo">
                    <div class="prop-element window" id="prop-window">
                        window
                        <span class="prop-phase phase-bubble">bubbles last</span>
                    </div>
                    <div class="prop-element document" id="prop-document">
                        document
                    </div>
                    <div class="prop-element body" id="prop-body">
                        body
                    </div>
                    <div class="prop-element div" id="prop-div">
                        div#container
                    </div>
                    <div class="prop-element btn-el" id="prop-btn" style="cursor: pointer;" onclick="animatePropagation()">
                        üéØ Click Me!
                        <span class="prop-phase phase-target">TARGET</span>
                    </div>
                </div>
            </div>
            <div>
                <div style="margin-bottom: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; font-size: 0.9rem;">
                        <input type="checkbox" id="stopBubble" style="width: 16px; height: 16px; accent-color: var(--accent-purple);">
                        Stop at div#container (stopPropagation)
                    </label>
                </div>
                <div class="event-log" id="propLog" style="height: 250px;">
                    <div class="log-entry" style="opacity: 0.4">
                        <span class="log-msg">Click the target element ‚Üí</span>
                    </div>
                </div>

                <div style="margin-top: 1rem; padding: 1rem; background: var(--code-bg); border-radius: 10px;">
                    <p class="text-sm font-bold mb-1">Legend:</p>
                    <div style="display: flex; flex-direction: column; gap: 0.25rem; font-size: 0.78rem;">
                        <span><span class="prop-phase phase-capture">Capture</span> window ‚Üí target (top-down)</span>
                        <span><span class="prop-phase phase-target">Target</span> the clicked element</span>
                        <span><span class="prop-phase phase-bubble">Bubble</span> target ‚Üí window (bottom-up)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     EVENT TYPES SECTION
============================================ -->
<section id="eventtypes">
    <div class="section-header">
        <div class="breadcrumb">Event Types</div>
        <h2>üéØ Event Types Deep Dive</h2>
        <p>Every possible interaction generates a specific event type. Let's master the most important ones.</p>
    </div>

    <!-- EVENT TYPES GRID -->
    <div class="event-types-grid mb-3">
        <div class="event-type-card">
            <div class="event-icon">üñ±Ô∏è</div>
            <h4>Mouse Events</h4>
            <p>Pointer interactions</p>
            <ul class="event-list">
                <li>click</li>
                <li>dblclick</li>
                <li>mousedown/up</li>
                <li>mousemove</li>
                <li>mouseenter/leave</li>
                <li>mouseover/out</li>
                <li>contextmenu</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">‚å®Ô∏è</div>
            <h4>Keyboard Events</h4>
            <p>Key press interactions</p>
            <ul class="event-list">
                <li>keydown ‚Üê use this</li>
                <li>keyup</li>
                <li>keypress ‚Üê deprecated</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üìù</div>
            <h4>Form Events</h4>
            <p>Form & input handling</p>
            <ul class="event-list">
                <li>submit</li>
                <li>input ‚Üê real-time</li>
                <li>change ‚Üê on blur</li>
                <li>focus / blur</li>
                <li>focusin / focusout</li>
                <li>reset</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üìú</div>
            <h4>Document Events</h4>
            <p>Page lifecycle</p>
            <ul class="event-list">
                <li>DOMContentLoaded</li>
                <li>load</li>
                <li>beforeunload</li>
                <li>scroll</li>
                <li>resize</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üì±</div>
            <h4>Touch Events</h4>
            <p>Mobile interactions</p>
            <ul class="event-list">
                <li>touchstart</li>
                <li>touchend</li>
                <li>touchmove</li>
                <li>touchcancel</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üñ±Ô∏è‚ÜïÔ∏è</div>
            <h4>Pointer Events</h4>
            <p>Unified input (modern)</p>
            <ul class="event-list">
                <li>pointerdown</li>
                <li>pointerup</li>
                <li>pointermove</li>
                <li>pointerenter/leave</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üì¶</div>
            <h4>Drag Events</h4>
            <p>Drag & drop</p>
            <ul class="event-list">
                <li>dragstart</li>
                <li>drag</li>
                <li>dragend</li>
                <li>dragover</li>
                <li>drop</li>
            </ul>
        </div>
        <div class="event-type-card">
            <div class="event-icon">üîó</div>
            <h4>Custom Events</h4>
            <p>Dispatch your own</p>
            <ul class="event-list">
                <li>new Event()</li>
                <li>new CustomEvent()</li>
                <li>dispatchEvent()</li>
            </ul>
        </div>
    </div>

    <!-- CLICK EVENT DEEP DIVE -->
    <div class="card">
        <h3>üñ±Ô∏è click Event ‚Äî Deep Dive</h3>
        <div class="two-col">
            <div>
                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">click event patterns</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="cm">// Mouse position</span>
  <span class="var">e</span>.<span class="prop">clientX</span>  <span class="cm">// viewport X</span>
  <span class="var">e</span>.<span class="prop">clientY</span>  <span class="cm">// viewport Y</span>

  <span class="cm">// Which button?</span>
  <span class="var">e</span>.<span class="prop">button</span>   <span class="cm">// 0=left, 1=mid, 2=right</span>

  <span class="cm">// Modifier keys held?</span>
  <span class="var">e</span>.<span class="prop">shiftKey</span> <span class="cm">// boolean</span>
  <span class="var">e</span>.<span class="prop">ctrlKey</span>  <span class="cm">// boolean</span>
  <span class="var">e</span>.<span class="prop">altKey</span>   <span class="cm">// boolean</span>
  <span class="var">e</span>.<span class="prop">metaKey</span>  <span class="cm">// Cmd on Mac</span>

  <span class="cm">// Click count</span>
  <span class="var">e</span>.<span class="prop">detail</span>   <span class="cm">// 1=single, 2=double</span>
});

<span class="cm">// Right click</span>
<span class="var">el</span>.<span class="fn">addEventListener</span>(<span class="str">'contextmenu'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// Custom context menu</span>
});</code></pre>
                </div>
            </div>
            <div>
                <div class="demo-area" id="clickDemo">
                    <span style="font-size: 3rem">üñ±Ô∏è</span>
                    <p class="text-muted text-sm">Click, Shift+Click, or Right-click</p>
                    <button class="btn btn-primary" id="clickTestBtn">üéØ Click Me!</button>
                </div>
                <div class="demo-output mt-1" id="clickOutput">Click the button to see event details...</div>
            </div>
        </div>
    </div>

    <!-- INPUT EVENT DEEP DIVE -->
    <div class="card">
        <h3>üìù input Event ‚Äî Real-time Input Handling</h3>
        <div class="two-col">
            <div>
                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">input vs change events</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="kw">const</span> <span class="var">input</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'input'</span>);

<span class="cm">// 'input' = fires on EVERY keystroke</span>
<span class="var">input</span>.<span class="fn">addEventListener</span>(<span class="str">'input'</span>, (<span class="var">e</span>) => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">value</span>); <span class="cm">// current value</span>
  <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">data</span>);          <span class="cm">// character typed</span>
  <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">inputType</span>);    <span class="cm">// 'insertText', etc.</span>
});

<span class="cm">// 'change' = fires when value changes AND</span>
<span class="cm">//           the element loses focus (blur)</span>
<span class="var">input</span>.<span class="fn">addEventListener</span>(<span class="str">'change'</span>, (<span class="var">e</span>) => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Final value:'</span>, <span class="var">e</span>.<span class="prop">target</span>.<span class="prop">value</span>);
});

<span class="cm">// ‚ö†Ô∏è Debounce expensive operations on input!</span>
<span class="kw">let</span> <span class="var">timeout</span>;
<span class="var">input</span>.<span class="fn">addEventListener</span>(<span class="str">'input'</span>, (<span class="var">e</span>) => {
  <span class="fn">clearTimeout</span>(<span class="var">timeout</span>);
  <span class="var">timeout</span> = <span class="fn">setTimeout</span>(() => {
    <span class="fn">searchAPI</span>(<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">value</span>); <span class="cm">// wait 300ms</span>
  }, <span class="num">300</span>);
});</code></pre>
                </div>
            </div>
            <div>
                <div class="demo-area" style="padding: 1.5rem; flex-direction: column; align-items: stretch;">
                    <label style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Live typing demo:</label>
                    <input type="text" id="inputDemo" placeholder="Start typing here..." style="background: var(--bg-primary); border: 2px solid var(--border); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem; outline: none; transition: border-color 0.2s;">
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <div style="flex: 1; background: var(--bg-primary); border-radius: 8px; padding: 0.75rem; font-size: 0.8rem;">
                            <div class="text-muted text-sm">Character Count</div>
                            <div id="charCount" style="font-size: 1.5rem; font-weight: 900; color: var(--accent-cyan);">0</div>
                        </div>
                        <div style="flex: 1; background: var(--bg-primary); border-radius: 8px; padding: 0.75rem; font-size: 0.8rem;">
                            <div class="text-muted text-sm">Word Count</div>
                            <div id="wordCount" style="font-size: 1.5rem; font-weight: 900; color: var(--accent-green);">0</div>
                        </div>
                        <div style="flex: 1; background: var(--bg-primary); border-radius: 8px; padding: 0.75rem; font-size: 0.8rem;">
                            <div class="text-muted text-sm">Last Key</div>
                            <div id="lastKey" style="font-size: 1rem; font-weight: 900; color: var(--accent-orange);">‚Äî</div>
                        </div>
                    </div>
                </div>
                <div class="demo-output mt-1" id="inputOutput">Start typing above...</div>
            </div>
        </div>
    </div>

    <!-- SUBMIT EVENT DEEP DIVE -->
    <div class="card">
        <h3>üì¨ submit Event ‚Äî Form Handling Master</h3>
        <div class="two-col">
            <div>
                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">Complete form handling pattern</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="kw">const</span> <span class="var">form</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#myForm'</span>);

<span class="var">form</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, (<span class="var">e</span>) => {
  <span class="cm">// 1Ô∏è‚É£ ALWAYS prevent default first!</span>
  <span class="var">e</span>.<span class="fn">preventDefault</span>();

  <span class="cm">// 2Ô∏è‚É£ Get form data (modern way)</span>
  <span class="kw">const</span> <span class="var">formData</span> = <span class="kw">new</span> <span class="fn">FormData</span>(<span class="var">e</span>.<span class="prop">target</span>);
  <span class="kw">const</span> <span class="var">data</span> = <span class="fn">Object</span>.<span class="fn">fromEntries</span>(<span class="var">formData</span>);

  <span class="cm">// 3Ô∏è‚É£ Validate</span>
  <span class="kw">if</span> (!<span class="var">data</span>.<span class="prop">email</span>.<span class="fn">includes</span>(<span class="str">'@'</span>)) {
    <span class="fn">showError</span>(<span class="str">'Invalid email'</span>);
    <span class="kw">return</span>;
  }

  <span class="cm">// 4Ô∏è‚É£ Send data</span>
  <span class="fn">fetch</span>(<span class="str">'/api/submit'</span>, {
    <span class="prop">method</span>: <span class="str">'POST'</span>,
    <span class="prop">body</span>: <span class="fn">JSON</span>.<span class="fn">stringify</span>(<span class="var">data</span>)
  });
});

<span class="cm">// ‚ö†Ô∏è Triggered by: submit button click,</span>
<span class="cm">//   Enter key in a text input</span></code></pre>
                </div>
            </div>
            <div>
                <form id="submitDemo" style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; display: flex; flex-direction: column; gap: 0.75rem;">
                    <h4 style="margin-bottom: 0.5rem;">Live Form Demo</h4>
                    <input type="text" name="name" placeholder="Your name" style="background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; transition: border-color 0.2s; font-size: 0.9rem;">
                    <input type="email" name="email" placeholder="your@email.com" style="background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; transition: border-color 0.2s; font-size: 0.9rem;">
                    <select name="role" style="background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; font-size: 0.9rem;">
                        <option value="">Select role...</option>
                        <option value="frontend">Frontend Dev</option>
                        <option value="backend">Backend Dev</option>
                        <option value="fullstack">Fullstack Dev</option>
                    </select>
                    <button type="submit" class="btn btn-primary">üöÄ Submit Form</button>
                </form>
                <div class="demo-output mt-1" id="submitOutput" style="min-height: 80px;">Form data will appear here...</div>
            </div>
        </div>
    </div>

    <!-- KEYBOARD EVENTS -->
    <div class="card">
        <h3>‚å®Ô∏è Keyboard Events ‚Äî keydown, keyup</h3>
        <div class="callout warning mb-2">
            <span class="callout-icon">‚ö†Ô∏è</span>
            <div class="callout-content">
                <strong>keypress is DEPRECATED!</strong>
                <p>Use <code>keydown</code> instead. Use <code>event.key</code> for readable names, <code>event.code</code> for physical key position.</p>
            </div>
        </div>
        <div class="two-col">
            <div class="code-block">
                <pre><code><span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, (<span class="var">e</span>) => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">key</span>);   <span class="cm">// "a", "Enter", "ArrowUp"</span>
  <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">code</span>);  <span class="cm">// "KeyA", "Enter", "ArrowUp"</span>

  <span class="cm">// Keyboard shortcuts:</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">ctrlKey</span> && <span class="var">e</span>.<span class="prop">key</span> === <span class="str">'s'</span>) {
    <span class="var">e</span>.<span class="fn">preventDefault</span>();
    <span class="fn">saveDocument</span>();
  }

  <span class="cm">// Escape key handler:</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span> === <span class="str">'Escape'</span>) <span class="fn">closeModal</span>();

  <span class="cm">// Arrow key navigation:</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span>.<span class="fn">startsWith</span>(<span class="str">'Arrow'</span>)) {
    <span class="fn">movePlayer</span>(<span class="var">e</span>.<span class="prop">key</span>);
  }
});

<span class="cm">// key vs code difference:</span>
<span class="cm">// e.key  = what character (language-dependent)</span>
<span class="cm">// e.code = physical key (QWERTY position)</span>
<span class="cm">// "a" vs "A" ‚Üí e.key differs, e.code = "KeyA"</span></code></pre>
            </div>
            <div>
                <div class="demo-area" style="min-height: 120px; flex-direction: column; align-items: center;">
                    <span style="font-size: 2rem">‚å®Ô∏è</span>
                    <p class="text-sm text-muted">Press any key while focused here</p>
                    <input type="text" id="keyboardDemo" placeholder="Click here, then press any key" style="background: var(--bg-primary); border: 2px solid var(--accent-purple); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 0.9rem; outline: none; width: 100%; text-align: center;">
                </div>
                <div class="demo-output mt-1" id="keyOutput" style="min-height: 100px;">Press keys in the input above...</div>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     EVENT DELEGATION SECTION
============================================ -->
<section id="delegation">
    <div class="section-header">
        <div class="breadcrumb">Pattern</div>
        <h2>üå≥ Event Delegation</h2>
        <p>The art of listening on a parent instead of many children. One listener to rule them all.</p>
    </div>

    <div class="callout info mb-3">
        <span class="callout-icon">üí°</span>
        <div class="callout-content">
            <strong>What is Event Delegation?</strong>
            <p>Instead of attaching event listeners to each child element, you attach ONE listener to a parent. When a child is clicked, the event bubbles up to the parent's listener. You then use <code>event.target</code> to figure out which child was actually clicked.</p>
        </div>
    </div>

    <!-- WHY DELEGATION -->
    <div class="two-col mb-3">
        <div class="card" style="border-color: var(--accent-red);">
            <h3>‚ùå Without Delegation (Bad)</h3>
            <div class="code-block">
                <pre><code><span class="cm">// 100 list items = 100 listeners = üíÄ memory waste</span>
<span class="kw">const</span> <span class="var">items</span> = <span class="var">document</span>.<span class="fn">querySelectorAll</span>(<span class="str">'li'</span>);

<span class="var">items</span>.<span class="fn">forEach</span>((<span class="var">item</span>) => {
  <span class="var">item</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="kw">function</span>() {
    <span class="var">console</span>.<span class="fn">log</span>(<span class="kw">this</span>.<span class="prop">textContent</span>);
  });
});

<span class="cm">// Problems:</span>
<span class="cm">// ‚ùå 100 listeners in memory</span>
<span class="cm">// ‚ùå New items added later? Need to re-attach!</span>
<span class="cm">// ‚ùå Slow for large lists</span>
<span class="cm">// ‚ùå forEach loop runs every time</span></code></pre>
            </div>
        </div>
        <div class="card" style="border-color: var(--accent-green);">
            <h3>‚úÖ With Delegation (Great)</h3>
            <div class="code-block">
                <pre><code><span class="cm">// 1 listener on parent = üöÄ efficient</span>
<span class="kw">const</span> <span class="var">list</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'ul'</span>);

<span class="var">list</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="cm">// Check what was actually clicked</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">tagName</span> === <span class="str">'LI'</span>) {
    <span class="var">console</span>.<span class="fn">log</span>(<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">textContent</span>);
  }
});

<span class="cm">// Benefits:</span>
<span class="cm">// ‚úÖ 1 listener no matter how many children</span>
<span class="cm">// ‚úÖ Works for dynamically added items!</span>
<span class="cm">// ‚úÖ Better memory performance</span>
<span class="cm">// ‚úÖ Cleaner code</span></code></pre>
            </div>
        </div>
    </div>

    <!-- DELEGATION PATTERNS -->
    <div class="card">
        <h3>üéØ Delegation Patterns ‚Äî From Basic to Pro</h3>
        <div class="inner-tabs">
            <button class="inner-tab active" onclick="switchInnerTab(this, 'del-basic')">Basic</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'del-matches')">closest() & matches()</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'del-data')">data-* Attributes</button>
            <button class="inner-tab" onclick="switchInnerTab(this, 'del-dynamic')">Dynamic Items</button>
        </div>

        <div class="inner-tab-content active" id="del-basic">
            <div class="code-block">
                <pre><code><span class="cm">// Basic delegation by tag name</span>
<span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#list'</span>)
  .<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {

    <span class="cm">// Pattern 1: Check tagName</span>
    <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">tagName</span> === <span class="str">'LI'</span>) {
      <span class="var">e</span>.<span class="prop">target</span>.<span class="prop">classList</span>.<span class="fn">toggle</span>(<span class="str">'selected'</span>);
    }

    <span class="cm">// Pattern 2: Check className</span>
    <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">classList</span>.<span class="fn">contains</span>(<span class="str">'delete-btn'</span>)) {
      <span class="var">e</span>.<span class="prop">target</span>.<span class="prop">closest</span>(<span class="str">'li'</span>).<span class="fn">remove</span>();
    }

    <span class="cm">// Pattern 3: Check id</span>
    <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">id</span> === <span class="str">'special'</span>) {
      <span class="fn">handleSpecial</span>(<span class="var">e</span>);
    }
  });</code></pre>
            </div>
        </div>

        <div class="inner-tab-content" id="del-matches">
            <div class="code-block">
                <pre><code><span class="cm">// .matches() ‚Äî like querySelector but for checking</span>
<span class="var">container</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {

  <span class="cm">// matches() = does this element match a CSS selector?</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="fn">matches</span>(<span class="str">'.btn-delete'</span>)) {
    <span class="fn">deleteItem</span>(<span class="var">e</span>.<span class="prop">target</span>);
  }

  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="fn">matches</span>(<span class="str">'button[data-action]'</span>)) {
    <span class="fn">handleAction</span>(<span class="var">e</span>.<span class="prop">target</span>.<span class="prop">dataset</span>.<span class="prop">action</span>);
  }

  <span class="cm">// .closest() ‚Äî traverse up to find ancestor</span>
  <span class="cm">// SUPER useful when clicking an icon INSIDE a button</span>
  <span class="kw">const</span> <span class="var">btn</span> = <span class="var">e</span>.<span class="prop">target</span>.<span class="fn">closest</span>(<span class="str">'.card-btn'</span>);
  <span class="kw">if</span> (<span class="var">btn</span>) {
    <span class="cm">// Works even if user clicked the &lt;span&gt; inside the button!</span>
    <span class="var">btn</span>.<span class="prop">dataset</span>.<span class="prop">id</span>; <span class="cm">// get data from the button</span>
  }
});</code></pre>
            </div>
            <div class="callout tip mt-2">
                <span class="callout-icon">üî•</span>
                <div class="callout-content">
                    <strong><code>closest()</code> is your best friend in delegation!</strong>
                    <p>When users click an icon <code>&lt;span&gt;</code> inside a button, <code>e.target</code> is the icon, not the button. Use <code>e.target.closest('.btn')</code> to climb up to the button you care about.</p>
                </div>
            </div>
        </div>

        <div class="inner-tab-content" id="del-data">
            <div class="code-block">
                <pre><code><span class="cm">// data-* attributes = clean delegation pattern</span>
<span class="cm">/* HTML:
&lt;ul id="actions"&gt;
  &lt;li data-action="edit"   data-id="1"&gt;Edit&lt;/li&gt;
  &lt;li data-action="delete" data-id="1"&gt;Delete&lt;/li&gt;
  &lt;li data-action="view"   data-id="1"&gt;View&lt;/li&gt;
&lt;/ul&gt;
*/</span>

<span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#actions'</span>)
  .<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
    <span class="kw">const</span> <span class="var">item</span> = <span class="var">e</span>.<span class="prop">target</span>.<span class="fn">closest</span>(<span class="str">'[data-action]'</span>);
    <span class="kw">if</span> (!<span class="var">item</span>) <span class="kw">return</span>;

    <span class="kw">const</span> { <span class="var">action</span>, <span class="var">id</span> } = <span class="var">item</span>.<span class="prop">dataset</span>;

    <span class="cm">// Clean action dispatch!</span>
    <span class="kw">const</span> <span class="var">actions</span> = {
      <span class="prop">edit</span>:   (<span class="var">id</span>) => <span class="fn">editItem</span>(<span class="var">id</span>),
      <span class="prop">delete</span>: (<span class="var">id</span>) => <span class="fn">deleteItem</span>(<span class="var">id</span>),
      <span class="prop">view</span>:   (<span class="var">id</span>) => <span class="fn">viewItem</span>(<span class="var">id</span>),
    };

    <span class="var">actions</span>[<span class="var">action</span>]?.(<span class="var">id</span>);
  });</code></pre>
            </div>
        </div>

        <div class="inner-tab-content" id="del-dynamic">
            <div class="code-block">
                <pre><code><span class="cm">// Dynamic items ‚Äî delegation shines here!</span>
<span class="kw">const</span> <span class="var">list</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#todoList'</span>);

<span class="cm">// One listener set up ONCE</span>
<span class="var">list</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="kw">const</span> <span class="var">item</span> = <span class="var">e</span>.<span class="prop">target</span>.<span class="fn">closest</span>(<span class="str">'.todo-item'</span>);
  <span class="kw">if</span> (!<span class="var">item</span>) <span class="kw">return</span>;

  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="fn">matches</span>(<span class="str">'.delete'</span>)) <span class="var">item</span>.<span class="fn">remove</span>();
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">target</span>.<span class="fn">matches</span>(<span class="str">'.toggle'</span>)) <span class="var">item</span>.<span class="prop">classList</span>.<span class="fn">toggle</span>(<span class="str">'done'</span>);
});

<span class="cm">// Add items dynamically ‚Äî listener already works!</span>
<span class="kw">function</span> <span class="fn">addTodo</span>(<span class="var">text</span>) {
  <span class="kw">const</span> <span class="var">li</span> = <span class="var">document</span>.<span class="fn">createElement</span>(<span class="str">'li'</span>);
  <span class="var">li</span>.<span class="prop">className</span> = <span class="str">'todo-item'</span>;
  <span class="var">li</span>.<span class="prop">innerHTML</span> = <span class="str">`
    &lt;span&gt;${text}&lt;/span&gt;
    &lt;button class="toggle"&gt;‚úì&lt;/button&gt;
    &lt;button class="delete"&gt;‚úó&lt;/button&gt;
  `</span>;
  <span class="var">list</span>.<span class="fn">appendChild</span>(<span class="var">li</span>); <span class="cm">// ‚Üê listener already handles it!</span>
}</code></pre>
            </div>
        </div>
    </div>

    <!-- LIVE TODO APP DEMO -->
    <div class="card">
        <h3>üéÆ Live Demo ‚Äî Dynamic Todo List with Delegation</h3>
        <p class="text-sm text-muted mb-3">This entire app uses ONLY ONE event listener on the <code>ul</code> element:</p>

        <div class="two-col">
            <div>
                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                    <input type="text" id="todoInput" placeholder="Add a todo..." style="flex: 1; background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; font-size: 0.9rem;">
                    <button class="btn btn-primary" onclick="addTodoItem()">+ Add</button>
                </div>
                <ul id="delegationTodoList" class="delegation-list">
                    <li data-id="1">
                        <span>Learn addEventListener</span>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="del-badge" data-action="complete" style="cursor: pointer; border: none; background: rgba(16,185,129,0.2); color: var(--accent-green);">‚úì</button>
                            <button class="del-badge" data-action="delete" style="cursor: pointer; border: none; background: rgba(239,68,68,0.2); color: var(--accent-red);">‚úó</button>
                        </div>
                    </li>
                    <li data-id="2">
                        <span>Master event delegation</span>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="del-badge" data-action="complete" style="cursor: pointer; border: none; background: rgba(16,185,129,0.2); color: var(--accent-green);">‚úì</button>
                            <button class="del-badge" data-action="delete" style="cursor: pointer; border: none; background: rgba(239,68,68,0.2); color: var(--accent-red);">‚úó</button>
                        </div>
                    </li>
                    <li data-id="3">
                        <span>Get the job! üöÄ</span>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="del-badge" data-action="complete" style="cursor: pointer; border: none; background: rgba(16,185,129,0.2); color: var(--accent-green);">‚úì</button>
                            <button class="del-badge" data-action="delete" style="cursor: pointer; border: none; background: rgba(239,68,68,0.2); color: var(--accent-red);">‚úó</button>
                        </div>
                    </li>
                </ul>
            </div>
            <div>
                <div class="code-block" style="height: 100%;">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">The ONE listener powering this</span>
                    </div>
                    <pre><code><span class="cm">// Just THIS listener handles</span>
<span class="cm">// complete, delete, AND future items!</span>

<span class="var">list</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="kw">const</span> <span class="var">btn</span> = <span class="var">e</span>.<span class="prop">target</span>
    .<span class="fn">closest</span>(<span class="str">'[data-action]'</span>);
  
  <span class="kw">if</span> (!<span class="var">btn</span>) <span class="kw">return</span>;

  <span class="kw">const</span> <span class="var">li</span> = <span class="var">btn</span>.<span class="fn">closest</span>(<span class="str">'li'</span>);

  <span class="kw">if</span> (<span class="var">btn</span>.<span class="prop">dataset</span>.<span class="prop">action</span> === <span class="str">'delete'</span>) {
    <span class="var">li</span>.<span class="fn">remove</span>();
  }
  
  <span class="kw">if</span> (<span class="var">btn</span>.<span class="prop">dataset</span>.<span class="prop">action</span> === <span class="str">'complete'</span>) {
    <span class="var">li</span>.<span class="prop">style</span>.<span class="prop">opacity</span> = <span class="str">'0.4'</span>;
    <span class="var">li</span>.<span class="prop">style</span>.<span class="prop">textDecoration</span> 
      = <span class="str">'line-through'</span>;
  }
});

<span class="cm">// Adding new items?</span>
<span class="cm">// The listener already handles them! üéâ</span></code></pre>
                </div>
            </div>
        </div>
        <div class="demo-output mt-2" id="delegationLog">Click complete or delete buttons above. Watch how ONE listener handles everything!</div>
    </div>
</section>

<!-- ============================================
     MISTAKES & PITFALLS SECTION
============================================ -->
<section id="mistakes">
    <div class="section-header">
        <div class="breadcrumb">Pitfalls</div>
        <h2>‚ö†Ô∏è Common Mistakes & Pitfalls</h2>
        <p>Avoid these traps that trip up even experienced developers. Learn them once, avoid them forever.</p>
    </div>

    <!-- MISTAKE 1 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #1: Calling the Function Instead of Passing It</h3>
            <span class="badge badge-red">Most Common</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <p class="text-sm text-muted mb-1">The Bug:</p>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå WRONG ‚Äî executes immediately!</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="fn">handleClick</span>()); 
<span class="cm">//                              ^^^ calling it!</span>

<span class="cm">// What happens:</span>
<span class="cm">// handleClick() runs at page load</span>
<span class="cm">// Its RETURN VALUE becomes the listener</span>
<span class="cm">// (usually undefined ‚Äî does nothing on click)</span>

<span class="cm">// ‚ùå Also wrong with arguments:</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="fn">handleClick</span>(<span class="var">id</span>));</code></pre>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-muted mb-1">The Fix:</p>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ CORRECT ‚Äî pass the reference</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);
<span class="cm">//                              ^^^ no parens!</span>

<span class="cm">// ‚úÖ If you need arguments, wrap it:</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="fn">handleClick</span>(<span class="var">id</span>); <span class="cm">// called WHEN clicked</span>
});

<span class="cm">// ‚úÖ Or use .bind():</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>.<span class="fn">bind</span>(<span class="kw">null</span>, <span class="var">id</span>));</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 2 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #2: Attaching Listeners Before DOM Loads</h3>
            <span class="badge badge-red">Very Common</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå WRONG ‚Äî script in &lt;head&gt;, no defer</span>
<span class="kw">const</span> <span class="var">btn</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#btn'</span>);
<span class="cm">// btn = null! DOM not ready yet!</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handler</span>);
<span class="cm">// TypeError: Cannot read properties of null</span></code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Fix 1: Script at end of body</span>
<span class="cm">// &lt;script src="app.js"&gt;&lt;/script&gt; ‚Üê before &lt;/body&gt;</span>

<span class="cm">// ‚úÖ Fix 2: defer attribute</span>
<span class="cm">// &lt;script src="app.js" defer&gt;&lt;/script&gt;</span>

<span class="cm">// ‚úÖ Fix 3: DOMContentLoaded</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'DOMContentLoaded'</span>, () => {
  <span class="kw">const</span> <span class="var">btn</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#btn'</span>);
  <span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handler</span>);
});</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 3 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #3: Anonymous Functions Can't Be Removed</h3>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå Can't remove this!</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'hi'</span>);
});

<span class="cm">// This does NOTHING ‚Äî different reference!</span>
<span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'hi'</span>);
});

<span class="cm">// The listener stays forever üëª</span></code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Store the reference!</span>
<span class="kw">const</span> <span class="var">handleClick</span> = () => {
  <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'hi'</span>);
};

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// Now you CAN remove it!</span>
<span class="var">btn</span>.<span class="fn">removeEventListener</span>(<span class="str">'click'</span>, <span class="var">handleClick</span>);

<span class="cm">// Or use { once: true } if you only need it once:</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">handler</span>, { <span class="prop">once</span>: <span class="bool">true</span> });</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 4 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #4: Forgetting preventDefault() on Form Submit</h3>
            <span class="badge badge-orange">Page Reload Bug</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå Page reloads on submit!</span>
<span class="var">form</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, (<span class="var">e</span>) => {
  <span class="cm">// No preventDefault() here!</span>
  <span class="fn">handleFormData</span>(<span class="var">e</span>);
  <span class="cm">// Form submits ‚Üí page reloads</span>
  <span class="cm">// Your JS code is interrupted! üíÄ</span>
});</code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Always first line!</span>
<span class="var">form</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// ‚Üê ALWAYS first!</span>

  <span class="cm">// Now safely handle with JS</span>
  <span class="kw">const</span> <span class="var">data</span> = <span class="kw">new</span> <span class="fn">FormData</span>(<span class="var">e</span>.<span class="prop">target</span>);
  <span class="fn">handleFormData</span>(<span class="var">data</span>);
});</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 5 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #5: Using event.keyCode (Deprecated)</h3>
            <span class="badge badge-red">Deprecated</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå DEPRECATED ‚Äî don't use these:</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, (<span class="var">e</span>) => {
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">keyCode</span> === <span class="num">13</span>) { <span class="cm">// Enter ‚Üê bad</span>
    <span class="fn">submit</span>();
  }
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">which</span> === <span class="num">37</span>) { <span class="cm">// ArrowLeft ‚Üê bad</span>
    <span class="fn">moveLeft</span>();
  }
});

<span class="cm">// keypress is also DEPRECATED!</span>
<span class="var">input</span>.<span class="fn">addEventListener</span>(<span class="str">'keypress'</span>, ...);</code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Use e.key (readable strings!)</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, (<span class="var">e</span>) => {
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span> === <span class="str">'Enter'</span>) <span class="fn">submit</span>();
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span> === <span class="str">'ArrowLeft'</span>) <span class="fn">moveLeft</span>();
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span> === <span class="str">'Escape'</span>) <span class="fn">closeModal</span>();
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">key</span> === <span class="str">' '</span>) <span class="fn">pause</span>(); <span class="cm">// Space</span>

  <span class="cm">// Ctrl + S shortcut:</span>
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">ctrlKey</span> && <span class="var">e</span>.<span class="prop">key</span> === <span class="str">'s'</span>) <span class="fn">save</span>();
});
<span class="cm">// Use 'keydown', not 'keypress'!</span></code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 6 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #6: Adding Listeners in Loops Without Considering Scope</h3>
            <span class="badge badge-orange">Classic Trap</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå WRONG ‚Äî var scope issue</span>
<span class="kw">var</span> <span class="var">buttons</span> = <span class="var">document</span>.<span class="fn">querySelectorAll</span>(<span class="str">'button'</span>);

<span class="kw">for</span> (<span class="kw">var</span> <span class="var">i</span> = <span class="num">0</span>; <span class="var">i</span> < <span class="var">buttons</span>.<span class="prop">length</span>; <span class="var">i</span>++) {
  <span class="var">buttons</span>[<span class="var">i</span>].<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
    <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Button '</span> + <span class="var">i</span>);
    <span class="cm">// Always logs last value of i! üíÄ</span>
  });
}
<span class="cm">// Clicks always print "Button 3" (or whatever length is)</span></code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Fix 1: Use let (block scope)</span>
<span class="kw">const</span> <span class="var">buttons</span> = <span class="var">document</span>.<span class="fn">querySelectorAll</span>(<span class="str">'button'</span>);

<span class="kw">for</span> (<span class="kw">let</span> <span class="var">i</span> = <span class="num">0</span>; <span class="var">i</span> < <span class="var">buttons</span>.<span class="prop">length</span>; <span class="var">i</span>++) {
  <span class="var">buttons</span>[<span class="var">i</span>].<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
    <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Button '</span> + <span class="var">i</span>); <span class="cm">// correct! ‚úÖ</span>
  });
}

<span class="cm">// ‚úÖ Fix 2: Use forEach (even cleaner)</span>
<span class="var">buttons</span>.<span class="fn">forEach</span>((<span class="var">btn</span>, <span class="var">i</span>) => {
  <span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
    <span class="var">console</span>.<span class="fn">log</span>(<span class="str">'Button '</span> + <span class="var">i</span>); <span class="cm">// correct! ‚úÖ</span>
  });
});</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MISTAKE 7 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #7: Overusing stopPropagation()</h3>
        </div>
        <div class="mistake-body">
            <div class="code-block">
                <pre><code><span class="cm">// ‚ùå Stopping propagation breaks event delegation!</span>
<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">stopPropagation</span>(); <span class="cm">// ‚Üê Seems harmless...</span>
  <span class="fn">doSomething</span>();
});

<span class="cm">// But now, your delegation listener on a parent NEVER fires!</span>
<span class="cm">// Analytics tracking on document? Gone.</span>
<span class="cm">// Click-outside-to-close modal? Broken.</span>
<span class="cm">// Third-party libraries listening on document? Stopped.</span>

<span class="cm">// ‚úÖ Better: Check target instead of stopping propagation</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  <span class="kw">if</span> (!<span class="var">modal</span>.<span class="fn">contains</span>(<span class="var">e</span>.<span class="prop">target</span>)) {
    <span class="fn">closeModal</span>(); <span class="cm">// click outside = close</span>
  }
});</code></pre>
            </div>
        </div>
    </div>

    <!-- MISTAKE 8 -->
    <div class="mistake-card">
        <div class="mistake-header">
            <span style="font-size: 1.5rem">‚ùå</span>
            <h3>Mistake #8: Event Listener Memory Leaks</h3>
            <span class="badge badge-red">Performance Killer</span>
        </div>
        <div class="mistake-body">
            <div class="two-col">
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚ùå Opening modal ‚Äî adds listener</span>
<span class="kw">function</span> <span class="fn">openModal</span>() {
  <span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, <span class="fn">handleEsc</span>);
}

<span class="cm">// ‚ùå If closeModal never removes it...</span>
<span class="kw">function</span> <span class="fn">closeModal</span>() {
  <span class="cm">// Missing: removeEventListener!</span>
}

<span class="cm">// Open/close modal 100 times ‚Üí</span>
<span class="cm">// 100 keydown listeners on document! üíÄ</span></code></pre>
                    </div>
                </div>
                <div>
                    <div class="code-block">
                        <pre><code><span class="cm">// ‚úÖ Always clean up!</span>
<span class="kw">function</span> <span class="fn">openModal</span>() {
  <span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, <span class="fn">handleEsc</span>);
}

<span class="kw">function</span> <span class="fn">closeModal</span>() {
  <span class="cm">// Remove when done!</span>
  <span class="var">document</span>.<span class="fn">removeEventListener</span>(<span class="str">'keydown'</span>, <span class="fn">handleEsc</span>);
}

<span class="cm">// ‚úÖ Or use { once: true } if one-shot</span>
<span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, <span class="fn">handleEsc</span>, { <span class="prop">once</span>: <span class="bool">true</span> });</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     PRACTICE SECTION
============================================ -->
<section id="practice">
    <div class="section-header">
        <div class="breadcrumb">Hands-on</div>
        <h2>üèãÔ∏è Practice Exercises</h2>
        <p>Build real things. Read the challenges, study the hints, then write your solution in the editor.</p>
    </div>

    <div class="exercise-container">

        <!-- EXERCISE 1 -->
        <div class="exercise-card">
            <div class="exercise-header">
                <div>
                    <h3>Exercise 1: Click Counter with Multiple Events</h3>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <span class="badge badge-green">Beginner</span>
                        <span class="badge badge-cyan">addEventListener</span>
                    </div>
                </div>
            </div>
            <div class="exercise-body">
                <p><strong>Task:</strong> Create a button that tracks left clicks, right clicks, and double clicks separately. Display counts for each type. Add a reset that clears all counts.</p>

                <div class="callout tip mb-2">
                    <span class="callout-icon">üí°</span>
                    <div class="callout-content">
                        <strong>Hints:</strong>
                        <p>Use 'click' for left clicks, 'contextmenu' + preventDefault() for right clicks, 'dblclick' for double clicks. Note: a dblclick also fires two click events!</p>
                    </div>
                </div>

                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">Solution</span>
                    </div>
                    <pre><code><span class="kw">const</span> <span class="var">btn</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#clickBtn'</span>);
<span class="kw">let</span> <span class="var">counts</span> = { <span class="prop">left</span>: <span class="num">0</span>, <span class="prop">right</span>: <span class="num">0</span>, <span class="prop">double</span>: <span class="num">0</span> };

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, () => {
  <span class="var">counts</span>.<span class="prop">left</span>++;
  <span class="fn">updateDisplay</span>();
});

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'contextmenu'</span>, (<span class="var">e</span>) => {
  <span class="var">e</span>.<span class="fn">preventDefault</span>(); <span class="cm">// Stop browser menu</span>
  <span class="var">counts</span>.<span class="prop">right</span>++;
  <span class="fn">updateDisplay</span>();
});

<span class="var">btn</span>.<span class="fn">addEventListener</span>(<span class="str">'dblclick'</span>, () => {
  <span class="var">counts</span>.<span class="prop">double</span>++;
  <span class="fn">updateDisplay</span>();
});

<span class="kw">function</span> <span class="fn">updateDisplay</span>() {
  <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#left-count'</span>).<span class="prop">textContent</span> = <span class="var">counts</span>.<span class="prop">left</span>;
  <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#right-count'</span>).<span class="prop">textContent</span> = <span class="var">counts</span>.<span class="prop">right</span>;
  <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#double-count'</span>).<span class="prop">textContent</span> = <span class="var">counts</span>.<span class="prop">double</span>;
}</code></pre>
                </div>

                <!-- Live Exercise 1 -->
                <div style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                    <p class="text-sm text-muted mb-2">Try it live:</p>
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 1rem;">
                        <button id="ex1Btn" class="btn btn-primary" style="font-size: 1.1rem; padding: 1rem 2.5rem;">
                            üñ±Ô∏è Click, Right-click, or Double-click me!
                        </button>
                        <div style="display: flex; gap: 2rem;">
                            <div style="text-align: center;">
                                <div id="ex1Left" style="font-size: 2.5rem; font-weight: 900; color: var(--accent-cyan);">0</div>
                                <div class="text-sm text-muted">Left Clicks</div>
                            </div>
                            <div style="text-align: center;">
                                <div id="ex1Right" style="font-size: 2.5rem; font-weight: 900; color: var(--accent-red);">0</div>
                                <div class="text-sm text-muted">Right Clicks</div>
                            </div>
                            <div style="text-align: center;">
                                <div id="ex1Double" style="font-size: 2.5rem; font-weight: 900; color: var(--accent-green);">0</div>
                                <div class="text-sm text-muted">Double Clicks</div>
                            </div>
                        </div>
                        <button class="btn btn-secondary text-sm" onclick="resetEx1()">Reset Counts</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXERCISE 2 -->
        <div class="exercise-card">
            <div class="exercise-header">
                <div>
                    <h3>Exercise 2: Live Search with Debouncing</h3>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <span class="badge badge-orange">Intermediate</span>
                        <span class="badge badge-cyan">input event + setTimeout</span>
                    </div>
                </div>
            </div>
            <div class="exercise-body">
                <p><strong>Task:</strong> Create a search input that filters a list of items in real-time, but debounces the search by 300ms to avoid searching on every keypress.</p>

                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">Solution ‚Äî Debounced Live Search</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="kw">const</span> <span class="var">searchInput</span> = <span class="var">document</span>.<span class="fn">querySelector</span>(<span class="str">'#search'</span>);
<span class="kw">const</span> <span class="var">items</span> = [<span class="str">'JavaScript'</span>, <span class="str">'TypeScript'</span>, <span class="str">'React'</span>, <span class="str">'Vue'</span>, <span class="str">'Angular'</span>];
<span class="kw">let</span> <span class="var">debounceTimer</span>;

<span class="var">searchInput</span>.<span class="fn">addEventListener</span>(<span class="str">'input'</span>, (<span class="var">e</span>) => {
  <span class="cm">// Clear previous timer</span>
  <span class="fn">clearTimeout</span>(<span class="var">debounceTimer</span>);

  <span class="cm">// Set new timer ‚Äî only search after 300ms of no typing</span>
  <span class="var">debounceTimer</span> = <span class="fn">setTimeout</span>(() => {
    <span class="kw">const</span> <span class="var">query</span> = <span class="var">e</span>.<span class="prop">target</span>.<span class="prop">value</span>.<span class="fn">toLowerCase</span>();
    <span class="kw">const</span> <span class="var">results</span> = <span class="var">items</span>.<span class="fn">filter</span>(<span class="var">item</span> =>
      <span class="var">item</span>.<span class="fn">toLowerCase</span>().<span class="fn">includes</span>(<span class="var">query</span>)
    );
    <span class="fn">displayResults</span>(<span class="var">results</span>);
  }, <span class="num">300</span>);
});</code></pre>
                </div>

                <!-- Live Exercise 2 -->
                <div style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                    <input type="text" id="ex2Search" placeholder="üîç Search frameworks..." style="width: 100%; background: var(--bg-card); border: 2px solid var(--accent-purple); border-radius: 8px; padding: 0.75rem 1rem; color: var(--text-primary); font-size: 1rem; outline: none; margin-bottom: 1rem;">
                    <div id="ex2Results" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 0.5rem;"></div>
                    <div id="ex2Status" class="text-sm text-muted mt-1"></div>
                </div>
            </div>
        </div>

        <!-- EXERCISE 3 -->
        <div class="exercise-card">
            <div class="exercise-header">
                <div>
                    <h3>Exercise 3: Keyboard Shortcuts Manager</h3>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <span class="badge badge-orange">Intermediate</span>
                        <span class="badge badge-cyan">keydown + Modifiers</span>
                    </div>
                </div>
            </div>
            <div class="exercise-body">
                <p><strong>Task:</strong> Implement keyboard shortcuts ‚Äî Ctrl+S to "save", Ctrl+Z to "undo", Escape to "cancel", and arrow keys to "navigate". Log what happens.</p>

                <div class="code-block">
                    <div class="code-header">
                        <div class="dots"><span class="dot-red"></span><span class="dot-yellow"></span><span class="dot-green"></span></div>
                        <span class="code-label">Solution</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="var">document</span>.<span class="fn">addEventListener</span>(<span class="str">'keydown'</span>, (<span class="var">e</span>) => {
  <span class="kw">const</span> <span class="var">shortcuts</span> = {
    <span class="str">'ctrl+s'</span>: <span class="str">'üíæ Document Saved!'</span>,
    <span class="str">'ctrl+z'</span>: <span class="str">'‚Ü© Undo!'</span>,
    <span class="str">'ctrl+shift+z'</span>: <span class="str">'‚Ü™ Redo!'</span>,
    <span class="str">'escape'</span>: <span class="str">'‚ùå Cancelled!'</span>,
    <span class="str">'arrowup'</span>: <span class="str">'‚¨Ü Move Up'</span>,
    <span class="str">'arrowdown'</span>: <span class="str">'‚¨á Move Down'</span>,
  };

  <span class="cm">// Build a key string from the event</span>
  <span class="kw">const</span> <span class="var">parts</span> = [];
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">ctrlKey</span>) <span class="var">parts</span>.<span class="fn">push</span>(<span class="str">'ctrl'</span>);
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">shiftKey</span>) <span class="var">parts</span>.<span class="fn">push</span>(<span class="str">'shift'</span>);
  <span class="kw">if</span> (<span class="var">e</span>.<span class="prop">altKey</span>) <span class="var">parts</span>.<span class="fn">push</span>(<span class="str">'alt'</span>);
  <span class="var">parts</span>.<span class="fn">push</span>(<span class="var">e</span>.<span class="prop">key</span>.<span class="fn">toLowerCase</span>());

  <span class="kw">const</span> <span class="var">combo</span> = <span class="var">parts</span>.<span class="fn">join</span>(<span class="str">'+'</span>);

  <span class="kw">if</span> (<span class="var">shortcuts</span>[<span class="var">combo</span>]) {
    <span class="var">e</span>.<span class="fn">preventDefault</span>();
    <span class="fn">showMessage</span>(<span class="var">shortcuts</span>[<span class="var">combo</span>]);
  }
});</code></pre>
                </div>

                <!-- Live Exercise 3 -->
                <div style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                    <div id="ex3Area" tabindex="0" style="background: var(--bg-primary); border: 2px dashed var(--border); border-radius: 10px; padding: 2rem; text-align: center; outline: none; cursor: pointer; min-height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 0.5rem;" onclick="this.focus()">
                        <span style="font-size: 2rem">‚å®Ô∏è</span>
                        <span class="text-sm text-muted">Click here first, then try keyboard shortcuts:</span>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; margin-top: 0.5rem;">
                            <span class="badge badge-purple">Ctrl+S</span>
                            <span class="badge badge-purple">Ctrl+Z</span>
                            <span class="badge badge-purple">Ctrl+Shift+Z</span>
                            <span class="badge badge-purple">Escape</span>
                            <span class="badge badge-purple">Arrow Keys</span>
                        </div>
                    </div>
                    <div id="ex3Output" class="demo-output mt-2">Focus the box above and press shortcuts...</div>
                </div>
            </div>
        </div>

        <!-- EXERCISE 4 -->
        <div class="exercise-card">
            <div class="exercise-header">
                <div>
                    <h3>Exercise 4: Form Validation with Real-time Feedback</h3>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <span class="badge badge-red">Advanced</span>
                        <span class="badge badge-cyan">input + submit + blur</span>
                    </div>
                </div>
            </div>
            <div class="exercise-body">
                <p><strong>Task:</strong> A form with real-time validation. Email validates on input, password shows strength indicator, form prevents submit if invalid.</p>

                <!-- Live Exercise 4 -->
                <div style="background: var(--code-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-top: 1rem;">
                    <form id="ex4Form" style="display: flex; flex-direction: column; gap: 1rem;">
                        <div>
                            <label style="font-size: 0.85rem; color: var(--text-secondary); display: block; margin-bottom: 0.4rem;">Email Address</label>
                            <input type="text" id="ex4Email" placeholder="enter@email.com" style="width: 100%; background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; font-size: 0.9rem; transition: border-color 0.2s;">
                            <div id="ex4EmailMsg" style="font-size: 0.8rem; margin-top: 0.3rem; height: 1rem;"></div>
                        </div>
                        <div>
                            <label style="font-size: 0.85rem; color: var(--text-secondary); display: block; margin-bottom: 0.4rem;">Password</label>
                            <input type="password" id="ex4Password" placeholder="Enter password" style="width: 100%; background: var(--bg-card); border: 2px solid var(--border); border-radius: 8px; padding: 0.65rem; color: var(--text-primary); outline: none; font-size: 0.9rem; transition: border-color 0.2s;">
                            <div id="ex4PasswordStrength" style="height: 6px; background: var(--border); border-radius: 3px; margin-top: 0.5rem; overflow: hidden;"><div id="ex4StrengthBar" style="height: 100%; width: 0; transition: all 0.3s; border-radius: 3px;"></div></div>
                            <div id="ex4PasswordMsg" style="font-size: 0.8rem; margin-top: 0.3rem; height: 1rem;"></div>
                        </div>
                        <button type="submit" class="btn btn-primary">Create Account</button>
                        <div id="ex4Result" class="demo-output" style="min-height: 40px; display: none;"></div>
                    </form>
                </div>
            </div>
        </div>

    </div>
</section>

<!-- ============================================
     QUIZ SECTION
============================================ -->
<section id="quiz">
    <div class="section-header">
        <div class="breadcrumb">Assessment</div>
        <h2>üß† Knowledge Quiz</h2>
        <p>15 questions across all topics. Test yourself before the real interview!</p>
    </div>

    <div class="quiz-container">
        <div class="quiz-progress">
            <div class="progress-bar">
                <div class="progress-fill" id="quizProgress" style="width: 0%"></div>
            </div>
            <span class="quiz-score" id="quizScoreDisplay">Score: 0/0</span>
        </div>

        <div id="quizArea"></div>

        <div id="quizResults" class="hidden">
            <div class="score-display">
                <div class="score-circle" id="finalScoreCircle">0%</div>
                <h2 id="finalScoreTitle" style="margin-bottom: 0.5rem;"></h2>
                <p id="finalScoreMsg" style="color: var(--text-secondary);" class="mb-3"></p>
                <div id="topicBreakdown" style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-bottom: 1.5rem;"></div>
                <button class="btn btn-primary" onclick="restartQuiz()">üîÑ Retake Quiz</button>
            </div>
        </div>
    </div>
</section>

<!-- ============================================
     CHEATSHEET SECTION
============================================ -->
<section id="cheatsheet">
    <div class="section-header">
        <div class="breadcrumb">Reference</div>
        <h2>üìã Quick Cheatsheet</h2>
        <p>Everything you need in one place. Bookmark this section.</p>
    </div>

    <div class="card">
        <h3>üîß addEventListener API</h3>
        <table class="cheat-table">
            <thead>
                <tr>
                    <th>Method/Property</th>
                    <th>Description</th>
                    <th>Example</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>addEventListener(type, fn)</td>
                    <td>Attach an event listener</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">el.addEventListener('click', fn)</code></td>
                </tr>
                <tr>
                    <td>removeEventListener(type, fn)</td>
                    <td>Remove a named listener</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">el.removeEventListener('click', fn)</code></td>
                </tr>
                <tr>
                    <td>{ once: true }</td>
                    <td>Auto-remove after first fire</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">el.addEventListener('click', fn, {once: true})</code></td>
                </tr>
                <tr>
                    <td>{ capture: true }</td>
                    <td>Listen during capture phase</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">el.addEventListener('click', fn, {capture: true})</code></td>
                </tr>
                <tr>
                    <td>{ passive: true }</td>
                    <td>Won't call preventDefault (perf)</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">el.addEventListener('scroll', fn, {passive: true})</code></td>
                </tr>
                <tr>
                    <td>AbortController</td>
                    <td>Remove multiple listeners at once</td>
                    <td><code style="color:var(--accent-green);font-size:0.8rem">controller.abort()</code></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="card">
        <h3>üîç Event Object Methods</h3>
        <table class="cheat-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>What it does</th>
                    <th>Common use</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>e.preventDefault()</td>
                    <td>Stop default browser behavior</td>
                    <td>Forms, links, right-click</td>
                </tr>
                <tr>
                    <td>e.stopPropagation()</td>
                    <td>Stop bubbling/capturing</td>
                    <td>Prevent parent handlers</td>
                </tr>
                <tr>
                    <td>e.stopImmediatePropagation()</td>
                    <td>Stop all listeners on same element + propagation</td>
                    <td>Nuclear option</td>
                </tr>
                <tr>
                    <td>e.target</td>
                    <td>Element that triggered event</td>
                    <td>Event delegation</td>
                </tr>
                <tr>
                    <td>e.currentTarget</td>
                    <td>Element with the listener</td>
                    <td>Inside delegation handlers</td>
                </tr>
                <tr>
                    <td>e.target.closest(selector)</td>
                    <td>Climb up DOM to find ancestor</td>
                    <td>Delegation with nested HTML</td>
                </tr>
                <tr>
                    <td>e.target.matches(selector)</td>
                    <td>Check if target matches CSS selector</td>
                    <td>Delegation filtering</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="two-col">
        <div class="card">
            <h3>üéØ Must-Know Event Types</h3>
            <table class="cheat-table">
                <thead>
                    <tr><th>Event</th><th>When it fires</th></tr>
                </thead>
                <tbody>
                    <tr><td>click</td><td>Mouse left-click released</td></tr>
                    <tr><td>dblclick</td><td>Two rapid clicks</td></tr>
                    <tr><td>contextmenu</td><td>Right-click</td></tr>
                    <tr><td>input</td><td>Every keystroke in input</td></tr>
                    <tr><td>change</td><td>Input loses focus with new value</td></tr>
                    <tr><td>submit</td><td>Form submit</td></tr>
                    <tr><td>focus/blur</td><td>Element gains/loses focus</td></tr>
                    <tr><td>keydown</td><td>Key pressed (use this!)</td></tr>
                    <tr><td>keyup</td><td>Key released</td></tr>
                    <tr><td>mouseover/out</td><td>Enter/leave (incl. children)</td></tr>
                    <tr><td>mouseenter/leave</td><td>Enter/leave (no children)</td></tr>
                    <tr><td>scroll</td><td>Element or window scrolled</td></tr>
                    <tr><td>resize</td><td>Window resized</td></tr>
                    <tr><td>DOMContentLoaded</td><td>HTML parsed, DOM ready</td></tr>
                    <tr><td>load</td><td>All resources loaded</td></tr>
                </tbody>
            </table>
        </div>
        <div class="card">
            <h3>‚úÖ Event Delegation Pattern</h3>
            <div class="code-block">
                <pre><code><span class="cm">// THE universal delegation pattern</span>
<span class="var">parent</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, (<span class="var">e</span>) => {
  
  <span class="cm">// Find closest matching element</span>
  <span class="kw">const</span> <span class="var">target</span> = <span class="var">e</span>.<span class="prop">target</span>
    .<span class="fn">closest</span>(<span class="str">'[data-action]'</span>);
  
  <span class="cm">// Guard clause</span>
  <span class="kw">if</span> (!<span class="var">target</span>) <span class="kw">return</span>;
  
  <span class="cm">// Get data and act</span>
  <span class="kw">const</span> { <span class="var">action</span>, <span class="var">id</span> } = <span class="var">target</span>.<span class="prop">dataset</span>;
  <span class="var">handlers</span>[<span class="var">action</span>]?.(<span class="var">id</span>);
});</code></pre>
            </div>
            <div class="code-block mt-2">
                <pre><code><span class="cm">// Remove multiple listeners cleanly</span>
<span class="kw">const</span> <span class="var">ac</span> = <span class="kw">new</span> <span class="fn">AbortController</span>();
<span class="kw">const</span> <span class="var">opts</span> = { <span class="prop">signal</span>: <span class="var">ac</span>.<span class="prop">signal</span> };

<span class="var">a</span>.<span class="fn">addEventListener</span>(<span class="str">'click'</span>, <span class="var">fnA</span>, <span class="var">opts</span>);
<span class="var">b</span>.<span class="fn">addEventListener</span>(<span class="str">'input'</span>, <span class="var">fnB</span>, <span class="var">opts</span>);
<span class="var">c</span>.<span class="fn">addEventListener</span>(<span class="str">'submit'</span>, <span class="var">fnC</span>, <span class="var">opts</span>);

<span class="cm">// Clean up ALL at once:</span>
<span class="var">ac</span>.<span class="fn">abort</span>(); <span class="cm">// ‚Üê One call does it all!</span></code></pre>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>üö´ Golden Rules</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;">
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Always use <code>addEventListener</code> over inline HTML or DOM properties</p></div>
            </div>
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Call <code>e.preventDefault()</code> as the FIRST line in submit handlers</p></div>
            </div>
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Use <code>e.key</code> for keyboard events, never <code>e.keyCode</code></p></div>
            </div>
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Store handler references if you need to remove them later</p></div>
            </div>
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Use event delegation for lists, tables, and dynamic content</p></div>
            </div>
            <div class="callout success">
                <span class="callout-icon">‚úÖ</span>
                <div class="callout-content"><p>Use <code>e.target.closest()</code> in delegation to handle nested children</p></div>
            </div>
            <div class="callout danger">
                <span class="callout-icon">‚ùå</span>
                <div class="callout-content"><p>Never call the handler when passing it: <code>fn()</code> ‚Üê wrong, <code>fn</code> ‚Üê right</p></div>
            </div>
            <div class="callout danger">
                <span class="callout-icon">‚ùå</span>
                <div class="callout-content"><p>Don't use <code>stopPropagation()</code> unless absolutely necessary</p></div>
            </div>
        </div>
    </div>
</section>

</main>

<script>
// ============================================
// NAVIGATION
// ============================================
function showSection(id) {
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.nav-tabs a').forEach(a => a.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.getElementById('tab-' + id).classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function switchInnerTab(btn, targetId) {
    const container = btn.closest('.card') || btn.closest('.playground-body') || btn.parentElement;
    container.querySelectorAll('.inner-tab').forEach(t => t.classList.remove('active'));
    container.querySelectorAll('.inner-tab-content').forEach(c => c.classList.remove('active'));
    btn.classList.add('active');
    const target = document.getElementById(targetId);
    if (target) target.classList.add('active');
}

// Reading progress
window.addEventListener('scroll', () => {
    const scrollTop = window.scrollY;
    const docHeight = document.body.scrollHeight - window.innerHeight;
    const progress = (scrollTop / docHeight) * 100;
    document.getElementById('readingProgress').style.width = progress + '%';
});

// ============================================
// COPY CODE
// ============================================
function copyCode(btn) {
    const pre = btn.closest('.code-block').querySelector('pre');
    const text = pre.innerText;
    navigator.clipboard.writeText(text).then(() => {
        btn.textContent = '‚úì Copied!';
        btn.style.background = 'var(--accent-green)';
        btn.style.borderColor = 'var(--accent-green)';
        btn.style.color = 'white';
        setTimeout(() => {
            btn.textContent = 'Copy';
            btn.style.background = '';
            btn.style.borderColor = '';
            btn.style.color = '';
        }, 2000);
    });
}

// ============================================
// EVENT PLAYGROUND (addEventListener section)
// ============================================
let logCount = 0;
let useCapture = false;

function addLog(type, msg, color = 'var(--accent-green)') {
    const log = document.getElementById('eventLog');
    const time = new Date().toLocaleTimeString('en', {hour12: false});
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.innerHTML = `
        <span class="log-time">${time}</span>
        <span class="log-type" style="color:${color}">${type}</span>
        <span class="log-msg">${msg}</span>
    `;
    log.appendChild(entry);
    log.scrollTop = log.scrollHeight;
    logCount++;
    document.getElementById('logCount').textContent = `${logCount} events`;
}

function clearEventLog() {
    document.getElementById('eventLog').innerHTML = '';
    logCount = 0;
    document.getElementById('logCount').textContent = '0 events';
}

function toggleCapture() {
    useCapture = !useCapture;
    document.getElementById('captureStatus').textContent = useCapture ? 'ON' : 'OFF';
}

const targetBox = document.getElementById('event-target-box');
targetBox.addEventListener('click', (e) => {
    addLog('CLICK', `clientX:${e.clientX}, clientY:${e.clientY}, shift:${e.shiftKey}`, 'var(--accent-cyan)');
    createRipple(e, targetBox);
});
targetBox.addEventListener('mouseenter', () => addLog('MOUSEENTER', 'Mouse entered box', 'var(--accent-green)'));
targetBox.addEventListener('mouseleave', () => addLog('MOUSELEAVE', 'Mouse left box', 'var(--accent-orange)'));
targetBox.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    addLog('CONTEXTMENU', 'Right-click detected!', 'var(--accent-pink)');
});
targetBox.addEventListener('dblclick', () => addLog('DBLCLICK', 'Double click!', 'var(--accent-purple)'));

function createRipple(e, el) {
    const rect = el.getBoundingClientRect();
    const ripple = document.createElement('div');
    ripple.className = 'ripple';
    ripple.style.left = (e.clientX - rect.left) + 'px';
    ripple.style.top = (e.clientY - rect.top) + 'px';
    ripple.style.background = 'rgba(124, 58, 237, 0.4)';
    el.style.position = 'relative';
    el.appendChild(ripple);
    setTimeout(() => ripple.remove(), 700);
}

// ============================================
// TARGET vs CURRENTTARGET DEMO
// ============================================
document.getElementById('target-demo-parent').addEventListener('click', (e) => {
    const output = document.getElementById('targetOutput');
    output.textContent = `e.target = ${e.target.tagName}${e.target.id ? '#'+e.target.id : ''}
e.currentTarget = ${e.currentTarget.tagName}${e.currentTarget.id ? '#'+e.currentTarget.id : ''}
Same? ${e.target === e.currentTarget}`;
    const isChild = e.target.id === 'target-demo-child';
    output.style.color = isChild ? 'var(--accent-orange)' : 'var(--accent-green)';
});

// ============================================
// EVENT PROPAGATION DEMO
// ============================================
function addPropLog(msg, phase) {
    const log = document.getElementById('propLog');
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.innerHTML = `<span class="log-msg">${msg}</span> <span class="prop-phase phase-${phase}">${phase}</span>`;
    log.appendChild(entry);
    log.scrollTop = log.scrollHeight;
}

function animatePropagation() {
    const propLog = document.getElementById('propLog');
    propLog.innerHTML = '';
    const stopAtDiv = document.getElementById('stopBubble').checked;

    const elements = [
        { id: 'prop-btn', name: 'button#target', phase: 'target', delay: 0 },
        { id: 'prop-div', name: 'div#container', phase: 'bubble', delay: 400 },
        { id: 'prop-body', name: 'body', phase: 'bubble', delay: 800 },
        { id: 'prop-document', name: 'document', phase: 'bubble', delay: 1200 },
        { id: 'prop-window', name: 'window', phase: 'bubble', delay: 1600 },
    ];

    elements.forEach((el, index) => {
        if (stopAtDiv && index > 1) return; // Stop after div

        setTimeout(() => {
            const domEl = document.getElementById(el.id);
            domEl.classList.add('pulse');
            setTimeout(() => domEl.classList.remove('pulse'), 600);

            const stopped = stopAtDiv && index === 1;
            addPropLog(`üìç ${el.name}`, el.phase);
            if (stopped) {
                const entry = document.createElement('div');
                entry.className = 'log-entry';
                entry.innerHTML = `<span class="log-msg" style="color:var(--accent-red)">‚õî stopPropagation() ‚Äî bubbling stopped here!</span>`;
                propLog.appendChild(entry);
                propLog.scrollTop = propLog.scrollHeight;
            }
        }, el.delay);
    });
}

// ============================================
// CLICK EVENT DEMO
// ============================================
const clickTestBtn = document.getElementById('clickTestBtn');
clickTestBtn.addEventListener('click', (e) => {
    const output = document.getElementById('clickOutput');
    const modifiers = [];
    if (e.shiftKey) modifiers.push('Shift');
    if (e.ctrlKey) modifiers.push('Ctrl');
    if (e.altKey) modifiers.push('Alt');
    if (e.metaKey) modifiers.push('Meta');
    output.textContent = `Event Type: ${e.type}
Button: ${e.button} (0=left, 1=mid, 2=right)
Position: (${e.clientX}, ${e.clientY}) in viewport
Modifiers held: ${modifiers.length ? modifiers.join('+') : 'none'}
Click count: ${e.detail}
isTrusted: ${e.isTrusted}`;
});

clickTestBtn.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    const output = document.getElementById('clickOutput');
    output.textContent = `Right-click detected!
Event: contextmenu
Position: (${e.clientX}, ${e.clientY})
Button: ${e.button} (2 = right mouse button)`;
});

// ============================================
// INPUT EVENT DEMO
// ============================================
const inputDemo = document.getElementById('inputDemo');
inputDemo.addEventListener('focus', () => { inputDemo.style.borderColor = 'var(--accent-purple)'; });
inputDemo.addEventListener('blur', () => { inputDemo.style.borderColor = 'var(--border)'; });

inputDemo.addEventListener('input', (e) => {
    const val = e.target.value;
    document.getElementById('charCount').textContent = val.length;
    document.getElementById('wordCount').textContent = val.trim() ? val.trim().split(/\s+/).length : 0;
    document.getElementById('lastKey').textContent = e.data || '(delete)';
    document.getElementById('inputOutput').textContent = `input event fired!
e.data = "${e.data}"
e.inputType = "${e.inputType}"
e.target.value = "${val}"`;
});

inputDemo.addEventListener('keydown', (e) => {
    document.getElementById('lastKey').textContent = e.key;
});

// ============================================
// SUBMIT DEMO
// ============================================
document.getElementById('submitDemo').addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const data = Object.fromEntries(formData);
    const output = document.getElementById('submitOutput');
    output.textContent = `‚úÖ Form submitted (no page reload!)
FormData:
  name: "${data.name || '(empty)'}"
  email: "${data.email || '(empty)'}"
  role: "${data.role || '(not selected)'}"

e.preventDefault() blocked the default form submission!`;
});

// ============================================
// KEYBOARD DEMO
// ============================================
document.getElementById('keyboardDemo').addEventListener('keydown', (e) => {
    const output = document.getElementById('keyOutput');
    const modifiers = [];
    if (e.ctrlKey) modifiers.push('Ctrl');
    if (e.shiftKey) modifiers.push('Shift');
    if (e.altKey) modifiers.push('Alt');
    output.textContent = `keydown event!
e.key = "${e.key}"
e.code = "${e.code}"
Modifiers: ${modifiers.join(' + ') || 'none'}
e.repeat = ${e.repeat}`;
});

// ============================================
// DELEGATION TODO LIST
// ============================================
let todoId = 10;

document.getElementById('delegationTodoList').addEventListener('click', (e) => {
    const btn = e.target.closest('[data-action]');
    if (!btn) return;

    const li = btn.closest('li');
    const action = btn.dataset.action;
    const log = document.getElementById('delegationLog');

    if (action === 'delete') {
        li.style.transform = 'translateX(20px)';
        li.style.opacity = '0';
        li.style.transition = 'all 0.3s';
        setTimeout(() => li.remove(), 300);
        log.textContent = `üóëÔ∏è Item deleted using delegation! (ONE listener handled this)`;
    }
    if (action === 'complete') {
        li.style.opacity = li.style.opacity === '0.4' ? '1' : '0.4';
        li.style.textDecoration = li.style.textDecoration === 'line-through' ? '' : 'line-through';
        log.textContent = `‚úÖ Item toggled! e.target.closest('[data-action]') found the button even through nested elements.`;
    }
});

function addTodoItem() {
    const input = document.getElementById('todoInput');
    const text = input.value.trim();
    if (!text) return;

    const li = document.createElement('li');
    li.dataset.id = ++todoId;
    li.style.animation = 'fadeIn 0.3s ease';
    li.innerHTML = `
        <span>${text}</span>
        <div style="display: flex; gap: 0.5rem;">
            <button class="del-badge" data-action="complete" style="cursor: pointer; border: none; background: rgba(16,185,129,0.2); color: var(--accent-green);">‚úì</button>
            <button class="del-badge" data-action="delete" style="cursor: pointer; border: none; background: rgba(239,68,68,0.2); color: var(--accent-red);">‚úó</button>
        </div>
    `;
    document.getElementById('delegationTodoList').appendChild(li);
    input.value = '';
    document.getElementById('delegationLog').textContent = `‚ú® New item added! The existing delegation listener ALREADY handles it ‚Äî no new listeners needed!`;
}

document.getElementById('todoInput').addEventListener('keydown', (e) => {
    if (e.key === 'Enter') addTodoItem();
});

// ============================================
// EXERCISE 1 ‚Äî Click Counter
// ============================================
let ex1Counts = { left: 0, right: 0, double: 0 };
let ex1DoubleFlag = false;

const ex1Btn = document.getElementById('ex1Btn');

ex1Btn.addEventListener('dblclick', () => {
    ex1Counts.double++;
    ex1DoubleFlag = true;
    updateEx1();
});

ex1Btn.addEventListener('click', () => {
    if (!ex1DoubleFlag) {
        ex1Counts.left++;
        updateEx1();
    }
    ex1DoubleFlag = false;
});

ex1Btn.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    ex1Counts.right++;
    updateEx1();
});

function updateEx1() {
    document.getElementById('ex1Left').textContent = ex1Counts.left;
    document.getElementById('ex1Right').textContent = ex1Counts.right;
    document.getElementById('ex1Double').textContent = ex1Counts.double;
}

function resetEx1() {
    ex1Counts = { left: 0, right: 0, double: 0 };
    updateEx1();
}

// ============================================
// EXERCISE 2 ‚Äî Live Search with Debounce
// ============================================
const frameworks = [
    'JavaScript', 'TypeScript', 'React', 'Vue', 'Angular',
    'Svelte', 'Next.js', 'Nuxt.js', 'Express', 'Node.js',
    'Tailwind CSS', 'Bootstrap', 'Vite', 'Webpack', 'Jest',
    'GraphQL', 'REST API', 'MongoDB', 'PostgreSQL', 'Redis'
];

function renderEx2Results(items) {
    const container = document.getElementById('ex2Results');
    container.innerHTML = items.map(item => `
        <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; padding: 0.65rem 1rem; font-size: 0.85rem; font-weight: 600; color: var(--text-primary);">
            ${item}
        </div>
    `).join('');
}

renderEx2Results(frameworks);

let ex2Timer;
document.getElementById('ex2Search').addEventListener('input', (e) => {
    const status = document.getElementById('ex2Status');
    status.textContent = '‚è≥ Debouncing... (300ms)';
    clearTimeout(ex2Timer);
    ex2Timer = setTimeout(() => {
        const query = e.target.value.toLowerCase();
        const results = frameworks.filter(f => f.toLowerCase().includes(query));
        renderEx2Results(results);
        status.textContent = `‚úÖ Search fired after debounce! Found ${results.length} results.`;
    }, 300);
});

// ============================================
// EXERCISE 3 ‚Äî Keyboard Shortcuts
// ============================================
const ex3Area = document.getElementById('ex3Area');
ex3Area.addEventListener('keydown', (e) => {
    const parts = [];
    if (e.ctrlKey) parts.push('Ctrl');
    if (e.shiftKey) parts.push('Shift');
    if (e.altKey) parts.push('Alt');
    parts.push(e.key);
    const combo = parts.join('+').toLowerCase();

    const shortcuts = {
        'ctrl+s': 'üíæ Document Saved!',
        'ctrl+z': '‚Ü© Undo action!',
        'ctrl+shift+z': '‚Ü™ Redo action!',
        'escape': '‚ùå Action Cancelled!',
        'arrowup': '‚¨ÜÔ∏è Navigate Up',
        'arrowdown': '‚¨áÔ∏è Navigate Down',
        'arrowleft': '‚¨ÖÔ∏è Navigate Left',
        'arrowright': '‚û°Ô∏è Navigate Right',
    };

    const output = document.getElementById('ex3Output');
    if (shortcuts[combo]) {
        e.preventDefault();
        output.textContent = `‚úÖ Shortcut detected: ${parts.join('+')}
Action: ${shortcuts[combo]}
e.key = "${e.key}", ctrlKey=${e.ctrlKey}, shiftKey=${e.shiftKey}`;
        output.style.color = 'var(--accent-green)';
    } else {
        output.textContent = `Key pressed: ${parts.join('+')}
No shortcut mapped for this combination.`;
        output.style.color = 'var(--accent-orange)';
    }
});

// ============================================
// EXERCISE 4 ‚Äî Form Validation
// ============================================
const ex4Email = document.getElementById('ex4Email');
const ex4Password = document.getElementById('ex4Password');
let ex4Valid = { email: false, password: false };

ex4Email.addEventListener('input', (e) => {
    const val = e.target.value;
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const msg = document.getElementById('ex4EmailMsg');

    if (val.length === 0) {
        ex4Email.style.borderColor = 'var(--border)';
        msg.textContent = '';
        ex4Valid.email = false;
    } else if (emailRegex.test(val)) {
        ex4Email.style.borderColor = 'var(--accent-green)';
        msg.textContent = '‚úÖ Valid email!';
        msg.style.color = 'var(--accent-green)';
        ex4Valid.email = true;
    } else {
        ex4Email.style.borderColor = 'var(--accent-red)';
        msg.textContent = '‚ùå Invalid email format';
        msg.style.color = 'var(--accent-red)';
        ex4Valid.email = false;
    }
});

ex4Password.addEventListener('input', (e) => {
    const val = e.target.value;
    const msg = document.getElementById('ex4PasswordMsg');
    const bar = document.getElementById('ex4StrengthBar');

    let strength = 0;
    let label = '';
    let color = '';

    if (val.length >= 8) strength++;
    if (/[A-Z]/.test(val)) strength++;
    if (/[0-9]/.test(val)) strength++;
    if (/[^A-Za-z0-9]/.test(val)) strength++;

    const levels = [
        { label: '', pct: '0%', color: '' },
        { label: 'üòü Weak', pct: '25%', color: 'var(--accent-red)' },
        { label: 'üòê Fair', pct: '50%', color: 'var(--accent-orange)' },
        { label: 'üòä Good', pct: '75%', color: 'var(--accent-cyan)' },
        { label: 'üí™ Strong!', pct: '100%', color: 'var(--accent-green)' },
    ];

    const lvl = val.length === 0 ? levels[0] : levels[Math.max(1, strength)];
    bar.style.width = lvl.pct;
    bar.style.background = lvl.color;
    msg.textContent = lvl.label;
    msg.style.color = lvl.color;
    ex4Password.style.borderColor = strength >= 3 ? 'var(--accent-green)' : val.length > 0 ? 'var(--accent-orange)' : 'var(--border)';
    ex4Valid.password = strength >= 2;
});

document.getElementById('ex4Form').addEventListener('submit', (e) => {
    e.preventDefault();
    const result = document.getElementById('ex4Result');
    result.style.display = 'block';

    if (ex4Valid.email && ex4Valid.password) {
        result.textContent = 'üéâ Form is valid! Would send to API in real app.';
        result.style.color = 'var(--accent-green)';
    } else {
        result.textContent = '‚ùå Fix the errors above before submitting!';
        result.style.color = 'var(--accent-red)';
        if (!ex4Valid.email) ex4Email.style.borderColor = 'var(--accent-red)';
        if (!ex4Valid.password) ex4Password.style.borderColor = 'var(--accent-red)';
    }
});

// ============================================
// QUIZ
// ============================================
const quizQuestions = [
    {
        q: "What is the correct way to attach a click handler to a button?",
        code: null,
        options: [
            "btn.addEventListener('click', handleClick())",
            "btn.addEventListener('click', handleClick)",
            "btn.onclick = handleClick()",
            "btn.on('click', handleClick)"
        ],
        correct: 1,
        explanation: "Pass the function REFERENCE without parentheses. Using `handleClick()` calls the function immediately and passes its return value (usually undefined) as the listener."
    },
    {
        q: "Which property gives you the element that was ACTUALLY clicked (the source of the event)?",
        code: `parent.addEventListener('click', (e) => {
  // User clicked a child button
  // Which property is the button?
});`,
        options: ["e.currentTarget", "e.target", "e.srcElement", "e.this"],
        correct: 1,
        explanation: "`e.target` is the element that triggered the event. `e.currentTarget` is the element that has the listener attached. In delegation, these are usually different."
    },
    {
        q: "What does `e.preventDefault()` do?",
        code: null,
        options: [
            "Stops the event from bubbling up",
            "Removes the event listener",
            "Stops the browser's default behavior (like form submit or link navigation)",
            "Prevents other listeners on the same element from firing"
        ],
        correct: 2,
        explanation: "`preventDefault()` stops the browser's default behavior. For a form, that's preventing page reload. For a link, preventing navigation. It does NOT stop propagation."
    },
    {
        q: "Which `addEventListener` option automatically removes the listener after it fires once?",
        code: `element.addEventListener('click', handler, { ___ });`,
        options: ["{ single: true }", "{ once: true }", "{ auto: true }", "{ remove: true }"],
        correct: 1,
        explanation: "The `{ once: true }` option makes the browser automatically call `removeEventListener` after the handler fires for the first time."
    },
    {
        q: "Why can't you remove this event listener?",
        code: `btn.addEventListener('click', () => console.log('hi'));
btn.removeEventListener('click', () => console.log('hi'));`,
        options: [
            "removeEventListener doesn't work with arrow functions",
            "Each arrow function is a new object reference, so they don't match",
            "You need to pass { remove: true } as the third argument",
            "You should use `off` instead of `removeEventListener`"
        ],
        correct: 1,
        explanation: "Arrow functions (and any anonymous functions) create a new reference each time they're written. `removeEventListener` needs the EXACT same function reference that was passed to `addEventListener`."
    },
    {
        q: "What is Event Delegation?",
        code: null,
        options: [
            "Assigning events to every child element individually",
            "Using a parent element's listener to handle events from its children via bubbling",
            "Delegating event handling to a Web Worker",
            "Passing event objects between components"
        ],
        correct: 1,
        explanation: "Event delegation works because events bubble up. You put ONE listener on a parent, and use `e.target` to identify which child element triggered the event. This is more efficient and works for dynamically added children."
    },
    {
        q: "Which keyboard event property should you use (NOT deprecated)?",
        code: `document.addEventListener('keydown', (e) => {
  // Which to check for the Enter key?
});`,
        options: ["e.keyCode === 13", "e.which === 13", "e.key === 'Enter'", "e.charCode === 13"],
        correct: 2,
        explanation: "`e.keyCode`, `e.which`, and `e.charCode` are all DEPRECATED. Use `e.key` which gives you readable string values like 'Enter', 'Escape', 'ArrowUp', etc."
    },
    {
        q: "In event delegation, what method finds the nearest ancestor matching a selector?",
        code: `list.addEventListener('click', (e) => {
  const item = e.target.___('.todo-item');
});`,
        options: ["e.target.querySelector()", "e.target.closest()", "e.target.parent()", "e.target.matches()"],
        correct: 1,
        explanation: "`closest(selector)` traverses UP the DOM from `e.target` and returns the first ancestor (including itself) that matches the CSS selector. Essential when users click icons inside buttons."
    },
    {
        q: "What does `stopPropagation()` do?",
        code: null,
        options: [
            "Stops the event's default browser behavior",
            "Stops the event from bubbling/capturing through the DOM",
            "Stops all event listeners from firing",
            "Cancels the event entirely"
        ],
        correct: 1,
        explanation: "`stopPropagation()` prevents the event from propagating (bubbling up or capturing down) to other elements. It doesn't affect `preventDefault()` ‚Äî they're independent."
    },
    {
        q: "When is the `change` event fired on an input, unlike `input`?",
        code: null,
        options: [
            "On every single keystroke, same as `input`",
            "When the element loses focus AND the value has changed",
            "Only when the user presses Enter",
            "Only when the value is set via JavaScript"
        ],
        correct: 1,
        explanation: "`input` fires on every keystroke. `change` fires when the element loses focus AND the value is different from when it gained focus. For checkboxes/selects, `change` fires immediately on change."
    }

];
   // ============================================
// COMPLETE QUIZ IMPLEMENTATION
// ============================================

// Continue the quizQuestions array (total 15 questions)
const moreQuizQuestions = [
    {
        q: "What is the correct way to stop an event from bubbling?",
        code: null,
        options: [
            "e.preventDefault()",
            "e.stopPropagation()",
            "e.stopImmediatePropagation()",
            "e.cancelBubble = false"
        ],
        correct: 1,
        explanation: "`stopPropagation()` prevents the event from traveling up (bubbling) or down (capturing) the DOM tree. `preventDefault()` only stops default browser behavior."
    },
    {
        q: "Which of the following is NOT a valid `addEventListener` option?",
        code: `element.addEventListener('click', fn, { /* ??? */ });`,
        options: ["capture", "once", "passive", "defer"],
        correct: 3,
        explanation: "Valid options are `capture`, `once`, `passive`, and `signal`. `defer` is not an event listener option."
    },
    {
        q: "In a form submit handler, what should you always do FIRST?",
        code: `form.addEventListener('submit', (e) => { ___ });`,
        options: [
            "Validate the inputs",
            "Call e.preventDefault()",
            "Send data with fetch",
            "Check e.target"
        ],
        correct: 1,
        explanation: "Always call `e.preventDefault()` first to stop the page from reloading. After that you can safely validate and send data with JavaScript."
    },
    {
        q: "What does `{ passive: true }` do?",
        code: null,
        options: [
            "Makes the listener run only once",
            "Indicates the listener will never call preventDefault (improves scroll performance)",
            "Stops the event from bubbling",
            "Removes the listener after execution"
        ],
        correct: 1,
        explanation: "Passive listeners tell the browser you won't call `preventDefault()`. This enables optimizations like smooth scrolling, especially on touch events."
    },
    {
        q: "Which event fires when an element loses focus?",
        code: null,
        options: ["blur", "focusout", "change", "unfocus"],
        correct: 0,
        explanation: "`blur` fires when an element loses focus. `focusout` is similar but bubbles. `change` fires after blur but only if the value changed."
    }
];

// Add the remaining 5 questions
quizQuestions.push(...moreQuizQuestions);

// Quiz state
let currentQuestion = 0;
let score = 0;
let userAnswers = new Array(quizQuestions.length).fill(null);
let quizActive = false;

// DOM elements
const quizArea = document.getElementById('quizArea');
const quizResults = document.getElementById('quizResults');
const quizProgress = document.getElementById('quizProgress');
const quizScoreDisplay = document.getElementById('quizScoreDisplay');
const finalScoreCircle = document.getElementById('finalScoreCircle');
const finalScoreTitle = document.getElementById('finalScoreTitle');
const finalScoreMsg = document.getElementById('finalScoreMsg');
const topicBreakdown = document.getElementById('topicBreakdown');

// Initialize quiz on page load
function initQuiz() {
    renderQuestion(0);
    updateProgress();
    quizActive = true;
}

function renderQuestion(index) {
    if (index >= quizQuestions.length) {
        showResults();
        return;
    }

    const q = quizQuestions[index];
    let html = `
        <div class="question-card">
            <div class="question-num">Question ${index + 1} of ${quizQuestions.length}</div>
            <div class="question-text">${q.q}</div>
    `;

    if (q.code) {
        html += `<div class="question-code"><pre><code>${q.code}</code></pre></div>`;
    }

    html += `<div class="options-grid">`;
    q.options.forEach((opt, i) => {
        const isSelected = userAnswers[index] === i;
        html += `
            <button class="option-btn ${isSelected ? (i === q.correct ? 'correct' : 'wrong') : ''}" 
                    onclick="selectAnswer(${index}, ${i})"
                    ${userAnswers[index] !== null ? 'disabled' : ''}>
                ${opt}
            </button>
        `;
    });
    html += `</div>`;

    if (userAnswers[index] !== null) {
        const isCorrect = userAnswers[index] === q.correct;
        html += `
            <div class="explanation show">
                <strong>${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect'}</strong><br>
                ${q.explanation}
            </div>
        `;
    }

    html += `</div>`;

    // Navigation buttons
    html += `
        <div style="display: flex; justify-content: space-between; margin-top: 1.5rem;">
            <button class="btn btn-secondary" onclick="prevQuestion()" ${index === 0 ? 'disabled' : ''}>‚Üê Previous</button>
            <button class="btn btn-primary" onclick="nextQuestion()">
                ${index === quizQuestions.length - 1 ? 'Finish Quiz' : 'Next Question ‚Üí'}
            </button>
        </div>
    `;

    quizArea.innerHTML = html;
    updateProgress();
}

// Answer selection
window.selectAnswer = function(qIndex, optIndex) {
    if (userAnswers[qIndex] !== null) return; // Already answered

    userAnswers[qIndex] = optIndex;
    const isCorrect = optIndex === quizQuestions[qIndex].correct;
    if (isCorrect) score++;

    renderQuestion(qIndex);
    updateProgress();

    // Auto-advance after a short delay (optional)
    if (qIndex < quizQuestions.length - 1) {
        setTimeout(() => nextQuestion(), 800);
    }
};

window.prevQuestion = function() {
    if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion(currentQuestion);
    }
};

window.nextQuestion = function() {
    if (currentQuestion < quizQuestions.length - 1) {
        currentQuestion++;
        renderQuestion(currentQuestion);
    } else {
        showResults();
    }
};

function updateProgress() {
    const answered = userAnswers.filter(a => a !== null).length;
    const percent = (answered / quizQuestions.length) * 100;
    quizProgress.style.width = percent + '%';
    quizScoreDisplay.textContent = `Score: ${score}/${answered}`;
}

function showResults() {
    quizArea.style.display = 'none';
    quizResults.classList.remove('hidden');

    const percent = Math.round((score / quizQuestions.length) * 100);
    finalScoreCircle.textContent = percent + '%';
    finalScoreTitle.textContent = percent >= 80 ? 'üèÜ Master Level!' : percent >= 50 ? 'üëç Getting There!' : 'üìö Keep Learning!';
    finalScoreMsg.textContent = `You answered ${score} out of ${quizQuestions.length} correctly.`;

    // Simple breakdown by topic (just for fun)
    const topics = [
        { name: 'addEventListener', count: 3 },
        { name: 'Event Object', count: 3 },
        { name: 'Event Types', count: 3 },
        { name: 'Delegation', count: 3 },
        { name: 'Mistakes', count: 3 }
    ];
    topicBreakdown.innerHTML = topics.map(t => `
        <div style="background: var(--bg-card); border-radius: 8px; padding: 0.5rem 1rem;">
            <span style="color: var(--accent-cyan);">${t.name}</span>
            <span style="color: var(--text-secondary);">${t.count} q</span>
        </div>
    `).join('');

    // Trigger confetti for high scores
    if (percent >= 80) {
        confetti();
    }
}

window.restartQuiz = function() {
    // Reset state
    currentQuestion = 0;
    score = 0;
    userAnswers = new Array(quizQuestions.length).fill(null);
    quizArea.style.display = 'block';
    quizResults.classList.add('hidden');
    renderQuestion(0);
    updateProgress();
};

// ============================================
// CONFETTI CELEBRATION
// ============================================
function confetti() {
    const colors = ['#7c3aed', '#2563eb', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', '#ec4899'];
    for (let i = 0; i < 80; i++) {
        setTimeout(() => {
            const piece = document.createElement('div');
            piece.className = 'confetti-piece';
            piece.style.left = Math.random() * 100 + '%';
            piece.style.background = colors[Math.floor(Math.random() * colors.length)];
            piece.style.width = Math.random() * 12 + 5 + 'px';
            piece.style.height = piece.style.width;
            piece.style.animationDuration = Math.random() * 2 + 2 + 's';
            piece.style.opacity = Math.random() * 0.8 + 0.2;
            document.body.appendChild(piece);
            setTimeout(() => piece.remove(), 4000);
        }, i * 30);
    }
}

// Start the quiz when the page loads
initQuiz();

// ============================================
// ENSURE ALL FUNCTIONS ARE DEFINED
// ============================================
// (restartQuiz is already defined above)

</script>
</body>

</html>