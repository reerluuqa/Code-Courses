<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regex Master Academy - Interactive Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --primary: #38bdf8;
            --secondary: #818cf8;
            --success: #34d399;
            --danger: #f87171;
            --warning: #fbbf24;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

       .app-container {
    display: block; /* Changed from grid */
    min-height: 100vh;
}

        /* Sidebar */
        .sidebar {
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 2rem 1rem;
            position: fixed;
            height: 100vh;
            width: 250px;
            overflow-y: auto;
            z-index: 100;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .nav-item {
            padding: 0.75rem 1rem;
            margin-bottom: 0.25rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: var(--bg-hover);
        }

        .nav-item.active {
            background: linear-gradient(135deg, rgba(56, 189, 248, 0.2), rgba(129, 140, 248, 0.2));
            color: var(--primary);
            border: 1px solid rgba(56, 189, 248, 0.3);
        }

        .nav-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .badge {
            background: var(--primary);
            color: var(--bg-dark);
            padding: 0.125rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: auto;
        }

        /* Main Content */
      .main-content {
    margin-left: 250px; /* Space for fixed sidebar */
    padding: 2rem;
    /* max-width: 1200px;  REMOVED */
    width: 100%; /* Ensures full width */
}

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .progress-bar {
            width: 200px;
            height: 8px;
            background: var(--bg-hover);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.5s ease;
            width: 0%;
        }

        .xp-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--warning);
            font-weight: bold;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        h1, h2, h3 {
            margin-bottom: 1rem;
        }

        h1 { font-size: 2rem; color: var(--primary); }
        h2 { font-size: 1.5rem; color: var(--text); }
        h3 { font-size: 1.25rem; color: var(--text-muted); }

        /* Interactive Playground */
        .playground {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 600;
        }

        .regex-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            transition: all 0.2s;
        }

        .regex-input-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.1);
        }

        .regex-delimiter {
            color: var(--warning);
            font-family: 'Courier New', monospace;
            font-weight: bold;
            margin-right: 0.25rem;
        }

        input[type="text"], textarea {
            background: transparent;
            border: none;
            color: var(--text);
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            width: 100%;
            outline: none;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
            padding: 1rem;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            line-height: 1.8;
        }

        .flags-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .flag-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border-radius: 2rem;
            font-size: 0.85rem;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .flag-toggle:hover {
            border-color: var(--primary);
        }

        .flag-toggle.active {
            background: rgba(56, 189, 248, 0.2);
            border-color: var(--primary);
            color: var(--primary);
        }

        .flag-toggle input {
            display: none;
        }

        /* Visual Regex Builder */
        .regex-visualizer {
            background: var(--bg-dark);
            border-radius: 0.5rem;
            padding: 1.5rem;
            min-height: 200px;
            border: 2px solid var(--border);
        }

        .regex-token {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            margin: 0.125rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            position: relative;
            cursor: help;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .token-literal { background: rgba(52, 211, 153, 0.2); color: var(--success); border: 1px solid var(--success); }
        .token-anchor { background: rgba(251, 191, 36, 0.2); color: var(--warning); border: 1px solid var(--warning); }
        .token-quantifier { background: rgba(56, 189, 248, 0.2); color: var(--primary); border: 1px solid var(--primary); }
        .token-charclass { background: rgba(129, 140, 248, 0.2); color: var(--secondary); border: 1px solid var(--secondary); }
        .token-group { background: rgba(248, 113, 113, 0.2); color: var(--danger); border: 1px solid var(--danger); }
        .token-escape { background: rgba(167, 139, 250, 0.2); color: #a78bfa; border: 1px solid #a78bfa; }

        .match-display {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-dark);
            border-radius: 0.5rem;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 2;
        }

        .match-highlight {
            background: rgba(52, 211, 153, 0.3);
            border-bottom: 2px solid var(--success);
            border-radius: 2px;
            position: relative;
            animation: pulse 2s infinite;
        }

        .match-highlight.error {
            background: rgba(248, 113, 113, 0.3);
            border-bottom-color: var(--danger);
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0%, 100% { background: rgba(52, 211, 153, 0.3); }
            50% { background: rgba(52, 211, 153, 0.5); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Method Cards */
        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .method-card {
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .method-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .method-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
        }

        .method-name {
            font-family: 'Courier New', monospace;
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .method-syntax {
            background: rgba(0,0,0,0.3);
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        /* Quiz Section */
        .quiz-option {
            display: block;
            width: 100%;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text);
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .quiz-option:hover:not(:disabled) {
            border-color: var(--primary);
            background: var(--bg-hover);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: rgba(52, 211, 153, 0.1);
        }

        .quiz-option.wrong {
            border-color: var(--danger);
            background: rgba(248, 113, 113, 0.1);
            animation: shake 0.5s;
        }

        .quiz-option:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .explanation {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(56, 189, 248, 0.1);
            border-left: 4px solid var(--primary);
            border-radius: 0 0.5rem 0.5rem 0;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        /* Pitfalls */
        .pitfall-card {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.1), rgba(251, 191, 36, 0.1));
            border: 2px solid var(--danger);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .pitfall-badge {
            position: absolute;
            top: -12px;
            right: 20px;
            background: var(--danger);
            color: white;
            padding: 0.25rem 1rem;
            border-radius: 1rem;
            font-weight: bold;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .code-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .code-block {
            background: #000;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .code-block.bad {
            border: 2px solid var(--danger);
        }

        .code-block.good {
            border: 2px solid var(--success);
        }

        .code-label {
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .code-label.bad { color: var(--danger); }
        .code-label.good { color: var(--success); }

        /* Challenge Mode */
        .challenge-editor {
            background: var(--bg-dark);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }

        .test-cases {
            margin-top: 1.5rem;
        }

        .test-case {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: rgba(0,0,0,0.2);
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            font-family: 'Courier New', monospace;
        }

        .test-case.pass {
            border-left: 4px solid var(--success);
        }

        .test-case.fail {
            border-left: 4px solid var(--danger);
        }

        .status-icon {
            font-weight: bold;
        }

        .status-icon.pass { color: var(--success); }
        .status-icon.fail { color: var(--danger); }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: var(--bg-dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.85rem;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.5);
            display: none;
            pointer-events: none;
        }

        .tooltip.show {
            display: block;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
            .playground {
                grid-template-columns: 1fr;
            }
            .code-comparison {
                grid-template-columns: 1fr;
            }
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--primary);
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            z-index: 9999;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Syntax Highlighting in Text */
        .syntax-literal { color: var(--success); }
        .syntax-special { color: var(--warning); }
        .syntax-quantifier { color: var(--primary); font-weight: bold; }
        .syntax-anchor { color: #f472b6; }
        .syntax-group { color: var(--danger); }

        .hidden { display: none !important; }

        .tab-container {
            display: flex;
            gap: 1rem;
            border-bottom: 2px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <span>‚ö°</span>
                <span>RegexMaster</span>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Learn</div>
                <div class="nav-item active" onclick="app.navigate('playground')">
                    <span>üéÆ</span> Playground
                </div>
                <div class="nav-item" onclick="app.navigate('syntax')">
                    <span>üìö</span> Syntax Guide
                </div>
                <div class="nav-item" onclick="app.navigate('methods')">
                    <span>üîß</span> JS Methods
                </div>
                <div class="nav-item" onclick="app.navigate('patterns')">
                    <span>üéØ</span> Common Patterns
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Practice</div>
                <div class="nav-item" onclick="app.navigate('challenges')">
                    <span>üèÜ</span> Challenges
                    <span class="badge" id="challenge-badge">0/5</span>
                </div>
                <div class="nav-item" onclick="app.navigate('quiz')">
                    <span>‚ùì</span> Quiz Arena
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Advanced</div>
                <div class="nav-item" onclick="app.navigate('pitfalls')">
                    <span>‚ö†Ô∏è</span> Pitfalls & Bugs
                </div>
                <div class="nav-item" onclick="app.navigate('visualizer')">
                    <span>üëÅÔ∏è</span> Visualizer
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="header">
                <div>
                    <h1 id="page-title">Regex Playground</h1>
                    <p style="color: var(--text-muted);">Master pattern matching for technical interviews</p>
                </div>
                <div style="display: flex; gap: 2rem; align-items: center;">
                    <div class="xp-display">
                        <span>‚ö°</span>
                        <span id="xp-display">0 XP</span>
                    </div>
                    <div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.25rem;">Progress</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="global-progress"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PLAYGROUND SECTION -->
            <section id="section-playground" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üß™</div>
                        <div>
                            <h2>Interactive Playground</h2>
                            <p style="color: var(--text-muted);">Test patterns in real-time with visual feedback</p>
                        </div>
                    </div>

                    <div class="playground">
                        <div>
                            <div class="input-group">
                                <label>Regular Expression</label>
                                <div class="regex-input-wrapper">
                                    <span class="regex-delimiter">/</span>
                                    <input type="text" id="regex-pattern" placeholder="Enter pattern (e.g., [a-z]+)" autocomplete="off">
                                    <span class="regex-delimiter" id="regex-flags-display">/g</span>
                                </div>
                                <div class="flags-container">
                                    <label class="flag-toggle active" onclick="app.toggleFlag('g')">
                                        <input type="checkbox" checked> Global (g)
                                    </label>
                                    <label class="flag-toggle" onclick="app.toggleFlag('i')">
                                        <input type="checkbox"> Ignore Case (i)
                                    </label>
                                    <label class="flag-toggle" onclick="app.toggleFlag('m')">
                                        <input type="checkbox"> Multiline (m)
                                    </label>
                                    <label class="flag-toggle" onclick="app.toggleFlag('s')">
                                        <input type="checkbox"> DotAll (s)
                                    </label>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Test String</label>
                                <textarea id="test-string" placeholder="Enter text to test against...">Hello World! hello@example.com
Phone: 123-456-7890
Price: $49.99"></textarea>
                            </div>

                            <button class="btn btn-primary" onclick="app.runRegex()">
                                <span>‚ñ∂</span> Run Match
                            </button>
                        </div>

                        <div>
                            <div class="input-group">
                                <label>Visual Breakdown</label>
                                <div class="regex-visualizer" id="visualizer">
                                    <p style="color: var(--text-muted); text-align: center; margin-top: 4rem;">
                                        Enter a pattern to see visual breakdown
                                    </p>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Match Results</label>
                                <div class="match-display" id="match-results">
                                    <span style="color: var(--text-muted);">No pattern entered yet...</span>
                                </div>
                            </div>

                            <div class="input-group">
                                <label>Method Results</label>
                                <div id="method-results" style="font-family: monospace; font-size: 0.9rem; color: var(--text-muted);">
                                    <div>.test(): <span id="result-test">-</span></div>
                                    <div>.match(): <span id="result-match">-</span></div>
                                    <div>.split(): <span id="result-split">-</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SYNTAX SECTION -->
            <section id="section-syntax" class="section hidden">
                <div class="card">
                    <h2>Regex Syntax Cheatsheet</h2>
                    <p style="color: var(--text-muted); margin-bottom: 2rem;">Click any item to test it in the playground</p>

                    <div class="tab-container">
                        <button class="tab active" onclick="app.switchTab('anchors')">Anchors</button>
                        <button class="tab" onclick="app.switchTab('quantifiers')">Quantifiers</button>
                        <button class="tab" onclick="app.switchTab('charclasses')">Char Classes</button>
                        <button class="tab" onclick="app.switchTab('groups')">Groups</button>
                        <button class="tab" onclick="app.switchTab('lookarounds')">Lookarounds</button>
                    </div>

                    <div id="tab-anchors" class="tab-content active">
                        <div class="method-grid">
                            <div class="method-card" onclick="app.tryPattern('^start')">
                                <div class="method-name">^</div>
                                <div class="method-syntax">/^hello/</div>
                                <p>Matches beginning of string (or line with m flag)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('end$')">
                                <div class="method-name">$</div>
                                <div class="method-syntax">/world$/</div>
                                <p>Matches end of string (or line with m flag)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('\\bword\\b')">
                                <div class="method-name">\b</div>
                                <div class="method-syntax">/\btest\b/</div>
                                <p>Word boundary (between \w and \W)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('\\B')">
                                <div class="method-name">\B</div>
                                <div class="method-syntax">/\Btest\B/</div>
                                <p>Non-word boundary</p>
                            </div>
                        </div>
                    </div>

                    <div id="tab-quantifiers" class="tab-content">
                        <div class="method-grid">
                            <div class="method-card" onclick="app.tryPattern('a*')">
                                <div class="method-name">*</div>
                                <div class="method-syntax">/a*/</div>
                                <p>0 or more (greedy)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('a+')">
                                <div class="method-name">+</div>
                                <div class="method-syntax">/a+/</div>
                                <p>1 or more (greedy)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('a?')">
                                <div class="method-name">?</div>
                                <div class="method-syntax">/a?/</div>
                                <p>0 or 1 (optional)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('a{3,5}')">
                                <div class="method-name">{n,m}</div>
                                <div class="method-syntax">/a{2,4}/</div>
                                <p>Between n and m times</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('a*?')">
                                <div class="method-name">*?</div>
                                <div class="method-syntax">/a*?/</div>
                                <p>Lazy (non-greedy) version</p>
                                <small style="color: var(--warning);">‚ö†Ô∏è Common pitfall!</small>
                            </div>
                        </div>
                    </div>

                    <div id="tab-charclasses" class="tab-content">
                        <div class="method-grid">
                            <div class="method-card" onclick="app.tryPattern('[abc]')">
                                <div class="method-name">[...]</div>
                                <div class="method-syntax">/[aeiou]/</div>
                                <p>Any character in brackets</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('[^abc]')">
                                <div class="method-name">[^...]</div>
                                <div class="method-syntax">/[^0-9]/</div>
                                <p>Negated character class</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('\\d')">
                                <div class="method-name">\d</div>
                                <div class="method-syntax">/\d+/</div>
                                <p>Digit [0-9]</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('\\w')">
                                <div class="method-name">\w</div>
                                <div class="method-syntax">/\w+/</div>
                                <p>Word character [a-zA-Z0-9_]</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('\\s')">
                                <div class="method-name">\s</div>
                                <div class="method-syntax">/\s+/</div>
                                <p>Whitespace</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('.')">
                                <div class="method-name">.</div>
                                <div class="method-syntax">/./g</div>
                                <p>Any character (except newline)</p>
                            </div>
                        </div>
                    </div>

                    <div id="tab-groups" class="tab-content">
                        <div class="method-grid">
                            <div class="method-card" onclick="app.tryPattern('(abc)')">
                                <div class="method-name">(...)</div>
                                <div class="method-syntax">/(ha)+/</div>
                                <p>Capturing group</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('(?:abc)')">
                                <div class="method-name">(?:...)</div>
                                <div class="method-syntax">/(?:https?:\/\/)/</div>
                                <p>Non-capturing group</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('(?<name>\\w+)')">
                                <div class="method-name">(?&lt;name&gt;...)</div>
                                <div class="method-syntax">/(?<user>\w+)/</div>
                                <p>Named capturing group (ES2018)</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('(a|b)')">
                                <div class="method-name">|</div>
                                <div class="method-syntax">/(cat|dog)/</div>
                                <p>Alternation (OR)</p>
                            </div>
                        </div>
                    </div>

                    <div id="tab-lookarounds" class="tab-content">
                        <div class="method-grid">
                            <div class="method-card" onclick="app.tryPattern('(?=\\d)')">
                                <div class="method-name">(?=...)</div>
                                <div class="method-syntax">/\w(?=\d)/</div>
                                <p>Positive lookahead</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('(?!\\d)')">
                                <div class="method-name">(?!...)</div>
                                <div class="method-syntax">/\w(?!\d)/</div>
                                <p>Negative lookahead</p>
                            </div>
                            <div class="method-card" onclick="app.tryPattern('(?<=\\$)\\d+')">
                                <div class="method-name">(?&lt;=...)</div>
                                <div class="method-syntax">/(?<=\$)\d+/</div>
                                <p>Positive lookbehind</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- METHODS SECTION -->
            <section id="section-methods" class="section hidden">
                <div class="card">
                    <h2>JavaScript Regex Methods</h2>
                    <p style="color: var(--text-muted); margin-bottom: 2rem;">Understanding the difference between String and RegExp methods</p>

                    <div class="method-grid">
                        <div class="method-card">
                            <div class="method-name">RegExp.prototype.test()</div>
                            <div class="method-syntax">/regex/.test(string)</div>
                            <p>Returns boolean. <strong>Fastest</strong> for validation.</p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                const email = /^\S+@\S+\.\S+$/;<br>
                                email.test("user@example.com"); // true<br>
                                email.test("invalid"); // false
                            </div>
                            <div style="margin-top: 0.5rem; padding: 0.5rem; background: rgba(251, 191, 36, 0.1); border-radius: 0.25rem; font-size: 0.85rem; color: var(--warning);">
                                ‚ö†Ô∏è Warning: With /g flag, maintains lastIndex state!
                            </div>
                        </div>

                        <div class="method-card">
                            <div class="method-name">String.prototype.match()</div>
                            <div class="method-syntax">string.match(regex)</div>
                            <p>Returns array of matches or null.</p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                "abc123".match(/\d+/); // ["123"]<br>
                                "abc123".match(/\d+/g); // ["123"]<br>
                                "abc".match(/\d+/); // null
                            </div>
                        </div>

                        <div class="method-card">
                            <div class="method-name">String.prototype.matchAll()</div>
                            <div class="method-syntax">string.matchAll(regex)</div>
                            <p>Returns iterator with capture groups. <strong>ES2020</strong></p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                const str = "test1 test2";<br>
                                const matches = [...str.matchAll(/test(\d)/g)];<br>
                                // [[ "test1", "1" ], [ "test2", "2" ]]
                            </div>
                        </div>

                        <div class="method-card">
                            <div class="method-name">String.prototype.replace()</div>
                            <div class="method-syntax">string.replace(regex, replacement)</div>
                            <p>Replace matches. Supports $1, $2 for groups.</p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                "2024-03-15".replace(/(\d{4})-(\d{2})-(\d{2})/, '$2/$3/$1')<br>
                                // "03/15/2024"
                            </div>
                        </div>

                        <div class="method-card">
                            <div class="method-name">String.prototype.split()</div>
                            <div class="method-syntax">string.split(regex)</div>
                            <p>Split by pattern. Can use capture groups to include delimiters.</p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                "a,b;c|d".split(/[,;|]/); // ["a", "b", "c", "d"]<br>
                                "a,b".split(/(,)/); // ["a", ",", "b"]
                            </div>
                        </div>

                        <div class="method-card">
                            <div class="method-name">RegExp.prototype.exec()</div>
                            <div class="method-syntax">regex.exec(string)</div>
                            <p>Returns match object with groups. Iterates with /g flag.</p>
                            <div class="challenge-editor" style="margin-top: 1rem; font-size: 0.9rem;">
                                const regex = /(\d+)/g;<br>
                                regex.exec("age: 30, height: 180");<br>
                                // ["30", "30", index: 5, ...]
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PATTERNS SECTION -->
            <section id="section-patterns" class="section hidden">
                <div class="card">
                    <h2>Common Patterns for Interviews</h2>
                    <p style="color: var(--text-muted); margin-bottom: 2rem;">Production-ready patterns with explanations</p>

                    <div class="method-grid">
                        <div class="method-card" onclick="app.tryPattern('^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$')">
                            <div class="method-name">Email Validation</div>
                            <div class="method-syntax">Basic email pattern</div>
                            <p>Not RFC 5322 compliant but works for 99% cases</p>
                            <button class="btn" style="margin-top: 1rem; font-size: 0.8rem;" onclick="event.stopPropagation(); app.showPatternDetail('email')">
                                View Details
                            </button>
                        </div>

                        <div class="method-card" onclick="app.tryPattern('^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$')">
                            <div class="method-name">Strong Password</div>
                            <div class="method-syntax">8+ chars, mixed case, number, special</div>
                            <p>Uses positive lookaheads for complex validation</p>
                        </div>

                        <div class="method-card" onclick="app.tryPattern('^\\+?[1-9]\\d{1,14}$')">
                            <div class="method-name">Phone (E.164)</div>
                            <div class="method-syntax">International format</div>
                            <p>Optional + prefix, 1-15 digits, no spaces</p>
                        </div>

                        <div class="method-card" onclick="app.tryPattern('^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$')">
                            <div class="method-name">Hex Color</div>
                            <div class="method-syntax">#RGB or #RRGGBB</div>
                            <p>Validates CSS hex colors with optional shorthand</p>
                        </div>

                        <div class="method-card" onclick="app.tryPattern('^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?$')">
                            <div class="method-name">URL Validation</div>
                            <div class="method-syntax">Basic URL pattern</div>
                            <p>Protocol optional, domain and path support</p>
                        </div>

                        <div class="method-card" onclick="app.tryPattern('\\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b')">
                            <div class="method-name">IPv4 Address</div>
                            <div class="method-syntax">0-255.0-255.0-255.0-255</div>
                            <p>Validates each octet range individually</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CHALLENGES SECTION -->
            <section id="section-challenges" class="section hidden">
                <div class="card">
                    <h2>Regex Challenges</h2>
                    <p style="color: var(--text-muted);">Complete all challenges to earn the Regex Master badge!</p>

                    <div id="challenge-container">
                        <div class="challenge-item" data-challenge="1">
                            <h3>Challenge 1: Extract Prices üí∞</h3>
                            <p>Extract all dollar amounts from text (e.g., $19.99, $1,234.56)</p>
                            
                            <div class="challenge-editor">
                                <div class="input-group">
                                    <label>Your Pattern:</label>
                                    <div class="regex-input-wrapper">
                                        <span class="regex-delimiter">/</span>
                                        <input type="text" id="challenge-1-input" placeholder="\$\d+\.\d{2}">
                                        <span class="regex-delimiter">/g</span>
                                    </div>
                                </div>
                                
                                <div class="test-cases">
                                    <div class="test-case" data-input="Price: $19.99" data-expected='["$19.99"]'>
                                        <span>Price: $19.99</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="Total: $1,234.56 and $50" data-expected='["$1,234.56","$50"]'>
                                        <span>Total: $1,234.56 and $50</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="Free item $0.00" data-expected='["$0.00"]'>
                                        <span>Free item $0.00</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                </div>

                                <button class="btn btn-primary" onclick="app.runChallenge(1)" style="margin-top: 1rem;">
                                    Test Solution
                                </button>
                                <button class="btn btn-success hidden" id="challenge-1-next" onclick="app.nextChallenge(2)" style="margin-top: 1rem; margin-left: 0.5rem;">
                                    Next Challenge ‚Üí
                                </button>
                            </div>
                        </div>

                        <div class="challenge-item hidden" data-challenge="2">
                            <h3>Challenge 2: Validate Username üë§</h3>
                            <p>Create a pattern for usernames: 3-16 chars, alphanumeric + underscore, must start with letter</p>
                            
                            <div class="challenge-editor">
                                <div class="input-group">
                                    <label>Your Pattern (use ^ and $):</label>
                                    <div class="regex-input-wrapper">
                                        <span class="regex-delimiter">/</span>
                                        <input type="text" id="challenge-2-input" placeholder="^[a-zA-Z]...">
                                        <span class="regex-delimiter">/</span>
                                    </div>
                                </div>
                                
                                <div class="test-cases">
                                    <div class="test-case" data-input="user_123" data-match="true">
                                        <span>user_123 (valid)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="123user" data-match="false">
                                        <span>123user (invalid - starts with number)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="ab" data-match="false">
                                        <span>ab (invalid - too short)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                </div>

                                <button class="btn btn-primary" onclick="app.runChallenge(2)" style="margin-top: 1rem;">
                                    Test Solution
                                </button>
                            </div>
                        </div>

                        <div class="challenge-item hidden" data-challenge="3">
                            <h3>Challenge 3: Password Strength üîí</h3>
                            <p>Pattern must contain: 1 uppercase, 1 lowercase, 1 digit, 8+ length</p>
                            <p style="font-size: 0.9rem; color: var(--warning);">Hint: Use positive lookaheads (?=...)</p>
                            
                            <div class="challenge-editor">
                                <div class="input-group">
                                    <label>Your Pattern:</label>
                                    <div class="regex-input-wrapper">
                                        <span class="regex-delimiter">/</span>
                                        <input type="text" id="challenge-3-input" placeholder="^(?=.*[A-Z])...">
                                        <span class="regex-delimiter">/</span>
                                    </div>
                                </div>
                                
                                <div class="test-cases">
                                    <div class="test-case" data-input="Password1" data-match="true">
                                        <span>Password1 (valid)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="password" data-match="false">
                                        <span>password (invalid - no uppercase/number)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                    <div class="test-case" data-input="PASS1" data-match="false">
                                        <span>PASS1 (invalid - too short)</span>
                                        <span class="status-icon">‚è≥</span>
                                    </div>
                                </div>

                                <button class="btn btn-primary" onclick="app.runChallenge(3)" style="margin-top: 1rem;">
                                    Test Solution
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- QUIZ SECTION -->
            <section id="section-quiz" class="section hidden">
                <div class="card">
                    <h2>Regex Quiz Arena</h2>
                    <div id="quiz-container">
                        <div class="quiz-question" data-question="1">
                            <h3>Question 1: What does <code>/^abc$/</code> match?</h3>
                            <div style="margin: 1.5rem 0;">
                                <button class="quiz-option" onclick="app.answerQuiz(1, 'a', false)">
                                    A) Any string containing "abc" anywhere
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(1, 'b', true)">
                                    B) Only the exact string "abc"
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(1, 'c', false)">
                                    C) Strings starting with "abc"
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(1, 'd', false)">
                                    D) Strings ending with "abc"
                                </button>
                            </div>
                            <div class="explanation" id="explanation-1">
                                <strong>Correct!</strong> <code>^</code> asserts start of string, <code>$</code> asserts end. Together they require full string match. Without them, it would be a partial match.
                            </div>
                        </div>

                        <div class="quiz-question hidden" data-question="2">
                            <h3>Question 2: What's the difference between <code>.*</code> and <code>.*?</code>?</h3>
                            <div style="margin: 1.5rem 0;">
                                <button class="quiz-option" onclick="app.answerQuiz(2, 'a', false)">
                                    A) No difference, both match any character
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(2, 'b', true)">
                                    B) Greedy vs Lazy matching
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(2, 'c', false)">
                                    C) One matches newlines, one doesn't
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(2, 'd', false)">
                                    D) Case sensitivity difference
                                </button>
                            </div>
                            <div class="explanation" id="explanation-2">
                                <strong>Correct!</strong> <code>.*</code> is greedy (matches as much as possible), <code>.*?</code> is lazy (matches as little as possible). In "abc", /a.*c/ matches whole string, /a.*?c/ matches just "abc".
                            </div>
                        </div>

                        <div class="quiz-question hidden" data-question="3">
                            <h3>Question 3: Why does <code>/\w+/</code> not match "caf√©"?</h3>
                            <div style="margin: 1.5rem 0;">
                                <button class="quiz-option" onclick="app.answerQuiz(3, 'a', false)">
                                    A) The + quantifier doesn't work with \w
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(3, 'b', true)">
                                    B) \w only matches [a-zA-Z0-9_], not accented chars
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(3, 'c', false)">
                                    C) Missing 'u' (unicode) flag
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(3, 'd', false)">
                                    D) JavaScript doesn't support Unicode
                                </button>
                            </div>
                            <div class="explanation" id="explanation-3">
                                <strong>Correct!</strong> <code>\w</code> is limited to ASCII word characters. For Unicode (including √©, √±, ‰∏≠), use <code>[\p{L}\p{N}_]</code> with the 'u' flag (ES2018).
                            </div>
                        </div>

                        <div class="quiz-question hidden" data-question="4">
                            <h3>Question 4: What happens with <code>/\d/g</code> and <code>.test()</code> in a loop?</h3>
                            <div style="margin: 1.5rem 0;">
                                <button class="quiz-option" onclick="app.answerQuiz(4, 'a', false)">
                                    A) Returns true for every digit found
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(4, 'b', true)">
                                    B) Alternates true/false due to lastIndex
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(4, 'c', false)">
                                    C) Always returns false after first call
                                </button>
                                <button class="quiz-option" onclick="app.answerQuiz(4, 'd', false)">
                                    D) Throws an error
                                </button>
                            </div>
                            <div class="explanation" id="explanation-4">
                                <strong>Correct!</strong> This is the infamous "sticky" bug! With /g flag, <code>test()</code> updates <code>lastIndex</code>. After finding last match, it resets to 0 and returns false, causing infinite loops in while(regex.test(str)) patterns.
                            </div>
                        </div>
                    </div>
                    <div id="quiz-score" style="margin-top: 2rem; text-align: center; font-size: 1.2rem; color: var(--success); display: none;">
                        üéâ Quiz Complete! You earned <span id="quiz-xp">100</span> XP!
                    </div>
                </div>
            </section>

            <!-- PITFALLS SECTION -->
            <section id="section-pitfalls" class="section hidden">
                <div class="card">
                    <h2>‚ö†Ô∏è Common Pitfalls & Bugs</h2>
                    <p style="color: var(--text-muted); margin-bottom: 2rem;">Mistakes that cost developers hours in production</p>

                    <div class="pitfall-card">
                        <span class="pitfall-badge">Critical Bug</span>
                        <h3>The Global Flag Trap with .test()</h3>
                        <p style="margin: 1rem 0;">Using <code>/g</code> with <code>RegExp.prototype.test()</code> causes it to track <code>lastIndex</code>, leading to unpredictable boolean alternation.</p>
                        
                        <div class="code-comparison">
                            <div>
                                <div class="code-label bad">‚ùå Buggy Code</div>
                                <div class="code-block bad">
const regex = /\d/g;<br>
while(regex.test("123")) {<br>
&nbsp;&nbsp;console.log("match");<br>
}<br>
// Infinite loop! Returns: T,F,T,F...
                                </div>
                            </div>
                            <div>
                                <div class="code-label good">‚úÖ Fixed Code</div>
                                <div class="code-block good">
const regex = /\d/g;<br>
const str = "123";<br>
// Option 1: Remove /g if not needed<br>
const regex2 = /\d/;<br>
<br>
// Option 2: Reset lastIndex<br>
regex.lastIndex = 0;<br>
while(regex.test(str)) { ... }
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pitfall-card">
                        <span class="pitfall-badge">Performance</span>
                        <h3>Catastrophic Backtracking</h3>
                        <p style="margin: 1rem 0;">Nested quantifiers like <code>(a+)+</code> can cause exponential time complexity (ReDoS attacks).</p>
                        
                        <div class="code-comparison">
                            <div>
                                <div class="code-label bad">‚ùå Dangerous</div>
                                <div class="code-block bad">
/^(\d+)*$/.test("123456789!")<br>
// Hangs on non-matching input<br>
// Complexity: O(2^n)
                                </div>
                            </div>
                            <div>
                                <div class="code-label good">‚úÖ Safe</div>
                                <div class="code-block good">
/^\d+$/.test("123456789!")<br>
// Linear time O(n)<br>
// Atomic groups (if available) or<br>
// possessive quantifiers help
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pitfall-card">
                        <span class="pitfall-badge">Logic Error</span>
                        <h3>Greedy vs Lazy Misunderstanding</h3>
                        <p style="margin: 1rem 0;"><code>.*</code> matches as much as possible, often swallowing delimiters you want to match separately.</p>
                        
                        <div class="code-comparison">
                            <div>
                                <div class="code-label bad">‚ùå Wrong Match</div>
                                <div class="code-block bad">
HTML: &lt;b&gt;bold&lt;/b&gt; text<br>
Pattern: /&lt;.*&gt;/<br>
Matches: &lt;b&gt;bold&lt;/b&gt;<br>
// Too greedy!
                                </div>
                            </div>
                            <div>
                                <div class="code-label good">‚úÖ Correct</div>
                                <div class="code-block good">
Pattern: /&lt;.*?&gt;/ (Lazy)<br>
Or: /&lt;[^&gt;]*&gt;/ (Negated)<br>
Matches: &lt;b&gt; and &lt;/b&gt;<br>
// Separate matches
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pitfall-card">
                        <span class="pitfall-badge">Validation</span>
                        <h3>Not Anchoring Patterns</h3>
                        <p style="margin: 1rem 0;">Forgetting <code>^</code> and <code>$</code> allows partial matches, passing invalid input.</p>
                        
                        <div class="code-comparison">
                            <div>
                                <div class="code-label bad">‚ùå Bypassable</div>
                                <div class="code-block bad">
// Email validation<br>
/\w+@\w+\.\w+/.test(<br>
&nbsp;&nbsp;"hacker@evil.com @real.com"<br>
) // true! (partial match)
                                </div>
                            </div>
                            <div>
                                <div class="code-label good">‚úÖ Strict</div>
                                <div class="code-block good">
/^\w+@\w+\.\w+$/.test(...)<br>
// Or use \A and \Z if available<br>
// Ensures full string match only
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VISUALIZER SECTION -->
            <section id="section-visualizer" class="section hidden">
                <div class="card">
                    <h2>Regex Visualizer</h2>
                    <p style="color: var(--text-muted);">Understand how the engine processes your pattern</p>
                    
                    <div class="playground" style="margin-top: 2rem;">
                        <div>
                            <div class="input-group">
                                <label>Pattern</label>
                                <div class="regex-input-wrapper">
                                    <span class="regex-delimiter">/</span>
                                    <input type="text" id="viz-pattern" placeholder="(a|b)*c+">
                                    <span class="regex-delimiter">/</span>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="app.visualizeRegex()">Visualize</button>
                            
                            <div style="margin-top: 2rem; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 0.5rem;">
                                <h4 style="margin-bottom: 1rem;">Legend</h4>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.9rem;">
                                    <div><span class="regex-token token-literal">abc</span> Literal text</div>
                                    <div><span class="regex-token token-anchor">^$</span> Anchors</div>
                                    <div><span class="regex-token token-quantifier">*+?</span> Quantifiers</div>
                                    <div><span class="regex-token token-charclass">[a-z]</span> Character class</div>
                                    <div><span class="regex-token token-group">()</span> Grouping</div>
                                    <div><span class="regex-token token-escape">\d</span> Escaped sequence</div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="regex-visualizer" id="viz-output" style="min-height: 300px;">
                                <p style="color: var(--text-muted); text-align: center; margin-top: 6rem;">
                                    Enter a pattern to visualize
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        class RegexAcademy {
            constructor() {
                this.xp = parseInt(localStorage.getItem('regex_xp')) || 0;
                this.completedChallenges = JSON.parse(localStorage.getItem('regex_challenges')) || [];
                this.currentFlags = 'g';
                this.currentSection = 'playground';
                this.init();
            }

            init() {
                this.updateXPDisplay();
                this.setupEventListeners();
                this.setupTooltip();
                
                // Auto-run on load with example
                document.getElementById('regex-pattern').value = '\\b\\w+@\\w+\\.\\w+\\b';
                this.runRegex();
            }

            setupEventListeners() {
                // Live regex input
                const patternInput = document.getElementById('regex-pattern');
                const testString = document.getElementById('test-string');
                
                if(patternInput) {
                    patternInput.addEventListener('input', () => this.runRegex());
                }
                if(testString) {
                    testString.addEventListener('input', () => this.runRegex());
                }
            }

            setupTooltip() {
                const tooltip = document.getElementById('tooltip');
                document.addEventListener('mousemove', (e) => {
                    if(e.target.classList.contains('regex-token')) {
                        tooltip.textContent = e.target.dataset.tooltip || 'Regex component';
                        tooltip.style.left = e.clientX + 10 + 'px';
                        tooltip.style.top = e.clientY + 10 + 'px';
                        tooltip.classList.add('show');
                    } else {
                        tooltip.classList.remove('show');
                    }
                });
            }

            navigate(section) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                
                // Show target section
                document.getElementById(`section-${section}`).classList.remove('hidden');
                
                // Update nav
                event.target.closest('.nav-item').classList.add('active');
                
                // Update title
                const titles = {
                    'playground': 'Regex Playground',
                    'syntax': 'Syntax Guide',
                    'methods': 'JavaScript Methods',
                    'patterns': 'Common Patterns',
                    'challenges': 'Coding Challenges',
                    'quiz': 'Quiz Arena',
                    'pitfalls': 'Pitfalls & Bugs',
                    'visualizer': 'Visualizer'
                };
                document.getElementById('page-title').textContent = titles[section];
                
                this.currentSection = section;
            }

            switchTab(tabName) {
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                
                // Show selected
                document.getElementById(`tab-${tabName}`).classList.add('active');
                event.target.classList.add('active');
            }

            toggleFlag(flag) {
                const toggle = event.currentTarget;
                const checkbox = toggle.querySelector('input');
                
                if(this.currentFlags.includes(flag)) {
                    this.currentFlags = this.currentFlags.replace(flag, '');
                    toggle.classList.remove('active');
                    checkbox.checked = false;
                } else {
                    this.currentFlags += flag;
                    toggle.classList.add('active');
                    checkbox.checked = true;
                }
                
                document.getElementById('regex-flags-display').textContent = '/' + this.currentFlags;
                this.runRegex();
            }

            runRegex() {
                const pattern = document.getElementById('regex-pattern').value;
                const text = document.getElementById('test-string').value;
                
                if(!pattern) {
                    document.getElementById('visualizer').innerHTML = '<p style="color: var(--text-muted); text-align: center;">Enter a pattern...</p>';
                    return;
                }

                try {
                    const regex = new RegExp(pattern, this.currentFlags);
                    
                    // Update visualizer
                    this.visualizePattern(pattern);
                    
                    // Run matches
                    let matches = [];
                    let match;
                    
                    if(this.currentFlags.includes('g')) {
                        while((match = regex.exec(text)) !== null) {
                            if(match.index === regex.lastIndex) regex.lastIndex++;
                            matches.push({
                                text: match[0],
                                index: match.index,
                                groups: match.slice(1)
                            });
                        }
                    } else {
                        match = regex.exec(text);
                        if(match) {
                            matches.push({
                                text: match[0],
                                index: match.index,
                                groups: match.slice(1)
                            });
                        }
                    }

                    // Display results
                    this.displayMatches(text, matches);
                    this.displayMethodResults(regex, text);

                } catch(e) {
                    document.getElementById('visualizer').innerHTML = 
                        `<span style="color: var(--danger);">Invalid Regex: ${e.message}</span>`;
                    document.getElementById('match-results').innerHTML = 
                        '<span style="color: var(--danger);">Syntax Error</span>';
                }
            }

            visualizePattern(pattern) {
                const container = document.getElementById('visualizer');
                container.innerHTML = '';
                
                // Simple tokenizer for visualization
                const tokens = this.tokenizeRegex(pattern);
                tokens.forEach(token => {
                    const span = document.createElement('span');
                    span.className = `regex-token token-${token.type}`;
                    span.textContent = token.value;
                    span.dataset.tooltip = token.description;
                    container.appendChild(span);
                });
            }

            tokenizeRegex(pattern) {
                const tokens = [];
                let i = 0;
                
                const descriptions = {
                    '^': 'Start of string anchor',
                    '$': 'End of string anchor',
                    '.': 'Any character (except newline)',
                    '*': '0 or more (greedy)',
                    '+': '1 or more (greedy)',
                    '?': '0 or 1 (optional)',
                    '*?': '0 or more (lazy)',
                    '+?': '1 or more (lazy)',
                    '??': '0 or 1 (lazy)',
                    '|': 'Alternation (OR)',
                    '\\d': 'Digit [0-9]',
                    '\\w': 'Word character [a-zA-Z0-9_]',
                    '\\s': 'Whitespace',
                    '\\b': 'Word boundary',
                    '\\D': 'Non-digit',
                    '\\W': 'Non-word',
                    '\\S': 'Non-whitespace'
                };

                while(i < pattern.length) {
                    let char = pattern[i];
                    let next = pattern[i+1] || '';
                    
                    // Check for escaped characters
                    if(char === '\\') {
                        const escape = char + next;
                        if(descriptions[escape]) {
                            tokens.push({type: 'escape', value: escape, description: descriptions[escape]});
                            i += 2;
                            continue;
                        }
                    }
                    
                    // Check for quantifiers with ?
                    if(['*', '+', '?'].includes(char) && next === '?') {
                        tokens.push({type: 'quantifier', value: char+'?', description: descriptions[char+'?']});
                        i += 2;
                        continue;
                    }
                    
                    // Single char tokens
                    if(['^', '$', '.', '*', '+', '?', '|'].includes(char)) {
                        tokens.push({
                            type: char === '^' || char === '$' ? 'anchor' : 
                                  ['*', '+', '?'].includes(char) ? 'quantifier' : 'literal',
                            value: char,
                            description: descriptions[char] || 'Special character'
                        });
                        i++;
                        continue;
                    }
                    
                    // Character classes
                    if(char === '[') {
                        let end = pattern.indexOf(']', i);
                        if(end === -1) end = pattern.length;
                        const content = pattern.slice(i, end+1);
                        tokens.push({
                            type: 'charclass',
                            value: content,
                            description: 'Character class: match any char inside'
                        });
                        i = end + 1;
                        continue;
                    }
                    
                    // Groups
                    if(char === '(') {
                        let end = this.findClosingParen(pattern, i);
                        if(end === -1) end = pattern.length;
                        const content = pattern.slice(i, end+1);
                        const type = content.startsWith('(?:') ? 'non-capturing group' :
                                    content.startsWith('(?<') ? 'named capturing group' :
                                    content.startsWith('(?=') || content.startsWith('(?!') ? 'lookahead' :
                                    content.startsWith('(?<=') || content.startsWith('(?<!') ? 'lookbehind' :
                                    'capturing group';
                        tokens.push({
                            type: 'group',
                            value: content,
                            description: type
                        });
                        i = end + 1;
                        continue;
                    }
                    
                    // Literals
                    tokens.push({
                        type: 'literal',
                        value: char,
                        description: `Literal character "${char}"`
                    });
                    i++;
                }
                
                return tokens;
            }

            findClosingParen(str, start) {
                let count = 1;
                let i = start + 1;
                while(i < str.length && count > 0) {
                    if(str[i] === '(' && str[i-1] !== '\\') count++;
                    if(str[i] === ')' && str[i-1] !== '\\') count--;
                    i++;
                }
                return count === 0 ? i-1 : -1;
            }

            displayMatches(text, matches) {
                const container = document.getElementById('match-results');
                if(matches.length === 0) {
                    container.innerHTML = '<span style="color: var(--text-muted);">No matches found</span>';
                    return;
                }

                let html = '';
                let lastIndex = 0;
                
                matches.forEach((match, idx) => {
                    html += text.slice(lastIndex, match.index);
                    html += `<mark class="match-highlight" title="Match ${idx+1}: ${match.text}">${match.text}</mark>`;
                    lastIndex = match.index + match.text.length;
                });
                html += text.slice(lastIndex);
                
                container.innerHTML = html;
            }

            displayMethodResults(regex, text) {
                // Reset lastIndex for test
                regex.lastIndex = 0;
                document.getElementById('result-test').textContent = regex.test(text);
                
                const match = text.match(regex);
                document.getElementById('result-match').textContent = match ? 
                    `[${match.slice(0, 3).join(', ')}${match.length > 3 ? '...' : ''}]` : 'null';
                
                const split = text.split(regex);
                document.getElementById('result-split').textContent = 
                    `[${split.slice(0, 3).map(s => `"${s}"`).join(', ')}${split.length > 3 ? '...' : ''}]`;
            }

            tryPattern(pattern) {
                this.navigate('playground');
                document.getElementById('regex-pattern').value = pattern;
                this.runRegex();
                
                // Scroll to playground
                document.getElementById('section-playground').scrollIntoView({behavior: 'smooth'});
            }

            runChallenge(num) {
                const input = document.getElementById(`challenge-${num}-input`).value;
                const testCases = document.querySelectorAll(`[data-challenge="${num}"] .test-case`);
                let allPassed = true;

                try {
                    const regex = new RegExp(input, num === 1 ? 'g' : '');

                    testCases.forEach(tc => {
                        const text = tc.dataset.input;
                        const expected = tc.dataset.expected;
                        const shouldMatch = tc.dataset.match === 'true';
                        
                        let passed = false;
                        
                        if(num === 1) {
                            // Extraction challenge
                            const matches = text.match(regex) || [];
                            const expectedArr = JSON.parse(expected);
                            passed = JSON.stringify(matches) === JSON.stringify(expectedArr);
                        } else {
                            // Validation challenge
                            const result = regex.test(text);
                            passed = result === shouldMatch;
                        }

                        tc.className = 'test-case ' + (passed ? 'pass' : 'fail');
                        tc.querySelector('.status-icon').textContent = passed ? '‚úÖ' : '‚ùå';
                        tc.querySelector('.status-icon').className = 'status-icon ' + (passed ? 'pass' : 'fail');
                        
                        if(!passed) allPassed = false;
                    });

                    if(allPassed) {
                        this.addXP(50);
                        if(!this.completedChallenges.includes(num)) {
                            this.completedChallenges.push(num);
                            localStorage.setItem('regex_challenges', JSON.stringify(this.completedChallenges));
                            document.getElementById('challenge-badge').textContent = `${this.completedChallenges.length}/5`;
                        }
                        
                        // Show next button
                        const nextBtn = document.getElementById(`challenge-${num}-next`);
                        if(nextBtn) nextBtn.classList.remove('hidden');
                        
                        // Confetti effect
                        this.confetti();
                    }

                } catch(e) {
                    alert('Invalid regex: ' + e.message);
                }
            }

            nextChallenge(num) {
                document.querySelectorAll('.challenge-item').forEach(c => c.classList.add('hidden'));
                document.querySelector(`[data-challenge="${num}"]`).classList.remove('hidden');
            }

            answerQuiz(question, answer, correct) {
                const buttons = document.querySelectorAll(`[data-question="${question}"] .quiz-option`);
                buttons.forEach(btn => {
                    btn.disabled = true;
                    if(btn === event.target) {
                        btn.classList.add(correct ? 'correct' : 'wrong');
                    }
                });

                document.getElementById(`explanation-${question}`).classList.add('show');

                if(correct) {
                    this.addXP(25);
                    
                    // Show next question after delay
                    setTimeout(() => {
                        const next = document.querySelector(`[data-question="${question + 1}"]`);
                        if(next) {
                            next.classList.remove('hidden');
                            next.scrollIntoView({behavior: 'smooth'});
                        } else {
                            // Quiz complete
                            document.getElementById('quiz-score').style.display = 'block';
                            this.confetti();
                        }
                    }, 1500);
                }
            }

            visualizeRegex() {
                const pattern = document.getElementById('viz-pattern').value;
                if(!pattern) return;
                
                const output = document.getElementById('viz-output');
                output.innerHTML = '';
                
                // Create a more detailed visualization
                const explanation = document.createElement('div');
                explanation.style.marginBottom = '1rem';
                explanation.style.color = 'var(--text-muted)';
                
                try {
                    new RegExp(pattern);
                    explanation.textContent = 'Pattern structure analysis:';
                    output.appendChild(explanation);
                    
                    const tokens = this.tokenizeRegex(pattern);
                    const flow = document.createElement('div');
                    flow.style.display = 'flex';
                    flow.style.flexWrap = 'wrap';
                    flow.style.alignItems = 'center';
                    flow.style.gap = '0.5rem';
                    
                    // Add start anchor visual
                    const start = document.createElement('div');
                    start.textContent = 'START';
                    start.style.cssText = 'padding: 0.5rem; background: var(--bg-hover); border-radius: 0.25rem; font-size: 0.8rem;';
                    flow.appendChild(start);
                    
                    tokens.forEach((token, i) => {
                        const box = document.createElement('div');
                        box.className = `regex-token token-${token.type}`;
                        box.textContent = token.value;
                        box.style.padding = '1rem';
                        box.style.fontSize = '1.2rem';
                        box.dataset.tooltip = token.description;
                        
                        // Add arrow
                        if(i < tokens.length - 1) {
                            const arrow = document.createElement('span');
                            arrow.textContent = '‚Üí';
                            arrow.style.color = 'var(--text-muted)';
                            flow.appendChild(box);
                            flow.appendChild(arrow);
                        } else {
                            flow.appendChild(box);
                        }
                    });
                    
                    // Add end anchor visual
                    const end = document.createElement('div');
                    end.textContent = 'END';
                    end.style.cssText = 'padding: 0.5rem; background: var(--bg-hover); border-radius: 0.25rem; font-size: 0.8rem;';
                    flow.appendChild(end);
                    
                    output.appendChild(flow);
                    
                    // Add explanation text
                    const details = document.createElement('div');
                    details.style.marginTop = '2rem';
                    details.style.padding = '1rem';
                    details.style.background = 'rgba(0,0,0,0.2)';
                    details.style.borderRadius = '0.5rem';
                    details.innerHTML = '<h4 style="margin-bottom: 0.5rem;">How it works:</h4>';
                    
                    let description = [];
                    tokens.forEach(token => {
                        description.push(`<span class="regex-token token-${token.type}">${token.value}</span>: ${token.description}`);
                    });
                    
                    details.innerHTML += '<ul style="margin-left: 1.5rem; line-height: 2;">' + 
                        description.map(d => `<li>${d}</li>`).join('') + 
                        '</ul>';
                    
                    output.appendChild(details);
                    
                } catch(e) {
                    output.innerHTML = `<span style="color: var(--danger);">Error: ${e.message}</span>`;
                }
            }

            addXP(amount) {
                this.xp += amount;
                localStorage.setItem('regex_xp', this.xp);
                this.updateXPDisplay();
                
                // Animate XP
                const display = document.getElementById('xp-display');
                display.style.transform = 'scale(1.5)';
                display.style.color = '#fbbf24';
                setTimeout(() => {
                    display.style.transform = 'scale(1)';
                    display.style.color = 'var(--warning)';
                }, 300);
            }

            updateXPDisplay() {
                document.getElementById('xp-display').textContent = this.xp + ' XP';
                document.getElementById('challenge-badge').textContent = `${this.completedChallenges.length}/5`;
                
                // Update progress bar (max 500 XP for demo)
                const progress = Math.min((this.xp / 500) * 100, 100);
                document.getElementById('global-progress').style.width = progress + '%';
            }

            confetti() {
                for(let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = ['#38bdf8', '#34d399', '#fbbf24', '#f87171'][Math.floor(Math.random() * 4)];
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 4000);
                }
            }
        }

        const app = new RegexAcademy();
    </script>
</body>
</html>