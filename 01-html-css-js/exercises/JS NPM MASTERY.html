<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NPM Mastery - Interactive Learning Hub</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--bg:#0b0e17;--bg2:#121829;--bg3:#1a2035;--bg4:#222940;
--accent:#6c5ce7;--accent2:#a29bfe;--accent3:#00cec9;
--green:#00b894;--red:#e17055;--orange:#fdcb6e;--pink:#fd79a8;
--text:#e4e6ef;--text2:#9ea3b5;--text3:#6b7280;
--radius:12px;--shadow:0 4px 24px rgba(0,0,0,.4);
}
body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);overflow:hidden;height:100vh}
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:var(--bg2)}
::-webkit-scrollbar-thumb{background:var(--accent);border-radius:3px}

.app{display:flex;height:100vh}

/* Sidebar */
.sidebar{width:280px;background:var(--bg2);border-right:1px solid var(--bg4);display:flex;flex-direction:column;flex-shrink:0}
.sidebar-header{padding:20px;border-bottom:1px solid var(--bg4);text-align:center}
.sidebar-header h1{font-size:1.3em;background:linear-gradient(135deg,var(--accent),var(--accent3));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px}
.sidebar-header p{font-size:.75em;color:var(--text2)}
.xp-bar-container{margin-top:12px;background:var(--bg);border-radius:20px;padding:3px;position:relative}
.xp-bar{height:20px;background:linear-gradient(90deg,var(--accent),var(--accent3));border-radius:17px;transition:width .6s ease;min-width:20px;display:flex;align-items:center;justify-content:center;font-size:.65em;font-weight:700}
.xp-label{font-size:.7em;color:var(--text2);margin-top:4px;text-align:right}
.chapter-list{flex:1;overflow-y:auto;padding:10px}
.chapter-btn{width:100%;padding:12px 16px;background:none;border:none;color:var(--text2);text-align:left;cursor:pointer;border-radius:8px;margin-bottom:4px;display:flex;align-items:center;gap:10px;transition:all .2s;font-size:.85em;position:relative}
.chapter-btn:hover{background:var(--bg3);color:var(--text)}
.chapter-btn.active{background:linear-gradient(135deg,rgba(108,92,231,.2),rgba(0,206,201,.1));color:var(--text);border-left:3px solid var(--accent)}
.chapter-btn .ch-icon{font-size:1.2em;width:28px;text-align:center}
.chapter-btn .ch-check{margin-left:auto;color:var(--green);font-size:1em;opacity:0;transition:.2s}
.chapter-btn.completed .ch-check{opacity:1}
.chapter-btn .ch-num{font-size:.6em;background:var(--bg4);padding:2px 6px;border-radius:4px;margin-left:auto}
.sidebar-footer{padding:15px;border-top:1px solid var(--bg4);text-align:center}
.sidebar-footer .stats{display:flex;justify-content:space-around;font-size:.75em;color:var(--text2)}
.stats span{display:flex;flex-direction:column;align-items:center;gap:2px}
.stats .stat-num{font-size:1.3em;font-weight:700;color:var(--accent2)}

/* Main Content */
.main{flex:1;overflow-y:auto;scroll-behavior:smooth}
.chapter-content{display:none;padding:30px 40px 60px;max-width:900px;margin:0 auto;animation:fadeIn .4s ease}
.chapter-content.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
.chapter-title{font-size:2em;margin-bottom:8px;background:linear-gradient(135deg,var(--accent2),var(--accent3));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.chapter-subtitle{color:var(--text2);margin-bottom:30px;font-size:1em}

/* Content Elements */
.section{margin-bottom:40px}
.section h3{font-size:1.3em;margin-bottom:15px;color:var(--accent2);display:flex;align-items:center;gap:8px}
.section p{line-height:1.7;color:var(--text2);margin-bottom:12px}
.highlight{color:var(--accent3);font-weight:600}
.highlight2{color:var(--orange);font-weight:600}
.highlight3{color:var(--pink);font-weight:600}

/* Cards */
.card{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:20px;margin-bottom:16px;transition:all .3s}
.card:hover{border-color:var(--accent);box-shadow:0 0 20px rgba(108,92,231,.1)}
.card h4{color:var(--text);margin-bottom:10px;display:flex;align-items:center;gap:8px}
.card p{color:var(--text2);font-size:.9em}
.card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:20px}
.mini-card{background:var(--bg3);border:1px solid var(--bg4);border-radius:10px;padding:16px;text-align:center;transition:.3s}
.mini-card:hover{transform:translateY(-3px);border-color:var(--accent)}
.mini-card .mc-icon{font-size:2em;margin-bottom:8px}
.mini-card h5{color:var(--text);margin-bottom:6px}
.mini-card p{color:var(--text2);font-size:.8em}

/* Code Blocks */
.code-block{background:#0d1117;border:1px solid var(--bg4);border-radius:10px;margin:16px 0;overflow:hidden}
.code-header{background:var(--bg4);padding:8px 16px;display:flex;justify-content:space-between;align-items:center;font-size:.8em;color:var(--text2)}
.code-header .lang{color:var(--accent3);font-weight:600}
.code-header .copy-btn{background:none;border:1px solid var(--text3);color:var(--text2);padding:3px 10px;border-radius:5px;cursor:pointer;font-size:.85em;transition:.2s}
.code-header .copy-btn:hover{border-color:var(--accent);color:var(--accent2)}
.code-body{padding:16px 20px;font-family:'Fira Code',monospace;font-size:.85em;line-height:1.6;overflow-x:auto;white-space:pre;color:#c9d1d9}
.code-body .kw{color:#ff7b72}
.code-body .str{color:#a5d6ff}
.code-body .num{color:#79c0ff}
.code-body .cmt{color:#8b949e;font-style:italic}
.code-body .prop{color:#d2a8ff}
.code-body .fn{color:#d2a8ff}
.code-body .val{color:#7ee787}
.code-body .cmd{color:#ffa657}
.code-body .flag{color:#79c0ff}

/* Terminal */
.terminal{background:#0d1117;border:1px solid var(--bg4);border-radius:10px;margin:16px 0;overflow:hidden;font-family:'Fira Code',monospace}
.terminal-header{background:#1c2130;padding:8px 16px;display:flex;align-items:center;gap:8px}
.terminal-dot{width:12px;height:12px;border-radius:50%}
.terminal-dot.r{background:#ff5f56}.terminal-dot.y{background:#ffbd2e}.terminal-dot.g{background:#27c93f}
.terminal-header span{color:var(--text2);font-size:.8em;margin-left:8px}
.terminal-body{padding:16px 20px;font-size:.85em;line-height:1.8;min-height:120px;max-height:300px;overflow-y:auto}
.terminal-line{display:flex;gap:8px;margin-bottom:2px;flex-wrap:wrap}
.terminal-prompt{color:var(--green);white-space:nowrap}
.terminal-cmd{color:var(--text)}
.terminal-output{color:var(--text2);padding-left:0;white-space:pre-wrap;width:100%}
.terminal-input-line{display:flex;align-items:center;gap:8px;margin-top:4px}
.terminal-input{background:none;border:none;color:var(--text);font-family:inherit;font-size:inherit;outline:none;flex:1;caret-color:var(--accent3)}
.terminal-error{color:var(--red)}
.terminal-success{color:var(--green)}
.terminal-warn{color:var(--orange)}

/* Quizzes */
.quiz-box{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:24px;margin:20px 0}
.quiz-box h4{color:var(--accent2);margin-bottom:6px;display:flex;align-items:center;gap:8px}
.quiz-box .q-label{font-size:.7em;background:var(--accent);color:#fff;padding:2px 8px;border-radius:4px}
.quiz-question{color:var(--text);margin:12px 0;font-size:1em;line-height:1.5}
.quiz-options{display:flex;flex-direction:column;gap:8px;margin:16px 0}
.quiz-option{padding:12px 16px;background:var(--bg3);border:2px solid var(--bg4);border-radius:8px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:10px;font-size:.9em}
.quiz-option:hover{border-color:var(--accent);background:rgba(108,92,231,.1)}
.quiz-option.selected{border-color:var(--accent);background:rgba(108,92,231,.15)}
.quiz-option.correct{border-color:var(--green)!important;background:rgba(0,184,148,.15)!important}
.quiz-option.wrong{border-color:var(--red)!important;background:rgba(225,112,85,.15)!important}
.quiz-option .opt-letter{width:28px;height:28px;border-radius:50%;background:var(--bg4);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8em;flex-shrink:0;transition:.2s}
.quiz-option.correct .opt-letter{background:var(--green);color:#fff}
.quiz-option.wrong .opt-letter{background:var(--red);color:#fff}
.quiz-submit{padding:10px 24px;background:linear-gradient(135deg,var(--accent),#5a4bd1);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:.9em;font-weight:600;transition:.3s;margin-top:8px}
.quiz-submit:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(108,92,231,.4)}
.quiz-submit:disabled{opacity:.5;cursor:not-allowed;transform:none}
.quiz-feedback{margin-top:12px;padding:12px 16px;border-radius:8px;font-size:.9em;display:none;line-height:1.5}
.quiz-feedback.show{display:block;animation:fadeIn .3s}
.quiz-feedback.correct{background:rgba(0,184,148,.15);border:1px solid var(--green);color:var(--green)}
.quiz-feedback.wrong{background:rgba(225,112,85,.15);border:1px solid var(--red);color:var(--red)}

/* Exercises */
.exercise-box{background:linear-gradient(135deg,rgba(108,92,231,.08),rgba(0,206,201,.08));border:1px solid var(--accent);border-radius:var(--radius);padding:24px;margin:20px 0}
.exercise-box h4{color:var(--accent3);margin-bottom:10px}
.exercise-input{width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--bg4);border-radius:8px;color:var(--text);font-family:'Fira Code',monospace;font-size:.85em;outline:none;transition:.2s;margin:8px 0}
.exercise-input:focus{border-color:var(--accent)}
.exercise-input::placeholder{color:var(--text3)}
.exercise-check{padding:8px 20px;background:var(--accent3);color:var(--bg);border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:.85em;transition:.2s;margin-top:4px}
.exercise-check:hover{opacity:.9}
.exercise-result{margin-top:10px;font-size:.85em;padding:8px 12px;border-radius:6px;display:none}
.exercise-result.show{display:block;animation:fadeIn .3s}
.exercise-result.correct{background:rgba(0,184,148,.15);color:var(--green)}
.exercise-result.wrong{background:rgba(225,112,85,.15);color:var(--red)}

/* Pitfall Box */
.pitfall{background:rgba(225,112,85,.08);border-left:4px solid var(--red);border-radius:0 10px 10px 0;padding:16px 20px;margin:16px 0}
.pitfall h4{color:var(--red);margin-bottom:8px;display:flex;align-items:center;gap:8px;font-size:.95em}
.pitfall p{color:var(--text2);font-size:.88em;line-height:1.6}
.pitfall code{background:rgba(225,112,85,.15);color:var(--red);padding:2px 6px;border-radius:4px;font-size:.9em}

/* Tip Box */
.tip{background:rgba(0,184,148,.08);border-left:4px solid var(--green);border-radius:0 10px 10px 0;padding:16px 20px;margin:16px 0}
.tip h4{color:var(--green);margin-bottom:8px;display:flex;align-items:center;gap:8px;font-size:.95em}
.tip p{color:var(--text2);font-size:.88em;line-height:1.6}
.tip code{background:rgba(0,184,148,.15);color:var(--green);padding:2px 6px;border-radius:4px;font-size:.9em}

/* Info Box */
.info{background:rgba(108,92,231,.08);border-left:4px solid var(--accent);border-radius:0 10px 10px 0;padding:16px 20px;margin:16px 0}
.info h4{color:var(--accent2);margin-bottom:8px;display:flex;align-items:center;gap:8px;font-size:.95em}
.info p{color:var(--text2);font-size:.88em;line-height:1.6}
.info code{background:rgba(108,92,231,.15);color:var(--accent2);padding:2px 6px;border-radius:4px;font-size:.9em}

/* Diagram */
.diagram{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:24px;margin:16px 0;text-align:center}
.diagram-title{font-size:.8em;color:var(--text2);margin-bottom:16px;text-transform:uppercase;letter-spacing:1px}
.flow-row{display:flex;align-items:center;justify-content:center;gap:12px;margin:12px 0;flex-wrap:wrap}
.flow-box{background:var(--bg3);border:2px solid var(--accent);border-radius:10px;padding:12px 20px;font-size:.85em;color:var(--text);position:relative;min-width:120px}
.flow-box.green{border-color:var(--green)}
.flow-box.orange{border-color:var(--orange)}
.flow-box.pink{border-color:var(--pink)}
.flow-box.cyan{border-color:var(--accent3)}
.flow-arrow{color:var(--accent2);font-size:1.5em}
.flow-arrow-down{color:var(--accent2);font-size:1.5em;display:block;text-align:center;margin:4px 0}

/* Semver Playground */
.semver-playground{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:24px;margin:16px 0}
.semver-display{display:flex;align-items:center;justify-content:center;gap:4px;margin:20px 0}
.semver-part{text-align:center}
.semver-part label{display:block;font-size:.7em;color:var(--text2);margin-bottom:6px;text-transform:uppercase;letter-spacing:1px}
.semver-part input{width:70px;height:50px;background:var(--bg);border:2px solid var(--bg4);border-radius:8px;color:var(--text);font-size:1.5em;text-align:center;outline:none;font-weight:700;font-family:inherit}
.semver-part input:focus{border-color:var(--accent)}
.semver-dot{font-size:2em;color:var(--text2);margin-top:20px}
.semver-result{margin-top:16px;padding:16px;background:var(--bg);border-radius:8px;font-size:.9em}
.range-example{display:inline-block;background:var(--bg3);border:1px solid var(--bg4);padding:4px 10px;border-radius:6px;margin:4px;font-family:'Fira Code',monospace;font-size:.85em;cursor:pointer;transition:.2s}
.range-example:hover{border-color:var(--accent);background:rgba(108,92,231,.15)}
.range-example.match{border-color:var(--green);background:rgba(0,184,148,.15);color:var(--green)}
.range-example.no-match{border-color:var(--red);background:rgba(225,112,85,.15);color:var(--red)}

/* Drag & Drop */
.drag-container{display:flex;gap:20px;margin:16px 0;flex-wrap:wrap}
.drag-source{flex:1;min-width:200px;background:var(--bg3);border:1px solid var(--bg4);border-radius:10px;padding:16px}
.drag-target{flex:1;min-width:200px;background:var(--bg3);border:1px solid var(--bg4);border-radius:10px;padding:16px}
.drag-source h5,.drag-target h5{color:var(--text2);margin-bottom:12px;font-size:.8em;text-transform:uppercase;letter-spacing:1px}
.drag-item{background:var(--bg);border:1px solid var(--bg4);border-radius:6px;padding:8px 12px;margin-bottom:6px;cursor:grab;font-size:.85em;transition:.2s;user-select:none}
.drag-item:hover{border-color:var(--accent)}
.drag-item:active{cursor:grabbing}
.drag-item.dragging{opacity:.5}
.drop-zone{min-height:40px;border:2px dashed var(--bg4);border-radius:6px;padding:8px;margin-bottom:8px;transition:.2s}
.drop-zone.over{border-color:var(--accent);background:rgba(108,92,231,.1)}
.drop-zone .label{font-size:.75em;color:var(--text3);margin-bottom:4px}

/* Accordion */
.accordion{border:1px solid var(--bg4);border-radius:10px;margin:12px 0;overflow:hidden}
.accordion-header{padding:14px 18px;background:var(--bg3);cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:.2s;font-size:.95em}
.accordion-header:hover{background:var(--bg4)}
.accordion-header .arr{transition:transform .3s}
.accordion-header.open .arr{transform:rotate(180deg)}
.accordion-body{padding:0 18px;max-height:0;overflow:hidden;transition:max-height .3s ease,padding .3s}
.accordion-body.open{max-height:1000px;padding:14px 18px}

/* Table */
.data-table{width:100%;border-collapse:collapse;margin:16px 0;font-size:.85em}
.data-table th{background:var(--bg3);padding:10px 14px;text-align:left;color:var(--accent2);border-bottom:2px solid var(--accent);font-weight:600}
.data-table td{padding:10px 14px;border-bottom:1px solid var(--bg4);color:var(--text2)}
.data-table tr:hover td{background:rgba(108,92,231,.05)}
.data-table code{background:var(--bg);padding:2px 6px;border-radius:4px;color:var(--accent3);font-size:.95em}

/* Inline code */
code{background:var(--bg3);color:var(--accent2);padding:2px 6px;border-radius:4px;font-family:'Fira Code',monospace;font-size:.88em}

/* Nav buttons */
.nav-buttons{display:flex;justify-content:space-between;margin-top:40px;padding-top:20px;border-top:1px solid var(--bg4)}
.nav-btn{padding:12px 28px;border-radius:8px;border:none;cursor:pointer;font-size:.9em;font-weight:600;transition:.3s;display:flex;align-items:center;gap:8px}
.nav-btn.prev{background:var(--bg3);color:var(--text);border:1px solid var(--bg4)}
.nav-btn.prev:hover{border-color:var(--accent)}
.nav-btn.next{background:linear-gradient(135deg,var(--accent),#5a4bd1);color:#fff}
.nav-btn.next:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(108,92,231,.4)}

/* Confetti */
.confetti-piece{position:fixed;width:10px;height:10px;top:-10px;animation:confettiFall 3s ease-in forwards;z-index:9999;border-radius:2px}
@keyframes confettiFall{
0%{transform:translateY(0) rotate(0deg);opacity:1}
100%{transform:translateY(100vh) rotate(720deg);opacity:0}
}

/* Toast */
.toast{position:fixed;bottom:30px;right:30px;padding:14px 24px;border-radius:10px;color:#fff;font-size:.9em;font-weight:600;z-index:9999;animation:toastIn .4s ease,toastOut .4s ease 2.6s forwards;display:flex;align-items:center;gap:8px}
.toast.success{background:linear-gradient(135deg,var(--green),#00a382)}
.toast.error{background:linear-gradient(135deg,var(--red),#c44569)}
.toast.info{background:linear-gradient(135deg,var(--accent),#5a4bd1)}
@keyframes toastIn{from{transform:translateX(120%)}to{transform:translateX(0)}}
@keyframes toastOut{from{transform:translateX(0);opacity:1}to{transform:translateX(120%);opacity:0}}

/* Package.json builder */
.builder-field{display:flex;align-items:center;gap:12px;margin:8px 0;padding:8px;border-radius:6px;transition:.2s}
.builder-field:hover{background:var(--bg3)}
.builder-field label{width:120px;font-size:.85em;color:var(--text2);flex-shrink:0}
.builder-field input,.builder-field select{flex:1;padding:8px 12px;background:var(--bg);border:1px solid var(--bg4);border-radius:6px;color:var(--text);font-family:'Fira Code',monospace;font-size:.85em;outline:none;transition:.2s}
.builder-field input:focus,.builder-field select:focus{border-color:var(--accent)}
.builder-output{background:#0d1117;border:1px solid var(--bg4);border-radius:10px;padding:20px;font-family:'Fira Code',monospace;font-size:.85em;line-height:1.6;color:#c9d1d9;white-space:pre;overflow-x:auto;margin-top:16px}

/* Responsive */
@media(max-width:768px){
.sidebar{width:60px}
.sidebar .ch-text,.sidebar-header p,.sidebar-header h1,.xp-bar-container,.xp-label,.sidebar-footer .stats span:last-child,.ch-num{display:none!important}
.chapter-btn{justify-content:center;padding:12px 8px}
.chapter-btn .ch-icon{margin:0}
.chapter-content{padding:20px}
.chapter-title{font-size:1.5em}
.card-grid{grid-template-columns:1fr}
.drag-container{flex-direction:column}
.flow-row{flex-direction:column}
.flow-arrow{transform:rotate(90deg)}
}

/* Tabs */
.tabs{display:flex;gap:4px;margin:16px 0;flex-wrap:wrap}
.tab-btn{padding:8px 16px;background:var(--bg3);border:1px solid var(--bg4);border-radius:8px 8px 0 0;cursor:pointer;color:var(--text2);font-size:.85em;transition:.2s;border-bottom:none}
.tab-btn:hover{color:var(--text)}
.tab-btn.active{background:var(--bg2);color:var(--accent2);border-color:var(--accent)}
.tab-content{display:none;border:1px solid var(--bg4);border-radius:0 10px 10px 10px;padding:16px;background:var(--bg2)}
.tab-content.active{display:block}

/* Badge */
.badge{display:inline-block;padding:3px 10px;border-radius:12px;font-size:.7em;font-weight:700;text-transform:uppercase;letter-spacing:.5px}
.badge.new{background:rgba(0,206,201,.15);color:var(--accent3)}
.badge.important{background:rgba(225,112,85,.15);color:var(--red)}
.badge.pro{background:rgba(108,92,231,.15);color:var(--accent2)}

/* Progress dots */
.progress-dots{display:flex;gap:6px;margin:12px 0}
.progress-dot{width:8px;height:8px;border-radius:50%;background:var(--bg4);transition:.3s}
.progress-dot.filled{background:var(--accent)}
.progress-dot.current{background:var(--accent3);box-shadow:0 0 8px var(--accent3)}

/* Tooltip */
.tooltip-container{position:relative;display:inline-block;cursor:help;border-bottom:1px dashed var(--accent2)}
.tooltip-text{visibility:hidden;position:absolute;bottom:125%;left:50%;transform:translateX(-50%);background:var(--bg4);color:var(--text);padding:8px 12px;border-radius:6px;font-size:.8em;white-space:nowrap;z-index:10;opacity:0;transition:.2s}
.tooltip-container:hover .tooltip-text{visibility:visible;opacity:1}
.tooltip-text::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:var(--bg4)}

/* Interactive JSON builder */
.json-builder{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.json-builder .fields{display:flex;flex-direction:column;gap:8px}
.json-builder .preview{position:sticky;top:20px}

@media(max-width:900px){
.json-builder{grid-template-columns:1fr}
}

/* Version match game */
.version-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:8px;margin:12px 0}
.version-cell{padding:8px;background:var(--bg3);border:2px solid var(--bg4);border-radius:6px;text-align:center;font-family:'Fira Code',monospace;font-size:.85em;cursor:pointer;transition:.2s}
.version-cell:hover{border-color:var(--accent)}
.version-cell.match{border-color:var(--green);background:rgba(0,184,148,.1);color:var(--green)}
.version-cell.no-match{border-color:var(--red);background:rgba(225,112,85,.1);color:var(--red)}

.chapter-complete-banner{text-align:center;padding:30px;background:linear-gradient(135deg,rgba(108,92,231,.1),rgba(0,206,201,.1));border:1px solid var(--accent);border-radius:var(--radius);margin:30px 0}
.chapter-complete-banner h3{color:var(--accent2);margin-bottom:8px}
.chapter-complete-banner p{color:var(--text2);font-size:.9em}
</style>
</head>
<body>

<div class="app">
<!-- Sidebar -->
<aside class="sidebar">
<div class="sidebar-header">
<h1>üì¶ NPM Mastery</h1>
<p>Interactive Learning Hub</p>
<div class="xp-bar-container">
<div class="xp-bar" id="xpBar" style="width:5%">0 XP</div>
</div>
<div class="xp-label" id="xpLabel">0 / 1000 XP</div>
</div>
<div class="chapter-list" id="chapterList"></div>
<div class="sidebar-footer">
<div class="stats">
<span><div class="stat-num" id="statCorrect">0</div>Correct</span>
<span><div class="stat-num" id="statStreak">0</div>Streak</span>
<span><div class="stat-num" id="statComplete">0%</div>Done</span>
</span>
</div>
</div>
</aside>

<!-- Main Content -->
<main class="main" id="mainContent">

<!-- ==================== CHAPTER 0: WELCOME ==================== -->
<div class="chapter-content active" id="chapter-0">
<h2 class="chapter-title">Welcome to NPM Mastery! üöÄ</h2>
<p class="chapter-subtitle">Master package management and become job-ready</p>

<div class="section">
<div class="card" style="text-align:center;padding:30px">
<h4>üéØ Your Learning Journey</h4>
<p>8 interactive chapters packed with examples, exercises, quizzes, and real-world scenarios</p>
<div class="progress-dots" style="justify-content:center;margin:20px 0">
<div class="progress-dot current"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
<div class="progress-dot"></div>
</div>
</div>

<div class="card-grid">
<div class="mini-card"><div class="mc-icon">üìù</div><h5>Quizzes</h5><p>Test your knowledge with interactive quizzes</p></div>
<div class="mini-card"><div class="mc-icon">üíª</div><h5>Terminal Sim</h5><p>Practice npm commands in a virtual terminal</p></div>
<div class="mini-card"><div class="mc-icon">üß©</div><h5>Exercises</h5><p>Hands-on fill-in-the-blank challenges</p></div>
<div class="mini-card"><div class="mc-icon">‚ö†Ô∏è</div><h5>Pitfalls</h5><p>Learn common mistakes to avoid</p></div>
<div class="mini-card"><div class="mc-icon">üèÜ</div><h5>XP System</h5><p>Earn XP and track your progress</p></div>
<div class="mini-card"><div class="mc-icon">üéì</div><h5>Job Ready</h5><p>Interview-ready knowledge</p></div>
</div>

<h3>üìö What is NPM?</h3>
<p><span class="highlight">NPM (Node Package Manager)</span> is the world's largest software registry. It consists of three components:</p>

<div class="diagram">
<div class="diagram-title">NPM Ecosystem</div>
<div class="flow-row">
<div class="flow-box">üåê NPM Registry<br><small style="color:var(--text2)">2M+ packages</small></div>
<div class="flow-box green">üíª NPM CLI<br><small style="color:var(--text2)">Command-line tool</small></div>
<div class="flow-box orange">üåç npmjs.com<br><small style="color:var(--text2)">Website & docs</small></div>
</div>
</div>

<p>Every JavaScript developer interacts with NPM daily. Whether you're installing React, running tests, or publishing your own library ‚Äî <span class="highlight2">NPM is at the center of it all.</span></p>

<div class="terminal">
<div class="terminal-header">
<div class="terminal-dot r"></div><div class="terminal-dot y"></div><div class="terminal-dot g"></div>
<span>Terminal</span>
</div>
<div class="terminal-body">
<div class="terminal-line"><span class="terminal-prompt">$</span><span class="terminal-cmd">npm --version</span></div>
<div class="terminal-output">10.2.4</div>
<div class="terminal-line"><span class="terminal-prompt">$</span><span class="terminal-cmd">npm help</span></div>
<div class="terminal-output terminal-success">npm &lt;command&gt;

Usage:
npm install        install all deps from package.json
npm init           create a new package.json
npm publish        publish a package to the registry
npm audit          check for security vulnerabilities
...</div>
</div>
</div>
</div>

<div class="nav-buttons">
<div></div>
<button class="nav-btn next" onclick="goToChapter(1)">Start Learning ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 1: PACKAGE.JSON ==================== -->
<div class="chapter-content" id="chapter-1">
<h2 class="chapter-title">üìÑ Package.json Mastery</h2>
<p class="chapter-subtitle">The heart of every Node.js project</p>

<div class="section">
<h3>üìå What is package.json?</h3>
<p>The <code>package.json</code> file is the <span class="highlight">manifest of your project</span>. It holds metadata, dependencies, scripts, and configuration. Every Node.js project needs one.</p>

<div class="diagram">
<div class="diagram-title">Creating package.json</div>
<div class="flow-row">
<div class="flow-box cyan">npm init</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box">Answer prompts</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box green">package.json ‚úì</div>
</div>
<div style="margin-top:12px;font-size:.85em;color:var(--text2)">Or use <code>npm init -y</code> for instant defaults!</div>
</div>

<h3>üîë Essential Fields</h3>

<table class="data-table">
<thead><tr><th>Field</th><th>Purpose</th><th>Required?</th></tr></thead>
<tbody>
<tr><td><code>name</code></td><td>Package name (lowercase, no spaces)</td><td>‚úÖ Yes</td></tr>
<tr><td><code>version</code></td><td>Current version (semver format)</td><td>‚úÖ Yes</td></tr>
<tr><td><code>description</code></td><td>Brief description of the package</td><td>Recommended</td></tr>
<tr><td><code>main</code></td><td>Entry point file</td><td>Recommended</td></tr>
<tr><td><code>scripts</code></td><td>Runnable commands</td><td>Recommended</td></tr>
<tr><td><code>keywords</code></td><td>Search terms for discovery</td><td>Optional</td></tr>
<tr><td><code>author</code></td><td>Creator name/email</td><td>Optional</td></tr>
<tr><td><code>license</code></td><td>License type (MIT, ISC, etc.)</td><td>Recommended</td></tr>
<tr><td><code>dependencies</code></td><td>Production packages needed</td><td>Auto-managed</td></tr>
<tr><td><code>devDependencies</code></td><td>Development-only packages</td><td>Auto-managed</td></tr>
<tr><td><code>repository</code></td><td>Source code location</td><td>Optional</td></tr>
<tr><td><code>engines</code></td><td>Node/npm version requirements</td><td>Optional</td></tr>
</tbody>
</table>

<h3>üìã Complete Example</h3>
<div class="code-block">
<div class="code-header"><span class="lang">package.json</span></div>
<div class="code-body">{
  <span class="prop">"name"</span>: <span class="str">"my-awesome-app"</span>,
  <span class="prop">"version"</span>: <span class="str">"1.0.0"</span>,
  <span class="prop">"description"</span>: <span class="str">"A web application for managing tasks"</span>,
  <span class="prop">"main"</span>: <span class="str">"src/index.js"</span>,
  <span class="prop">"scripts"</span>: {
    <span class="prop">"start"</span>: <span class="str">"node src/index.js"</span>,
    <span class="prop">"dev"</span>: <span class="str">"nodemon src/index.js"</span>,
    <span class="prop">"test"</span>: <span class="str">"jest --coverage"</span>,
    <span class="prop">"build"</span>: <span class="str">"webpack --mode production"</span>,
    <span class="prop">"lint"</span>: <span class="str">"eslint src/**/*.js"</span>
  },
  <span class="prop">"keywords"</span>: [<span class="str">"task"</span>, <span class="str">"management"</span>, <span class="str">"productivity"</span>],
  <span class="prop">"author"</span>: <span class="str">"Jane Doe &lt;jane@example.com&gt;"</span>,
  <span class="prop">"license"</span>: <span class="str">"MIT"</span>,
  <span class="prop">"dependencies"</span>: {
    <span class="prop">"express"</span>: <span class="str">"^4.18.2"</span>,
    <span class="prop">"mongoose"</span>: <span class="str">"^7.6.3"</span>
  },
  <span class="prop">"devDependencies"</span>: {
    <span class="prop">"jest"</span>: <span class="str">"^29.7.0"</span>,
    <span class="prop">"nodemon"</span>: <span class="str">"^3.0.1"</span>,
    <span class="prop">"eslint"</span>: <span class="str">"^8.52.0"</span>
  },
  <span class="prop">"engines"</span>: {
    <span class="prop">"node"</span>: <span class="str">">=18.0.0"</span>
  },
  <span class="prop">"repository"</span>: {
    <span class="prop">"type"</span>: <span class="str">"git"</span>,
    <span class="prop">"url"</span>: <span class="str">"https://github.com/jane/my-awesome-app"</span>
  }
}</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Invalid package names</h4>
<p>Package names <strong>cannot</strong> contain uppercase letters, spaces, or start with a dot/underscore. ‚ùå <code>My-Package</code> ‚ùå <code>my package</code> ‚úÖ <code>my-package</code> ‚úÖ <code>@scope/my-package</code></p>
</div>

<h3>üèóÔ∏è Interactive: Build Your package.json</h3>
<div class="exercise-box">
<h4>üß© Package.json Builder</h4>
<p style="color:var(--text2);font-size:.9em;margin-bottom:12px">Fill in the fields and watch your package.json generate in real-time!</p>
<div class="json-builder">
<div class="fields">
<div class="builder-field">
<label>name:</label>
<input type="text" id="bjName" placeholder="my-app" oninput="updateBuilder()">
</div>
<div class="builder-field">
<label>version:</label>
<input type="text" id="bjVersion" placeholder="1.0.0" value="1.0.0" oninput="updateBuilder()">
</div>
<div class="builder-field">
<label>description:</label>
<input type="text" id="bjDesc" placeholder="A cool project" oninput="updateBuilder()">
</div>
<div class="builder-field">
<label>main:</label>
<input type="text" id="bjMain" placeholder="index.js" value="index.js" oninput="updateBuilder()">
</div>
<div class="builder-field">
<label>author:</label>
<input type="text" id="bjAuthor" placeholder="Your Name" oninput="updateBuilder()">
</div>
<div class="builder-field">
<label>license:</label>
<select id="bjLicense" onchange="updateBuilder()">
<option>MIT</option><option>ISC</option><option>Apache-2.0</option><option>GPL-3.0</option><option>BSD-3-Clause</option><option>UNLICENSED</option>
</select>
</div>
</div>
<div class="preview">
<div class="builder-output" id="builderOutput"></div>
</div>
</div>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>
<div class="quiz-box" id="quiz-1-1">
<h4><span class="q-label">Quiz</span> Package.json Basics</h4>
<p class="quiz-question">Which two fields are <strong>required</strong> in a package.json file?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> name and description</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> name and version</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> version and main</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> name and author</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-1-1', 1, 'Correct! name and version are the only two required fields. Without them, npm cannot identify or version your package.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-1-2">
<h4><span class="q-label">Quiz</span> npm init</h4>
<p class="quiz-question">What flag creates a package.json with all defaults instantly?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm init --fast</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm init -y</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm init --default</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm create --quick</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-1-2', 1, 'The -y (or --yes) flag skips all prompts and uses defaults. Super handy for quick project setup!')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>
</div>

<div class="section">
<h3>‚úèÔ∏è Exercise: Fill in the Blank</h3>
<div class="exercise-box" id="exercise-1-1">
<h4>üß© Complete the command</h4>
<p style="color:var(--text2);font-size:.9em">What command creates a package.json with default values?</p>
<div style="display:flex;align-items:center;gap:8px;margin:12px 0">
<code style="font-size:1em">npm</code>
<input class="exercise-input" style="max-width:200px" id="ex-1-1" placeholder="type here...">
</div>
<button class="exercise-check" onclick="checkExercise('ex-1-1', ['init -y','init --yes'], 'npm init -y creates package.json instantly!')">Check</button>
<div class="exercise-result" id="ex-1-1-result"></div>
</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Editing package.json manually</h4>
<p>While you <em>can</em> edit package.json by hand, always use <code>npm install &lt;pkg&gt;</code> to add dependencies. Manual edits can cause mismatches with <code>package-lock.json</code>, leading to inconsistent installs across environments.</p>
</div>

<div class="tip">
<h4>üí° Pro Tip: Custom npm init defaults</h4>
<p>Set default values so <code>npm init -y</code> is pre-filled:<br>
<code>npm config set init-author-name "Your Name"</code><br>
<code>npm config set init-license "MIT"</code></p>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(0)">‚Üê Welcome</button>
<button class="nav-btn next" onclick="goToChapter(2)">Dependencies ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 2: DEPENDENCIES ==================== -->
<div class="chapter-content" id="chapter-2">
<h2 class="chapter-title">üì¶ Dependencies Deep Dive</h2>
<p class="chapter-subtitle">Understanding how packages are managed</p>

<div class="section">
<h3>üîç Types of Dependencies</h3>
<p>NPM recognizes <span class="highlight">5 types</span> of dependencies. Understanding when to use each is crucial for professional development.</p>

<div class="card-grid">
<div class="mini-card" style="border-left:3px solid var(--green)">
<div class="mc-icon">üì¶</div>
<h5>dependencies</h5>
<p>Required at runtime<br><code>npm i express</code></p>
</div>
<div class="mini-card" style="border-left:3px solid var(--accent)">
<div class="mc-icon">üîß</div>
<h5>devDependencies</h5>
<p>Development only<br><code>npm i -D jest</code></p>
</div>
<div class="mini-card" style="border-left:3px solid var(--orange)">
<div class="mc-icon">ü§ù</div>
<h5>peerDependencies</h5>
<p>Required by host project<br>Plugin compatibility</p>
</div>
<div class="mini-card" style="border-left:3px solid var(--pink)">
<div class="mc-icon">‚ùì</div>
<h5>optionalDependencies</h5>
<p>Won't fail if missing<br>Platform-specific</p>
</div>
<div class="mini-card" style="border-left:3px solid var(--accent3)">
<div class="mc-icon">üìÅ</div>
<h5>bundledDependencies</h5>
<p>Packed with your package<br>Offline usage</p>
</div>
</div>

<h3>üìä dependencies vs devDependencies</h3>
<p>This is the <span class="highlight2">most important distinction</span> and a common interview question!</p>

<div class="diagram">
<div class="diagram-title">Which goes where?</div>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;text-align:left">
<div style="background:rgba(0,184,148,.1);border:1px solid var(--green);border-radius:10px;padding:16px">
<h5 style="color:var(--green);margin-bottom:8px">‚úÖ dependencies</h5>
<div style="font-size:.8em;color:var(--text2);line-height:2">
‚Ä¢ express, react, lodash<br>
‚Ä¢ mongoose, axios<br>
‚Ä¢ cors, dotenv<br>
‚Ä¢ Any package your <strong>production code</strong> imports
</div>
</div>
<div style="background:rgba(108,92,231,.1);border:1px solid var(--accent);border-radius:10px;padding:16px">
<h5 style="color:var(--accent2);margin-bottom:8px">üîß devDependencies</h5>
<div style="font-size:.8em;color:var(--text2);line-height:2">
‚Ä¢ jest, mocha, chai<br>
‚Ä¢ webpack, babel, typescript<br>
‚Ä¢ eslint, prettier<br>
‚Ä¢ nodemon, ts-node
</div>
</div>
</div>
</div>

<h3>üíª Installing Packages</h3>
<div class="code-block">
<div class="code-header"><span class="lang">Terminal Commands</span></div>
<div class="code-body"><span class="cmt"># Install a production dependency</span>
<span class="cmd">npm</span> install express
<span class="cmd">npm</span> i express              <span class="cmt"># shorthand</span>

<span class="cmt"># Install a dev dependency</span>
<span class="cmd">npm</span> install --save-dev jest
<span class="cmd">npm</span> i -D jest              <span class="cmt"># shorthand</span>

<span class="cmt"># Install specific version</span>
<span class="cmd">npm</span> i express@4.17.1

<span class="cmt"># Install all dependencies from package.json</span>
<span class="cmd">npm</span> install
<span class="cmd">npm</span> i                      <span class="cmt"># shorthand</span>

<span class="cmt"># Install production deps only (for deployment)</span>
<span class="cmd">npm</span> i --production
<span class="cmd">npm</span> i --omit=dev           <span class="cmt"># npm 8+</span>

<span class="cmt"># Install globally</span>
<span class="cmd">npm</span> i -g nodemon

<span class="cmt"># Uninstall</span>
<span class="cmd">npm</span> uninstall express
<span class="cmd">npm</span> rm express             <span class="cmt"># shorthand</span>

<span class="cmt"># Update packages</span>
<span class="cmd">npm</span> update                 <span class="cmt"># update all</span>
<span class="cmd">npm</span> update express         <span class="cmt"># update one</span>
<span class="cmd">npm</span> outdated               <span class="cmt"># check for updates</span></div>
</div>

<h3>üîí package-lock.json</h3>
<p>The <code>package-lock.json</code> file <span class="highlight">locks exact versions</span> of every installed package (including sub-dependencies). This ensures that <em>everyone</em> on your team gets identical installs.</p>

<div class="diagram">
<div class="diagram-title">How package-lock.json works</div>
<div class="flow-row">
<div class="flow-box cyan">You run<br><code>npm install</code></div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box">NPM resolves<br>version ranges</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box green">Exact versions<br>written to lock file</div>
</div>
<div class="flow-arrow-down">‚Üì</div>
<div class="flow-row">
<div class="flow-box orange">Teammate clones repo</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box">Runs <code>npm install</code></div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box green">Gets EXACT same<br>versions ‚úì</div>
</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Never delete or .gitignore package-lock.json!</h4>
<p>Many beginners add <code>package-lock.json</code> to <code>.gitignore</code>. <strong>DON'T!</strong> It should be committed to version control. Without it, different team members may get different versions, causing "works on my machine" bugs. Only <code>node_modules/</code> should be in .gitignore.</p>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: npm install vs npm ci</h4>
<p>In CI/CD pipelines, use <code>npm ci</code> instead of <code>npm install</code>. It's faster, stricter, and ensures exact versions from the lock file. <code>npm install</code> may update the lock file ‚Äî <code>npm ci</code> never does.</p>
</div>

<h3>ü§ù peerDependencies Explained</h3>
<p>When you build a <span class="highlight">plugin or library</span>, you don't want to bundle the host framework. Instead, you declare it as a peer dependency:</p>

<div class="code-block">
<div class="code-header"><span class="lang">package.json (React component library)</span></div>
<div class="code-body">{
  <span class="prop">"name"</span>: <span class="str">"my-react-datepicker"</span>,
  <span class="prop">"peerDependencies"</span>: {
    <span class="prop">"react"</span>: <span class="str">"^17.0.0 || ^18.0.0"</span>,
    <span class="prop">"react-dom"</span>: <span class="str">"^17.0.0 || ^18.0.0"</span>
  }
}
<span class="cmt">// This says: "I need React, but the HOST project provides it"</span>
<span class="cmt">// This prevents duplicate React installs!</span></div>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-2-1">
<h4><span class="q-label">Quiz</span> Dependency Types</h4>
<p class="quiz-question">Jest (a testing framework) should be installed as a:</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> dependency</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> devDependency</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> peerDependency</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> optionalDependency</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-2-1', 1, 'Jest is only needed during development for testing. It should NOT be shipped to production. Always use npm i -D jest.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-2-2">
<h4><span class="q-label">Quiz</span> npm ci</h4>
<p class="quiz-question">In a CI/CD pipeline (like GitHub Actions), which command should you use?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm install</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm ci</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm update</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm i --force</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-2-2', 1, 'npm ci is designed for automated environments. It deletes node_modules, installs from the lock file exactly, and fails if there is any mismatch.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="exercise-box" id="exercise-2-1">
<h4>üß© Exercise: Install Command</h4>
<p style="color:var(--text2);font-size:.9em">Write the shorthand command to install <strong>eslint</strong> as a dev dependency:</p>
<input class="exercise-input" id="ex-2-1" placeholder="npm ...">
<button class="exercise-check" onclick="checkExercise('ex-2-1', ['npm i -D eslint','npm install -D eslint','npm install --save-dev eslint','npm i --save-dev eslint'], 'npm i -D eslint is the shorthand way!')">Check</button>
<div class="exercise-result" id="ex-2-1-result"></div>
</div>
</div>

<div class="tip">
<h4>üí° Pro Tip: Check what's installed</h4>
<p><code>npm ls</code> ‚Äî list installed packages<br>
<code>npm ls --depth=0</code> ‚Äî only top-level<br>
<code>npm ls express</code> ‚Äî check specific package<br>
<code>npm explain express</code> ‚Äî why is it installed?</p>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(1)">‚Üê Package.json</button>
<button class="nav-btn next" onclick="goToChapter(3)">Semantic Versioning ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 3: SEMANTIC VERSIONING ==================== -->
<div class="chapter-content" id="chapter-3">
<h2 class="chapter-title">üè∑Ô∏è Semantic Versioning</h2>
<p class="chapter-subtitle">The universal language of software versions</p>

<div class="section">
<h3>üìê SemVer Format: MAJOR.MINOR.PATCH</h3>
<p>Semantic Versioning (SemVer) is a <span class="highlight">versioning standard</span> that communicates the nature of changes in each release.</p>

<div class="diagram">
<div class="diagram-title">Version Breakdown: 4.18.2</div>
<div style="display:flex;justify-content:center;gap:30px;flex-wrap:wrap;margin:20px 0">
<div style="text-align:center">
<div style="font-size:3em;font-weight:800;color:var(--red)">4</div>
<div style="font-size:.85em;color:var(--red);font-weight:600">MAJOR</div>
<div style="font-size:.75em;color:var(--text2);margin-top:4px">Breaking changes</div>
</div>
<div style="font-size:3em;color:var(--text3)">.</div>
<div style="text-align:center">
<div style="font-size:3em;font-weight:800;color:var(--orange)">18</div>
<div style="font-size:.85em;color:var(--orange);font-weight:600">MINOR</div>
<div style="font-size:.75em;color:var(--text2);margin-top:4px">New features<br>(backward compatible)</div>
</div>
<div style="font-size:3em;color:var(--text3)">.</div>
<div style="text-align:center">
<div style="font-size:3em;font-weight:800;color:var(--green)">2</div>
<div style="font-size:.85em;color:var(--green);font-weight:600">PATCH</div>
<div style="font-size:.75em;color:var(--text2);margin-top:4px">Bug fixes<br>(backward compatible)</div>
</div>
</div>
</div>

<h3>üìè Version Ranges</h3>
<p>NPM uses special syntax to specify <span class="highlight2">acceptable version ranges</span>. This is critical to understand!</p>

<table class="data-table">
<thead><tr><th>Syntax</th><th>Example</th><th>Matches</th><th>Rule</th></tr></thead>
<tbody>
<tr><td><code>^</code> (caret)</td><td><code>^1.2.3</code></td><td>1.2.3 to &lt;2.0.0</td><td>Allow MINOR + PATCH updates</td></tr>
<tr><td><code>~</code> (tilde)</td><td><code>~1.2.3</code></td><td>1.2.3 to &lt;1.3.0</td><td>Allow PATCH updates only</td></tr>
<tr><td>exact</td><td><code>1.2.3</code></td><td>1.2.3 only</td><td>Exact version, no updates</td></tr>
<tr><td><code>*</code></td><td><code>*</code></td><td>Any version</td><td>Accept anything (dangerous!)</td></tr>
<tr><td><code>&gt;=</code></td><td><code>&gt;=1.2.3</code></td><td>1.2.3 and above</td><td>Minimum version</td></tr>
<tr><td><code>x</code></td><td><code>1.2.x</code></td><td>1.2.0 to &lt;1.3.0</td><td>Any patch in 1.2</td></tr>
<tr><td>range</td><td><code>&gt;=1.2 &lt;2.0</code></td><td>1.2.0 to &lt;2.0.0</td><td>Explicit range</td></tr>
<tr><td><code>||</code></td><td><code>^1.0 || ^2.0</code></td><td>1.x or 2.x</td><td>Multiple ranges</td></tr>
</tbody>
</table>

<h3>üéÆ Interactive Semver Playground</h3>
<div class="semver-playground">
<h4 style="color:var(--accent2);margin-bottom:8px">Test Version Ranges</h4>
<p style="color:var(--text2);font-size:.85em">Enter a version range and see which versions match!</p>
<div style="display:flex;align-items:center;gap:12px;margin:16px 0;flex-wrap:wrap">
<label style="color:var(--text2);font-size:.9em">Range:</label>
<input type="text" id="semverRange" class="exercise-input" style="max-width:200px;margin:0" placeholder="^1.2.0" value="^1.2.0" oninput="checkSemverRange()">
</div>
<div class="version-grid" id="semverGrid"></div>
<div id="semverExplanation" style="margin-top:12px;padding:12px;background:var(--bg);border-radius:8px;font-size:.85em;color:var(--text2)"></div>
</div>

<h3>üî¢ Pre-release Versions</h3>
<div class="code-block">
<div class="code-header"><span class="lang">Pre-release examples</span></div>
<div class="code-body"><span class="cmt">// Pre-release versions (lower priority than release)</span>
<span class="str">"1.0.0-alpha"</span>      <span class="cmt">// Early testing</span>
<span class="str">"1.0.0-alpha.1"</span>    <span class="cmt">// Alpha iteration</span>
<span class="str">"1.0.0-beta"</span>       <span class="cmt">// Feature-complete testing</span>
<span class="str">"1.0.0-beta.2"</span>     <span class="cmt">// Beta iteration</span>
<span class="str">"1.0.0-rc.1"</span>       <span class="cmt">// Release candidate</span>

<span class="cmt">// Sort order (lowest ‚Üí highest):</span>
<span class="cmt">// 1.0.0-alpha &lt; 1.0.0-alpha.1 &lt; 1.0.0-beta &lt; 1.0.0-rc.1 &lt; 1.0.0</span>

<span class="cmt">// Build metadata (ignored in version comparison)</span>
<span class="str">"1.0.0+build.123"</span>
<span class="str">"1.0.0-beta+exp.sha.5114f85"</span></div>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-3-1">
<h4><span class="q-label">Quiz</span> Caret vs Tilde</h4>
<p class="quiz-question">Given the range <code>^2.3.4</code>, which version would <strong>NOT</strong> be accepted?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> 2.3.5</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> 2.9.0</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> 3.0.0</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> 2.4.0</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-3-1', 2, 'The caret (^) allows changes in MINOR and PATCH but NOT MAJOR. So ^2.3.4 means >=2.3.4 and <3.0.0. Version 3.0.0 is a new major version and is NOT accepted.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-3-2">
<h4><span class="q-label">Quiz</span> Tilde Range</h4>
<p class="quiz-question">Given the range <code>~1.5.2</code>, which is the highest version that would match?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> 1.5.9</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> 1.6.0</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> 2.0.0</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> 1.9.9</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-3-2', 0, 'Tilde (~) allows only PATCH updates. ~1.5.2 means >=1.5.2 and <1.6.0. So 1.5.9 is the highest match from these options. 1.6.0 is a new MINOR version and would NOT match.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-3-3">
<h4><span class="q-label">Quiz</span> Version Bump</h4>
<p class="quiz-question">You added a new feature to your library but it's fully backward compatible. What should you bump?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> MAJOR (1.0.0 ‚Üí 2.0.0)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> MINOR (1.0.0 ‚Üí 1.1.0)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> PATCH (1.0.0 ‚Üí 1.0.1)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> No change needed</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-3-3', 1, 'New backward-compatible features = MINOR bump. PATCH is for bug fixes. MAJOR is for breaking changes.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="exercise-box">
<h4>üß© Exercise: Version Range</h4>
<p style="color:var(--text2);font-size:.9em">What symbol means "allow minor and patch updates"? (Just the symbol)</p>
<input class="exercise-input" id="ex-3-1" placeholder="Type the symbol..." style="max-width:100px">
<button class="exercise-check" onclick="checkExercise('ex-3-1', ['^'], 'The caret (^) is the default range operator npm uses!')">Check</button>
<div class="exercise-result" id="ex-3-1-result"></div>
</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: ^0.x.y behaves differently!</h4>
<p>For versions below 1.0.0, the caret is more restrictive:<br>
<code>^0.2.3</code> means <code>>=0.2.3 &lt;0.3.0</code> (not &lt;1.0.0!)<br>
<code>^0.0.3</code> means <code>>=0.0.3 &lt;0.0.4</code> (exact!)<br>
This is because pre-1.0 versions are considered unstable, so even minor changes might break things.</p>
</div>

<div class="tip">
<h4>üí° Pro Tip: npm version command</h4>
<p>Use <code>npm version patch|minor|major</code> to automatically bump versions:<br>
<code>npm version patch</code> ‚Üí 1.0.0 ‚Üí 1.0.1<br>
<code>npm version minor</code> ‚Üí 1.0.0 ‚Üí 1.1.0<br>
<code>npm version major</code> ‚Üí 1.0.0 ‚Üí 2.0.0<br>
It also creates a git tag automatically!</p>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(2)">‚Üê Dependencies</button>
<button class="nav-btn next" onclick="goToChapter(4)">NPM Scripts ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 4: NPM SCRIPTS ==================== -->
<div class="chapter-content" id="chapter-4">
<h2 class="chapter-title">‚ö° NPM Scripts Power</h2>
<p class="chapter-subtitle">Automate your workflow like a pro</p>

<div class="section">
<h3>üìú What are NPM Scripts?</h3>
<p>NPM scripts are <span class="highlight">shell commands</span> defined in your package.json that can be run with <code>npm run &lt;name&gt;</code>. They're the standard way to automate tasks in JavaScript projects.</p>

<div class="code-block">
<div class="code-header"><span class="lang">package.json</span></div>
<div class="code-body">{
  <span class="prop">"scripts"</span>: {
    <span class="prop">"start"</span>: <span class="str">"node server.js"</span>,
    <span class="prop">"dev"</span>: <span class="str">"nodemon server.js"</span>,
    <span class="prop">"test"</span>: <span class="str">"jest --watchAll"</span>,
    <span class="prop">"build"</span>: <span class="str">"webpack --mode production"</span>,
    <span class="prop">"lint"</span>: <span class="str">"eslint src/ --ext .js,.jsx"</span>,
    <span class="prop">"format"</span>: <span class="str">"prettier --write \"src/**/*.js\""</span>,
    <span class="prop">"clean"</span>: <span class="str">"rm -rf dist node_modules"</span>,
    <span class="prop">"deploy"</span>: <span class="str">"npm run build && firebase deploy"</span>
  }
}</div>
</div>

<h3>üèÉ Running Scripts</h3>
<div class="code-block">
<div class="code-header"><span class="lang">Terminal</span></div>
<div class="code-body"><span class="cmt"># Built-in scripts (no "run" needed!)</span>
<span class="cmd">npm</span> start           <span class="cmt"># runs "start" script</span>
<span class="cmd">npm</span> test            <span class="cmt"># runs "test" script</span>
<span class="cmd">npm</span> stop            <span class="cmt"># runs "stop" script</span>
<span class="cmd">npm</span> restart         <span class="cmt"># runs "restart" script</span>

<span class="cmt"># Custom scripts (need "run")</span>
<span class="cmd">npm</span> run dev         <span class="cmt"># runs "dev" script</span>
<span class="cmd">npm</span> run build       <span class="cmt"># runs "build" script</span>
<span class="cmd">npm</span> run lint        <span class="cmt"># runs "lint" script</span>

<span class="cmt"># Pass arguments to scripts</span>
<span class="cmd">npm</span> run test -- --verbose
<span class="cmd">npm</span> run build -- --watch

<span class="cmt"># List all available scripts</span>
<span class="cmd">npm</span> run              <span class="cmt"># shows all scripts</span></div>
</div>

<h3>ü™ù Pre & Post Hooks</h3>
<p>NPM automatically runs <code>pre</code> and <code>post</code> scripts before and after named scripts!</p>

<div class="diagram">
<div class="diagram-title">Script Lifecycle: npm run build</div>
<div class="flow-row">
<div class="flow-box orange">prebuild<br><small>runs first</small></div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box cyan">build<br><small>main script</small></div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box green">postbuild<br><small>runs after</small></div>
</div>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">package.json - Hooks Example</span></div>
<div class="code-body">{
  <span class="prop">"scripts"</span>: {
    <span class="prop">"prebuild"</span>: <span class="str">"echo 'Cleaning dist...' && rm -rf dist"</span>,
    <span class="prop">"build"</span>: <span class="str">"webpack --mode production"</span>,
    <span class="prop">"postbuild"</span>: <span class="str">"echo 'Build complete! ‚úÖ'"</span>,
    
    <span class="prop">"pretest"</span>: <span class="str">"npm run lint"</span>,
    <span class="prop">"test"</span>: <span class="str">"jest"</span>,
    <span class="prop">"posttest"</span>: <span class="str">"echo 'All tests passed! üéâ'"</span>,
    
    <span class="prop">"preinstall"</span>: <span class="str">"echo 'Installing dependencies...'"</span>,
    <span class="prop">"postinstall"</span>: <span class="str">"echo 'Setup complete!'"</span>
  }
}</div>
</div>

<h3>üîó Script Composition</h3>
<div class="code-block">
<div class="code-header"><span class="lang">Chaining & Parallel Scripts</span></div>
<div class="code-body">{
  <span class="prop">"scripts"</span>: {
    <span class="cmt">// Sequential (&&) - run one after another</span>
    <span class="prop">"deploy"</span>: <span class="str">"npm run lint && npm run test && npm run build && npm run upload"</span>,
    
    <span class="cmt">// Using npx for one-off commands</span>
    <span class="prop">"serve"</span>: <span class="str">"npx serve dist"</span>,
    
    <span class="cmt">// Environment variables</span>
    <span class="prop">"start:prod"</span>: <span class="str">"NODE_ENV=production node server.js"</span>,
    <span class="prop">"start:dev"</span>: <span class="str">"NODE_ENV=development nodemon server.js"</span>,
    
    <span class="cmt">// Cross-platform (use cross-env package)</span>
    <span class="prop">"start"</span>: <span class="str">"cross-env NODE_ENV=production node server.js"</span>,
    
    <span class="cmt">// Parallel execution (use npm-run-all or concurrently)</span>
    <span class="prop">"dev"</span>: <span class="str">"concurrently \"npm run server\" \"npm run client\""</span>,
    <span class="prop">"server"</span>: <span class="str">"nodemon server.js"</span>,
    <span class="prop">"client"</span>: <span class="str">"cd client && npm start"</span>
  }
}</div>
</div>

<h3>üõ†Ô∏è Common Script Patterns</h3>
<div class="card-grid">
<div class="card">
<h4>üöÄ Full-Stack Dev</h4>
<div class="code-body" style="font-size:.8em;padding:8px">"dev": "concurrently \"npm:server\" \"npm:client\"",
"server": "nodemon api/index.js",
"client": "cd client && npm run dev"</div>
</div>
<div class="card">
<h4>üßπ Clean Build</h4>
<div class="code-body" style="font-size:.8em;padding:8px">"clean": "rm -rf dist",
"prebuild": "npm run clean",
"build": "tsc && vite build"</div>
</div>
<div class="card">
<h4>üìã CI Pipeline</h4>
<div class="code-body" style="font-size:.8em;padding:8px">"ci": "npm run lint && npm run test:ci && npm run build",
"test:ci": "jest --ci --coverage",
"lint": "eslint . --max-warnings 0"</div>
</div>
<div class="card">
<h4>üì¶ Release</h4>
<div class="code-body" style="font-size:.8em;padding:8px">"preversion": "npm run test",
"version": "npm run build && git add -A dist",
"postversion": "git push && git push --tags"</div>
</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Forgetting "run" for custom scripts</h4>
<p>Only <code>start</code>, <code>test</code>, <code>stop</code>, and <code>restart</code> work without "run":<br>
‚úÖ <code>npm start</code> ‚úÖ <code>npm test</code><br>
‚ùå <code>npm build</code> (this is a different npm command!)<br>
‚úÖ <code>npm run build</code> (this runs your script)</p>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Platform-specific commands</h4>
<p><code>rm -rf</code> doesn't work on Windows. Use <code>cross-env</code> for environment variables and <code>rimraf</code> for cross-platform file deletion:<br>
‚ùå <code>"clean": "rm -rf dist"</code><br>
‚úÖ <code>"clean": "rimraf dist"</code></p>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-4-1">
<h4><span class="q-label">Quiz</span> Script Hooks</h4>
<p class="quiz-question">When you run <code>npm test</code>, which scripts execute and in what order?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> test ‚Üí pretest ‚Üí posttest</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> pretest ‚Üí test ‚Üí posttest</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> test only</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> posttest ‚Üí test ‚Üí pretest</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-4-1', 1, 'NPM always runs hooks in order: pre ‚Üí main ‚Üí post. So pretest runs first, then test, then posttest.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-4-2">
<h4><span class="q-label">Quiz</span> Running Scripts</h4>
<p class="quiz-question">Which command correctly runs a custom script called "dev"?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm dev</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm run dev</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm exec dev</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm script dev</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-4-2', 1, 'Custom scripts require npm run <name>. Only start, test, stop, restart work without run.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="exercise-box">
<h4>üß© Exercise: Compose a Script</h4>
<p style="color:var(--text2);font-size:.9em">Write a script value that runs lint THEN test sequentially:</p>
<input class="exercise-input" id="ex-4-1" placeholder="npm run lint ...">
<button class="exercise-check" onclick="checkExercise('ex-4-1', ['npm run lint && npm run test','npm run lint && npm test'], 'Use && to chain commands sequentially!')">Check</button>
<div class="exercise-result" id="ex-4-1-result"></div>
</div>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(3)">‚Üê Semantic Versioning</button>
<button class="nav-btn next" onclick="goToChapter(5)">Security ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 5: SECURITY ==================== -->
<div class="chapter-content" id="chapter-5">
<h2 class="chapter-title">üîí Package Security</h2>
<p class="chapter-subtitle">Protect your project from vulnerabilities</p>

<div class="section">
<h3>üõ°Ô∏è Why Security Matters</h3>
<p>A typical Node.js project has <span class="highlight3">hundreds of transitive dependencies</span>. Each one is a potential attack vector. High-profile incidents like <strong>event-stream</strong> (2018) and <strong>colors.js</strong> (2022) show that supply chain attacks are real.</p>

<div class="diagram">
<div class="diagram-title">Supply Chain Attack Vectors</div>
<div class="flow-row">
<div class="flow-box pink">Typosquatting<br><small>babbel vs babel</small></div>
<div class="flow-box pink">Malicious Updates<br><small>compromised maintainer</small></div>
<div class="flow-box pink">Dependency Confusion<br><small>private vs public names</small></div>
</div>
</div>

<h3>üîç npm audit</h3>
<p>The built-in <code>npm audit</code> command scans your dependency tree for known vulnerabilities.</p>

<div class="terminal">
<div class="terminal-header">
<div class="terminal-dot r"></div><div class="terminal-dot y"></div><div class="terminal-dot g"></div>
<span>Security Audit</span>
</div>
<div class="terminal-body">
<div class="terminal-line"><span class="terminal-prompt">$</span><span class="terminal-cmd">npm audit</span></div>
<div class="terminal-output terminal-warn">
# npm audit report

lodash  &lt;4.17.21
Severity: <span style="color:var(--red)">critical</span>
Prototype Pollution in lodash
fix available via `npm audit fix`
node_modules/lodash

minimist  &lt;1.2.6  
Severity: <span style="color:var(--orange)">high</span>
Prototype Pollution
fix available via `npm audit fix --force`
node_modules/minimist

2 vulnerabilities (1 high, 1 critical)

To address all issues, run:
  npm audit fix</div>
</div>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">Security Commands</span></div>
<div class="code-body"><span class="cmt"># Check for vulnerabilities</span>
<span class="cmd">npm</span> audit

<span class="cmt"># Auto-fix what's possible</span>
<span class="cmd">npm</span> audit fix

<span class="cmt"># Fix even with breaking changes (careful!)</span>
<span class="cmd">npm</span> audit fix --force

<span class="cmt"># Show detailed report as JSON</span>
<span class="cmd">npm</span> audit --json

<span class="cmt"># Only show certain severity levels</span>
<span class="cmd">npm</span> audit --audit-level=high

<span class="cmt"># Check production deps only</span>
<span class="cmd">npm</span> audit --omit=dev</div>
</div>

<h3>üîê Security Best Practices</h3>
<div class="card-grid">
<div class="card">
<h4>1Ô∏è‚É£ Lock Dependencies</h4>
<p>Always commit <code>package-lock.json</code>. Use <code>npm ci</code> in CI/CD. This ensures reproducible builds with exact versions.</p>
</div>
<div class="card">
<h4>2Ô∏è‚É£ Audit Regularly</h4>
<p>Run <code>npm audit</code> in your CI pipeline. Fail the build on critical vulnerabilities. Use <code>npm audit --audit-level=critical</code>.</p>
</div>
<div class="card">
<h4>3Ô∏è‚É£ Minimize Dependencies</h4>
<p>Every dependency is a risk. Ask: "Can I write this in 20 lines instead of installing a package?" Avoid left-pad situations.</p>
</div>
<div class="card">
<h4>4Ô∏è‚É£ Use .npmrc</h4>
<p>Configure npm behavior per project. Set <code>save-exact=true</code> to lock exact versions. Use <code>ignore-scripts=true</code> for untrusted packages.</p>
</div>
<div class="card">
<h4>5Ô∏è‚É£ Enable 2FA</h4>
<p>If publishing packages, enable two-factor authentication on npmjs.com. Prevents account takeover attacks.</p>
</div>
<div class="card">
<h4>6Ô∏è‚É£ Check Before Install</h4>
<p>Use <code>npm info &lt;pkg&gt;</code> to check a package before installing. Look at download counts, maintenance, and last publish date.</p>
</div>
</div>

<h3>‚öôÔ∏è .npmrc Configuration</h3>
<div class="code-block">
<div class="code-header"><span class="lang">.npmrc</span></div>
<div class="code-body"><span class="cmt"># Save exact versions (no ^ or ~)</span>
save-exact=true

<span class="cmt"># Don't run install scripts from packages (security)</span>
ignore-scripts=true

<span class="cmt"># Set default registry</span>
registry=https://registry.npmjs.org/

<span class="cmt"># Private registry for scoped packages</span>
@mycompany:registry=https://npm.mycompany.com/

<span class="cmt"># Require audit to pass</span>
audit-level=moderate

<span class="cmt"># Set engine strict mode</span>
engine-strict=true</div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Blindly running npm audit fix --force</h4>
<p><code>--force</code> can upgrade packages to new MAJOR versions, potentially breaking your application. Always review what it wants to change first with <code>npm audit</code>, then fix manually when possible.</p>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Ignoring postinstall scripts</h4>
<p>Malicious packages can run code during <code>npm install</code> via <code>postinstall</code> scripts. Review packages before installing, especially ones with few downloads or new maintainers.</p>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-5-1">
<h4><span class="q-label">Quiz</span> Security Fundamentals</h4>
<p class="quiz-question">What is the FIRST command you should run to check for vulnerabilities?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm audit</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm audit fix --force</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm update</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm install --security</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-5-1', 0, 'Always start with npm audit to REVIEW vulnerabilities before taking action. Never jump straight to --force fixes!')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-5-2">
<h4><span class="q-label">Quiz</span> Supply Chain</h4>
<p class="quiz-question">What is "typosquatting" in the context of npm?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> Publishing a package with a name similar to a popular one to trick users</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> Using TypeScript in your package</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> Having too many typos in documentation</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> A testing methodology</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-5-2', 0, 'Typosquatting is a real attack where malicious actors publish packages like &quot;expres&quot; or &quot;loadash&quot; to catch typos. Always double-check package names!')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(4)">‚Üê NPM Scripts</button>
<button class="nav-btn next" onclick="goToChapter(6)">Creating Packages ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 6: CREATING PACKAGES ==================== -->
<div class="chapter-content" id="chapter-6">
<h2 class="chapter-title">üèóÔ∏è Creating & Publishing Packages</h2>
<p class="chapter-subtitle">Share your code with the world</p>

<div class="section">
<h3>üìÅ Package Structure</h3>
<p>A well-structured package is <span class="highlight">easy to use, maintain, and trust</span>. Here's the recommended structure:</p>

<div class="code-block">
<div class="code-header"><span class="lang">Project Structure</span></div>
<div class="code-body">my-awesome-package/
‚îú‚îÄ‚îÄ <span class="val">src/</span>               <span class="cmt"># Source code</span>
‚îÇ   ‚îú‚îÄ‚îÄ index.js        <span class="cmt"># Main entry point</span>
‚îÇ   ‚îú‚îÄ‚îÄ utils.js        <span class="cmt"># Utility functions</span>
‚îÇ   ‚îî‚îÄ‚îÄ constants.js    <span class="cmt"># Constants</span>
‚îú‚îÄ‚îÄ <span class="val">dist/</span>              <span class="cmt"># Built/compiled output</span>
‚îú‚îÄ‚îÄ <span class="val">test/</span>              <span class="cmt"># Tests</span>
‚îÇ   ‚îî‚îÄ‚îÄ index.test.js
‚îú‚îÄ‚îÄ <span class="val">.gitignore</span>         <span class="cmt"># Git ignore rules</span>
‚îú‚îÄ‚îÄ <span class="val">.npmignore</span>         <span class="cmt"># NPM ignore rules (or use "files" field)</span>
‚îú‚îÄ‚îÄ <span class="val">package.json</span>       <span class="cmt"># Package manifest</span>
‚îú‚îÄ‚îÄ <span class="val">README.md</span>          <span class="cmt"># Documentation</span>
‚îú‚îÄ‚îÄ <span class="val">LICENSE</span>            <span class="cmt"># License file</span>
‚îî‚îÄ‚îÄ <span class="val">CHANGELOG.md</span>       <span class="cmt"># Version history</span></div>
</div>

<h3>üìã Package.json for Publishing</h3>
<div class="code-block">
<div class="code-header"><span class="lang">package.json (publishable)</span></div>
<div class="code-body">{
  <span class="prop">"name"</span>: <span class="str">"@yourscope/string-utils"</span>,
  <span class="prop">"version"</span>: <span class="str">"1.0.0"</span>,
  <span class="prop">"description"</span>: <span class="str">"Lightweight string utility functions"</span>,
  <span class="prop">"main"</span>: <span class="str">"dist/index.js"</span>,          <span class="cmt">// CommonJS entry</span>
  <span class="prop">"module"</span>: <span class="str">"dist/index.mjs"</span>,        <span class="cmt">// ES Module entry</span>
  <span class="prop">"types"</span>: <span class="str">"dist/index.d.ts"</span>,        <span class="cmt">// TypeScript types</span>
  <span class="prop">"exports"</span>: {                       <span class="cmt">// Modern entry points</span>
    <span class="prop">"."</span>: {
      <span class="prop">"import"</span>: <span class="str">"./dist/index.mjs"</span>,
      <span class="prop">"require"</span>: <span class="str">"./dist/index.js"</span>
    }
  },
  <span class="prop">"files"</span>: [<span class="str">"dist"</span>, <span class="str">"README.md"</span>],   <span class="cmt">// What to include in package</span>
  <span class="prop">"scripts"</span>: {
    <span class="prop">"build"</span>: <span class="str">"rollup -c"</span>,
    <span class="prop">"test"</span>: <span class="str">"jest"</span>,
    <span class="prop">"prepublishOnly"</span>: <span class="str">"npm run test && npm run build"</span>
  },
  <span class="prop">"keywords"</span>: [<span class="str">"string"</span>, <span class="str">"utils"</span>, <span class="str">"lightweight"</span>],
  <span class="prop">"author"</span>: <span class="str">"Jane Doe &lt;jane@example.com&gt;"</span>,
  <span class="prop">"license"</span>: <span class="str">"MIT"</span>,
  <span class="prop">"repository"</span>: {
    <span class="prop">"type"</span>: <span class="str">"git"</span>,
    <span class="prop">"url"</span>: <span class="str">"https://github.com/jane/string-utils"</span>
  },
  <span class="prop">"bugs"</span>: {
    <span class="prop">"url"</span>: <span class="str">"https://github.com/jane/string-utils/issues"</span>
  },
  <span class="prop">"homepage"</span>: <span class="str">"https://github.com/jane/string-utils#readme"</span>,
  <span class="prop">"engines"</span>: {
    <span class="prop">"node"</span>: <span class="str">">=16.0.0"</span>
  }
}</div>
</div>

<h3>üöÄ Publishing Workflow</h3>
<div class="diagram">
<div class="diagram-title">Steps to Publish</div>
<div class="flow-row">
<div class="flow-box cyan">1. Create<br>account</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box">2. npm login</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box orange">3. Build<br>& test</div>
<div class="flow-arrow">‚Üí</div>
<div class="flow-box green">4. npm<br>publish</div>
</div>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">Publishing Commands</span></div>
<div class="code-body"><span class="cmt"># 1. Create account at npmjs.com, then login</span>
<span class="cmd">npm</span> login

<span class="cmt"># 2. Check what will be published</span>
<span class="cmd">npm</span> pack --dry-run
<span class="cmt"># Shows exact files that will be included</span>

<span class="cmt"># 3. Publish!</span>
<span class="cmd">npm</span> publish
<span class="cmt"># For scoped packages (public):</span>
<span class="cmd">npm</span> publish --access public

<span class="cmt"># 4. Version bump for updates</span>
<span class="cmd">npm</span> version patch    <span class="cmt"># 1.0.0 ‚Üí 1.0.1</span>
<span class="cmd">npm</span> publish

<span class="cmt"># 5. Unpublish (within 72 hours only!)</span>
<span class="cmd">npm</span> unpublish my-package@1.0.0

<span class="cmt"># 6. Deprecate a version</span>
<span class="cmd">npm</span> deprecate my-package@1.0.0 "Use v2 instead"</div>
</div>

<h3>üîó npm link (Local Development)</h3>
<p>Test your package locally before publishing using <code>npm link</code>:</p>

<div class="code-block">
<div class="code-header"><span class="lang">Using npm link</span></div>
<div class="code-body"><span class="cmt"># In your PACKAGE directory:</span>
cd ~/my-awesome-package
<span class="cmd">npm</span> link
<span class="cmt"># Creates a global symlink to your package</span>

<span class="cmt"># In your TEST PROJECT directory:</span>
cd ~/my-test-app
<span class="cmd">npm</span> link my-awesome-package
<span class="cmt"># Now you can: const pkg = require('my-awesome-package')</span>
<span class="cmt"># Changes to your package are reflected immediately!</span>

<span class="cmt"># When done, unlink:</span>
<span class="cmd">npm</span> unlink my-awesome-package</div>
</div>

<h3>üìù The "files" Field vs .npmignore</h3>
<div class="info">
<h4>üí° Best Practice: Use the "files" field</h4>
<p>Instead of blacklisting with <code>.npmignore</code>, whitelist with the <code>"files"</code> field in package.json. It's safer ‚Äî you explicitly declare what to include instead of hoping you didn't forget to exclude something sensitive.</p>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">Whitelist approach</span></div>
<div class="code-body"><span class="cmt">// ‚úÖ Preferred: whitelist with "files"</span>
{
  <span class="prop">"files"</span>: [
    <span class="str">"dist"</span>,         <span class="cmt">// Only the built output</span>
    <span class="str">"README.md"</span>     <span class="cmt">// Documentation</span>
  ]
}
<span class="cmt">// package.json, README, LICENSE are always included</span>
<span class="cmt">// node_modules, .git are always excluded</span></div>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Publishing secrets</h4>
<p>If you don't use the <code>"files"</code> field, you might accidentally publish <code>.env</code> files, API keys, or private configs. ALWAYS check with <code>npm pack --dry-run</code> before publishing!</p>
</div>

<div class="pitfall">
<h4>‚ö†Ô∏è Pitfall: Forgetting prepublishOnly</h4>
<p>Use the <code>prepublishOnly</code> script to ensure tests pass and the build is fresh before every publish. Without it, you might publish broken or stale code.</p>
</div>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-6-1">
<h4><span class="q-label">Quiz</span> Publishing</h4>
<p class="quiz-question">What command should you run to preview what files will be included in your published package?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm publish --preview</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm pack --dry-run</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm ls --files</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm info --contents</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-6-1', 1, 'npm pack --dry-run shows you exactly what files would be included without actually creating the tarball. Always check before publishing!')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-6-2">
<h4><span class="q-label">Quiz</span> Entry Points</h4>
<p class="quiz-question">Which field in package.json specifies the entry point for <code>require()</code>?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> "entry"</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> "source"</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> "main"</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> "index"</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-6-2', 2, 'The &quot;main&quot; field specifies the CommonJS entry point. For ES modules, use &quot;module&quot; or the &quot;exports&quot; map.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="exercise-box">
<h4>üß© Exercise: Scoped Package</h4>
<p style="color:var(--text2);font-size:.9em">What flag do you need when publishing a scoped package as public?</p>
<input class="exercise-input" id="ex-6-1" placeholder="--...">
<button class="exercise-check" onclick="checkExercise('ex-6-1', ['--access public','--access=public'], 'Scoped packages are private by default. Use --access public to publish publicly!')">Check</button>
<div class="exercise-result" id="ex-6-1-result"></div>
</div>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(5)">‚Üê Security</button>
<button class="nav-btn next" onclick="goToChapter(7)">Pitfalls & Tips ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 7: PITFALLS & TIPS ==================== -->
<div class="chapter-content" id="chapter-7">
<h2 class="chapter-title">üí£ Pitfalls & Pro Tips</h2>
<p class="chapter-subtitle">Common mistakes and how to avoid them</p>

<div class="section">
<h3>üö® Top 10 NPM Mistakes</h3>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #1: Committing node_modules</h4>
<p>NEVER commit node_modules to git. It can contain thousands of files. Add it to .gitignore immediately.</p>
<div class="code-body" style="font-size:.8em;padding:8px;margin-top:8px"><span class="cmt"># .gitignore</span>
node_modules/
</div>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #2: Not using package-lock.json</h4>
<p>Deleting or .gitignoring package-lock.json causes version drift. Team members get different versions.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #3: Installing everything as dependencies</h4>
<p>Testing tools, linters, and build tools should be devDependencies. They bloat production installs.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #4: Using * as a version range</h4>
<p><code>"lodash": "*"</code> means "any version ever" ‚Äî including future breaking changes. Always use <code>^</code> or <code>~</code>.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #5: Ignoring npm audit warnings</h4>
<p>Critical vulnerabilities in your dependencies can be exploited. Run <code>npm audit</code> regularly and fix issues.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #6: Global installs for project tools</h4>
<p>Don't <code>npm i -g webpack</code>. Instead install locally and use npx or npm scripts. Globals cause version conflicts between projects.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #7: Not specifying engines</h4>
<p>Without <code>"engines"</code>, your package might run on an incompatible Node version and fail mysteriously.</p>
<div class="code-body" style="font-size:.8em;padding:8px;margin-top:8px"><span class="prop">"engines"</span>: { <span class="prop">"node"</span>: <span class="str">">=18.0.0"</span> }</div>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #8: Running npm install in production CI</h4>
<p>Use <code>npm ci</code> instead. It's faster, deterministic, and ensures the lock file is respected.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #9: Not using .npmignore or "files"</h4>
<p>Publishing test files, configs, and source maps bloats your package and may leak secrets.</p>
</div>

<div class="card" style="border-left:3px solid var(--red)">
<h4>‚ùå Mistake #10: Confusing npx and npm</h4>
<p><code>npm</code> manages packages. <code>npx</code> executes packages. <code>npx create-react-app</code> runs the package without installing it globally.</p>
</div>

<h3>‚úÖ Pro Tips Cheat Sheet</h3>

<div class="card-grid">
<div class="card" style="border-left:3px solid var(--green)">
<h4>üí° Speed up installs</h4>
<p><code>npm i --prefer-offline</code> uses cache first. <code>npm ci</code> is faster for clean installs.</p>
</div>
<div class="card" style="border-left:3px solid var(--green)">
<h4>üí° Check package size</h4>
<p>Use <code>npx bundlephobia &lt;pkg&gt;</code> or visit bundlephobia.com before adding a dependency.</p>
</div>
<div class="card" style="border-left:3px solid var(--green)">
<h4>üí° npm outdated</h4>
<p>Run <code>npm outdated</code> to see a table of packages that have newer versions available.</p>
</div>
<div class="card" style="border-left:3px solid var(--green)">
<h4>üí° npm why / explain</h4>
<p><code>npm explain &lt;pkg&gt;</code> shows WHY a package is installed and which packages depend on it.</p>
</div>
</div>

<h3>üìä npm vs yarn vs pnpm</h3>
<table class="data-table">
<thead><tr><th>Feature</th><th>npm</th><th>yarn</th><th>pnpm</th></tr></thead>
<tbody>
<tr><td>Speed</td><td>Good</td><td>Fast</td><td>Fastest</td></tr>
<tr><td>Disk space</td><td>High</td><td>High</td><td>Low (shared)</td></tr>
<tr><td>Lock file</td><td><code>package-lock.json</code></td><td><code>yarn.lock</code></td><td><code>pnpm-lock.yaml</code></td></tr>
<tr><td>Workspaces</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td></tr>
<tr><td>Built-in</td><td>‚úÖ (with Node)</td><td>‚ùå</td><td>‚ùå</td></tr>
</tbody>
</table>
</div>

<div class="section">
<h3>üìù Quiz Time!</h3>

<div class="quiz-box" id="quiz-7-1">
<h4><span class="q-label">Quiz</span> Best Practices</h4>
<p class="quiz-question">Which file should you ALWAYS commit to git?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> node_modules/</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> package-lock.json</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> .env</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> dist/</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-7-1', 1, 'package-lock.json ensures everyone gets the same dependency versions. node_modules is regenerated from it, .env contains secrets, and dist is built.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-7-2">
<h4><span class="q-label">Quiz</span> npx vs npm</h4>
<p class="quiz-question">What does <code>npx create-react-app my-app</code> do differently than <code>npm install -g create-react-app</code>?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npx downloads and executes without permanent global install</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npx is faster</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npx installs to devDependencies</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> There is no difference</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-7-2', 0, 'npx downloads the package temporarily, executes it, and removes it. No permanent global install needed. This ensures you always use the latest version.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(6)">‚Üê Creating Packages</button>
<button class="nav-btn next" onclick="goToChapter(8)">Final Challenge ‚Üí</button>
</div>
</div>

<!-- ==================== CHAPTER 8: FINAL CHALLENGE ==================== -->
<div class="chapter-content" id="chapter-8">
<h2 class="chapter-title">üèÜ Final Challenge</h2>
<p class="chapter-subtitle">Prove you've mastered NPM!</p>

<div class="section">
<h3>üéØ Comprehensive Assessment</h3>
<p>Answer all questions correctly to prove your NPM mastery! <span class="highlight">Each correct answer earns 20 XP.</span></p>

<div class="quiz-box" id="quiz-f-1">
<h4><span class="q-label">Final</span> Question 1 of 8</h4>
<p class="quiz-question">What is the DEFAULT version range operator npm uses when you run <code>npm install express</code>?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> ~ (tilde)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> ^ (caret)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> * (any)</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> exact (no prefix)</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-1', 1, 'NPM defaults to ^ (caret), which allows minor and patch updates. This is the sweet spot between stability and getting updates.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-2">
<h4><span class="q-label">Final</span> Question 2 of 8</h4>
<p class="quiz-question">Which command installs dependencies WITHOUT modifying package-lock.json?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> npm install</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> npm ci</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> npm update</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm install --frozen</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-2', 1, 'npm ci (clean install) reads package-lock.json exactly and NEVER modifies it. If there is a mismatch with package.json, it fails instead of updating.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-3">
<h4><span class="q-label">Final</span> Question 3 of 8</h4>
<p class="quiz-question">You rename a function parameter in your library (no behavior change). What version bump is appropriate?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> MAJOR</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> MINOR</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> PATCH</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> No bump needed</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-3', 2, 'Internal refactoring with no behavior change is a PATCH. Even though nothing visible changed, it is a new release with potentially different internal behavior.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-4">
<h4><span class="q-label">Final</span> Question 4 of 8</h4>
<p class="quiz-question">What does the <code>"files"</code> field in package.json control?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> Which files are tracked by git</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> Which files are included when the package is published</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> Which files are linted</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> Which files are compiled</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-4', 1, 'The &quot;files&quot; field is a whitelist of files/directories included when you npm publish. It keeps your package lean and prevents accidentally publishing secrets.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-5">
<h4><span class="q-label">Final</span> Question 5 of 8</h4>
<p class="quiz-question">What lifecycle script runs automatically BEFORE <code>npm publish</code>?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> prerelease</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> prepublishOnly</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> beforePublish</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> prebuild</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-5', 1, 'prepublishOnly runs ONLY before npm publish (not before npm install). It is the ideal place to run tests and build steps.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-6">
<h4><span class="q-label">Final</span> Question 6 of 8</h4>
<p class="quiz-question">Why should you NOT install project tools globally?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> Global packages are slower</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> Different projects may need different versions</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> Global packages can't be imported</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> npm doesn't support global installs anymore</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-6', 1, 'Project A might need webpack 4, Project B needs webpack 5. Local installs per project avoid conflicts. Use npx or npm scripts instead of globals.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-7">
<h4><span class="q-label">Final</span> Question 7 of 8</h4>
<p class="quiz-question">What does <code>npm link</code> do?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> Links to the npm website</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> Creates a symlink for local package development and testing</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> Links two packages as dependencies</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> Creates a shortcut to node_modules</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-7', 1, 'npm link creates a symbolic link so you can test a local package in another project without publishing. Changes are reflected in real-time!')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div class="quiz-box" id="quiz-f-8">
<h4><span class="q-label">Final</span> Question 8 of 8</h4>
<p class="quiz-question">A package has version <code>0.9.1</code>. Based on semver conventions, what does the leading 0 tell you?</p>
<div class="quiz-options">
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">A</span> The package is deprecated</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">B</span> The package is in initial development and the API may change at any time</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">C</span> The package has zero bugs</div>
<div class="quiz-option" onclick="selectOption(this)"><span class="opt-letter">D</span> The package is a beta release</div>
</div>
<button class="quiz-submit" onclick="checkQuiz('quiz-f-8', 1, 'Version 0.x.y indicates initial development. The public API is not considered stable. Anything may change at any time. That is why ^ behaves differently for 0.x versions.')">Check Answer</button>
<div class="quiz-feedback"></div>
</div>

<div id="finalResult" class="chapter-complete-banner" style="display:none">
<h3>üéâ Assessment Complete!</h3>
<p id="finalScore"></p>
</div>
</div>

<div class="section">
<h3>üíª Interactive Terminal Challenge</h3>
<p>Practice npm commands in this simulated terminal! Try the commands listed below.</p>

<div class="info">
<h4>üéÆ Try These Commands</h4>
<p>
<code>npm init -y</code> &bull;
<code>npm install express</code> &bull;
<code>npm i -D jest</code> &bull;
<code>npm audit</code> &bull;
<code>npm run build</code> &bull;
<code>npm outdated</code> &bull;
<code>npm version patch</code> &bull;
<code>npm publish</code> &bull;
<code>npm pack --dry-run</code> &bull;
<code>npm ls --depth=0</code> &bull;
<code>npm ci</code> &bull;
<code>help</code>
</p>
</div>

<div class="terminal" id="simTerminal">
<div class="terminal-header">
<div class="terminal-dot r"></div><div class="terminal-dot y"></div><div class="terminal-dot g"></div>
<span>npm-mastery ~/my-project</span>
</div>
<div class="terminal-body" id="terminalBody">
<div class="terminal-output terminal-success">Welcome to the NPM Terminal Simulator! üéÆ
Type npm commands to practice. Type "help" for available commands.
</div>
</div>
<div class="terminal-input-line" style="padding:8px 20px 12px">
<span class="terminal-prompt">$</span>
<input type="text" class="terminal-input" id="terminalInput" placeholder="Type a command..." autofocus>
</div>
</div>
</div>

<div class="nav-buttons">
<button class="nav-btn prev" onclick="goToChapter(7)">‚Üê Pitfalls & Tips</button>
<button class="nav-btn next" onclick="goToChapter(0)" style="background:linear-gradient(135deg,var(--green),#00a382)">üè† Back to Start</button>
</div>
</div>

</main>
</div>

<script>
// ========== STATE ==========
const state = {
    currentChapter: 0,
    xp: 0,
    maxXp: 1000,
    correct: 0,
    streak: 0,
    maxStreak: 0,
    answeredQuizzes: new Set(),
    completedExercises: new Set(),
    completedChapters: new Set()
};

const chapters = [
    { icon: 'üè†', title: 'Welcome', short: 'Welcome' },
    { icon: 'üìÑ', title: 'Package.json', short: 'pkg.json' },
    { icon: 'üì¶', title: 'Dependencies', short: 'Deps' },
    { icon: 'üè∑Ô∏è', title: 'Semantic Versioning', short: 'SemVer' },
    { icon: '‚ö°', title: 'NPM Scripts', short: 'Scripts' },
    { icon: 'üîí', title: 'Security', short: 'Security' },
    { icon: 'üèóÔ∏è', title: 'Creating Packages', short: 'Create' },
    { icon: 'üí£', title: 'Pitfalls & Tips', short: 'Pitfalls' },
    { icon: 'üèÜ', title: 'Final Challenge', short: 'Final' }
];

// ========== INIT ==========
function init() {
    renderChapterList();
    goToChapter(0);
    updateBuilder();
    initSemverPlayground();
    initTerminal();
    updateStats();
}

// ========== CHAPTER NAVIGATION ==========
function renderChapterList() {
    const list = document.getElementById('chapterList');
    list.innerHTML = chapters.map((ch, i) => `
        <button class="chapter-btn ${i === 0 ? 'active' : ''} ${state.completedChapters.has(i) ? 'completed' : ''}" 
                onclick="goToChapter(${i})" id="chBtn-${i}">
            <span class="ch-icon">${ch.icon}</span>
            <span class="ch-text">${ch.title}</span>
            <span class="ch-check">‚úì</span>
        </button>
    `).join('');
}

function goToChapter(index) {
    state.currentChapter = index;
    
    document.querySelectorAll('.chapter-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.chapter-btn').forEach(el => el.classList.remove('active'));
    
    const content = document.getElementById(`chapter-${index}`);
    const btn = document.getElementById(`chBtn-${index}`);
    
    if (content) content.classList.add('active');
    if (btn) btn.classList.add('active');
    
    document.getElementById('mainContent').scrollTo(0, 0);
    
    if (index > 0 && index < 8) {
        markChapterVisited(index);
    }
}

function markChapterVisited(index) {
    // Simple chapter tracking
}

// ========== QUIZ SYSTEM ==========
function selectOption(el) {
    const quizBox = el.closest('.quiz-box');
    if (quizBox.dataset.answered) return;
    
    quizBox.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
    el.classList.add('selected');
}

function checkQuiz(quizId, correctIndex, explanation) {
    const quizBox = document.getElementById(quizId);
    if (quizBox.dataset.answered) return;
    
    const options = quizBox.querySelectorAll('.quiz-option');
    const selected = quizBox.querySelector('.quiz-option.selected');
    const feedback = quizBox.querySelector('.quiz-feedback');
    const btn = quizBox.querySelector('.quiz-submit');
    
    if (!selected) {
        showToast('Please select an answer!', 'error');
        return;
    }
    
    const selectedIndex = Array.from(options).indexOf(selected);
    const isCorrect = selectedIndex === correctIndex;
    
    quizBox.dataset.answered = 'true';
    btn.disabled = true;
    
    options.forEach((opt, i) => {
        if (i === correctIndex) opt.classList.add('correct');
        if (i === selectedIndex && !isCorrect) opt.classList.add('wrong');
    });
    
    feedback.className = `quiz-feedback show ${isCorrect ? 'correct' : 'wrong'}`;
    feedback.innerHTML = `${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect!'} ${explanation}`;
    
    if (!state.answeredQuizzes.has(quizId)) {
        state.answeredQuizzes.add(quizId);
        if (isCorrect) {
            addXP(15);
            state.correct++;
            state.streak++;
            if (state.streak > state.maxStreak) state.maxStreak = state.streak;
            if (state.streak >= 3) showToast(`üî• ${state.streak} streak!`, 'success');
        } else {
            state.streak = 0;
        }
        updateStats();
        checkChapterCompletion();
    }
}

// ========== EXERCISE SYSTEM ==========
function checkExercise(inputId, acceptedAnswers, successMsg) {
    const input = document.getElementById(inputId);
    const result = document.getElementById(inputId + '-result');
    const value = input.value.trim().toLowerCase();
    
    const isCorrect = acceptedAnswers.some(ans => ans.toLowerCase() === value);
    
    result.className = `exercise-result show ${isCorrect ? 'correct' : 'wrong'}`;
    result.textContent = isCorrect ? `‚úÖ ${successMsg}` : `‚ùå Not quite. Try again! Hint: think about the flags and syntax.`;
    
    if (isCorrect && !state.completedExercises.has(inputId)) {
        state.completedExercises.add(inputId);
        addXP(20);
        state.correct++;
        state.streak++;
        updateStats();
        checkChapterCompletion();
    } else if (!isCorrect) {
        state.streak = 0;
        updateStats();
    }
}

// ========== XP SYSTEM ==========
function addXP(amount) {
    state.xp = Math.min(state.xp + amount, state.maxXp);
    const bar = document.getElementById('xpBar');
    const label = document.getElementById('xpLabel');
    const pct = (state.xp / state.maxXp) * 100;
    bar.style.width = Math.max(pct, 5) + '%';
    bar.textContent = state.xp + ' XP';
    label.textContent = `${state.xp} / ${state.maxXp} XP`;
    
    showConfetti();
}

function updateStats() {
    document.getElementById('statCorrect').textContent = state.correct;
    document.getElementById('statStreak').textContent = state.streak;
    
    const totalQuestions = 20;
    const pct = Math.round((state.answeredQuizzes.size + state.completedExercises.size) / totalQuestions * 100);
    document.getElementById('statComplete').textContent = Math.min(pct, 100) + '%';
}

function checkChapterCompletion() {
    // Simple heuristic based on activity
    const ch = state.currentChapter;
    if (ch > 0 && ch < 8) {
        const chContent = document.getElementById(`chapter-${ch}`);
        const totalQuizzes = chContent.querySelectorAll('.quiz-box').length;
        const answeredQuizzes = chContent.querySelectorAll('.quiz-box[data-answered]').length;
        
        if (answeredQuizzes >= totalQuizzes && totalQuizzes > 0) {
            if (!state.completedChapters.has(ch)) {
                state.completedChapters.add(ch);
                const btn = document.getElementById(`chBtn-${ch}`);
                if (btn) btn.classList.add('completed');
                showToast(`‚úÖ Chapter ${ch} completed!`, 'success');
            }
        }
    }
    
    // Check final challenge
    if (ch === 8) {
        const finalQuizzes = document.querySelectorAll('#chapter-8 .quiz-box');
        const answeredFinals = document.querySelectorAll('#chapter-8 .quiz-box[data-answered]');
        if (answeredFinals.length === finalQuizzes.length && finalQuizzes.length > 0) {
            const correctFinals = document.querySelectorAll('#chapter-8 .quiz-box .quiz-option.correct.selected').length;
            const resultDiv = document.getElementById('finalResult');
            const scoreP = document.getElementById('finalScore');
            resultDiv.style.display = 'block';
            scoreP.textContent = `You scored ${correctFinals}/${finalQuizzes.length}! ${correctFinals === finalQuizzes.length ? 'üåü PERFECT SCORE! You are NPM Master!' : correctFinals >= 6 ? 'üí™ Great job! Review missed topics.' : 'üìö Keep studying! Review the chapters above.'}`;
            if (correctFinals === finalQuizzes.length) {
                for (let i = 0; i < 30; i++) showConfetti();
            }
        }
    }
}

// ========== PACKAGE.JSON BUILDER ==========
function updateBuilder() {
    const name = document.getElementById('bjName').value || 'my-app';
    const version = document.getElementById('bjVersion').value || '1.0.0';
    const desc = document.getElementById('bjDesc').value || '';
    const main = document.getElementById('bjMain').value || 'index.js';
    const author = document.getElementById('bjAuthor').value || '';
    const license = document.getElementById('bjLicense').value;
    
    let json = '{\n';
    json += `  "name": "${name}",\n`;
    json += `  "version": "${version}",\n`;
    if (desc) json += `  "description": "${desc}",\n`;
    json += `  "main": "${main}",\n`;
    json += `  "scripts": {\n`;
    json += `    "test": "echo \\"Error: no test\\" && exit 1"\n`;
    json += `  },\n`;
    if (author) json += `  "author": "${author}",\n`;
    json += `  "license": "${license}"\n`;
    json += '}';
    
    document.getElementById('builderOutput').textContent = json;
}

// ========== SEMVER PLAYGROUND ==========
function initSemverPlayground() {
    const versions = [
        '1.0.0','1.0.1','1.0.5','1.1.0','1.1.1','1.2.0','1.2.3','1.2.5',
        '1.3.0','1.5.0','1.9.9','2.0.0','2.0.1','2.1.0','3.0.0','0.9.0'
    ];
    const grid = document.getElementById('semverGrid');
    grid.innerHTML = versions.map(v => `<div class="version-cell" data-version="${v}">${v}</div>`).join('');
    checkSemverRange();
}

function checkSemverRange() {
    const range = document.getElementById('semverRange').value.trim();
    const cells = document.querySelectorAll('.version-cell');
    const explanation = document.getElementById('semverExplanation');
    
    let matches = 0;
    cells.forEach(cell => {
        cell.className = 'version-cell';
        const v = cell.dataset.version;
        if (matchesSemver(v, range)) {
            cell.classList.add('match');
            matches++;
        } else {
            cell.classList.add('no-match');
        }
    });
    
    let explain = '';
    if (range.startsWith('^')) {
        const base = range.substring(1);
        const parts = base.split('.');
        if (parts[0] === '0') {
            explain = `<strong>^${base}</strong>: Allows PATCH updates only (since major is 0). Range: >=${base} and <0.${parseInt(parts[1]||0)+1}.0`;
        } else {
            explain = `<strong>^${base}</strong>: Allows MINOR + PATCH updates. Range: >=${base} and <${parseInt(parts[0])+1}.0.0`;
        }
    } else if (range.startsWith('~')) {
        const base = range.substring(1);
        const parts = base.split('.');
        explain = `<strong>~${base}</strong>: Allows PATCH updates only. Range: >=${base} and <${parts[0]}.${parseInt(parts[1]||0)+1}.0`;
    } else if (range === '*') {
        explain = '<strong>*</strong>: Matches ANY version. ‚ö†Ô∏è Dangerous!';
    } else if (/^\d+\.\d+\.\d+$/.test(range)) {
        explain = `<strong>${range}</strong>: Exact version only. No updates allowed.`;
    } else {
        explain = 'Enter a range like ^1.2.0, ~1.2.0, 1.2.0, or *';
    }
    
    explain += ` <br>‚úÖ ${matches} version(s) match.`;
    explanation.innerHTML = explain;
}

function matchesSemver(version, range) {
    const v = version.split('.').map(Number);
    
    if (range === '*') return true;
    
    if (range.startsWith('^')) {
        const base = range.substring(1).split('.').map(Number);
        if (v[0] < base[0] || (v[0] === base[0] && v[1] < base[1]) || 
            (v[0] === base[0] && v[1] === base[1] && v[2] < base[2])) return false;
        
        if (base[0] === 0) {
            if (base[1] === 0) return v[0] === 0 && v[1] === 0 && v[2] === base[2];
            return v[0] === 0 && v[1] === base[1];
        }
        return v[0] === base[0];
    }
    
    if (range.startsWith('~')) {
        const base = range.substring(1).split('.').map(Number);
        if (v[0] < base[0] || (v[0] === base[0] && v[1] < base[1]) || 
            (v[0] === base[0] && v[1] === base[1] && v[2] < base[2])) return false;
        return v[0] === base[0] && v[1] === base[1];
    }
    
    if (/^\d+\.\d+\.\d+$/.test(range)) {
        return version === range;
    }
    
    if (range.startsWith('>=')) {
        const base = range.substring(2).split('.').map(Number);
        if (v[0] > base[0]) return true;
        if (v[0] === base[0] && v[1] > base[1]) return true;
        if (v[0] === base[0] && v[1] === base[1] && v[2] >= base[2]) return true;
        return false;
    }
    
    return false;
}

// ========== TERMINAL SIMULATOR ==========
function initTerminal() {
    const input = document.getElementById('terminalInput');
    input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            const cmd = this.value.trim();
            if (cmd) executeCommand(cmd);
            this.value = '';
        }
    });
}

function executeCommand(cmd) {
    const body = document.getElementById('terminalBody');
    
    // Add the command line
    body.innerHTML += `<div class="terminal-line"><span class="terminal-prompt">$</span><span class="terminal-cmd">${escapeHtml(cmd)}</span></div>`;
    
    // Process command
    const output = processCommand(cmd.toLowerCase().trim());
    body.innerHTML += `<div class="terminal-output ${output.type}">${output.text}</div>`;
    
    body.scrollTop = body.scrollHeight;
    
    if (output.xp) {
        addXP(output.xp);
        state.correct++;
        updateStats();
    }
}

function processCommand(cmd) {
    const commands = {
        'npm init -y': {
            text: `Wrote to /my-project/package.json:

{
  "name": "my-project",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \\"Error: no test\\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}`,
            type: 'terminal-success', xp: 5
        },
        'npm init': {
            text: `This utility will walk you through creating a package.json file.
Use \`npm init -y\` for defaults.

package name: (my-project)
version: (1.0.0)
...
Is this OK? (yes)`,
            type: '', xp: 5
        },
        'npm install express': {
            text: `added 64 packages in 3s

8 packages are looking for funding
  run \`npm fund\` for details`,
            type: 'terminal-success', xp: 5
        },
        'npm i express': {
            text: `added 64 packages in 2.8s

8 packages are looking for funding
  run \`npm fund\` for details`,
            type: 'terminal-success', xp: 5
        },
        'npm i -d jest': {
            text: `added 283 packages in 12s

35 packages are looking for funding
  run \`npm fund\` for details`,
            type: 'terminal-success', xp: 5
        },
        'npm audit': {
            text: `found 0 vulnerabilities

‚úÖ No known vulnerabilities found. Your dependencies are secure!`,
            type: 'terminal-success', xp: 5
        },
        'npm run build': {
            text: `> my-project@1.0.0 build
> webpack --mode production

asset main.js 128 KiB [emitted] [minimized]
webpack compiled successfully in 2341 ms ‚úÖ`,
            type: 'terminal-success', xp: 5
        },
        'npm test': {
            text: `> my-project@1.0.0 test
> jest --coverage

 PASS  test/index.test.js
  ‚úì should add numbers (3ms)
  ‚úì should subtract numbers (1ms)

Test Suites: 1 passed, 1 total
Tests:       2 passed, 2 total
Coverage:    100%`,
            type: 'terminal-success', xp: 5
        },
        'npm outdated': {
            text: `Package     Current  Wanted  Latest  Location
express      4.18.2  4.18.3  5.0.0   node_modules/express
lodash       4.17.20 4.17.21 4.17.21 node_modules/lodash
jest         29.6.0  29.7.0  29.7.0  node_modules/jest`,
            type: 'terminal-warn', xp: 5
        },
        'npm version patch': {
            text: `v1.0.1`,
            type: 'terminal-success', xp: 5
        },
        'npm version minor': {
            text: `v1.1.0`,
            type: 'terminal-success', xp: 5
        },
        'npm version major': {
            text: `v2.0.0`,
            type: 'terminal-success', xp: 5
        },
        'npm publish': {
            text: `npm notice 
npm notice üì¶  my-project@1.0.0
npm notice === Tarball Contents ===
npm notice 1.2kB  dist/index.js
npm notice 0.5kB  package.json
npm notice 2.1kB  README.md
npm notice === Tarball Details ===
npm notice name:          my-project
npm notice version:       1.0.0
npm notice filename:      my-project-1.0.0.tgz
npm notice total files:   3
npm notice
+ my-project@1.0.0  ‚úÖ Published!`,
            type: 'terminal-success', xp: 5
        },
        'npm pack --dry-run': {
            text: `npm notice 
npm notice üì¶  my-project@1.0.0
npm notice === Tarball Contents ===
npm notice 1.2kB  dist/index.js
npm notice 0.5kB  package.json
npm notice 2.1kB  README.md
npm notice === Tarball Details ===
npm notice name:          my-project
npm notice version:       1.0.0
npm notice total files:   3
npm notice unpacked size: 3.8 kB
npm notice tarball size:  1.4 kB`,
            type: '', xp: 5
        },
        'npm ls --depth=0': {
            text: `my-project@1.0.0
‚îú‚îÄ‚îÄ express@4.18.2
‚îú‚îÄ‚îÄ cors@2.8.5
‚îî‚îÄ‚îÄ dotenv@16.3.1`,
            type: '', xp: 5
        },
        'npm ci': {
            text: `removed 0 packages, and audited 283 packages in 4s

found 0 vulnerabilities ‚úÖ
(clean install from package-lock.json)`,
            type: 'terminal-success', xp: 5
        },
        'npm --version': {
            text: '10.2.4',
            type: '', xp: 0
        },
        'node --version': {
            text: 'v20.10.0',
            type: '', xp: 0
        },
        'npm audit fix': {
            text: `fixed 0 of 0 vulnerabilities
‚úÖ Nothing to fix!`,
            type: 'terminal-success', xp: 5
        },
        'npm ls': {
            text: `my-project@1.0.0
‚îú‚îÄ‚îÄ express@4.18.2
‚îÇ   ‚îú‚îÄ‚îÄ body-parser@1.20.1
‚îÇ   ‚îú‚îÄ‚îÄ cookie@0.5.0
‚îÇ   ‚îî‚îÄ‚îÄ ... (58 more)
‚îú‚îÄ‚îÄ cors@2.8.5
‚îî‚îÄ‚îÄ dotenv@16.3.1`,
            type: '', xp: 5
        },
        'npm run': {
            text: `Lifecycle scripts included in my-project@1.0.0:
  test
    jest --coverage
  start
    node src/index.js

available via \`npm run-script\`:
  dev
    nodemon src/index.js
  build
    webpack --mode production
  lint
    eslint src/ --ext .js`,
            type: '', xp: 5
        },
        'clear': { text: '', type: 'clear', xp: 0 },
        'help': {
            text: `Available commands to try:
  npm init -y           Create package.json
  npm install express   Install a package
  npm i -D jest         Install dev dependency
  npm audit             Check vulnerabilities
  npm run build         Run build script
  npm test              Run tests
  npm outdated          Check for updates
  npm version patch     Bump version
  npm publish           Publish package
  npm pack --dry-run    Preview publish contents
  npm ls --depth=0      List dependencies
  npm ci                Clean install
  npm run               List all scripts
  clear                 Clear terminal`,
            type: 'terminal-success', xp: 0
        }
    };

    if (cmd === 'clear') {
        document.getElementById('terminalBody').innerHTML = '';
        return { text: '', type: '' };
    }

    const result = commands[cmd];
    if (result) return result;

    // Fuzzy match
    for (const [key, val] of Object.entries(commands)) {
        if (cmd.replace(/\s+/g, ' ') === key) return val;
    }

    return {
        text: `Command not recognized: "${cmd}"\nType "help" to see available commands.`,
        type: 'terminal-error',
        xp: 0
    };
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// ========== VISUAL EFFECTS ==========
function showConfetti() {
    const colors = ['#6c5ce7', '#a29bfe', '#00cec9', '#00b894', '#fdcb6e', '#fd79a8'];
    for (let i = 0; i < 8; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = Math.random() * 100 + 'vw';
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDuration = (2 + Math.random() * 2) + 's';
        piece.style.animationDelay = Math.random() * 0.5 + 's';
        const size = 6 + Math.random() * 8;
        piece.style.width = size + 'px';
        piece.style.height = size + 'px';
        document.body.appendChild(piece);
        setTimeout(() => piece.remove(), 4000);
    }
}

function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3200);
}

// ========== INITIALIZE ==========
init();
</script>

</body>
</html>