<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéØ RegEx Mastery - Interactive JS Regex Learning</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0a0a1a;--card:#12122a;--card2:#1a1a3e;--border:#2a2a5e;
  --primary:#7c6cf0;--secondary:#00d2d3;--accent:#ff6b9d;--warn:#ffc048;
  --success:#2ed573;--danger:#ff4757;--text:#e8e8ff;--muted:#8888aa;
  --code-bg:#0d0d22;--highlight:rgba(124,108,240,0.15);
}
body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;overflow:hidden}
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--primary)}

/* Sidebar */
.sidebar{width:240px;min-width:240px;background:var(--card);border-right:1px solid var(--border);display:flex;flex-direction:column;height:100vh;position:relative;z-index:10}
.sidebar-header{padding:20px;border-bottom:1px solid var(--border);text-align:center}
.sidebar-header h1{font-size:1.3em;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px}
.sidebar-header p{font-size:0.75em;color:var(--muted)}
.nav-items{flex:1;overflow-y:auto;padding:10px}
.nav-item{display:flex;align-items:center;gap:10px;padding:12px 16px;border-radius:10px;cursor:pointer;transition:all .2s;margin-bottom:4px;font-size:0.9em;color:var(--muted);position:relative}
.nav-item:hover{background:var(--highlight);color:var(--text)}
.nav-item.active{background:linear-gradient(135deg,rgba(124,108,240,0.2),rgba(255,107,157,0.1));color:var(--primary);font-weight:600;border:1px solid rgba(124,108,240,0.3)}
.nav-item .icon{font-size:1.2em;width:28px;text-align:center}
.nav-item .badge{margin-left:auto;background:var(--primary);color:#fff;font-size:0.7em;padding:2px 7px;border-radius:10px}
.progress-bar-container{padding:15px 20px;border-top:1px solid var(--border)}
.progress-label{display:flex;justify-content:space-between;font-size:0.75em;color:var(--muted);margin-bottom:6px}
.progress-track{height:6px;background:var(--border);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;transition:width .5s ease;width:0%}

/* Main Content */
.main{flex:1;overflow-y:auto;height:100vh;scroll-behavior:smooth}
.section{display:none;padding:30px 40px;max-width:1000px;margin:0 auto;animation:fadeIn .4s ease}
.section.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
h2{font-size:1.8em;margin-bottom:8px;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
h3{font-size:1.3em;color:var(--secondary);margin:25px 0 12px;display:flex;align-items:center;gap:8px}
h4{color:var(--accent);margin:18px 0 8px;font-size:1.05em}
.subtitle{color:var(--muted);margin-bottom:25px;font-size:1em}
p{line-height:1.7;margin-bottom:12px;color:#c8c8e8}

/* Cards */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:22px;margin-bottom:18px;transition:all .3s}
.card:hover{border-color:rgba(124,108,240,0.3)}
.card-header{display:flex;align-items:center;gap:10px;margin-bottom:12px;font-weight:600;font-size:1.05em}
.card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:15px;margin:15px 0}

/* Code blocks */
.code-block{background:var(--code-bg);border:1px solid var(--border);border-radius:10px;padding:16px 20px;margin:12px 0;font-family:'Fira Code','Cascadia Code',monospace;font-size:0.88em;line-height:1.8;overflow-x:auto;position:relative}
.code-block .label{position:absolute;top:8px;right:12px;font-size:0.7em;color:var(--muted);background:var(--card);padding:2px 8px;border-radius:4px;font-family:'Segoe UI',sans-serif}
code{font-family:'Fira Code','Cascadia Code',monospace;background:rgba(124,108,240,0.15);padding:2px 7px;border-radius:4px;font-size:0.88em;color:var(--secondary)}
.kw{color:var(--accent)}
.str{color:var(--success)}
.cm{color:var(--muted);font-style:italic}
.fn{color:var(--secondary)}
.num{color:var(--warn)}
.rx{color:var(--accent)}
.res{color:var(--warn)}

/* Interactive Playground */
.playground{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:22px;margin:18px 0}
.playground-title{font-weight:600;margin-bottom:14px;display:flex;align-items:center;gap:8px;color:var(--secondary)}
.input-group{margin-bottom:14px}
.input-group label{display:block;font-size:0.85em;color:var(--muted);margin-bottom:6px}
.input-group input,.input-group textarea,.input-group select{width:100%;background:var(--code-bg);border:1px solid var(--border);color:var(--text);padding:12px 16px;border-radius:8px;font-family:'Fira Code',monospace;font-size:0.9em;outline:none;transition:border .2s}
.input-group input:focus,.input-group textarea:focus{border-color:var(--primary)}
.input-group textarea{resize:vertical;min-height:80px;line-height:1.6}
.result-box{background:var(--code-bg);border:1px solid var(--border);border-radius:8px;padding:14px 18px;min-height:50px;font-family:'Fira Code',monospace;font-size:0.88em;line-height:1.8;white-space:pre-wrap;word-break:break-all}
.match-highlight{background:rgba(124,108,240,0.35);border:1px solid var(--primary);border-radius:3px;padding:1px 2px;color:#fff}
.match-group{background:rgba(0,210,211,0.25);border:1px solid var(--secondary);border-radius:3px;padding:1px 2px}
.flags-row{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
.flag-toggle{display:flex;align-items:center;gap:6px;padding:6px 14px;background:var(--code-bg);border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:all .2s;font-size:0.85em;user-select:none}
.flag-toggle:hover{border-color:var(--primary)}
.flag-toggle.active{background:rgba(124,108,240,0.2);border-color:var(--primary);color:var(--primary)}
.flag-toggle input{display:none}

/* Buttons */
.btn{padding:10px 22px;border:none;border-radius:8px;cursor:pointer;font-size:0.9em;font-weight:600;transition:all .2s;display:inline-flex;align-items:center;gap:7px}
.btn-primary{background:linear-gradient(135deg,var(--primary),#9b6cf0);color:#fff}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(124,108,240,0.3)}
.btn-success{background:linear-gradient(135deg,var(--success),#26c968);color:#fff}
.btn-danger{background:linear-gradient(135deg,var(--danger),#ff3344);color:#fff}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text)}
.btn-outline:hover{border-color:var(--primary);background:var(--highlight)}
.btn-sm{padding:7px 14px;font-size:0.82em}
.btn-group{display:flex;gap:10px;margin:15px 0;flex-wrap:wrap}

/* Tables */
.ref-table{width:100%;border-collapse:collapse;margin:15px 0;font-size:0.9em}
.ref-table th{background:var(--card2);padding:12px 16px;text-align:left;font-weight:600;color:var(--secondary);border-bottom:2px solid var(--border)}
.ref-table td{padding:10px 16px;border-bottom:1px solid rgba(42,42,94,0.5)}
.ref-table tr:hover td{background:var(--highlight)}
.ref-table td:first-child{font-family:'Fira Code',monospace;color:var(--accent);white-space:nowrap}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:6px;font-size:0.78em;font-weight:600;margin:2px}
.tag-green{background:rgba(46,213,115,0.15);color:var(--success);border:1px solid rgba(46,213,115,0.3)}
.tag-red{background:rgba(255,71,87,0.15);color:var(--danger);border:1px solid rgba(255,71,87,0.3)}
.tag-blue{background:rgba(124,108,240,0.15);color:var(--primary);border:1px solid rgba(124,108,240,0.3)}
.tag-orange{background:rgba(255,192,72,0.15);color:var(--warn);border:1px solid rgba(255,192,72,0.3)}

/* Quiz */
.quiz-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:24px;margin:18px 0}
.quiz-question{font-size:1.05em;font-weight:600;margin-bottom:16px;line-height:1.5}
.quiz-options{display:flex;flex-direction:column;gap:8px}
.quiz-option{padding:12px 18px;background:var(--code-bg);border:2px solid var(--border);border-radius:10px;cursor:pointer;transition:all .2s;font-size:0.92em;display:flex;align-items:center;gap:10px}
.quiz-option:hover{border-color:var(--primary);background:var(--highlight)}
.quiz-option.selected{border-color:var(--primary);background:rgba(124,108,240,0.15)}
.quiz-option.correct{border-color:var(--success);background:rgba(46,213,115,0.1)}
.quiz-option.wrong{border-color:var(--danger);background:rgba(255,71,87,0.1)}
.quiz-option .letter{width:28px;height:28px;border-radius:50%;background:var(--border);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:0.85em;flex-shrink:0}
.quiz-explanation{margin-top:12px;padding:14px;background:rgba(46,213,115,0.08);border:1px solid rgba(46,213,115,0.2);border-radius:8px;display:none;font-size:0.9em;line-height:1.6}
.quiz-score{text-align:center;padding:30px;font-size:1.4em}

/* Exercise */
.exercise{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:24px;margin:18px 0}
.exercise-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.exercise-status{font-size:0.85em;padding:4px 12px;border-radius:6px}
.exercise-desc{color:#b8b8d8;margin-bottom:14px;line-height:1.6}
.exercise-feedback{margin-top:12px;padding:12px 16px;border-radius:8px;display:none;font-size:0.9em}
.exercise-feedback.success{display:block;background:rgba(46,213,115,0.1);border:1px solid rgba(46,213,115,0.25);color:var(--success)}
.exercise-feedback.error{display:block;background:rgba(255,71,87,0.1);border:1px solid rgba(255,71,87,0.25);color:var(--danger)}

/* Pitfall */
.pitfall{border-radius:14px;padding:22px;margin:15px 0;border-left:4px solid}
.pitfall.bad{background:rgba(255,71,87,0.06);border-color:var(--danger)}
.pitfall.good{background:rgba(46,213,115,0.06);border-color:var(--success)}
.pitfall-label{font-weight:700;font-size:0.85em;margin-bottom:8px;display:flex;align-items:center;gap:6px}

/* Tooltip */
.tip{background:rgba(0,210,211,0.08);border:1px solid rgba(0,210,211,0.2);border-radius:10px;padding:14px 18px;margin:12px 0;font-size:0.9em}
.tip::before{content:'üí° ';font-size:1.1em}
.warn-box{background:rgba(255,192,72,0.08);border:1px solid rgba(255,192,72,0.2);border-radius:10px;padding:14px 18px;margin:12px 0;font-size:0.9em}
.warn-box::before{content:'‚ö†Ô∏è '}

/* Visual Regex Builder */
.regex-visual{display:flex;flex-wrap:wrap;gap:6px;margin:12px 0;align-items:center}
.regex-part{padding:8px 14px;border-radius:8px;font-family:'Fira Code',monospace;font-size:0.88em;position:relative;cursor:help;border:1px solid transparent}
.regex-part.literal{background:rgba(46,213,115,0.15);color:var(--success);border-color:rgba(46,213,115,0.3)}
.regex-part.meta{background:rgba(124,108,240,0.15);color:var(--primary);border-color:rgba(124,108,240,0.3)}
.regex-part.quantifier{background:rgba(255,192,72,0.15);color:var(--warn);border-color:rgba(255,192,72,0.3)}
.regex-part.anchor{background:rgba(255,107,157,0.15);color:var(--accent);border-color:rgba(255,107,157,0.3)}
.regex-part.group{background:rgba(0,210,211,0.15);color:var(--secondary);border-color:rgba(0,210,211,0.3)}
.regex-part .tooltip{position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);background:var(--card2);border:1px solid var(--border);padding:8px 12px;border-radius:8px;font-size:0.82em;white-space:nowrap;display:none;z-index:100;font-family:'Segoe UI',sans-serif;color:var(--text);box-shadow:0 4px 20px rgba(0,0,0,0.3)}
.regex-part:hover .tooltip{display:block}

/* Tabs */
.tabs{display:flex;gap:6px;margin-bottom:18px;flex-wrap:wrap;border-bottom:1px solid var(--border);padding-bottom:10px}
.tab{padding:8px 18px;border-radius:8px;cursor:pointer;font-size:0.88em;color:var(--muted);transition:all .2s;border:1px solid transparent}
.tab:hover{color:var(--text)}
.tab.active{background:var(--highlight);color:var(--primary);border-color:rgba(124,108,240,0.3)}
.tab-content{display:none}
.tab-content.active{display:block;animation:fadeIn .3s ease}

/* Animations */
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes slideIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}
.animate-in{animation:slideIn .3s ease}

/* Stats */
.stats-row{display:flex;gap:15px;margin:20px 0;flex-wrap:wrap}
.stat-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;flex:1;min-width:120px;text-align:center}
.stat-card .number{font-size:2em;font-weight:700;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.stat-card .label{font-size:0.8em;color:var(--muted);margin-top:4px}

/* Method signature */
.method-sig{background:var(--code-bg);border:1px solid var(--border);border-radius:10px;padding:14px 20px;font-family:'Fira Code',monospace;font-size:0.92em;margin:10px 0;border-left:3px solid var(--primary)}

/* Responsive */
@media(max-width:768px){
  .sidebar{width:60px;min-width:60px}
  .sidebar .nav-text,.sidebar-header p,.sidebar-header h1,.progress-label,.badge{display:none}
  .sidebar-header{padding:15px 10px}
  .nav-item{justify-content:center;padding:12px}
  .nav-item .icon{width:auto;font-size:1.3em}
  .section{padding:20px 15px}
  .card-grid{grid-template-columns:1fr}
}

/* Run button */
.run-btn{position:absolute;top:8px;right:8px;padding:4px 12px;background:var(--primary);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:0.75em;font-weight:600;opacity:0;transition:opacity .2s}
.code-block:hover .run-btn{opacity:1}
.code-output{background:#0a0a15;border:1px solid var(--border);border-top:none;border-radius:0 0 10px 10px;padding:12px 20px;font-family:'Fira Code',monospace;font-size:0.85em;margin-top:-12px;margin-bottom:12px;color:var(--success);display:none}
.code-output.visible{display:block}
.code-output::before{content:'‚ñ∏ Output: ';color:var(--muted);font-size:0.9em}

/* Cheatsheet */
.cheatsheet-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}
.cheat-item{background:var(--code-bg);border:1px solid var(--border);border-radius:8px;padding:10px 14px;display:flex;align-items:center;gap:12px}
.cheat-item .sym{font-family:'Fira Code',monospace;color:var(--accent);font-weight:700;min-width:50px;font-size:0.95em}
.cheat-item .desc{font-size:0.82em;color:var(--muted)}
</style>
</head>
<body>

<!-- SIDEBAR -->
<nav class="sidebar">
  <div class="sidebar-header">
    <h1>üéØ RegEx Mastery</h1>
    <p>JavaScript Edition</p>
  </div>
  <div class="nav-items" id="navItems">
    <div class="nav-item active" data-section="intro" onclick="showSection('intro')">
      <span class="icon">üöÄ</span><span class="nav-text">Introduction</span>
    </div>
    <div class="nav-item" data-section="syntax" onclick="showSection('syntax')">
      <span class="icon">üî§</span><span class="nav-text">Regex Syntax</span>
    </div>
    <div class="nav-item" data-section="methods" onclick="showSection('methods')">
      <span class="icon">üõ†Ô∏è</span><span class="nav-text">Methods</span>
    </div>
    <div class="nav-item" data-section="flags" onclick="showSection('flags')">
      <span class="icon">üö©</span><span class="nav-text">Flags</span>
    </div>
    <div class="nav-item" data-section="patterns" onclick="showSection('patterns')">
      <span class="icon">üìã</span><span class="nav-text">Common Patterns</span>
    </div>
    <div class="nav-item" data-section="playground" onclick="showSection('playground')">
      <span class="icon">üéÆ</span><span class="nav-text">Playground</span>
    </div>
    <div class="nav-item" data-section="exercises" onclick="showSection('exercises')">
      <span class="icon">üí™</span><span class="nav-text">Exercises</span><span class="badge" id="exBadge">0/8</span>
    </div>
    <div class="nav-item" data-section="quiz" onclick="showSection('quiz')">
      <span class="icon">üß†</span><span class="nav-text">Quiz</span><span class="badge" id="qzBadge">0/10</span>
    </div>
    <div class="nav-item" data-section="pitfalls" onclick="showSection('pitfalls')">
      <span class="icon">‚ö†Ô∏è</span><span class="nav-text">Pitfalls</span>
    </div>
    <div class="nav-item" data-section="cheatsheet" onclick="showSection('cheatsheet')">
      <span class="icon">üìù</span><span class="nav-text">Cheat Sheet</span>
    </div>
  </div>
  <div class="progress-bar-container">
    <div class="progress-label"><span>Progress</span><span id="progressPct">0%</span></div>
    <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
  </div>
</nav>

<!-- MAIN CONTENT -->
<main class="main" id="mainContent">

<!-- ==================== SECTION: INTRO ==================== -->
<div class="section active" id="sec-intro">
  <h2>üöÄ Introduction to Regular Expressions</h2>
  <p class="subtitle">Master the art of pattern matching in JavaScript</p>

  <div class="card">
    <div class="card-header">ü§î What are Regular Expressions?</div>
    <p>Regular Expressions (regex/regexp) are <strong>patterns</strong> used to match character combinations in strings. Think of them as a super-powered search tool that goes way beyond simple <code>Ctrl+F</code>.</p>
    <p>They let you: <span class="tag tag-green">Search</span> <span class="tag tag-blue">Validate</span> <span class="tag tag-orange">Extract</span> <span class="tag tag-red">Replace</span> text patterns.</p>
  </div>

  <h3>üì¶ Two Ways to Create a Regex</h3>
  <div class="card-grid">
    <div class="card">
      <div class="card-header"><span class="tag tag-green">Way 1</span> Regex Literal</div>
      <div class="code-block">
<span class="cm">// Pattern between forward slashes</span>
<span class="kw">const</span> regex = <span class="rx">/hello/i</span>;
<span class="cm">// ‚Üë pattern ‚Üë flag</span>

<span class="cm">// Best when pattern is KNOWN at code time</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><span class="tag tag-blue">Way 2</span> RegExp Constructor</div>
      <div class="code-block">
<span class="cm">// Using new RegExp(pattern, flags)</span>
<span class="kw">const</span> regex = <span class="kw">new</span> <span class="fn">RegExp</span>(<span class="str">'hello'</span>, <span class="str">'i'</span>);

<span class="cm">// Best when pattern is DYNAMIC (user input)</span>
      </div>
    </div>
  </div>

  <h3>‚ö° Your First Regex ‚Äî Try It Live!</h3>
  <div class="playground" id="introPlayground">
    <div class="playground-title">üéÆ Interactive: Match a Word</div>
    <div class="input-group">
      <label>Regex Pattern (without slashes):</label>
      <input type="text" id="introRegex" value="hello" placeholder="Type your regex...">
    </div>
    <div class="input-group">
      <label>Test String:</label>
      <input type="text" id="introText" value="Say hello to the world! Hello again." placeholder="Type text to test against...">
    </div>
    <div class="flags-row">
      <label class="flag-toggle active" onclick="this.classList.toggle('active');runIntro()"><input type="checkbox" checked>g (global)</label>
      <label class="flag-toggle active" onclick="this.classList.toggle('active');runIntro()"><input type="checkbox" checked>i (case-insensitive)</label>
    </div>
    <div class="result-box" id="introResult"></div>
  </div>

  <h3>üéØ Why Regex Matters for JS Developers</h3>
  <div class="stats-row">
    <div class="stat-card"><div class="number">90%</div><div class="label">of JS codebases use regex</div></div>
    <div class="stat-card"><div class="number">Top 5</div><div class="label">interview topic</div></div>
    <div class="stat-card"><div class="number">10x</div><div class="label">faster than manual parsing</div></div>
  </div>

  <div class="card">
    <div class="card-header">üè¢ Real-World Use Cases</div>
    <div class="code-block">
<span class="cm">// 1. Form Validation</span>
<span class="kw">const</span> isEmail = <span class="rx">/^[\w.-]+@[\w.-]+\.\w{2,}$/</span>.<span class="fn">test</span>(input);

<span class="cm">// 2. Extract data from strings</span>
<span class="kw">const</span> price = <span class="str">"Total: $49.99"</span>.<span class="fn">match</span>(<span class="rx">/\$[\d.]+/</span>); <span class="cm">// ["$49.99"]</span>

<span class="cm">// 3. Search & Replace</span>
<span class="kw">const</span> clean = text.<span class="fn">replace</span>(<span class="rx">/\s+/g</span>, <span class="str">' '</span>); <span class="cm">// collapse spaces</span>

<span class="cm">// 4. Parse URLs, logs, CSV, markdown...</span>
<span class="kw">const</span> [, year, month, day] = date.<span class="fn">match</span>(<span class="rx">/(\d{4})-(\d{2})-(\d{2})/</span>);
    </div>
  </div>

  <div class="tip">Ready to become a regex wizard? Let's start with the syntax ‚Äî it's simpler than it looks! Click <strong>"Regex Syntax"</strong> in the sidebar to continue.</div>
</div>

<!-- ==================== SECTION: SYNTAX ==================== -->
<div class="section" id="sec-syntax">
  <h2>üî§ Regex Syntax Deep Dive</h2>
  <p class="subtitle">Every symbol explained with visual breakdowns and interactive examples</p>

  <div class="tabs" id="syntaxTabs">
    <div class="tab active" onclick="showTab('syntax','chars')">Character Classes</div>
    <div class="tab" onclick="showTab('syntax','quant')">Quantifiers</div>
    <div class="tab" onclick="showTab('syntax','anchors')">Anchors</div>
    <div class="tab" onclick="showTab('syntax','groups')">Groups</div>
    <div class="tab" onclick="showTab('syntax','lookaround')">Lookaround</div>
  </div>

  <!-- Characters Tab -->
  <div class="tab-content active" id="syntax-chars">
    <h3>üìå Character Classes ‚Äî What to Match</h3>

    <table class="ref-table">
      <thead><tr><th>Pattern</th><th>Meaning</th><th>Example Match</th></tr></thead>
      <tbody>
        <tr><td>.</td><td>Any character except newline</td><td><code>/h.t/</code> ‚Üí "h<strong>a</strong>t", "h<strong>o</strong>t"</td></tr>
        <tr><td>\d</td><td>Any digit [0-9]</td><td><code>/\d\d/</code> ‚Üí "<strong>42</strong>"</td></tr>
        <tr><td>\D</td><td>Non-digit [^0-9]</td><td><code>/\D/</code> ‚Üí "<strong>a</strong>bc"</td></tr>
        <tr><td>\w</td><td>Word char [a-zA-Z0-9_]</td><td><code>/\w+/</code> ‚Üí "<strong>hello</strong>!"</td></tr>
        <tr><td>\W</td><td>Non-word char</td><td><code>/\W/</code> ‚Üí "hi<strong>!</strong>"</td></tr>
        <tr><td>\s</td><td>Whitespace (space, tab, newline)</td><td><code>/\s/</code> ‚Üí "a<strong> </strong>b"</td></tr>
        <tr><td>\S</td><td>Non-whitespace</td><td><code>/\S+/</code> ‚Üí "<strong>hello</strong> world"</td></tr>
        <tr><td>[abc]</td><td>Any of: a, b, or c</td><td><code>/[aeiou]/</code> ‚Üí "h<strong>e</strong>llo"</td></tr>
        <tr><td>[^abc]</td><td>NOT a, b, or c</td><td><code>/[^aeiou]/g</code> ‚Üí "<strong>h</strong>e<strong>ll</strong>o"</td></tr>
        <tr><td>[a-z]</td><td>Range: a through z</td><td><code>/[A-Z]/</code> ‚Üí "<strong>H</strong>ello"</td></tr>
        <tr><td>\t \n \r</td><td>Tab, newline, carriage return</td><td>Whitespace variants</td></tr>
      </tbody>
    </table>

    <h4>üîç Visual Breakdown: <code>/\d{3}-\d{4}/</code></h4>
    <div class="regex-visual">
      <div class="regex-part meta">\d<span class="tooltip">Any digit 0-9</span></div>
      <div class="regex-part quantifier">{3}<span class="tooltip">Exactly 3 times</span></div>
      <div class="regex-part literal">-<span class="tooltip">Literal hyphen</span></div>
      <div class="regex-part meta">\d<span class="tooltip">Any digit 0-9</span></div>
      <div class="regex-part quantifier">{4}<span class="tooltip">Exactly 4 times</span></div>
    </div>
    <p style="color:var(--muted);font-size:0.88em">üëÜ Hover each part to see what it means! Matches: "555-1234"</p>

    <div class="playground">
      <div class="playground-title">üéÆ Try Character Classes</div>
      <div class="input-group">
        <label>Regex:</label>
        <input type="text" id="charRegex" value="\d+" placeholder="e.g. \w+">
      </div>
      <div class="input-group">
        <label>Test String:</label>
        <input type="text" id="charText" value="Order #4521 placed on 2024-01-15 for $99.50" placeholder="Enter text...">
      </div>
      <button class="btn btn-primary btn-sm" onclick="runSyntaxDemo('char')">‚ñ∂ Run</button>
      <div class="result-box" id="charResult" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Quantifiers Tab -->
  <div class="tab-content" id="syntax-quant">
    <h3>üî¢ Quantifiers ‚Äî How Many to Match</h3>

    <table class="ref-table">
      <thead><tr><th>Pattern</th><th>Meaning</th><th>Example</th></tr></thead>
      <tbody>
        <tr><td>*</td><td>0 or more (greedy)</td><td><code>/go*/</code> ‚Üí "g", "go", "gooo"</td></tr>
        <tr><td>+</td><td>1 or more (greedy)</td><td><code>/go+/</code> ‚Üí "go", "goo" (not "g")</td></tr>
        <tr><td>?</td><td>0 or 1 (optional)</td><td><code>/colou?r/</code> ‚Üí "color", "colour"</td></tr>
        <tr><td>{n}</td><td>Exactly n times</td><td><code>/\d{4}/</code> ‚Üí "2024"</td></tr>
        <tr><td>{n,}</td><td>n or more times</td><td><code>/\d{2,}/</code> ‚Üí "42", "123" (not "5")</td></tr>
        <tr><td>{n,m}</td><td>Between n and m times</td><td><code>/\d{2,4}/</code> ‚Üí "42", "123", "1234"</td></tr>
        <tr><td>*?</td><td>0 or more (lazy/non-greedy)</td><td><code>/".+?"/</code> ‚Üí smallest match</td></tr>
        <tr><td>+?</td><td>1 or more (lazy)</td><td>Matches as FEW as possible</td></tr>
      </tbody>
    </table>

    <h4>‚öîÔ∏è Greedy vs Lazy ‚Äî The Key Difference</h4>
    <div class="card-grid">
      <div class="card">
        <div class="card-header"><span class="tag tag-orange">Greedy</span> Default behavior</div>
        <div class="code-block">
<span class="kw">const</span> str = <span class="str">'say "hello" and "bye"'</span>;
str.<span class="fn">match</span>(<span class="rx">/".+"/</span>);
<span class="cm">// ‚Üí ['"hello" and "bye"']  ‚Üê too much!</span>
<span class="cm">// Greedy .+ grabs EVERYTHING it can</span>
        </div>
      </div>
      <div class="card">
        <div class="card-header"><span class="tag tag-green">Lazy</span> Add ? after quantifier</div>
        <div class="code-block">
<span class="kw">const</span> str = <span class="str">'say "hello" and "bye"'</span>;
str.<span class="fn">match</span>(<span class="rx">/".+?"/g</span>);
<span class="cm">// ‚Üí ['"hello"', '"bye"']  ‚Üê perfect!</span>
<span class="cm">// Lazy .+? grabs as LITTLE as possible</span>
        </div>
      </div>
    </div>

    <div class="playground">
      <div class="playground-title">üéÆ Greedy vs Lazy Comparison</div>
      <div class="input-group">
        <label>Test String:</label>
        <input type="text" id="quantText" value='<div>Hello</div><div>World</div>' placeholder="Enter text...">
      </div>
      <div class="btn-group">
        <button class="btn btn-primary btn-sm" onclick="runQuantDemo('greedy')">‚ñ∂ Greedy: <code>&lt;.+&gt;</code></button>
        <button class="btn btn-success btn-sm" onclick="runQuantDemo('lazy')">‚ñ∂ Lazy: <code>&lt;.+?&gt;</code></button>
      </div>
      <div class="result-box" id="quantResult" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Anchors Tab -->
  <div class="tab-content" id="syntax-anchors">
    <h3>‚öì Anchors ‚Äî Where to Match</h3>
    <p>Anchors don't match characters ‚Äî they match <strong>positions</strong>.</p>

    <table class="ref-table">
      <thead><tr><th>Pattern</th><th>Meaning</th><th>Example</th></tr></thead>
      <tbody>
        <tr><td>^</td><td>Start of string (or line with /m)</td><td><code>/^Hello/</code> ‚Üí matches "Hello world" but not "Say Hello"</td></tr>
        <tr><td>$</td><td>End of string (or line with /m)</td><td><code>/world$/</code> ‚Üí matches "Hello world" but not "world peace"</td></tr>
        <tr><td>\b</td><td>Word boundary</td><td><code>/\bcat\b/</code> ‚Üí matches "cat" but NOT "caterpillar"</td></tr>
        <tr><td>\B</td><td>NOT a word boundary</td><td><code>/\Bcat/</code> ‚Üí matches "s<strong>cat</strong>ter" but NOT "cat"</td></tr>
      </tbody>
    </table>

    <h4>üîç Visual: Word Boundaries</h4>
    <div class="code-block">
<span class="cm">// \b marks the edge between a \w and a \W character</span>

<span class="str">"the cat scattered"</span>
     <span class="cm"> ‚Üë   ‚Üë               ‚Üê \bcat\b matches only here</span>
     <span class="cm">     not "scattered" because 's' is before 'cat'</span>

<span class="rx">/\bcat\b/</span>.<span class="fn">test</span>(<span class="str">"the cat sat"</span>)     <span class="cm">// true  ‚úÖ</span>
<span class="rx">/\bcat\b/</span>.<span class="fn">test</span>(<span class="str">"caterpillar"</span>)    <span class="cm">// false ‚ùå</span>
<span class="rx">/\bcat\b/</span>.<span class="fn">test</span>(<span class="str">"scattered"</span>)      <span class="cm">// false ‚ùå</span>
<span class="rx">/\bcat\b/</span>.<span class="fn">test</span>(<span class="str">"the cat's toy"</span>)  <span class="cm">// true  ‚úÖ</span>
    </div>

    <div class="playground">
      <div class="playground-title">üéÆ Try Anchors</div>
      <div class="input-group">
        <label>Regex:</label>
        <input type="text" id="anchorRegex" value="^\w+" placeholder="e.g. \bword\b">
      </div>
      <div class="input-group">
        <label>Test String:</label>
        <textarea id="anchorText" rows="3">Hello World
Goodbye World
Hello Again</textarea>
      </div>
      <div class="flags-row">
        <label class="flag-toggle active" onclick="this.classList.toggle('active')"><input type="checkbox" checked>g</label>
        <label class="flag-toggle" onclick="this.classList.toggle('active')"><input type="checkbox">m (multiline)</label>
      </div>
      <button class="btn btn-primary btn-sm" onclick="runAnchorDemo()">‚ñ∂ Run</button>
      <div class="result-box" id="anchorResult" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Groups Tab -->
  <div class="tab-content" id="syntax-groups">
    <h3>üì¶ Groups & Alternation</h3>

    <table class="ref-table">
      <thead><tr><th>Pattern</th><th>Meaning</th><th>Example</th></tr></thead>
      <tbody>
        <tr><td>(abc)</td><td>Capturing group</td><td><code>/(foo)(bar)/</code> ‚Üí captures "foo" and "bar"</td></tr>
        <tr><td>(?:abc)</td><td>Non-capturing group</td><td><code>/(?:foo)bar/</code> ‚Üí groups but doesn't capture</td></tr>
        <tr><td>(?&lt;name&gt;abc)</td><td>Named capturing group</td><td><code>/(?&lt;year&gt;\d{4})/</code></td></tr>
        <tr><td>\1</td><td>Backreference to group 1</td><td><code>/(\w+) \1/</code> ‚Üí "the the"</td></tr>
        <tr><td>a|b</td><td>Alternation (OR)</td><td><code>/cat|dog/</code> ‚Üí "cat" or "dog"</td></tr>
      </tbody>
    </table>

    <h4>üíé Capturing Groups in Action</h4>
    <div class="code-block">
<span class="cm">// Extract parts of a date</span>
<span class="kw">const</span> dateStr = <span class="str">"2024-01-15"</span>;
<span class="kw">const</span> regex = <span class="rx">/(\d{4})-(\d{2})-(\d{2})/</span>;
<span class="kw">const</span> match = dateStr.<span class="fn">match</span>(regex);

console.<span class="fn">log</span>(match[<span class="num">0</span>]); <span class="cm">// "2024-01-15" (full match)</span>
console.<span class="fn">log</span>(match[<span class="num">1</span>]); <span class="cm">// "2024" (year)</span>
console.<span class="fn">log</span>(match[<span class="num">2</span>]); <span class="cm">// "01" (month)</span>
console.<span class="fn">log</span>(match[<span class="num">3</span>]); <span class="cm">// "15" (day)</span>
    </div>

    <h4>üè∑Ô∏è Named Groups (Modern JS)</h4>
    <div class="code-block">
<span class="kw">const</span> regex = <span class="rx">/(?&lt;year&gt;\d{4})-(?&lt;month&gt;\d{2})-(?&lt;day&gt;\d{2})/</span>;
<span class="kw">const</span> match = <span class="str">"2024-01-15"</span>.<span class="fn">match</span>(regex);

console.<span class="fn">log</span>(match.groups.year);   <span class="cm">// "2024"</span>
console.<span class="fn">log</span>(match.groups.month);  <span class="cm">// "01"</span>
console.<span class="fn">log</span>(match.groups.day);    <span class="cm">// "15"</span>
    </div>

    <h4>üîÅ Backreferences ‚Äî Match Repeated Words</h4>
    <div class="code-block">
<span class="cm">// Find duplicate words</span>
<span class="kw">const</span> regex = <span class="rx">/\b(\w+)\s+\1\b/gi</span>;
<span class="str">"the the quick brown fox fox"</span>.<span class="fn">match</span>(regex);
<span class="cm">// ‚Üí ["the the", "fox fox"]</span>

<span class="cm">// \1 refers back to whatever group 1 captured!</span>
    </div>

    <div class="playground">
      <div class="playground-title">üéÆ Try Groups ‚Äî Extract Date Parts</div>
      <div class="input-group">
        <label>Regex (with groups):</label>
        <input type="text" id="groupRegex" value="(\d{4})-(\d{2})-(\d{2})" placeholder="e.g. (\w+)">
      </div>
      <div class="input-group">
        <label>Test String:</label>
        <input type="text" id="groupText" value="Born on 1995-07-23, graduated 2017-06-15" placeholder="Enter text...">
      </div>
      <button class="btn btn-primary btn-sm" onclick="runGroupDemo()">‚ñ∂ Extract Groups</button>
      <div class="result-box" id="groupResult" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Lookaround Tab -->
  <div class="tab-content" id="syntax-lookaround">
    <h3>üëÄ Lookahead & Lookbehind</h3>
    <p>These assert that a pattern <strong>exists</strong> (or doesn't) without including it in the match.</p>

    <table class="ref-table">
      <thead><tr><th>Pattern</th><th>Name</th><th>Meaning</th></tr></thead>
      <tbody>
        <tr><td>(?=abc)</td><td>Positive Lookahead</td><td>Followed by "abc"</td></tr>
        <tr><td>(?!abc)</td><td>Negative Lookahead</td><td>NOT followed by "abc"</td></tr>
        <tr><td>(?&lt;=abc)</td><td>Positive Lookbehind</td><td>Preceded by "abc"</td></tr>
        <tr><td>(?&lt;!abc)</td><td>Negative Lookbehind</td><td>NOT preceded by "abc"</td></tr>
      </tbody>
    </table>

    <div class="code-block">
<span class="cm">// Lookahead: Match number ONLY if followed by "px"</span>
<span class="str">"12px 5em 30px"</span>.<span class="fn">match</span>(<span class="rx">/\d+(?=px)/g</span>);
<span class="cm">// ‚Üí ["12", "30"]  ‚Üê "5" excluded (followed by "em")</span>

<span class="cm">// Negative lookahead: NOT followed by "px"</span>
<span class="str">"12px 5em 30px"</span>.<span class="fn">match</span>(<span class="rx">/\d+(?!px)\b/g</span>);
<span class="cm">// ‚Üí ["5"]</span>

<span class="cm">// Lookbehind: Match number AFTER "$"</span>
<span class="str">"$100 ‚Ç¨200 $300"</span>.<span class="fn">match</span>(<span class="rx">/(?&lt;=\$)\d+/g</span>);
<span class="cm">// ‚Üí ["100", "300"]</span>

<span class="cm">// Password: must contain uppercase, lowercase, digit</span>
<span class="kw">const</span> strongPw = <span class="rx">/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/</span>;
    </div>

    <div class="tip">Lookaround is <strong>zero-width</strong> ‚Äî it checks but doesn't consume characters. This means the same position can be checked by multiple lookarounds (great for password validation).</div>
  </div>
</div>

<!-- ==================== SECTION: METHODS ==================== -->
<div class="section" id="sec-methods">
  <h2>üõ†Ô∏è Regex Methods in JavaScript</h2>
  <p class="subtitle">Master every method ‚Äî know exactly when to use each one</p>

  <div class="tabs" id="methodTabs">
    <div class="tab active" onclick="showTab('method','test')">test()</div>
    <div class="tab" onclick="showTab('method','exec')">exec()</div>
    <div class="tab" onclick="showTab('method','match')">match()</div>
    <div class="tab" onclick="showTab('method','matchall')">matchAll()</div>
    <div class="tab" onclick="showTab('method','replace')">replace()</div>
    <div class="tab" onclick="showTab('method','search')">search()</div>
    <div class="tab" onclick="showTab('method','split')">split()</div>
  </div>

  <div class="tab-content active" id="method-test">
    <h3>‚úÖ RegExp.prototype.test()</h3>
    <div class="method-sig"><span class="fn">regex</span>.<span class="fn">test</span>(<span class="str">string</span>) ‚Üí <span class="kw">boolean</span></div>
    <p>Returns <code>true</code> or <code>false</code>. The simplest method ‚Äî perfect for <strong>validation</strong>.</p>
    <div class="code-block" id="codeTest">
<span class="kw">const</span> emailRegex = <span class="rx">/^[\w.-]+@[\w.-]+\.\w{2,}$/</span>;

emailRegex.<span class="fn">test</span>(<span class="str">"user@email.com"</span>);   <span class="cm">// true ‚úÖ</span>
emailRegex.<span class="fn">test</span>(<span class="str">"not-an-email"</span>);     <span class="cm">// false ‚ùå</span>
emailRegex.<span class="fn">test</span>(<span class="str">"@missing.com"</span>);     <span class="cm">// false ‚ùå</span>

<span class="cm">// Common use: conditionals</span>
<span class="kw">if</span> (<span class="rx">/^\d+$/</span>.<span class="fn">test</span>(input)) {
  console.<span class="fn">log</span>(<span class="str">"It's a number!"</span>);
}
    </div>
    <div class="warn-box"><strong>Pitfall with /g flag:</strong> <code>test()</code> with global flag remembers <code>lastIndex</code> and can return alternating true/false! See Pitfalls section.</div>
  </div>

  <div class="tab-content" id="method-exec">
    <h3>üî¨ RegExp.prototype.exec()</h3>
    <div class="method-sig"><span class="fn">regex</span>.<span class="fn">exec</span>(<span class="str">string</span>) ‚Üí <span class="kw">Array | null</span></div>
    <p>Returns detailed match info including groups and index. Use in a <strong>loop with /g</strong> for all matches.</p>
    <div class="code-block">
<span class="kw">const</span> regex = <span class="rx">/(\d{4})-(\d{2})/g</span>;
<span class="kw">const</span> str = <span class="str">"Dates: 2024-01, 2023-12"</span>;
<span class="kw">let</span> match;

<span class="kw">while</span> ((match = regex.<span class="fn">exec</span>(str)) !== <span class="kw">null</span>) {
  console.<span class="fn">log</span>(<span class="str">`Full: ${match[0]}`</span>);     <span class="cm">// "2024-01", "2023-12"</span>
  console.<span class="fn">log</span>(<span class="str">`Year: ${match[1]}`</span>);     <span class="cm">// "2024", "2023"</span>
  console.<span class="fn">log</span>(<span class="str">`Month: ${match[2]}`</span>);    <span class="cm">// "01", "12"</span>
  console.<span class="fn">log</span>(<span class="str">`Index: ${match.index}`</span>); <span class="cm">// 7, 16</span>
}
    </div>
  </div>

  <div class="tab-content" id="method-match">
    <h3>üéØ String.prototype.match()</h3>
    <div class="method-sig"><span class="str">string</span>.<span class="fn">match</span>(<span class="fn">regex</span>) ‚Üí <span class="kw">Array | null</span></div>
    <p>Behavior changes based on the <code>g</code> flag!</p>
    <div class="card-grid">
      <div class="card">
        <div class="card-header"><span class="tag tag-orange">Without /g</span></div>
        <div class="code-block">
<span class="str">"Price: $42.50"</span>.<span class="fn">match</span>(<span class="rx">/\$(\d+\.?\d*)/</span>);
<span class="cm">// ["$42.50", "42.50", index: 7, groups: undefined]</span>
<span class="cm">// Returns FIRST match + groups</span>
        </div>
      </div>
      <div class="card">
        <div class="card-header"><span class="tag tag-green">With /g</span></div>
        <div class="code-block">
<span class="str">"$42 and $99"</span>.<span class="fn">match</span>(<span class="rx">/\$\d+/g</span>);
<span class="cm">// ["$42", "$99"]</span>
<span class="cm">// Returns ALL matches, NO groups</span>
        </div>
      </div>
    </div>
    <div class="tip">Without <code>/g</code>: detailed info for first match. With <code>/g</code>: all matches but no group details. Need both? Use <code>matchAll()</code>!</div>
  </div>

  <div class="tab-content" id="method-matchall">
    <h3>üåü String.prototype.matchAll()</h3>
    <div class="method-sig"><span class="str">string</span>.<span class="fn">matchAll</span>(<span class="fn">regex</span>) ‚Üí <span class="kw">Iterator</span></div>
    <p>Returns an iterator of ALL matches WITH full details. <strong>Requires /g flag.</strong> The modern best practice!</p>
    <div class="code-block">
<span class="kw">const</span> str = <span class="str">"2024-01-15 and 2023-12-25"</span>;
<span class="kw">const</span> regex = <span class="rx">/(?&lt;year&gt;\d{4})-(?&lt;month&gt;\d{2})-(?&lt;day&gt;\d{2})/g</span>;

<span class="kw">for</span> (<span class="kw">const</span> match <span class="kw">of</span> str.<span class="fn">matchAll</span>(regex)) {
  console.<span class="fn">log</span>(match[<span class="num">0</span>]);              <span class="cm">// full match</span>
  console.<span class="fn">log</span>(match.groups.year);     <span class="cm">// named group</span>
  console.<span class="fn">log</span>(match.index);           <span class="cm">// position</span>
}

<span class="cm">// Or convert to array:</span>
<span class="kw">const</span> allMatches = [...str.<span class="fn">matchAll</span>(regex)];
    </div>
  </div>

  <div class="tab-content" id="method-replace">
    <h3>üîÑ String.prototype.replace() / replaceAll()</h3>
    <div class="method-sig"><span class="str">string</span>.<span class="fn">replace</span>(<span class="fn">regex</span>, <span class="str">replacement</span>) ‚Üí <span class="kw">string</span></div>
    <div class="code-block">
<span class="cm">// Simple replacement</span>
<span class="str">"Hello World"</span>.<span class="fn">replace</span>(<span class="rx">/world/i</span>, <span class="str">"JS"</span>);
<span class="cm">// ‚Üí "Hello JS"</span>

<span class="cm">// Using captured groups in replacement</span>
<span class="str">"John Smith"</span>.<span class="fn">replace</span>(<span class="rx">/(\w+) (\w+)/</span>, <span class="str">"$2, $1"</span>);
<span class="cm">// ‚Üí "Smith, John"  ‚Üê $1 and $2 reference groups!</span>

<span class="cm">// Using a function for dynamic replacement</span>
<span class="str">"3 cats and 5 dogs"</span>.<span class="fn">replace</span>(<span class="rx">/\d+/g</span>, (n) => n * 2);
<span class="cm">// ‚Üí "6 cats and 10 dogs"</span>

<span class="cm">// Mask sensitive data</span>
<span class="str">"Card: 4532-1234-5678-9012"</span>.<span class="fn">replace</span>(
  <span class="rx">/(\d{4})-(\d{4})-(\d{4})-(\d{4})/</span>,
  <span class="str">"****-****-****-$4"</span>
);
<span class="cm">// ‚Üí "Card: ****-****-****-9012"</span>
    </div>
  </div>

  <div class="tab-content" id="method-search">
    <h3>üîç String.prototype.search()</h3>
    <div class="method-sig"><span class="str">string</span>.<span class="fn">search</span>(<span class="fn">regex</span>) ‚Üí <span class="kw">number</span></div>
    <p>Returns the <strong>index</strong> of the first match, or <code>-1</code> if not found. Like <code>indexOf</code> but with regex!</p>
    <div class="code-block">
<span class="str">"Hello 42 World"</span>.<span class="fn">search</span>(<span class="rx">/\d+/</span>);    <span class="cm">// 6</span>
<span class="str">"Hello World"</span>.<span class="fn">search</span>(<span class="rx">/\d+/</span>);       <span class="cm">// -1</span>
<span class="str">"Hello World"</span>.<span class="fn">search</span>(<span class="rx">/world/i</span>);    <span class="cm">// 6</span>
    </div>
  </div>

  <div class="tab-content" id="method-split">
    <h3>‚úÇÔ∏è String.prototype.split()</h3>
    <div class="method-sig"><span class="str">string</span>.<span class="fn">split</span>(<span class="fn">regex</span>) ‚Üí <span class="kw">Array</span></div>
    <p>Split a string using a regex pattern as the delimiter.</p>
    <div class="code-block">
<span class="cm">// Split by any whitespace</span>
<span class="str">"one  two\tthree\nfour"</span>.<span class="fn">split</span>(<span class="rx">/\s+/</span>);
<span class="cm">// ‚Üí ["one", "two", "three", "four"]</span>

<span class="cm">// Split and keep delimiters (use capturing group)</span>
<span class="str">"one1two2three"</span>.<span class="fn">split</span>(<span class="rx">/(\d)/</span>);
<span class="cm">// ‚Üí ["one", "1", "two", "2", "three"]</span>

<span class="cm">// Parse CSV (handle commas in quotes)</span>
<span class="str">"a,b,c"</span>.<span class="fn">split</span>(<span class="rx">/,/</span>);
<span class="cm">// ‚Üí ["a", "b", "c"]</span>
    </div>
  </div>

  <h3 style="margin-top:30px">üìä Method Comparison Cheat Table</h3>
  <table class="ref-table">
    <thead><tr><th>Method</th><th>Called On</th><th>Returns</th><th>Best For</th></tr></thead>
    <tbody>
      <tr><td>test()</td><td>RegExp</td><td>Boolean</td><td>Validation (yes/no)</td></tr>
      <tr><td>exec()</td><td>RegExp</td><td>Array/null</td><td>Iterative matching with groups</td></tr>
      <tr><td>match()</td><td>String</td><td>Array/null</td><td>Find one or all matches</td></tr>
      <tr><td>matchAll()</td><td>String</td><td>Iterator</td><td>All matches with full details</td></tr>
      <tr><td>replace()</td><td>String</td><td>String</td><td>Find & replace</td></tr>
      <tr><td>search()</td><td>String</td><td>Number</td><td>Find position</td></tr>
      <tr><td>split()</td><td>String</td><td>Array</td><td>Tokenize strings</td></tr>
    </tbody>
  </table>

  <div class="playground">
    <div class="playground-title">üéÆ Method Explorer ‚Äî Try Any Method</div>
    <div class="input-group">
      <label>Choose Method:</label>
      <select id="methodSelect" onchange="updateMethodDemo()" style="padding:10px;background:var(--code-bg);border:1px solid var(--border);color:var(--text);border-radius:8px;font-size:0.9em">
        <option value="test">regex.test(string)</option>
        <option value="match">string.match(regex)</option>
        <option value="matchAll">string.matchAll(regex)</option>
        <option value="replace">string.replace(regex, replacement)</option>
        <option value="search">string.search(regex)</option>
        <option value="split">string.split(regex)</option>
      </select>
    </div>
    <div class="input-group">
      <label>Regex:</label>
      <input type="text" id="methodRegex" value="\d+" placeholder="Pattern">
    </div>
    <div class="input-group">
      <label>Test String:</label>
      <input type="text" id="methodText" value="I have 3 cats and 5 dogs" placeholder="Enter text">
    </div>
    <div class="input-group" id="replaceGroup" style="display:none">
      <label>Replacement:</label>
      <input type="text" id="methodReplace" value="[NUMBER]" placeholder="Replacement string">
    </div>
    <div class="flags-row">
      <label class="flag-toggle active" onclick="this.classList.toggle('active')"><input type="checkbox" checked>g</label>
      <label class="flag-toggle active" onclick="this.classList.toggle('active')"><input type="checkbox" checked>i</label>
    </div>
    <button class="btn btn-primary btn-sm" onclick="runMethodDemo()">‚ñ∂ Run</button>
    <div class="result-box" id="methodResult" style="margin-top:12px"></div>
  </div>
</div>

<!-- ==================== SECTION: FLAGS ==================== -->
<div class="section" id="sec-flags">
  <h2>üö© Flags & Modifiers</h2>
  <p class="subtitle">Flags change HOW the regex engine processes your pattern</p>

  <div class="card-grid">
    <div class="card">
      <div class="card-header"><code>g</code> ‚Äî Global</div>
      <p>Find ALL matches, not just the first one.</p>
      <div class="code-block">
<span class="str">"ha ha ha"</span>.<span class="fn">match</span>(<span class="rx">/ha/</span>);   <span class="cm">// ["ha"]</span>
<span class="str">"ha ha ha"</span>.<span class="fn">match</span>(<span class="rx">/ha/g</span>);  <span class="cm">// ["ha","ha","ha"]</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><code>i</code> ‚Äî Case Insensitive</div>
      <p>Ignore uppercase/lowercase differences.</p>
      <div class="code-block">
<span class="rx">/hello/</span>.<span class="fn">test</span>(<span class="str">"Hello"</span>);   <span class="cm">// false</span>
<span class="rx">/hello/i</span>.<span class="fn">test</span>(<span class="str">"Hello"</span>);  <span class="cm">// true</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><code>m</code> ‚Äî Multiline</div>
      <p>Makes <code>^</code> and <code>$</code> match start/end of each <strong>line</strong>.</p>
      <div class="code-block">
<span class="kw">const</span> text = <span class="str">`line1\nline2\nline3`</span>;
text.<span class="fn">match</span>(<span class="rx">/^\w+/g</span>);   <span class="cm">// ["line1"]</span>
text.<span class="fn">match</span>(<span class="rx">/^\w+/gm</span>);  <span class="cm">// ["line1","line2","line3"]</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><code>s</code> ‚Äî DotAll</div>
      <p>Makes <code>.</code> also match <code>\n</code> (newline).</p>
      <div class="code-block">
<span class="rx">/hello.world/</span>.<span class="fn">test</span>(<span class="str">"hello\nworld"</span>);
<span class="cm">// false ‚Äî . doesn't match \n</span>
<span class="rx">/hello.world/s</span>.<span class="fn">test</span>(<span class="str">"hello\nworld"</span>);
<span class="cm">// true ‚Äî with /s, . matches everything</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><code>u</code> ‚Äî Unicode</div>
      <p>Enables full Unicode support (emoji, CJK, etc).</p>
      <div class="code-block">
<span class="rx">/^.$/</span>.<span class="fn">test</span>(<span class="str">"üòÄ"</span>);   <span class="cm">// false ‚Üê emoji = 2 chars!</span>
<span class="rx">/^.$/u</span>.<span class="fn">test</span>(<span class="str">"üòÄ"</span>);  <span class="cm">// true  ‚Üê /u handles it</span>

<span class="cm">// Unicode property escapes</span>
<span class="rx">/\p{Emoji}/u</span>.<span class="fn">test</span>(<span class="str">"üòÄ"</span>);  <span class="cm">// true</span>
      </div>
    </div>
    <div class="card">
      <div class="card-header"><code>y</code> ‚Äî Sticky</div>
      <p>Matches only at <code>lastIndex</code> position.</p>
      <div class="code-block">
<span class="kw">const</span> r = <span class="rx">/\d+/y</span>;
r.lastIndex = <span class="num">4</span>;
r.<span class="fn">exec</span>(<span class="str">"abc 123"</span>); <span class="cm">// ["123"]</span>
r.lastIndex = <span class="num">0</span>;
r.<span class="fn">exec</span>(<span class="str">"abc 123"</span>); <span class="cm">// null ‚Üê not at 0!</span>
      </div>
    </div>
  </div>

  <div class="playground">
    <div class="playground-title">üéÆ Flag Toggle Demo</div>
    <div class="input-group">
      <label>Regex Pattern:</label>
      <input type="text" id="flagRegex" value="hello" placeholder="Pattern">
    </div>
    <div class="input-group">
      <label>Test String:</label>
      <textarea id="flagText" rows="3">Hello World
hello again
HELLO there</textarea>
    </div>
    <div class="flags-row" id="flagToggles">
      <label class="flag-toggle" onclick="this.classList.toggle('active');runFlagDemo()"><input type="checkbox">g</label>
      <label class="flag-toggle" onclick="this.classList.toggle('active');runFlagDemo()"><input type="checkbox">i</label>
      <label class="flag-toggle" onclick="this.classList.toggle('active');runFlagDemo()"><input type="checkbox">m</label>
      <label class="flag-toggle" onclick="this.classList.toggle('active');runFlagDemo()"><input type="checkbox">s</label>
      <label class="flag-toggle" onclick="this.classList.toggle('active');runFlagDemo()"><input type="checkbox">u</label>
    </div>
    <div class="result-box" id="flagResult"></div>
  </div>
</div>

<!-- ==================== SECTION: PATTERNS ==================== -->
<div class="section" id="sec-patterns">
  <h2>üìã Common Real-World Patterns</h2>
  <p class="subtitle">Copy-paste ready patterns you'll use in actual projects</p>

  <div id="patternCards"></div>

  <div class="playground">
    <div class="playground-title">üéÆ Pattern Tester ‚Äî Validate Anything</div>
    <div class="input-group">
      <label>Choose a Pattern:</label>
      <select id="patternSelect" onchange="loadPattern()" style="padding:10px;background:var(--code-bg);border:1px solid var(--border);color:var(--text);border-radius:8px;font-size:0.9em;width:100%">
      </select>
    </div>
    <div class="input-group">
      <label>Regex (editable):</label>
      <input type="text" id="patternRegex" placeholder="Pattern will load here...">
    </div>
    <div class="input-group">
      <label>Test Input:</label>
      <input type="text" id="patternInput" placeholder="Type to validate...">
    </div>
    <button class="btn btn-primary btn-sm" onclick="testPattern()">‚ñ∂ Validate</button>
    <div class="result-box" id="patternResult" style="margin-top:12px"></div>
  </div>
</div>

<!-- ==================== SECTION: PLAYGROUND ==================== -->
<div class="section" id="sec-playground">
  <h2>üéÆ Regex Playground</h2>
  <p class="subtitle">Your sandbox ‚Äî test any regex with live match highlighting</p>

  <div class="playground" style="background:var(--card);border-color:var(--primary)">
    <div class="input-group">
      <label>Regular Expression:</label>
      <div style="display:flex;gap:8px;align-items:center">
        <span style="font-size:1.2em;color:var(--muted)">/</span>
        <input type="text" id="pgRegex" value="(\w+)@(\w+)\.(\w+)" placeholder="Your pattern here" oninput="runPlayground()">
        <span style="font-size:1.2em;color:var(--muted)">/</span>
        <input type="text" id="pgFlags" value="g" style="width:60px;text-align:center" placeholder="gi" oninput="runPlayground()">
      </div>
    </div>
    <div class="input-group">
      <label>Test String:</label>
      <textarea id="pgText" rows="5" oninput="runPlayground()">Contact us at support@company.com or sales@shop.org for more info. You can also reach admin@test.co.uk anytime.</textarea>
    </div>
    <h4 style="color:var(--secondary)">üéØ Match Results</h4>
    <div class="result-box" id="pgHighlight" style="min-height:60px"></div>
    <h4 style="color:var(--secondary)">üìä Match Details</h4>
    <div class="result-box" id="pgDetails" style="min-height:40px"></div>
    <div style="display:flex;gap:15px;margin-top:12px;flex-wrap:wrap">
      <div id="pgMatchCount" style="font-size:0.85em;color:var(--muted)">Matches: 0</div>
      <div id="pgGroupCount" style="font-size:0.85em;color:var(--muted)">Groups: 0</div>
    </div>
  </div>
</div>

<!-- ==================== SECTION: EXERCISES ==================== -->
<div class="section" id="sec-exercises">
  <h2>üí™ Exercises ‚Äî Practice Makes Perfect</h2>
  <p class="subtitle">Write regex patterns to solve each challenge. <span id="exScore" style="color:var(--success)">0/8 completed</span></p>

  <div id="exerciseContainer"></div>
</div>

<!-- ==================== SECTION: QUIZ ==================== -->
<div class="section" id="sec-quiz">
  <h2>üß† Quiz ‚Äî Test Your Knowledge</h2>
  <p class="subtitle">10 questions covering everything you've learned. <span id="quizScoreDisplay" style="color:var(--success)"></span></p>

  <div id="quizContainer"></div>
  <div class="btn-group" style="justify-content:center;margin-top:20px">
    <button class="btn btn-primary" onclick="resetQuiz()">üîÑ Reset Quiz</button>
  </div>
</div>

<!-- ==================== SECTION: PITFALLS ==================== -->
<div class="section" id="sec-pitfalls">
  <h2>‚ö†Ô∏è Common Pitfalls & Mistakes</h2>
  <p class="subtitle">Avoid these traps that catch even experienced developers</p>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #1: The Sticky lastIndex Bug</div>
    <p>Using <code>test()</code> or <code>exec()</code> with the <code>/g</code> flag on the <strong>same regex object</strong> causes alternating results!</p>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå WRONG ‚Äî Reusing /g regex with test()</div>
      <div class="code-block">
<span class="kw">const</span> regex = <span class="rx">/hello/g</span>;
regex.<span class="fn">test</span>(<span class="str">"hello world"</span>); <span class="cm">// true  (lastIndex ‚Üí 5)</span>
regex.<span class="fn">test</span>(<span class="str">"hello world"</span>); <span class="cm">// false (starts at 5!)</span>
regex.<span class="fn">test</span>(<span class="str">"hello world"</span>); <span class="cm">// true  (reset to 0)</span>
<span class="cm">// üò± Alternates true/false forever!</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Don't use /g with test(), or use literal</div>
      <div class="code-block">
<span class="cm">// Option 1: Remove /g flag</span>
<span class="kw">const</span> regex = <span class="rx">/hello/</span>; <span class="cm">// no /g</span>
regex.<span class="fn">test</span>(<span class="str">"hello"</span>); <span class="cm">// always consistent</span>

<span class="cm">// Option 2: Use inline regex literal</span>
<span class="rx">/hello/g</span>.<span class="fn">test</span>(<span class="str">"hello"</span>); <span class="cm">// creates new regex each time</span>

<span class="cm">// Option 3: Reset lastIndex</span>
regex.lastIndex = <span class="num">0</span>;
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #2: Forgetting to Escape Special Characters</div>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå WRONG</div>
      <div class="code-block">
<span class="cm">// Trying to match "3.14"</span>
<span class="rx">/3.14/</span>.<span class="fn">test</span>(<span class="str">"3X14"</span>); <span class="cm">// true! . matches ANY character</span>

<span class="cm">// Trying to match "$100"</span>
<span class="rx">/$100/</span>.<span class="fn">test</span>(<span class="str">"$100"</span>); <span class="cm">// false! $ means end-of-string</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Escape with backslash</div>
      <div class="code-block">
<span class="rx">/3\.14/</span>.<span class="fn">test</span>(<span class="str">"3.14"</span>);   <span class="cm">// true ‚úÖ</span>
<span class="rx">/3\.14/</span>.<span class="fn">test</span>(<span class="str">"3X14"</span>);   <span class="cm">// false ‚úÖ</span>

<span class="rx">/\$100/</span>.<span class="fn">test</span>(<span class="str">"$100"</span>);   <span class="cm">// true ‚úÖ</span>

<span class="cm">// Special chars to escape: . * + ? ^ $ { } [ ] ( ) | \ /</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #3: Double Escaping in RegExp Constructor</div>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå WRONG</div>
      <div class="code-block">
<span class="cm">// In constructor, backslash needs escaping itself!</span>
<span class="kw">new</span> <span class="fn">RegExp</span>(<span class="str">"\d+"</span>);  <span class="cm">// Actually matches "d+" (wrong!)</span>
<span class="cm">// The string "\d" is just "d" ‚Äî JS eats the backslash</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Double the backslash</div>
      <div class="code-block">
<span class="kw">new</span> <span class="fn">RegExp</span>(<span class="str">"\\d+"</span>);       <span class="cm">// Correct! Matches digits</span>
<span class="kw">new</span> <span class="fn">RegExp</span>(<span class="str">"\\$\\d+\\.\\d+"</span>); <span class="cm">// Matches "$12.50"</span>

<span class="cm">// Or just use regex literals when possible:</span>
<span class="rx">/\d+/</span>     <span class="cm">// Much cleaner! No double escaping needed</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #4: Greedy by Default</div>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå Unexpected behavior</div>
      <div class="code-block">
<span class="cm">// Trying to extract HTML tags individually</span>
<span class="str">"&lt;b&gt;bold&lt;/b&gt; and &lt;i&gt;italic&lt;/i&gt;"</span>.<span class="fn">match</span>(<span class="rx">/&lt;.+&gt;/</span>);
<span class="cm">// ‚Üí ["&lt;b&gt;bold&lt;/b&gt; and &lt;i&gt;italic&lt;/i&gt;"]  ‚Üê grabs everything!</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Use lazy quantifier or negated class</div>
      <div class="code-block">
<span class="cm">// Lazy quantifier</span>
<span class="str">"&lt;b&gt;bold&lt;/b&gt;"</span>.<span class="fn">match</span>(<span class="rx">/&lt;.+?&gt;/g</span>);
<span class="cm">// ‚Üí ["&lt;b&gt;", "&lt;/b&gt;"]  ‚úÖ</span>

<span class="cm">// Negated character class (often faster)</span>
<span class="str">"&lt;b&gt;bold&lt;/b&gt;"</span>.<span class="fn">match</span>(<span class="rx">/&lt;[^&gt;]+&gt;/g</span>);
<span class="cm">// ‚Üí ["&lt;b&gt;", "&lt;/b&gt;"]  ‚úÖ</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #5: Catastrophic Backtracking</div>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå Can freeze your browser!</div>
      <div class="code-block">
<span class="cm">// Nested quantifiers on overlapping patterns</span>
<span class="rx">/(a+)+b/</span>.<span class="fn">test</span>(<span class="str">"aaaaaaaaaaaaaaaaaaaaac"</span>);
<span class="cm">// üò± Takes exponential time! Browser hangs!</span>

<span class="cm">// The engine tries every possible combination</span>
<span class="cm">// of splitting the a's between the inner and outer +</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Avoid nested quantifiers or use atomic groups</div>
      <div class="code-block">
<span class="cm">// Simplify the pattern</span>
<span class="rx">/a+b/</span>.<span class="fn">test</span>(<span class="str">"aaaaaaaaaaaaaaac"</span>); <span class="cm">// instant!</span>

<span class="cm">// Rules to avoid catastrophic backtracking:</span>
<span class="cm">// 1. Never nest quantifiers: (a+)+ or (a*)*</span>
<span class="cm">// 2. Be specific: use [^"]* instead of .*</span>
<span class="cm">// 3. Use possessive quantifiers if available</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">üî¥ Pitfall #6: match() with /g Loses Group Info</div>
    <div class="pitfall bad">
      <div class="pitfall-label" style="color:var(--danger)">‚ùå Groups disappear with /g</div>
      <div class="code-block">
<span class="kw">const</span> str = <span class="str">"2024-01, 2023-12"</span>;
str.<span class="fn">match</span>(<span class="rx">/(\d{4})-(\d{2})/g</span>);
<span class="cm">// ‚Üí ["2024-01", "2023-12"]  ‚Üê where are my groups?!</span>
      </div>
    </div>
    <div class="pitfall good">
      <div class="pitfall-label" style="color:var(--success)">‚úÖ FIX ‚Äî Use matchAll() instead</div>
      <div class="code-block">
<span class="kw">const</span> str = <span class="str">"2024-01, 2023-12"</span>;
<span class="kw">for</span> (<span class="kw">const</span> m <span class="kw">of</span> str.<span class="fn">matchAll</span>(<span class="rx">/(\d{4})-(\d{2})/g</span>)) {
  console.<span class="fn">log</span>(m[<span class="num">1</span>], m[<span class="num">2</span>]); <span class="cm">// "2024" "01" then "2023" "12" ‚úÖ</span>
}
      </div>
    </div>
  </div>
</div>

<!-- ==================== SECTION: CHEATSHEET ==================== -->
<div class="section" id="sec-cheatsheet">
  <h2>üìù Regex Cheat Sheet</h2>
  <p class="subtitle">Your quick reference for everything regex in JavaScript</p>

  <h3>üî§ Character Classes</h3>
  <div class="cheatsheet-grid" id="cheatChars"></div>

  <h3>üî¢ Quantifiers</h3>
  <div class="cheatsheet-grid" id="cheatQuant"></div>

  <h3>‚öì Anchors & Boundaries</h3>
  <div class="cheatsheet-grid" id="cheatAnchors"></div>

  <h3>üì¶ Groups & Lookaround</h3>
  <div class="cheatsheet-grid" id="cheatGroups"></div>

  <h3>üö© Flags</h3>
  <div class="cheatsheet-grid" id="cheatFlags"></div>

  <h3>üõ†Ô∏è Methods Quick Ref</h3>
  <div class="cheatsheet-grid" id="cheatMethods"></div>
</div>

</main>

<script>
// ========== NAVIGATION ==========
const visited = new Set(['intro']);
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('sec-' + id).classList.add('active');
  document.querySelector(`[data-section="${id}"]`).classList.add('active');
  visited.add(id);
  updateProgress();
  document.getElementById('mainContent').scrollTop = 0;
  // Run initial demos
  if (id === 'intro') runIntro();
  if (id === 'playground') runPlayground();
  if (id === 'flags') runFlagDemo();
}

function updateProgress() {
  const total = document.querySelectorAll('.nav-item').length;
  const pct = Math.round((visited.size / total) * 100);
  document.getElementById('progressPct').textContent = pct + '%';
  document.getElementById('progressFill').style.width = pct + '%';
}

// ========== TABS ==========
function showTab(prefix, name) {
  const container = document.getElementById('sec-' + (prefix === 'syntax' ? 'syntax' : 'methods'));
  const tabId = prefix === 'syntax' ? 'syntaxTabs' : 'methodTabs';
  document.querySelectorAll(`#${tabId} .tab`).forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  const allTC = container.querySelectorAll('.tab-content');
  allTC.forEach(tc => tc.classList.remove('active'));
  const target = document.getElementById(prefix + '-' + name);
  if (target) target.classList.add('active');
}

// ========== HELPER: Highlight matches ==========
function highlightMatches(text, regex) {
  if (!regex) return escapeHtml(text);
  try {
    const r = new RegExp(regex.source, regex.flags.includes('g') ? regex.flags : regex.flags + 'g');
    let result = '';
    let lastIdx = 0;
    let m;
    let safety = 0;
    while ((m = r.exec(text)) !== null && safety++ < 500) {
      if (m.index > lastIdx) result += escapeHtml(text.slice(lastIdx, m.index));
      result += `<span class="match-highlight">${escapeHtml(m[0])}</span>`;
      lastIdx = r.lastIndex;
      if (m[0].length === 0) r.lastIndex++;
    }
    if (lastIdx < text.length) result += escapeHtml(text.slice(lastIdx));
    return result || escapeHtml(text);
  } catch(e) {
    return escapeHtml(text) + `\n<span style="color:var(--danger)">Error: ${e.message}</span>`;
  }
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function safeRegex(pattern, flags) {
  try { return new RegExp(pattern, flags); }
  catch(e) { return null; }
}

// ========== INTRO DEMO ==========
function runIntro() {
  const pat = document.getElementById('introRegex').value;
  const text = document.getElementById('introText').value;
  const flagEls = document.querySelectorAll('#introPlayground .flag-toggle');
  let flags = '';
  if (flagEls[0].classList.contains('active')) flags += 'g';
  if (flagEls[1].classList.contains('active')) flags += 'i';
  const r = safeRegex(pat, flags);
  if (!r) {
    document.getElementById('introResult').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }
  const highlighted = highlightMatches(text, r);
  const matches = text.match(r);
  document.getElementById('introResult').innerHTML = highlighted +
    `\n\n<span style="color:var(--muted)">Matches found: <span style="color:var(--success)">${matches ? matches.length : 0}</span></span>`;
}

// ========== SYNTAX DEMOS ==========
function runSyntaxDemo(type) {
  const pat = document.getElementById(type + 'Regex').value;
  const text = document.getElementById(type + 'Text').value;
  const r = safeRegex(pat, 'g');
  if (!r) {
    document.getElementById(type + 'Result').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }
  const highlighted = highlightMatches(text, r);
  const matches = text.match(r);
  document.getElementById(type + 'Result').innerHTML = highlighted +
    `\n\n<span style="color:var(--muted)">Matches: <span style="color:var(--warn)">[${matches ? matches.map(m => `"${m}"`).join(', ') : ''}]</span></span>`;
}

function runQuantDemo(type) {
  const text = document.getElementById('quantText').value;
  const pat = type === 'greedy' ? '<.+>' : '<.+?>';
  const r = new RegExp(pat, 'g');
  const highlighted = highlightMatches(text, r);
  const matches = text.match(r);
  document.getElementById('quantResult').innerHTML =
    `<span style="color:var(--muted)">${type === 'greedy' ? 'üü° Greedy' : 'üü¢ Lazy'}: /${pat}/g</span>\n` +
    highlighted +
    `\n\n<span style="color:var(--warn)">Matches: [${matches ? matches.map(m => `"${escapeHtml(m)}"`).join(', ') : ''}]</span>`;
}

function runAnchorDemo() {
  const pat = document.getElementById('anchorRegex').value;
  const text = document.getElementById('anchorText').value;
  const flagEls = document.querySelectorAll('#sec-syntax .tab-content:nth-child(3) .flag-toggle');
  let flags = '';
  flagEls.forEach(f => { if (f.classList.contains('active')) flags += f.textContent.trim().charAt(0); });
  const r = safeRegex(pat, flags);
  if (!r) {
    document.getElementById('anchorResult').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }
  const highlighted = highlightMatches(text, r);
  const matches = text.match(r);
  document.getElementById('anchorResult').innerHTML = highlighted +
    `\n\n<span style="color:var(--muted)">Matches: [${matches ? matches.map(m => `"${m}"`).join(', ') : 'none'}]</span>` +
    `\n<span style="color:var(--muted)">Flags: /${pat}/${flags}</span>`;
}

function runGroupDemo() {
  const pat = document.getElementById('groupRegex').value;
  const text = document.getElementById('groupText').value;
  const r = safeRegex(pat, 'g');
  if (!r) {
    document.getElementById('groupResult').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }
  let output = highlightMatches(text, r) + '\n\n';
  try {
    const allMatches = [...text.matchAll(r)];
    if (allMatches.length === 0) {
      output += '<span style="color:var(--danger)">No matches found</span>';
    } else {
      allMatches.forEach((m, i) => {
        output += `<span style="color:var(--secondary)">Match ${i+1}:</span> "${m[0]}" at index ${m.index}\n`;
        for (let g = 1; g < m.length; g++) {
          output += `  <span style="color:var(--accent)">Group ${g}:</span> "${m[g]}"\n`;
        }
      });
    }
  } catch(e) {
    output += `<span style="color:var(--danger)">${e.message}</span>`;
  }
  document.getElementById('groupResult').innerHTML = output;
}

// ========== METHOD DEMO ==========
function updateMethodDemo() {
  const method = document.getElementById('methodSelect').value;
  document.getElementById('replaceGroup').style.display = method === 'replace' ? 'block' : 'none';
}

function runMethodDemo() {
  const method = document.getElementById('methodSelect').value;
  const pat = document.getElementById('methodRegex').value;
  const text = document.getElementById('methodText').value;
  const replacement = document.getElementById('methodReplace').value;
  const flagEls = document.querySelectorAll('#sec-methods .flag-toggle');
  let flags = '';
  flagEls.forEach(f => { if (f.classList.contains('active')) flags += f.textContent.trim().charAt(0); });

  const r = safeRegex(pat, flags);
  if (!r) {
    document.getElementById('methodResult').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }

  let output = `<span style="color:var(--muted)">// regex = /${pat}/${flags}</span>\n`;
  try {
    switch(method) {
      case 'test':
        const testResult = r.test(text);
        output += `regex.test("${escapeHtml(text)}")\n`;
        output += `‚Üí <span style="color:${testResult ? 'var(--success)' : 'var(--danger)'}"><strong>${testResult}</strong></span>`;
        break;
      case 'match':
        const matchResult = text.match(r);
        output += `"...".match(regex)\n`;
        output += `‚Üí <span style="color:var(--warn)">${JSON.stringify(matchResult)}</span>`;
        break;
      case 'matchAll':
        if (!flags.includes('g')) {
          output += `<span style="color:var(--danger)">‚ö†Ô∏è matchAll() requires the /g flag!</span>`;
        } else {
          const allM = [...text.matchAll(r)];
          output += `[..."...".matchAll(regex)]\n`;
          allM.forEach((m, i) => {
            output += `\n<span style="color:var(--secondary)">Match ${i+1}:</span> "${m[0]}" @ index ${m.index}`;
            for (let g = 1; g < m.length; g++) {
              output += `\n  <span style="color:var(--accent)">Group ${g}:</span> "${m[g]}"`;
            }
          });
          if (allM.length === 0) output += '‚Üí <span style="color:var(--danger)">No matches</span>';
        }
        break;
      case 'replace':
        const replaceResult = text.replace(r, replacement);
        output += `"...".replace(regex, "${escapeHtml(replacement)}")\n`;
        output += `‚Üí "<span style="color:var(--success)">${escapeHtml(replaceResult)}</span>"`;
        break;
      case 'search':
        const searchResult = text.search(r);
        output += `"...".search(regex)\n`;
        output += `‚Üí <span style="color:var(--warn)">${searchResult}</span>`;
        if (searchResult >= 0) output += ` <span style="color:var(--muted)">(found at index ${searchResult})</span>`;
        else output += ` <span style="color:var(--danger)">(not found)</span>`;
        break;
      case 'split':
        const splitResult = text.split(r);
        output += `"...".split(regex)\n`;
        output += `‚Üí <span style="color:var(--warn)">${JSON.stringify(splitResult)}</span>\n`;
        output += `<span style="color:var(--muted)">(${splitResult.length} parts)</span>`;
        break;
    }
  } catch(e) {
    output += `<span style="color:var(--danger)">Error: ${e.message}</span>`;
  }
  document.getElementById('methodResult').innerHTML = output;
}

// ========== FLAGS DEMO ==========
function runFlagDemo() {
  const pat = document.getElementById('flagRegex').value;
  const text = document.getElementById('flagText').value;
  const flagEls = document.querySelectorAll('#flagToggles .flag-toggle');
  let flags = '';
  const flagLetters = ['g','i','m','s','u'];
  flagEls.forEach((f, i) => { if (f.classList.contains('active')) flags += flagLetters[i]; });

  const r = safeRegex(pat, flags);
  if (!r) {
    document.getElementById('flagResult').innerHTML = '<span style="color:var(--danger)">Invalid regex</span>';
    return;
  }

  const highlighted = highlightMatches(text, r);
  const matches = text.match(r);
  document.getElementById('flagResult').innerHTML =
    `<span style="color:var(--muted)">/${pat}/${flags}</span>\n\n` +
    highlighted +
    `\n\n<span style="color:var(--muted)">Matches: <span style="color:var(--success)">${matches ? matches.length : 0}</span></span>` +
    `\n<span style="color:var(--warn)">${matches ? JSON.stringify(matches) : 'null'}</span>`;
}

// ========== PATTERNS ==========
const commonPatterns = [
  { name: 'Email Address', pattern: '^[\\w.-]+@[\\w.-]+\\.\\w{2,}$', examples: ['user@email.com','bad@','a@b.c'], desc: 'Validates basic email format' },
  { name: 'URL', pattern: '^https?:\\/\\/[\\w.-]+(?:\\.[\\w]{2,})(?:\\/\\S*)?$', examples: ['https://google.com','http://example.org/path','ftp://bad'], desc: 'HTTP/HTTPS URLs' },
  { name: 'Phone (US)', pattern: '^\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}$', examples: ['(555) 123-4567','555-123-4567','5551234567'], desc: 'US phone numbers in various formats' },
  { name: 'Password (Strong)', pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*]).{8,}$', examples: ['Str0ng!Pass','weak','NoSpecial1'], desc: 'Min 8 chars, upper+lower+digit+special' },
  { name: 'IPv4 Address', pattern: '^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$', examples: ['192.168.1.1','255.255.255.0','999.999.999.999'], desc: 'Valid IPv4 address' },
  { name: 'Date (YYYY-MM-DD)', pattern: '^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$', examples: ['2024-01-15','2023-12-31','2024-13-01'], desc: 'ISO date format' },
  { name: 'Hex Color', pattern: '^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$', examples: ['#ff0000','#f00','#gg0000'], desc: '#RGB or #RRGGBB format' },
  { name: 'Username', pattern: '^[a-zA-Z][a-zA-Z0-9_]{2,15}$', examples: ['john_doe','a','123start'], desc: 'Letter start, 3-16 chars, alphanumeric+underscore' },
  { name: 'Zip Code (US)', pattern: '^\\d{5}(-\\d{4})?$', examples: ['90210','90210-1234','1234'], desc: '5 digits, optional +4' },
  { name: 'HTML Tag', pattern: '<([a-z][a-z0-9]*)\\b[^>]*>(.*?)<\\/\\1>', examples: ['<div>content</div>','<br>','<b>bold</b>'], desc: 'Opening and closing HTML tags' }
];

function buildPatternCards() {
  const container = document.getElementById('patternCards');
  const select = document.getElementById('patternSelect');
  let html = '';
  commonPatterns.forEach((p, i) => {
    select.innerHTML += `<option value="${i}">${p.name}</option>`;
    html += `<div class="card">
      <div class="card-header">${p.name}</div>
      <p style="font-size:0.9em">${p.desc}</p>
      <div class="code-block"><span class="rx">/${p.pattern.replace(/</g,'&lt;').replace(/>/g,'&gt;')}/</span></div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        ${p.examples.map(ex => {
          try {
            const r = new RegExp(p.pattern);
            const pass = r.test(ex);
            return `<span class="tag ${pass ? 'tag-green' : 'tag-red'}">${pass ? '‚úÖ' : '‚ùå'} ${escapeHtml(ex)}</span>`;
          } catch(e) { return `<span class="tag tag-red">‚ö† ${escapeHtml(ex)}</span>`; }
        }).join('')}
      </div>
    </div>`;
  });
  container.innerHTML = html;
  loadPattern();
}

function loadPattern() {
  const idx = document.getElementById('patternSelect').value;
  const p = commonPatterns[idx];
  document.getElementById('patternRegex').value = p.pattern;
  document.getElementById('patternInput').value = p.examples[0];
  testPattern();
}

function testPattern() {
  const pat = document.getElementById('patternRegex').value;
  const input = document.getElementById('patternInput').value;
  const r = safeRegex(pat);
  if (!r) {
    document.getElementById('patternResult').innerHTML = '<span style="color:var(--danger)">Invalid regex pattern</span>';
    return;
  }
  const pass = r.test(input);
  document.getElementById('patternResult').innerHTML =
    `<span style="font-size:1.3em">${pass ? '‚úÖ' : '‚ùå'}</span> <strong style="color:${pass ? 'var(--success)' : 'var(--danger)'}">` +
    `${pass ? 'VALID ‚Äî Pattern matches!' : 'INVALID ‚Äî No match'}</strong>` +
    `\n<span style="color:var(--muted)">/${escapeHtml(pat)}/.test("${escapeHtml(input)}") ‚Üí ${pass}</span>`;
}

// ========== PLAYGROUND ==========
function runPlayground() {
  const pat = document.getElementById('pgRegex').value;
  const flags = document.getElementById('pgFlags').value;
  const text = document.getElementById('pgText').value;

  if (!pat) {
    document.getElementById('pgHighlight').innerHTML = escapeHtml(text);
    document.getElementById('pgDetails').innerHTML = '<span style="color:var(--muted)">Enter a pattern above...</span>';
    document.getElementById('pgMatchCount').textContent = 'Matches: 0';
    document.getElementById('pgGroupCount').textContent = 'Groups: 0';
    return;
  }

  const r = safeRegex(pat, flags);
  if (!r) {
    document.getElementById('pgHighlight').innerHTML = `<span style="color:var(--danger)">Invalid regex: Check your pattern</span>`;
    document.getElementById('pgDetails').innerHTML = '';
    return;
  }

  document.getElementById('pgHighlight').innerHTML = highlightMatches(text, r);

  // Details
  let details = '';
  try {
    const fWithG = flags.includes('g') ? flags : flags + 'g';
    const r2 = new RegExp(pat, fWithG);
    const allM = [...text.matchAll(r2)];
    document.getElementById('pgMatchCount').textContent = `Matches: ${allM.length}`;
    const numGroups = allM.length > 0 ? allM[0].length - 1 : 0;
    document.getElementById('pgGroupCount').textContent = `Groups per match: ${numGroups}`;

    allM.forEach((m, i) => {
      details += `<span style="color:var(--secondary)">Match ${i+1}:</span> "<span style="color:var(--success)">${escapeHtml(m[0])}</span>" <span style="color:var(--muted)">[index ${m.index}]</span>\n`;
      for (let g = 1; g < m.length; g++) {
        details += `  <span style="color:var(--accent)">Group ${g}:</span> "${escapeHtml(m[g] || '')}"\n`;
      }
    });
    if (allM.length === 0) details = '<span style="color:var(--muted)">No matches found</span>';
  } catch(e) {
    details = `<span style="color:var(--danger)">${e.message}</span>`;
  }
  document.getElementById('pgDetails').innerHTML = details;
}

// ========== EXERCISES ==========
const exercises = [
  {
    title: '1. Match All Digits',
    desc: 'Write a regex to find ALL individual digits in the string.',
    testStr: 'I have 3 dogs and 12 cats',
    expected: ['3','1','2'],
    hint: 'Use \\d with the global flag'
  },
  {
    title: '2. Validate a 5-Digit Zip Code',
    desc: 'Write a regex that matches ONLY valid 5-digit US zip codes (nothing else).',
    testStr: '90210',
    validate: (pat) => {
      const r = safeRegex(pat);
      return r && r.test('90210') && r.test('00000') && !r.test('1234') && !r.test('123456') && !r.test('abcde');
    },
    hint: 'Use ^ and $ anchors with \\d{5}'
  },
  {
    title: '3. Extract Words Starting with Capital',
    desc: 'Find all words that start with an uppercase letter.',
    testStr: 'Hello world, My Name is John Smith',
    expected: ['Hello','My','Name','John','Smith'],
    hint: 'Use [A-Z] followed by \\w*'
  },
  {
    title: '4. Find Duplicate Words',
    desc: 'Write a regex to find repeated consecutive words like "the the".',
    testStr: 'the the quick brown fox fox jumped',
    expectedCount: 2,
    hint: 'Use a capturing group with backreference: (\\w+)\\s+\\1'
  },
  {
    title: '5. Extract Domain from Email',
    desc: 'Use a capturing group to extract just the domain name (after @, before .) from an email.',
    testStr: 'user@example.com',
    validateGroup: (pat) => {
      const r = safeRegex(pat);
      if (!r) return false;
      const m = 'user@example.com'.match(r);
      return m && (m[1] === 'example' || m[0] === 'example');
    },
    hint: 'Use @(\\w+)\\. to capture the domain'
  },
  {
    title: '6. Replace Profanity with ***',
    desc: 'Write a regex to replace "damn" or "hell" (case-insensitive) with "***".',
    testStr: 'What the Hell! Damn it!',
    validateReplace: (pat) => {
      const r = safeRegex(pat, 'gi');
      if (!r) return false;
      const result = 'What the Hell! Damn it!'.replace(r, '***');
      return result === 'What the ***! *** it!';
    },
    hint: 'Use alternation: damn|hell with /gi flags'
  },
  {
    title: '7. Match Valid Hex Colors',
    desc: 'Match both #RGB and #RRGGBB hex color formats.',
    testStr: '#ff0 #aabb00 #xyz',
    validate: (pat) => {
      const r = safeRegex(pat);
      return r && r.test('#fff') && r.test('#aabb00') && !r.test('#xyz') && !r.test('#ffff');
    },
    hint: '#([0-9a-fA-F]{3}|[0-9a-fA-F]{6}) ‚Äî order matters!'
  },
  {
    title: '8. Password Validator',
    desc: 'Validate: minimum 8 chars, at least one uppercase, one lowercase, one digit.',
    testStr: 'MyPass1word',
    validate: (pat) => {
      const r = safeRegex(pat);
      return r && r.test('MyPass1word') && r.test('Hello123') && !r.test('short1A') && !r.test('nouppercase1') && !r.test('NOLOWER1') && !r.test('NoDigitsHere');
    },
    hint: 'Use multiple lookaheads: ^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).{8,}$'
  }
];

let exerciseResults = {};

function buildExercises() {
  const container = document.getElementById('exerciseContainer');
  let html = '';
  exercises.forEach((ex, i) => {
    html += `<div class="exercise" id="ex-${i}">
      <div class="exercise-header">
        <h4 style="margin:0;color:var(--text)">${ex.title}</h4>
        <span class="exercise-status tag ${exerciseResults[i] ? 'tag-green' : 'tag-blue'}" id="exStatus-${i}">
          ${exerciseResults[i] ? '‚úÖ Solved' : 'üìù Unsolved'}
        </span>
      </div>
      <p class="exercise-desc">${ex.desc}</p>
      <div style="font-size:0.85em;color:var(--muted);margin-bottom:10px">Test string: <code>${escapeHtml(ex.testStr)}</code></div>
      <div class="input-group">
        <label>Your Regex Pattern:</label>
        <input type="text" id="exInput-${i}" placeholder="Type your regex here...">
      </div>
      <div class="btn-group">
        <button class="btn btn-primary btn-sm" onclick="checkExercise(${i})">‚úì Check</button>
        <button class="btn btn-outline btn-sm" onclick="showHint(${i})">üí° Hint</button>
      </div>
      <div class="exercise-feedback" id="exFeedback-${i}"></div>
      <div id="exHint-${i}" style="display:none;margin-top:8px;padding:10px;background:rgba(255,192,72,0.08);border:1px solid rgba(255,192,72,0.2);border-radius:8px;font-size:0.88em;color:var(--warn)">üí° Hint: <code>${ex.hint}</code></div>
    </div>`;
  });
  container.innerHTML = html;
}

function checkExercise(i) {
  const ex = exercises[i];
  const pat = document.getElementById(`exInput-${i}`).value;
  const fb = document.getElementById(`exFeedback-${i}`);
  let success = false;

  if (!pat) {
    fb.className = 'exercise-feedback error';
    fb.textContent = 'Please enter a regex pattern!';
    return;
  }

  const r = safeRegex(pat, 'g');
  if (!r) {
    fb.className = 'exercise-feedback error';
    fb.textContent = 'Invalid regex syntax. Check your pattern.';
    return;
  }

  if (ex.validate) {
    success = ex.validate(pat);
  } else if (ex.validateGroup) {
    success = ex.validateGroup(pat);
  } else if (ex.validateReplace) {
    success = ex.validateReplace(pat);
  } else if (ex.expected) {
    const matches = ex.testStr.match(r);
    success = matches && JSON.stringify(matches) === JSON.stringify(ex.expected);
  } else if (ex.expectedCount) {
    const matches = ex.testStr.match(r);
    success = matches && matches.length === ex.expectedCount;
  }

  if (success) {
    fb.className = 'exercise-feedback success';
    fb.innerHTML = `‚úÖ Correct! Great job! Your pattern <code>/${escapeHtml(pat)}/</code> works perfectly!`;
    exerciseResults[i] = true;
    document.getElementById(`exStatus-${i}`).className = 'exercise-status tag tag-green';
    document.getElementById(`exStatus-${i}`).textContent = '‚úÖ Solved';
  } else {
    fb.className = 'exercise-feedback error';
    let msg = `‚ùå Not quite. `;
    if (ex.expected) {
      const matches = ex.testStr.match(r);
      msg += `Expected: [${ex.expected.map(e=>`"${e}"`).join(', ')}], Got: ${matches ? '['+matches.map(e=>`"${e}"`).join(', ')+']' : 'null'}`;
    } else {
      msg += 'Your pattern doesn\'t pass all test cases. Try again!';
    }
    fb.innerHTML = msg;
  }
  updateExerciseScore();
}

function showHint(i) {
  const hint = document.getElementById(`exHint-${i}`);
  hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
}

function updateExerciseScore() {
  const solved = Object.keys(exerciseResults).length;
  document.getElementById('exScore').textContent = `${solved}/${exercises.length} completed`;
  document.getElementById('exBadge').textContent = `${solved}/${exercises.length}`;
}

// ========== QUIZ ==========
const quizQuestions = [
  {
    q: 'What does <code>/\\d+/</code> match?',
    opts: ['One or more letters','Exactly one digit','One or more digits','Zero or more digits'],
    ans: 2,
    explain: '\\d matches a digit (0-9), and + means "one or more". So \\d+ matches sequences like "42" or "100".'
  },
  {
    q: 'What does <code>"hello".match(/l/g)</code> return?',
    opts: ['["l"]','["l", "l"]','["ll"]','null'],
    ans: 1,
    explain: 'With the /g flag, match() returns ALL matches. There are two "l" characters in "hello", so we get ["l", "l"].'
  },
  {
    q: 'Which method returns a boolean?',
    opts: ['match()','exec()','test()','search()'],
    ans: 2,
    explain: 'test() returns true or false. match() returns an array/null, exec() returns an array/null, search() returns a number.'
  },
  {
    q: 'What does the <code>^</code> character mean INSIDE a character class <code>[^abc]</code>?',
    opts: ['Start of string','Any character EXCEPT a, b, c','Match a, b, or c','End of string'],
    ans: 1,
    explain: 'Inside [...], the ^ at the start means NEGATION ‚Äî match any character NOT in the set. Outside [...], ^ means start of string.'
  },
  {
    q: 'What is the output of <code>/^\\d+$/.test("123abc")</code>?',
    opts: ['true','false','["123"]','123'],
    ans: 1,
    explain: '^ anchors to start and $ to end. The pattern requires the ENTIRE string to be digits. "123abc" has non-digits, so it\'s false.'
  },
  {
    q: 'What does <code>?</code> mean after another quantifier like <code>+?</code>?',
    opts: ['Optional (0 or 1)','Makes the quantifier lazy (non-greedy)','Makes it possessive','Matches literally "?"'],
    ans: 1,
    explain: 'A ? after +, *, or {} makes the quantifier lazy ‚Äî it matches as FEW characters as possible instead of as many as possible.'
  },
  {
    q: 'What does <code>"John Smith".replace(/(\\w+) (\\w+)/, "$2, $1")</code> return?',
    opts: ['"$2, $1"','"Smith, John"','"John, Smith"','Error'],
    ans: 1,
    explain: '$1 refers to the first captured group ("John") and $2 to the second ("Smith"). So the replacement produces "Smith, John".'
  },
  {
    q: 'Which flag makes <code>.</code> also match newline characters?',
    opts: ['g','m','s','u'],
    ans: 2,
    explain: 'The /s flag (dotAll) makes . match ANY character including \\n. Without it, . matches everything EXCEPT newline.'
  },
  {
    q: 'What is a <strong>word boundary</strong> <code>\\b</code>?',
    opts: ['A space character','The position between a word char and a non-word char','A line break','The start of a word only'],
    ans: 1,
    explain: '\\b matches the position (not a character) between a \\w (word) and \\W (non-word) character, or at the start/end of string if adjacent to \\w.'
  },
  {
    q: 'What is wrong with <code>new RegExp("\\d+")</code>?',
    opts: ['Nothing, it works fine','The backslash needs to be doubled: "\\\\d+"','You can\'t use RegExp constructor with \\d','The + is invalid'],
    ans: 1,
    explain: 'In a string, "\\d" is just "d" because JS interprets \\d as an escape sequence. You need "\\\\d+" so the string contains the literal \\d.'
  }
];

let quizAnswers = {};
let quizSubmitted = {};

function buildQuiz() {
  const container = document.getElementById('quizContainer');
  let html = '';
  quizQuestions.forEach((q, i) => {
    html += `<div class="quiz-card" id="quiz-${i}">
      <div class="quiz-question">${i+1}. ${q.q}</div>
      <div class="quiz-options" id="quizOpts-${i}">
        ${q.opts.map((opt, j) => `
          <div class="quiz-option" onclick="selectQuizOption(${i}, ${j})" id="qopt-${i}-${j}">
            <span class="letter">${String.fromCharCode(65+j)}</span>
            <span>${opt}</span>
          </div>
        `).join('')}
      </div>
      <div class="btn-group">
        <button class="btn btn-primary btn-sm" onclick="submitQuizAnswer(${i})" id="qsubmit-${i}">Check Answer</button>
      </div>
      <div class="quiz-explanation" id="qexplain-${i}">üí° ${q.explain}</div>
    </div>`;
  });
  container.innerHTML = html;
}

function selectQuizOption(qi, oi) {
  if (quizSubmitted[qi]) return;
  document.querySelectorAll(`#quizOpts-${qi} .quiz-option`).forEach(o => o.classList.remove('selected'));
  document.getElementById(`qopt-${qi}-${oi}`).classList.add('selected');
  quizAnswers[qi] = oi;
}

function submitQuizAnswer(qi) {
  if (quizSubmitted[qi]) return;
  if (quizAnswers[qi] === undefined) return;
  quizSubmitted[qi] = true;

  const correct = quizQuestions[qi].ans;
  const chosen = quizAnswers[qi];

  document.querySelectorAll(`#quizOpts-${qi} .quiz-option`).forEach((o, j) => {
    if (j === correct) o.classList.add('correct');
    if (j === chosen && j !== correct) o.classList.add('wrong');
  });

  document.getElementById(`qexplain-${qi}`).style.display = 'block';
  document.getElementById(`qsubmit-${qi}`).disabled = true;
  document.getElementById(`qsubmit-${qi}`).textContent = chosen === correct ? '‚úÖ Correct!' : '‚ùå Wrong';

  updateQuizScore();
}

function updateQuizScore() {
  let correct = 0;
  let answered = 0;
  Object.keys(quizSubmitted).forEach(qi => {
    answered++;
    if (quizAnswers[qi] === quizQuestions[qi].ans) correct++;
  });
  document.getElementById('quizScoreDisplay').textContent = `Score: ${correct}/${answered}`;
  document.getElementById('qzBadge').textContent = `${correct}/${quizQuestions.length}`;
}

function resetQuiz() {
  quizAnswers = {};
  quizSubmitted = {};
  buildQuiz();
  document.getElementById('quizScoreDisplay').textContent = '';
  document.getElementById('qzBadge').textContent = `0/${quizQuestions.length}`;
}

// ========== CHEAT SHEET ==========
function buildCheatSheet() {
  const data = {
    cheatChars: [
      ['.','Any char (not \\n)'],['\\d','Digit [0-9]'],['\\D','Non-digit'],['\\w','Word [a-zA-Z0-9_]'],
      ['\\W','Non-word'],['\\s','Whitespace'],['\\S','Non-whitespace'],['[abc]','Any of a,b,c'],
      ['[^abc]','Not a,b,c'],['[a-z]','Range a-z'],['\\t','Tab'],['\\n','Newline']
    ],
    cheatQuant: [
      ['*','0 or more'],['+','1 or more'],['?','0 or 1 (optional)'],['{3}','Exactly 3'],
      ['{3,}','3 or more'],['{3,5}','3 to 5'],['*?','0+ (lazy)'],['+?','1+ (lazy)']
    ],
    cheatAnchors: [
      ['^','Start of string'],['$','End of string'],['\\b','Word boundary'],['\\B','Not word boundary']
    ],
    cheatGroups: [
      ['(abc)','Capture group'],['(?:abc)','Non-capture group'],['(?<n>abc)','Named group'],
      ['\\1','Backreference'],['a|b','Alternation (OR)'],['(?=abc)','Lookahead'],
      ['(?!abc)','Neg. lookahead'],['(?<=abc)','Lookbehind'],['(?<!abc)','Neg. lookbehind']
    ],
    cheatFlags: [
      ['g','Global (all matches)'],['i','Case insensitive'],['m','Multiline (^$ per line)'],
      ['s','DotAll (. = \\n too)'],['u','Unicode support'],['y','Sticky (lastIndex)']
    ],
    cheatMethods: [
      ['test()','Boolean match check'],['exec()','Detailed match + groups'],['match()','Find matches'],
      ['matchAll()','All matches iterator'],['replace()','Find & replace'],['search()','Find index'],
      ['split()','Split by pattern']
    ]
  };

  Object.keys(data).forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.innerHTML = data[id].map(([sym, desc]) =>
      `<div class="cheat-item"><span class="sym">${escapeHtml(sym)}</span><span class="desc">${desc}</span></div>`
    ).join('');
  });
}

// ========== INIT ==========
document.addEventListener('DOMContentLoaded', () => {
  buildPatternCards();
  buildExercises();
  buildQuiz();
  buildCheatSheet();
  runIntro();

  // Auto-run playground on input
  document.getElementById('introRegex').addEventListener('input', runIntro);
  document.getElementById('introText').addEventListener('input', runIntro);
  document.getElementById('flagRegex').addEventListener('input', runFlagDemo);
  document.getElementById('flagText').addEventListener('input', runFlagDemo);
  document.getElementById('patternInput').addEventListener('input', testPattern);
  document.getElementById('patternRegex').addEventListener('input', testPattern);
});
</script>
</body>
</html>