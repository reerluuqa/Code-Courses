<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES6+ Mastery Bootcamp | Interactive JavaScript Learning</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-code: #0d1117;
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Layout */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 2rem 1rem;
            position: fixed;
            height: 100vh;
            width: 280px;
            overflow-y: auto;
            z-index: 100;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: 2rem;
        }

        .stats {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary);
        }

        .nav-link.completed {
            color: var(--success);
        }

        .nav-icon {
            width: 24px;
            margin-right: 0.75rem;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 2rem;
            max-width: 1200px;
        }

        .header {
            margin-bottom: 2rem;
        }

        .module-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text), var(--text-muted));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .badge-container {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            background: rgba(139, 92, 246, 0.2);
            color: var(--secondary);
            border-radius: 20px;
            font-size: 0.875rem;
            border: 1px solid var(--secondary);
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Code Editor */
        .code-playground {
            background: var(--bg-code);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border);
            margin: 1rem 0;
        }

        .editor-header {
            background: #161b22;
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .editor-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-family: monospace;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        textarea.code-input {
            width: 100%;
            min-height: 150px;
            background: transparent;
            color: #e6edf3;
            border: none;
            padding: 1rem;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            outline: none;
        }

        .output-panel {
            background: #0d1117;
            border-top: 1px solid var(--border);
            padding: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
            min-height: 60px;
        }

        .output-label {
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .output-content {
            color: var(--success);
        }

        .output-error {
            color: var(--danger);
        }

        /* Visual Demos */
        .visual-demo {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px dashed var(--primary);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
        }

        .demo-stage {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            justify-content: center;
            min-height: 100px;
        }

        .box {
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .box.spread {
            animation: spreadOut 2s infinite;
        }

        @keyframes spreadOut {
            0%, 100% { transform: scale(1) translateX(0); }
            50% { transform: scale(1.1) translateX(20px); }
        }

        .arrow {
            font-size: 2rem;
            color: var(--secondary);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Quiz Styles */
        .quiz-container {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 2rem;
        }

        .quiz-option {
            background: var(--bg-dark);
            border: 2px solid var(--border);
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.wrong {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .quiz-option input {
            display: none;
        }

        /* Pitfall Cards */
        .pitfall {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--danger);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .pitfall-title {
            color: var(--danger);
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tip {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .tip-title {
            color: var(--warning);
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        /* Exercise */
        .exercise {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
            border: 2px solid var(--success);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .difficulty {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .difficulty.easy { background: var(--success); color: white; }
        .difficulty.medium { background: var(--warning); color: black; }
        .difficulty.hard { background: var(--danger); color: white; }

        /* Confetti Canvas */
        #confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: var(--bg-dark);
            border-radius: 4px;
            overflow: hidden;
            margin: 2rem 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.5s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
        }

        /* Syntax Highlighting Simulation */
        .code-keyword { color: #ff7b72; }
        .code-string { color: #a5d6ff; }
        .code-function { color: #d2a8ff; }
        .code-comment { color: #8b949e; font-style: italic; }
        .code-number { color: #79c0ff; }
    </style>
</head>
<body>
    <canvas id="confetti"></canvas>
    
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo">ES6+ Mastery</div>
            <div class="subtitle">From Zero to Job-Ready</div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="xp-display">0</div>
                    <div class="stat-label">XP Points</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="progress-display">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>

            <ul class="nav-menu" id="nav-menu">
                <!-- Generated by JS -->
            </ul>
        </aside>

        <main class="main-content" id="main-content">
            <!-- Dynamic Content -->
        </main>
    </div>

    <script>
        // Application State
        const state = {
            xp: 0,
            completedModules: new Set(),
            currentModule: 'template-literals',
            moduleProgress: {},
            badges: []
        };

        // Module Definitions
        const modules = [
            {
                id: 'template-literals',
                title: 'Template Literals',
                icon: 'üìù',
                description: 'Supercharged strings with interpolation and multiline support',
                sections: ['basics', 'interpolation', 'multiline', 'tagged'],
                color: 'var(--primary)'
            },
            {
                id: 'destructuring',
                title: 'Destructuring',
                icon: 'üì¶',
                description: 'Unpack values from arrays and objects into distinct variables',
                sections: ['arrays', 'objects', 'nested', 'renaming'],
                color: 'var(--secondary)'
            },
            {
                id: 'spread-rest',
                title: 'Spread & Rest',
                icon: 'üí•',
                description: 'Expand elements with spread, collect them with rest',
                sections: ['spread-arrays', 'spread-objects', 'rest-parameters', 'rest-destructuring'],
                color: 'var(--success)'
            },
            {
                id: 'default-params',
                title: 'Default Parameters',
                icon: '‚öôÔ∏è',
                description: 'Set fallback values for function parameters',
                sections: ['basics', 'expressions', 'destructuring-defaults'],
                color: 'var(--warning)'
            },
            {
                id: 'enhanced-objects',
                title: 'Enhanced Object Literals',
                icon: '‚ú®',
                description: 'Shorthand syntax for cleaner object definitions',
                sections: ['shorthand-properties', 'shorthand-methods', 'computed-properties'],
                color: '#ec4899'
            }
        ];

        // Content Database
        const content = {
            'template-literals': {
                basics: {
                    title: 'Backtick Basics',
                    content: `
                        <p>Template literals use backticks (\`) instead of quotes. They support:</p>
                        <ul style="margin: 1rem 0; padding-left: 1.5rem;">
                            <li>String interpolation with <code>\${}</code></li>
                            <li>Multiline strings without \\n</li>
                            <li>Tagged templates for advanced formatting</li>
                        </ul>
                    `,
                    example: `// Old way (ES5)
var name = "World";
var greeting = "Hello, " + name + "!";

// New way (ES6+)
const name = "World";
const greeting = \\`Hello, \\${name}!\\`;

console.log(greeting);`,
                    visual: `
                        <div class="visual-demo">
                            <div class="demo-stage">
                                <div class="box">"Hello,"</div>
                                <div class="arrow">+</div>
                                <div class="box" style="background: var(--secondary)">name</div>
                                <div class="arrow">+</div>
                                <div class="box">"!"</div>
                                <div class="arrow">‚Üí</div>
                                <div class="box spread">\\`Hello, \\${name}!\\`</div>
                            </div>
                        </div>
                    `
                },
                interpolation: {
                    title: 'Expression Interpolation',
                    content: `<p>Inside <code>\${}</code>, you can put any JavaScript expression:</p>`,
                    example: `const a = 5;
const b = 10;

// Math operations
console.log(\\`Fifteen is \\${a + b} and not \\${2 * a + b}.\\`);

// Ternary operators
const isMember = true;
console.log(\\`The fee is \\${isMember ? '$2.00' : '$10.00'}\\`);

// Function calls
const now = new Date();
console.log(\\`Today is \\${now.toLocaleDateString()}\\`);`,
                    pitfall: {
                        title: 'The undefined trap',
                        description: 'If your variable is undefined, it prints "undefined" as string, not an error (unlike concatenation which might coerce unexpectedly).',
                        code: `const user = undefined;
console.log(\\`Hello \\${user}\\`); // "Hello undefined"
// vs
console.log("Hello " + user); // "Hello undefined" (same here, but be careful!)`
                    }
                },
                multiline: {
                    title: 'Multiline Strings',
                    content: `<p>No more <code>\\n</code> or string concatenation for multiline text:</p>`,
                    example: `// HTML template
const html = \\`
  <div class="container">
    <h1>Hello World</h1>
    <p>This is a multiline string</p>
  </div>
\\`;

// SQL query
const query = \\`
  SELECT * FROM users
  WHERE active = true
  AND created_at > '2024-01-01'
\\`;`,
                    exercise: {
                        title: 'Fix the Indentation',
                        difficulty: 'easy',
                        description: 'The HTML below has unwanted indentation. Fix it using template literals properly.',
                        starterCode: `function generateCard(name, role) {
    // Fix this to return properly formatted HTML without leading spaces
    return "<div class='card'>\\n" +
           "  <h2>" + name + "</h2>\\n" +
           "  <p>" + role + "</p>\\n" +
           "</div>";
}`,
                        solution: `function generateCard(name, role) {
    return \\`
<div class="card">
  <h2>\\${name}</h2>
  <p>\\${role}</p>
</div>\\`;
}`,
                        test: (code) => code.includes('`') && code.includes('${name}') && code.includes('${role}')
                    }
                }
            },
            'destructuring': {
                arrays: {
                    title: 'Array Destructuring',
                    content: `<p>Extract values from arrays into variables based on position:</p>`,
                    example: `const colors = ['red', 'green', 'blue'];

// Old way
const first = colors[0];
const second = colors[1];

// New way
const [first, second, third] = colors;

console.log(first);  // 'red'
console.log(second); // 'green'

// Skip elements with commas
const [,, last] = colors;
console.log(last);   // 'blue'`,
                    visual: `
                        <div class="visual-demo">
                            <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                                <div style="border: 2px solid var(--primary); padding: 1rem; border-radius: 8px;">
                                    <div style="display: flex; gap: 0.5rem;">
                                        <div class="box">red</div>
                                        <div class="box">green</div>
                                        <div class="box">blue</div>
                                    </div>
                                    <div style="text-align: center; margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-muted)">Array</div>
                                </div>
                                <div class="arrow">‚Üí</div>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div class="box" style="background: var(--secondary); font-size: 0.875rem;">first = red</div>
                                    <div class="box" style="background: var(--secondary); font-size: 0.875px;">second = green</div>
                                    <div class="box" style="background: var(--secondary); font-size: 0.875px;">third = blue</div>
                                </div>
                            </div>
                        </div>
                    `,
                    pitfall: {
                        title: 'Undefined Hell',
                        description: 'Destructuring undefined or null throws a TypeError. Always check if data exists first.',
                        code: `const data = null;
const { name } = data; // ‚ùå TypeError: Cannot destructure property 'name' of 'null'

// Safe approach
const { name } = data || {}; // ‚úÖ name is undefined, no error`
                    }
                },
                objects: {
                    title: 'Object Destructuring',
                    content: `<p>Extract properties by key name. Order doesn't matter!</p>`,
                    example: `const user = {
    name: 'Alice',
    age: 30,
    job: 'Developer'
};

// Extract by property name
const { name, age } = user;
console.log(name); // 'Alice'

// Assign to new variable names
const { name: fullName, age: yearsOld } = user;
console.log(fullName); // 'Alice'

// Default values
const { country = 'USA' } = user;
console.log(country); // 'USA' (fallback)`,
                    exercise: {
                        title: 'API Response Handler',
                        difficulty: 'medium',
                        description: 'Destructure the API response to extract user data and stats. Get the username, email, and nested profile age.',
                        starterCode: `const apiResponse = {
    username: "coder123",
    email: "coder@example.com",
    profile: {
        age: 25,
        city: "NYC"
    },
    stats: {
        followers: 1000,
        following: 500
    }
};

// Your code here: extract username, email, age, and followers
// Hint: You'll need nested destructuring

console.log(/* your variables */);`,
                        solution: `const { username, email, profile: { age }, stats: { followers } } = apiResponse;
console.log(username, email, age, followers);`,
                        test: (code) => code.includes('profile:') && code.includes('stats:') && code.includes('const')
                    }
                }
            },
            'spread-rest': {
                'spread-arrays': {
                    title: 'Spread in Arrays',
                    content: `<p>The spread operator <code>...</code> expands an iterable (like an array) into individual elements:</p>`,
                    example: `const arr1 = [1, 2, 3];
const arr2 = [...arr1, 4, 5, 6];

console.log(arr2); // [1, 2, 3, 4, 5, 6]

// Copying arrays (shallow copy!)
const original = [{a: 1}, {b: 2}];
const copy = [...original];
copy[0].a = 999;
console.log(original[0].a); // 999 (Oops! Same reference)

// Combining arrays
const fruits = ['apple', 'banana'];
const veggies = ['carrot', 'spinach'];
const food = [...fruits, ...veggies];`,
                    pitfall: {
                        title: 'Shallow Copy Danger',
                        description: 'Spread only copies one level deep. Nested objects/arrays are still references!',
                        code: `const users = [{name: 'Alice'}, {name: 'Bob'}];
const usersCopy = [...users];

usersCopy[0].name = 'Charlie';
console.log(users[0].name); // 'Charlie' - Original changed!

// Deep copy solution:
const deepCopy = JSON.parse(JSON.stringify(users));
// Or use structuredClone (modern browsers)
const modernCopy = structuredClone(users);`
                    }
                },
                'rest-parameters': {
                    title: 'Rest Parameters',
                    content: `<p>Collect remaining arguments into an array. Must be the last parameter:</p>`,
                    example: `function sum(...numbers) {
    return numbers.reduce((total, num) => total + num, 0);
}

console.log(sum(1, 2, 3, 4)); // 10
console.log(sum(10, 20));     // 30

// Mixed with regular parameters
function greet(greeting, ...names) {
    return \\`\\${greeting}, \\${names.join(' and ')}!\\`;
}

console.log(greet('Hello', 'Alice', 'Bob', 'Charlie'));
// "Hello, Alice and Bob and Charlie!"`,
                    exercise: {
                        title: 'Build a Logger',
                        difficulty: 'medium',
                        description: 'Create a function that takes a level (info, warn, error) and any number of messages, formats them with timestamps.',
                        starterCode: `function log(level, ...messages) {
    // Should return: "[TIMESTAMP] [LEVEL]: message1 message2..."
    // Hint: use new Date().toISOString() for timestamp
}

// Test cases:
console.log(log('info', 'Server started', 'Port 3000'));
console.log(log('error', 'Connection failed', 'Retrying...'));`,
                        solution: `function log(level, ...messages) {
    const timestamp = new Date().toISOString();
    return \\`[\\${timestamp}] [\\${level.toUpperCase()}]: \\${messages.join(' ')}\\`;
}`,
                        test: (code) => code.includes('...messages') && code.includes('join')
                    }
                }
            },
            'default-params': {
                basics: {
                    title: 'Default Values',
                    content: `<p>Set fallback values that activate when argument is <strong>undefined</strong>:</p>`,
                    example: `function greet(name = 'Guest') {
    return \\`Hello, \\${name}!\\`;
}

console.log(greet('Alice')); // "Hello, Alice!"
console.log(greet());        // "Hello, Guest!"
console.log(greet(undefined)); // "Hello, Guest!"

// BUT:
console.log(greet(null));    // "Hello, null!" (null is not undefined)`,
                    pitfall: {
                        title: 'The Null vs Undefined Trap',
                        description: 'Default parameters only kick in for undefined, not other falsy values like null, 0, false, or empty string.',
                        code: `function calculatePrice(price, tax = 0.1) {
    return price + (price * tax);
}

calculatePrice(100, 0);     // 100 (0 is explicit)
calculatePrice(100, null);  // 100 (null coerces to 0 in math, but be careful!)
calculatePrice(100);        // 110 (uses default 0.1)`
                    }
                }
            },
            'enhanced-objects': {
                'shorthand-properties': {
                    title: 'Shorthand Properties',
                    content: `<p>When property name matches variable name, use the shorthand:</p>`,
                    example: `const name = 'Alice';
const age = 30;

// Old way
const user = {
    name: name,
    age: age,
    greet: function() { return 'Hi'; }
};

// New way
const user = {
    name,
    age,
    greet() { return 'Hi'; }  // Method shorthand too!
};`,
                    exercise: {
                        title: 'Config Object Builder',
                        difficulty: 'easy',
                        description: 'Refactor this code to use enhanced object literals.',
                        starterCode: `const host = 'localhost';
const port = 3000;
const ssl = false;

const config = {
    host: host,
    port: port,
    ssl: ssl,
    connect: function() {
        return \\`Connecting to \\${this.host}:\\${this.port}\\`;
    }
};`,
                        solution: `const host = 'localhost';
const port = 3000;
const ssl = false;

const config = {
    host,
    port,
    ssl,
    connect() {
        return \\`Connecting to \\${this.host}:\\${this.port}\\`;
    }
};`,
                        test: (code) => !code.includes('host: host') && code.includes('connect()')
                    }
                }
            }
        };

        // Initialize App
        function init() {
            renderNav();
            loadModule('template-literals');
            updateStats();
        }

        // Navigation
        function renderNav() {
            const nav = document.getElementById('nav-menu');
            nav.innerHTML = modules.map(mod => `
                <li class="nav-item">
                    <div class="nav-link ${state.currentModule === mod.id ? 'active' : ''} ${state.completedModules.has(mod.id) ? 'completed' : ''}" 
                         onclick="loadModule('${mod.id}')">
                        <span class="nav-icon">${mod.icon}</span>
                        <span>${mod.title}</span>
                        ${state.completedModules.has(mod.id) ? '‚úì' : ''}
                    </div>
                </li>
            `).join('');
        }

        // Load Module Content
        function loadModule(moduleId) {
            state.currentModule = moduleId;
            const module = modules.find(m => m.id === moduleId);
            const moduleContent = content[moduleId];
            
            const main = document.getElementById('main-content');
            main.innerHTML = `
                <div class="header">
                    <h1 class="module-title">${module.icon} ${module.title}</h1>
                    <p style="color: var(--text-muted); font-size: 1.125rem;">${module.description}</p>
                    <div class="progress-container">
                        <div class="progress-bar" style="width: ${getModuleProgress(moduleId)}%"></div>
                    </div>
                </div>

                ${Object.entries(moduleContent).map(([key, section]) => `
                    <div class="card" id="section-${key}">
                        <h2 class="card-title">${section.title}</h2>
                        ${section.content}
                        
                        ${section.visual || ''}
                        
                        <div class="code-playground">
                            <div class="editor-header">
                                <span class="editor-label">JavaScript</span>
                                <div class="editor-actions">
                                    <button class="btn btn-primary" onclick="runCode('${key}')">‚ñ∂ Run</button>
                                    <button class="btn btn-secondary" onclick="resetCode('${key}')">‚Ü∫ Reset</button>
                                </div>
                            </div>
                            <textarea class="code-input" id="code-${key}" spellcheck="false">${section.example}</textarea>
                            <div class="output-panel">
                                <div class="output-label">Console Output</div>
                                <div class="output-content" id="output-${key}">Click "Run" to see output...</div>
                            </div>
                        </div>

                        ${section.pitfall ? `
                            <div class="pitfall">
                                <div class="pitfall-title">‚ö†Ô∏è Pitfall: ${section.pitfall.title}</div>
                                <p>${section.pitfall.description}</p>
                                <div class="code-playground" style="margin-top: 1rem;">
                                    <textarea class="code-input" readonly style="min-height: 80px;">${section.pitfall.code}</textarea>
                                </div>
                            </div>
                        ` : ''}

                        ${section.exercise ? renderExercise(key, section.exercise) : ''}
                    </div>
                `).join('')}

                ${renderQuiz(moduleId)}
            `;
            
            renderNav();
            highlightCode();
        }

        function renderExercise(key, ex) {
            return `
                <div class="exercise" id="exercise-${key}">
                    <div class="exercise-header">
                        <h3>üí™ Coding Challenge: ${ex.title}</h3>
                        <span class="difficulty ${ex.difficulty}">${ex.difficulty.toUpperCase()}</span>
                    </div>
                    <p>${ex.description}</p>
                    <div class="code-playground">
                        <div class="editor-header">
                            <span class="editor-label">Your Solution</span>
                            <button class="btn btn-success" onclick="checkExercise('${key}')">‚úì Check Solution</button>
                        </div>
                        <textarea class="code-input" id="exercise-code-${key}" spellcheck="false">${ex.starterCode}</textarea>
                    </div>
                    <div id="exercise-feedback-${key}" style="margin-top: 1rem;"></div>
                </div>
            `;
        }

        function renderQuiz(moduleId) {
            const quizzes = {
                'template-literals': [
                    { q: 'What is the output of: `Hello ${1 + 2}`?', options: ['Hello 3', 'Hello 12', 'Hello ${1 + 2}', 'Syntax Error'], correct: 0 },
                    { q: 'Which character wraps template literals?', options: ['"', "'", '`', '/'], correct: 2 }
                ],
                'destructuring': [
                    { q: 'What is the value of y? const [x, y = 5] = [1];', options: ['undefined', '1', '5', 'null'], correct: 2 },
                    { q: 'Can you destructure nested objects?', options: ['Yes', 'No', 'Only in arrays', 'Only with spread'], correct: 0 }
                ],
                'spread-rest': [
                    { q: 'What does ...rest do in function parameters?', options: ['Spreads arguments', 'Collects arguments into array', 'Clones the function', 'Throws error'], correct: 1 },
                    { q: 'Is [...array] a deep or shallow copy?', options: ['Deep', 'Shallow', 'Reference', 'Depends on browser'], correct: 1 }
                ],
                'default-params': [
                    { q: 'When does a default parameter apply?', options: ['Always', 'When argument is undefined', 'When argument is null', 'When argument is falsy'], correct: 1 }
                ],
                'enhanced-objects': [
                    { q: 'What is {name} shorthand for?', options: ['{name: name}', '{name: null}', '{name: undefined}', 'Syntax error'], correct: 0 }
                ]
            };

            const questions = quizzes[moduleId] || [];
            if (questions.length === 0) return '';

            return `
                <div class="card">
                    <h2 class="card-title">üéØ Knowledge Check</h2>
                    <div class="quiz-container">
                        ${questions.map((q, idx) => `
                            <div style="margin-bottom: 2rem;">
                                <p style="font-weight: bold; margin-bottom: 1rem;">${idx + 1}. ${q.q}</p>
                                <div id="quiz-${moduleId}-${idx}">
                                    ${q.options.map((opt, optIdx) => `
                                        <label class="quiz-option" onclick="checkQuiz('${moduleId}', ${idx}, ${optIdx}, ${q.correct}, this)">
                                            <input type="radio" name="q${idx}">
                                            <span>${opt}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div id="quiz-result-${moduleId}" style="text-align: center; margin-top: 2rem; font-size: 1.25rem;"></div>
                </div>
            `;
        }

        // Code Execution
        function runCode(key) {
            const code = document.getElementById(`code-${key}`).value;
            const output = document.getElementById(`output-${key}`);
            
            // Capture console.log
            const originalLog = console.log;
            let logs = [];
            console.log = (...args) => logs.push(args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' '));
            
            try {
                // Safe-ish eval for learning purposes
                const result = eval(code);
                if (result !== undefined && logs.length === 0) {
                    logs.push(String(result));
                }
                output.innerHTML = logs.join('\n') || 'undefined';
                output.className = 'output-content';
            } catch (err) {
                output.innerHTML = `‚ùå ${err.message}`;
                output.className = 'output-error';
            } finally {
                console.log = originalLog;
            }
        }

        function resetCode(key) {
            const moduleContent = content[state.currentModule];
            const section = moduleContent[key];
            document.getElementById(`code-${key}`).value = section.example;
            document.getElementById(`output-${key}`).innerHTML = 'Click "Run" to see output...';
            document.getElementById(`output-${key}`).className = 'output-content';
        }

        // Exercise Validation
        function checkExercise(key) {
            const moduleContent = content[state.currentModule];
            const ex = moduleContent[key].exercise;
            const userCode = document.getElementById(`exercise-code-${key}`).value;
            const feedback = document.getElementById(`exercise-feedback-${key}`);
            
            try {
                if (ex.test(userCode)) {
                    feedback.innerHTML = `<div style="color: var(--success); font-weight: bold;">‚úÖ Correct! Well done!</div>`;
                    addXP(50);
                    triggerConfetti();
                    if (!state.moduleProgress[state.currentModule]) state.moduleProgress[state.currentModule] = new Set();
                    state.moduleProgress[state.currentModule].add(key);
                    updateStats();
                } else {
                    feedback.innerHTML = `<div style="color: var(--warning);">‚ö†Ô∏è Not quite. Check your syntax and try again.</div>`;
                }
            } catch (e) {
                feedback.innerHTML = `<div style="color: var(--danger);">‚ùå Error: ${e.message}</div>`;
            }
        }

        // Quiz Logic
        function checkQuiz(moduleId, qIdx, selected, correct, element) {
            const container = document.getElementById(`quiz-${moduleId}-${qIdx}`);
            const options = container.querySelectorAll('.quiz-option');
            
            options.forEach(opt => opt.style.pointerEvents = 'none');
            
            if (selected === correct) {
                element.classList.add('correct');
                addXP(20);
            } else {
                element.classList.add('wrong');
                options[correct].classList.add('correct');
            }
            
            // Check if all questions answered
            setTimeout(() => checkQuizCompletion(moduleId), 100);
        }

        function checkQuizCompletion(moduleId) {
            const module = document.getElementById(`quiz-result-${moduleId}`);
            if (!module) return;
            
            // Simple completion check - in real app, track properly
            state.completedModules.add(moduleId);
            module.innerHTML = `üéâ Module Complete! +100 XP`;
            addXP(100);
            triggerConfetti();
            updateStats();
            renderNav();
        }

        // Gamification
        function addXP(amount) {
            state.xp += amount;
            updateStats();
        }

        function updateStats() {
            document.getElementById('xp-display').textContent = state.xp;
            const progress = Math.min(100, Math.floor((state.completedModules.size / modules.length) * 100));
            document.getElementById('progress-display').textContent = progress + '%';
        }

        function getModuleProgress(moduleId) {
            if (!state.moduleProgress[moduleId]) return 0;
            const totalSections = Object.keys(content[moduleId] || {}).length;
            return Math.floor((state.moduleProgress[moduleId].size / totalSections) * 100);
        }

        // Visual Effects
        function triggerConfetti() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const colors = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
            
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    life: 1
                });
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;
                
                particles.forEach(p => {
                    if (p.life > 0) {
                        active = true;
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += 0.5; // gravity
                        p.life -= 0.02;
                        
                        ctx.globalAlpha = p.life;
                        ctx.fillStyle = p.color;
                        ctx.fillRect(p.x, p.y, 8, 8);
                    }
                });
                
                if (active) requestAnimationFrame(animate);
                else ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
            
            animate();
        }

        // Simple Syntax Highlighting
        function highlightCode() {
            // In a real app, use Prism.js or Highlight.js
            // This is a simulation for the demo
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', init);
        
        // Make functions global for HTML onclick handlers
        window.loadModule = loadModule;
        window.runCode = runCode;
        window.resetCode = resetCode;
        window.checkExercise = checkExercise;
        window.checkQuiz = checkQuiz;
    </script>
</body>
</html>