<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript Dojo - Master TypeScript</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap');

        :root {
            --ts-blue: #3178C6;
            --ts-light: #235A97;
            --danger: #E53E3E;
            --success: #48BB78;
            --warning: #D69E2E;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            overflow-x: hidden;
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: var(--ts-blue); border-radius: 4px; }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .float { animation: float 3s ease-in-out infinite; }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(49, 120, 198, 0.3); }
            50% { box-shadow: 0 0 40px rgba(49, 120, 198, 0.6); }
        }
        .glow-effect { animation: glow 2s ease-in-out infinite; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.5s ease-in-out; }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in { animation: slideIn 0.5s ease-out forwards; }

        /* Glassmorphism */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Code Editor Styling */
        .code-editor {
            background: #1e1e1e;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        .line-numbers {
            color: #858585;
            text-align: right;
            padding-right: 16px;
            user-select: none;
            border-right: 1px solid #333;
        }
        textarea.code-input {
            background: transparent;
            color: #d4d4d4;
            border: none;
            resize: none;
            outline: none;
            line-height: 1.5;
            tab-size: 2;
        }
        
        /* Type Containers Visual */
        .type-box {
            transition: all 0.3s ease;
            border: 2px dashed rgba(49, 120, 198, 0.3);
        }
        .type-box:hover {
            border-color: var(--ts-blue);
            transform: scale(1.05);
        }
        .type-box.filled {
            border-style: solid;
            background: rgba(49, 120, 198, 0.1);
        }

        /* Interactive Elements */
        .draggable {
            cursor: move;
            transition: transform 0.2s;
        }
        .draggable.dragging {
            opacity: 0.5;
            transform: scale(1.1);
        }
        .drop-zone {
            transition: all 0.3s;
            border: 2px dashed #475569;
        }
        .drop-zone.drag-over {
            border-color: var(--ts-blue);
            background: rgba(49, 120, 198, 0.1);
            transform: scale(1.02);
        }

        /* Progress Ring */
        .progress-ring {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            stroke-linecap: round;
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f00;
            position: absolute;
            animation: fall linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(360deg); }
        }

        /* Terminal Effect */
        .terminal {
            background: #000;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .terminal-header {
            background: #333;
            padding: 8px 12px;
            border-radius: 8px 8px 0 0;
            display: flex;
            gap: 8px;
        }
        .terminal-btn { width: 12px; height: 12px; border-radius: 50%; }
        .terminal-content { padding: 16px; color: #0f0; }

        /* Badge */
        .badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 15px rgba(118, 75, 162, 0.4);
        }

        .highlight-error { 
            background: rgba(229, 62, 62, 0.3); 
            border-bottom: 2px wavy var(--danger);
            cursor: help;
        }
        .highlight-success { 
            background: rgba(72, 187, 120, 0.2); 
            border-bottom: 2px solid var(--success);
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full glass z-50 border-b border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3 cursor-pointer" onclick="showDashboard()">
                    <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl glow-effect">
                        TS
                    </div>
                    <span class="font-bold text-xl tracking-tight">TypeScript<span class="text-blue-400">Dojo</span></span>
                </div>
                
                <div class="flex items-center gap-6">
                    <div class="hidden md:flex items-center gap-2 glass px-4 py-2 rounded-full">
                        <i class="fas fa-fire text-orange-500"></i>
                        <span id="streak-display" class="font-mono font-bold">0</span>
                        <span class="text-sm text-gray-400">day streak</span>
                    </div>
                    
                    <div class="hidden md:flex items-center gap-2">
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Level</div>
                            <div id="level-display" class="font-bold text-blue-400">Padawan</div>
                        </div>
                        <div class="relative w-12 h-12">
                            <svg class="progress-ring w-12 h-12">
                                <circle class="text-gray-700" stroke-width="3" stroke="currentColor" fill="transparent" r="20" cx="24" cy="24"/>
                                <circle id="xp-ring" class="progress-ring-circle text-blue-500" stroke-width="3" stroke="currentColor" fill="transparent" r="20" cx="24" cy="24" stroke-dasharray="125.6" stroke-dashoffset="125.6"/>
                            </svg>
                            <span id="xp-text" class="absolute inset-0 flex items-center justify-center text-xs font-bold">0%</span>
                        </div>
                    </div>
                    
                    <button onclick="toggleHelp()" class="text-gray-400 hover:text-white transition">
                        <i class="fas fa-question-circle text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 pb-12 px-4 max-w-7xl mx-auto">
        
        <!-- Dashboard View -->
        <div id="dashboard" class="space-y-8">
            <!-- Hero -->
            <div class="text-center py-12 space-y-4 slide-in">
                <div class="inline-block px-4 py-2 rounded-full bg-blue-900/30 border border-blue-500/30 text-blue-300 text-sm font-semibold mb-4">
                    <i class="fas fa-rocket mr-2"></i>Zero to Production Ready
                </div>
                <h1 class="text-5xl md:text-6xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-600">
                    Master TypeScript
                </h1>
                <p class="text-xl text-gray-400 max-w-2xl mx-auto">
                    Interactive training for competitive tech interviews. No more <code class="bg-gray-800 px-2 py-1 rounded text-red-400">any</code> types.
                </p>
            </div>

            <!-- Module Grid -->
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Module 1: Basic Types -->
                <div onclick="loadModule('basicTypes')" class="glass rounded-2xl p-6 cursor-pointer hover:border-blue-500 transition-all duration-300 group relative overflow-hidden slide-in" style="animation-delay: 0.1s">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl group-hover:bg-blue-500/20 transition"></div>
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-blue-600/20 flex items-center justify-center text-blue-400 text-2xl">
                            <i class="fas fa-cube"></i>
                        </div>
                        <span id="progress-basicTypes" class="text-sm font-mono text-gray-500">0%</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 group-hover:text-blue-400 transition">Basic Types</h3>
                    <p class="text-gray-400 mb-4">Primitive types, arrays, tuples, enums, and the type safety foundation.</p>
                    <div class="flex gap-2 flex-wrap">
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">string</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">number</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-red-400">any vs unknown</span>
                    </div>
                </div>

                <!-- Module 2: Interfaces -->
                <div onclick="loadModule('interfaces')" class="glass rounded-2xl p-6 cursor-pointer hover:border-purple-500 transition-all duration-300 group relative overflow-hidden slide-in" style="animation-delay: 0.2s">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl group-hover:bg-purple-500/20 transition"></div>
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-purple-600/20 flex items-center justify-center text-purple-400 text-2xl">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <span id="progress-interfaces" class="text-sm font-mono text-gray-500">0%</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 group-hover:text-purple-400 transition">Interfaces & Types</h3>
                    <p class="text-gray-400 mb-4">Object shapes, type aliases, extending, and declaration merging.</p>
                    <div class="flex gap-2 flex-wrap">
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">interface</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">type</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-yellow-400">extends</span>
                    </div>
                </div>

                <!-- Module 3: Generics -->
                <div onclick="loadModule('generics')" class="glass rounded-2xl p-6 cursor-pointer hover:border-green-500 transition-all duration-300 group relative overflow-hidden slide-in" style="animation-delay: 0.3s">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-green-500/10 rounded-full blur-3xl group-hover:bg-green-500/20 transition"></div>
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-green-600/20 flex items-center justify-center text-green-400 text-2xl">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <span id="progress-generics" class="text-sm font-mono text-gray-500">0%</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 group-hover:text-green-400 transition">Generics</h3>
                    <p class="text-gray-400 mb-4">Reusable type templates, constraints, and generic functions.</p>
                    <div class="flex gap-2 flex-wrap">
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">&lt;T&gt;</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">constraints</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-green-400">utility types</span>
                    </div>
                </div>

                <!-- Module 4: Configuration -->
                <div onclick="loadModule('config')" class="glass rounded-2xl p-6 cursor-pointer hover:border-orange-500 transition-all duration-300 group relative overflow-hidden slide-in" style="animation-delay: 0.4s">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-orange-500/10 rounded-full blur-3xl group-hover:bg-orange-500/20 transition"></div>
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-orange-600/20 flex items-center justify-center text-orange-400 text-2xl">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <span id="progress-config" class="text-sm font-mono text-gray-500">0%</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 group-hover:text-orange-400 transition">TS Config</h3>
                    <p class="text-gray-400 mb-4">tsconfig.json, strict mode, compiler options, and production setup.</p>
                    <div class="flex gap-2 flex-wrap">
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">strict</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-gray-300">target</span>
                        <span class="text-xs px-2 py-1 bg-gray-800 rounded text-red-400">noImplicitAny</span>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="glass rounded-2xl p-6 mt-8 slide-in" style="animation-delay: 0.5s">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-line text-blue-400"></i>
                    Your Journey
                </h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="text-center p-4 bg-gray-800/50 rounded-xl">
                        <div id="stat-xp" class="text-3xl font-bold text-blue-400">0</div>
                        <div class="text-sm text-gray-400">XP Earned</div>
                    </div>
                    <div class="text-center p-4 bg-gray-800/50 rounded-xl">
                        <div id="stat-challenges" class="text-3xl font-bold text-purple-400">0</div>
                        <div class="text-sm text-gray-400">Challenges</div>
                    </div>
                    <div class="text-center p-4 bg-gray-800/50 rounded-xl">
                        <div id="stat-perfect" class="text-3xl font-bold text-green-400">0</div>
                        <div class="text-sm text-gray-400">Perfect Runs</div>
                    </div>
                    <div class="text-center p-4 bg-gray-800/50 rounded-xl">
                        <div id="stat-bugs" class="text-3xl font-bold text-red-400">0</div>
                        <div class="text-sm text-gray-400">Bugs Caught</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module View (Hidden by default) -->
        <div id="module-view" class="hidden space-y-6">
            <button onclick="showDashboard()" class="mb-4 text-gray-400 hover:text-white flex items-center gap-2 transition">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </button>
            
            <div id="module-content" class="space-y-6">
                <!-- Dynamic content loaded here -->
            </div>
        </div>

    </main>

    <!-- Help Modal -->
    <div id="help-modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4">
        <div class="glass rounded-2xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">How to Use TypeScript Dojo</h2>
                <button onclick="toggleHelp()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="space-y-4 text-gray-300">
                <p>Welcome, ninja! This dojo will train you in the ancient arts of Type Safety.</p>
                <ul class="space-y-2 list-disc list-inside">
                    <li>Complete all 4 modules to earn the <strong>Type Master</strong> badge</li>
                    <li>Each module has theory, interactive examples, and a boss battle</li>
                    <li>Watch out for <span class="text-red-400">Pitfall</span> warnings ‚Äì these are mistakes that cost developers their jobs</li>
                    <li>Earn XP by writing correct TypeScript and catching bugs</li>
                </ul>
                <div class="mt-6 p-4 bg-blue-900/30 rounded-lg border border-blue-500/30">
                    <strong class="text-blue-400">Pro Tip:</strong> In real interviews, never use <code>any</code>. Treat it like a forbidden technique.
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management
        const state = {
            xp: parseInt(localStorage.getItem('ts_xp') || '0'),
            level: localStorage.getItem('ts_level') || 'Padawan',
            streak: parseInt(localStorage.getItem('ts_streak') || '0'),
            completed: JSON.parse(localStorage.getItem('ts_completed') || '[]'),
            currentModule: null,
            stats: {
                challenges: parseInt(localStorage.getItem('ts_challenges') || '0'),
                perfect: parseInt(localStorage.getItem('ts_perfect') || '0'),
                bugs: parseInt(localStorage.getItem('ts_bugs') || '0')
            }
        };

        // Content Data
        const modules = {
            basicTypes: {
                title: 'Basic Types Fundamentals',
                color: 'blue',
                icon: 'cube',
                sections: [
                    {
                        type: 'theory',
                        title: 'The Type Container Model',
                        content: `
                            <div class="mb-6">
                                <p class="mb-4">Think of types as containers. Each container can only hold specific shapes of data.</p>
                                <div class="grid grid-cols-3 gap-4 mt-6">
                                    <div class="type-box p-4 rounded-lg text-center">
                                        <div class="text-3xl mb-2">üì¶</div>
                                        <div class="font-mono text-blue-400">string</div>
                                        <div class="text-xs text-gray-500 mt-2">"hello", 'world'</div>
                                    </div>
                                    <div class="type-box p-4 rounded-lg text-center">
                                        <div class="text-3xl mb-2">üî¢</div>
                                        <div class="font-mono text-green-400">number</div>
                                        <div class="text-xs text-gray-500 mt-2">42, 3.14, -7</div>
                                    </div>
                                    <div class="type-box p-4 rounded-lg text-center">
                                        <div class="text-3xl mb-2">‚úÖ</div>
                                        <div class="font-mono text-purple-400">boolean</div>
                                        <div class="text-xs text-gray-500 mt-2">true, false</div>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'Type Matcher',
                        description: 'Drag the correct type to each variable',
                        setup: 'typeMatcher'
                    },
                    {
                        type: 'code',
                        title: 'Arrays & Tuples',
                        description: 'Arrays hold multiple items of the SAME type. Tuples have FIXED positions with specific types.',
                        code: `// Array: All items must be strings
let names: string[] = ["Alice", "Bob", "Charlie"];

// Tuple: Fixed structure [string, number]
let user: [string, number] = ["Alice", 25];
// user = [25, "Alice"]; // ‚ùå Error! Order matters`,
                        exercise: 'Fix the tuple type to match the data: ["Error Code", 404, true]',
                        initialCode: 'let errorResponse = ["Error Code", 404, true];',
                        solution: 'let errorResponse: [string, number, boolean] = ["Error Code", 404, true];',
                        validate: (code) => code.includes('[string, number, boolean]') || code.includes('[string,number,boolean]')
                    },
                    {
                        type: 'pitfall',
                        title: '‚ò†Ô∏è The any Trap vs unknown Safety',
                        content: `
                            <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-4 mb-4">
                                <h4 class="text-red-400 font-bold mb-2">The Deadly any</h4>
                                <p class="text-sm mb-2">Using <code>any</code> disables type checking. It's like turning off the safety on a weapon.</p>
                                <pre class="bg-gray-900 p-2 rounded text-sm">let data: any = "string";
data.toFixed(2); // Runtime error! TypeScript didn't catch this.</pre>
                            </div>
                            <div class="bg-green-900/20 border border-green-500/30 rounded-lg p-4">
                                <h4 class="text-green-400 font-bold mb-2">The Safe unknown</h4>
                                <p class="text-sm mb-2"><code>unknown</code> forces you to check types before using them.</p>
                                <pre class="bg-gray-900 p-2 rounded text-sm">let data: unknown = "string";
if (typeof data === "string") {
  data.toUpperCase(); // ‚úÖ Safe!
}</pre>
                            </div>
                        `
                    },
                    {
                        type: 'quiz',
                        questions: [
                            {
                                q: 'What is the type of []?',
                                options: ['any[]', 'never[]', 'unknown', 'undefined'],
                                correct: 0,
                                explanation: 'An empty array defaults to any[] unless explicitly typed.'
                            },
                            {
                                q: 'Which is safer: any or unknown?',
                                options: ['any - more flexible', 'unknown - forces type guards', 'They are identical', 'unknown is deprecated'],
                                correct: 1,
                                explanation: 'unknown requires type checking before operations, making it type-safe.'
                            }
                        ]
                    }
                ]
            },
            interfaces: {
                title: 'Interfaces vs Type Aliases',
                color: 'purple',
                icon: 'project-diagram',
                sections: [
                    {
                        type: 'theory',
                        title: 'Contracts and Shapes',
                        content: `
                            <p class="mb-4">Interfaces describe the shape of objects. Think of them as molds or blueprints.</p>
                            <div class="grid md:grid-cols-2 gap-4 mt-6">
                                <div class="glass p-4 rounded-lg border-l-4 border-purple-500">
                                    <h4 class="font-bold text-purple-400 mb-2">Interface</h4>
                                    <ul class="text-sm space-y-1 text-gray-300">
                                        <li>‚úÖ Can be extended (merged)</li>
                                        <li>‚úÖ Declaration merging</li>
                                        <li>‚ùå Only objects</li>
                                        <li>Best for: Public APIs, Classes</li>
                                    </ul>
                                </div>
                                <div class="glass p-4 rounded-lg border-l-4 border-pink-500">
                                    <h4 class="font-bold text-pink-400 mb-2">Type Alias</h4>
                                    <ul class="text-sm space-y-1 text-gray-300">
                                        <li>‚úÖ Unions & Primitives</li>
                                        <li>‚úÖ Mapped types</li>
                                        <li>‚ùå No merging</li>
                                        <li>Best for: Complex types, Unions</li>
                                    </ul>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'Build an Interface',
                        description: 'Construct the User interface by selecting required properties',
                        setup: 'interfaceBuilder'
                    },
                    {
                        type: 'code',
                        title: 'Extending vs Intersection',
                        description: 'Interface extends creates a inheritance chain. Type intersection (&) combines types.',
                        code: `// Interface extension
interface Animal { name: string; }
interface Dog extends Animal { breed: string; }

// Type intersection
type Animal = { name: string; };
type Dog = Animal & { breed: string; };`,
                        exercise: 'Create an interface Vehicle with brand, year, and an optional model property',
                        initialCode: '// Write your interface here\n',
                        solution: 'interface Vehicle { brand: string; year: number; model?: string; }',
                        validate: (code) => /interface\s+\w+\s*\{[^}]*\w+\??\s*:\s*\w+[^}]*\}/.test(code) && code.includes('interface')
                    },
                    {
                        type: 'pitfall',
                        title: 'üö® Optional vs Undefined',
                        content: `
                            <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4">
                                <p class="mb-2"><strong>property?: string</strong> means the property can be omitted.</p>
                                <p class="mb-2"><strong>property: string | undefined</strong> means it MUST exist but can be undefined.</p>
                                <pre class="bg-gray-900 p-2 rounded text-sm mt-2">interface Config {
  name?: string;        // Can be missing
  port: number | undefined;  // Must be present
}
const c: Config = { port: undefined }; // name is optional, port required</pre>
                            </div>
                        `
                    }
                ]
            },
            generics: {
                title: 'Generics Mastery',
                color: 'green',
                icon: 'box-open',
                sections: [
                    {
                        type: 'theory',
                        title: 'The Template Concept',
                        content: `
                            <p class="mb-4">Generics are like reusable molds with empty slots. Instead of making a separate box for apples and oranges, make a Box&lt;T&gt;.</p>
                            <div class="flex justify-center my-8">
                                <div class="relative">
                                    <div class="w-32 h-32 border-4 border-dashed border-green-500 rounded-lg flex items-center justify-center text-4xl">
                                        <span class="text-green-400 font-mono font-bold">T</span>
                                    </div>
                                    <div class="absolute -right-16 top-0 text-sm text-gray-400">Type Parameter</div>
                                </div>
                                <div class="flex items-center mx-4 text-2xl text-gray-600">‚Üí</div>
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="w-16 h-16 bg-green-900/30 rounded flex items-center justify-center text-2xl">üì¶</div>
                                    <div class="w-16 h-16 bg-blue-900/30 rounded flex items-center justify-center text-2xl">üì¶</div>
                                    <div class="w-16 h-16 bg-purple-900/30 rounded flex items-center justify-center text-2xl">üì¶</div>
                                    <div class="w-16 h-16 bg-orange-900/30 rounded flex items-center justify-center text-2xl">üì¶</div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'Generic Constraints',
                        description: 'Limit what T can be using extends',
                        setup: 'genericConstraints'
                    },
                    {
                        type: 'code',
                        title: 'Generic Functions',
                        description: 'Functions that work with any type while preserving type information',
                        code: `// Without generics - we lose type info
function identity(arg: any): any { return arg; }

// With generics - type is preserved
function identity<T>(arg: T): T { return arg; }

let output = identity<string>("myString");
// output is typed as 'string', not 'any'`,
                        exercise: 'Write a generic function wrapInArray that takes a value and returns [value]',
                        initialCode: '// function wrapInArray...',
                        solution: 'function wrapInArray<T>(value: T): T[] { return [value]; }',
                        validate: (code) => code.includes('<T>') && code.includes('T[]') && code.includes('return [')
                    },
                    {
                        type: 'quiz',
                        questions: [
                            {
                                q: 'What does <T extends { length: number }> constrain?',
                                options: ['Only arrays', 'Anything with a length property', 'Only strings', 'Only numbers'],
                                correct: 1,
                                explanation: 'extends checks for structure. Strings, arrays, and objects with length qualify.'
                            }
                        ]
                    }
                ]
            },
            config: {
                title: 'TSConfig & Strict Mode',
                color: 'orange',
                icon: 'cogs',
                sections: [
                    {
                        type: 'theory',
                        title: 'The Compiler Control Center',
                        content: `
                            <p class="mb-4">tsconfig.json is your TypeScript manifest. The most important setting is <code>strict: true</code>.</p>
                            <div class="terminal mt-4">
                                <div class="terminal-header">
                                    <div class="terminal-btn bg-red-500"></div>
                                    <div class="terminal-btn bg-yellow-500"></div>
                                    <div class="terminal-btn bg-green-500"></div>
                                    <span class="ml-2 text-xs text-gray-400">tsconfig.json</span>
                                </div>
                                <div class="terminal-content text-sm">
                                    {
                                      "compilerOptions": {
                                        "target": "ES2020",
                                        "module": "ESNext",
                                        "strict": true,  ‚Üê üéØ Critical for production
                                        "noImplicitAny": true,
                                        "strictNullChecks": true
                                      }
                                    }
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'Strict Mode Simulator',
                        description: 'Toggle options to see how they catch bugs',
                        setup: 'strictModeSimulator'
                    },
                    {
                        type: 'pitfall',
                        title: 'üíÄ The Production Config Disaster',
                        content: `
                            <div class="space-y-4">
                                <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-4">
                                    <h4 class="text-red-400 font-bold mb-2">Never do this in production:</h4>
                                    <pre class="bg-gray-900 p-2 rounded text-sm">{
  "compilerOptions": {
    "strict": false,
    "noImplicitAny": false  // Silent failures everywhere!
  }
}</pre>
                                </div>
                                <p class="text-sm">Turning off strict mode leads to runtime errors in production that TypeScript should have caught. Always enable strict mode from day one.</p>
                            </div>
                        `
                    }
                ]
            }
        };

        // Initialize
        function init() {
            updateStats();
            updateProgress();
        }

        function updateStats() {
            document.getElementById('xp-text').textContent = Math.min(state.xp, 100) + '%';
            document.getElementById('xp-ring').style.strokeDashoffset = 125.6 - (Math.min(state.xp, 100) / 100 * 125.6);
            document.getElementById('streak-display').textContent = state.streak;
            document.getElementById('level-display').textContent = state.level;
            document.getElementById('stat-xp').textContent = state.xp;
            document.getElementById('stat-challenges').textContent = state.stats.challenges;
            document.getElementById('stat-perfect').textContent = state.stats.perfect;
            document.getElementById('stat-bugs').textContent = state.stats.bugs;
            
            // Save to localStorage
            localStorage.setItem('ts_xp', state.xp);
            localStorage.setItem('ts_level', state.level);
            localStorage.setItem('ts_streak', state.streak);
            localStorage.setItem('ts_completed', JSON.stringify(state.completed));
        }

        function addXP(amount) {
            state.xp += amount;
            if (state.xp >= 100) {
                state.xp = 0;
                levelUp();
            }
            updateStats();
            createConfetti();
        }

        function levelUp() {
            const levels = ['Padawan', 'Ninja', 'Samurai', 'Sensei', 'Grandmaster'];
            const currentIdx = levels.indexOf(state.level);
            if (currentIdx < levels.length - 1) {
                state.level = levels[currentIdx + 1];
                alert(`üéâ Level Up! You are now a ${state.level}!`);
            }
        }

        function updateProgress() {
            Object.keys(modules).forEach(key => {
                const el = document.getElementById(`progress-${key}`);
                if (state.completed.includes(key)) {
                    el.textContent = '100%';
                    el.classList.add('text-green-400');
                }
            });
        }

        function showDashboard() {
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('module-view').classList.add('hidden');
        }

        function loadModule(moduleKey) {
            state.currentModule = moduleKey;
            const module = modules[moduleKey];
            const container = document.getElementById('module-content');
            
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('module-view').classList.remove('hidden');
            
            container.innerHTML = `
                <div class="glass rounded-2xl p-8 mb-6 border-l-4 border-${module.color}-500 slide-in">
                    <h1 class="text-4xl font-bold mb-2 flex items-center gap-3">
                        <i class="fas fa-${module.icon} text-${module.color}-400"></i>
                        ${module.title}
                    </h1>
                    <p class="text-gray-400">Complete all sections to master this topic</p>
                </div>
            `;
            
            module.sections.forEach((section, idx) => {
                const sectionEl = document.createElement('div');
                sectionEl.className = 'glass rounded-xl p-6 slide-in';
                sectionEl.style.animationDelay = `${idx * 0.1}s`;
                
                if (section.type === 'theory') {
                    sectionEl.innerHTML = `
                        <h3 class="text-2xl font-bold mb-4 text-${module.color}-400">${section.title}</h3>
                        ${section.content}
                    `;
                } else if (section.type === 'code') {
                    sectionEl.innerHTML = createCodeChallenge(section, module.color);
                } else if (section.type === 'quiz') {
                    sectionEl.innerHTML = createQuiz(section, module.color);
                } else if (section.type === 'pitfall') {
                    sectionEl.innerHTML = `
                        <div class="flex items-center gap-2 mb-4">
                            <i class="fas fa-skull-crossbones text-red-500 text-2xl"></i>
                            <h3 class="text-2xl font-bold text-red-400">${section.title}</h3>
                        </div>
                        ${section.content}
                    `;
                } else if (section.type === 'interactive') {
                    sectionEl.innerHTML = createInteractive(section, module.color);
                    sectionEl.id = `interactive-${section.setup}`;
                }
                
                container.appendChild(sectionEl);
            });
            
            // Initialize interactive components
            setTimeout(() => {
                if (module.sections.find(s => s.setup === 'typeMatcher')) initTypeMatcher();
                if (module.sections.find(s => s.setup === 'interfaceBuilder')) initInterfaceBuilder();
                if (module.sections.find(s => s.setup === 'genericConstraints')) initGenericConstraints();
                if (module.sections.find(s => s.setup === 'strictModeSimulator')) initStrictModeSimulator();
            }, 100);
        }

        function createCodeChallenge(section, color) {
            return `
                <h3 class="text-xl font-bold mb-2 text-${color}-400">${section.title}</h3>
                <p class="text-gray-400 mb-4">${section.description}</p>
                <div class="code-editor mb-4">
                    <div class="flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700">
                        <span class="text-sm text-gray-400">Exercise.ts</span>
                        <button onclick="resetCode(this)" class="text-xs text-gray-400 hover:text-white">
                            <i class="fas fa-undo"></i> Reset
                        </button>
                    </div>
                    <div class="flex">
                        <div class="line-numbers p-4 text-sm font-mono bg-gray-900 text-gray-600 select-none">
                            1<br>2<br>3<br>4<br>5
                        </div>
                        <textarea class="code-input w-full p-4 font-mono text-sm bg-gray-900 text-gray-300" 
                            rows="5" spellcheck="false" data-initial="${section.initialCode}" 
                            data-solution="${section.solution}" data-validate="${section.validate.toString()}">${section.initialCode}</textarea>
                    </div>
                </div>
                <div class="bg-gray-800/50 rounded-lg p-4 mb-4">
                    <strong class="text-yellow-400">Task:</strong> ${section.exercise}
                </div>
                <button onclick="checkCode(this)" class="bg-${color}-600 hover:bg-${color}-500 text-white px-6 py-2 rounded-lg font-bold transition">
                    <i class="fas fa-play mr-2"></i>Run Type Checker
                </button>
                <div class="result mt-4 hidden"></div>
            `;
        }

        function createQuiz(section, color) {
            let html = `<h3 class="text-xl font-bold mb-4 text-${color}-400">Knowledge Check</h3>`;
            section.questions.forEach((q, idx) => {
                html += `
                    <div class="mb-6 quiz-question" data-answered="false">
                        <p class="font-semibold mb-3">${idx + 1}. ${q.q}</p>
                        <div class="space-y-2">
                            ${q.options.map((opt, optIdx) => `
                                <button onclick="checkAnswer(this, ${optIdx}, ${q.correct}, '${q.explanation}')" 
                                    class="w-full text-left p-3 rounded-lg border border-gray-700 hover:border-${color}-500 hover:bg-gray-800 transition flex justify-between items-center">
                                    <span>${opt}</span>
                                    <i class="fas fa-check-circle opacity-0 text-green-400"></i>
                                </button>
                            `).join('')}
                        </div>
                        <div class="explanation mt-2 hidden p-3 rounded bg-gray-800 text-sm"></div>
                    </div>
                `;
            });
            return html;
        }

        function createInteractive(section, color) {
            return `
                <h3 class="text-xl font-bold mb-2 text-${color}-400">${section.title}</h3>
                <p class="text-gray-400 mb-4">${section.description}</p>
                <div class="interactive-container bg-gray-900/50 rounded-lg p-6 min-h-[300px]">
                    <!-- Interactive content will be injected here -->
                </div>
            `;
        }

        // Interactive Components
        function initTypeMatcher() {
            const container = document.querySelector('#interactive-typeMatcher .interactive-container');
            container.innerHTML = `
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-bold mb-4 text-gray-300">Variables (Drop types here)</h4>
                        <div class="space-y-3">
                            <div class="drop-zone p-4 rounded-lg bg-gray-800" data-accepts="string">
                                <span class="font-mono text-sm text-gray-400">let username = "alice";</span>
                                <div class="mt-2 h-8 border-2 border-dashed border-gray-600 rounded flex items-center justify-center text-xs text-gray-500 drop-target">
                                    Drop type here
                                </div>
                            </div>
                            <div class="drop-zone p-4 rounded-lg bg-gray-800" data-accepts="number">
                                <span class="font-mono text-sm text-gray-400">let age = 25;</span>
                                <div class="mt-2 h-8 border-2 border-dashed border-gray-600 rounded flex items-center justify-center text-xs text-gray-500 drop-target">
                                    Drop type here
                                </div>
                            </div>
                            <div class="drop-zone p-4 rounded-lg bg-gray-800" data-accepts="boolean">
                                <span class="font-mono text-sm text-gray-400">let isActive = true;</span>
                                <div class="mt-2 h-8 border-2 border-dashed border-gray-600 rounded flex items-center justify-center text-xs text-gray-500 drop-target">
                                    Drop type here
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-bold mb-4 text-gray-300">Available Types (Drag to match)</h4>
                        <div class="flex flex-wrap gap-2">
                            <div class="draggable bg-blue-600/20 border border-blue-500 text-blue-400 px-4 py-2 rounded cursor-move" draggable="true" data-type="string">string</div>
                            <div class="draggable bg-green-600/20 border border-green-500 text-green-400 px-4 py-2 rounded cursor-move" draggable="true" data-type="number">number</div>
                            <div class="draggable bg-purple-600/20 border border-purple-500 text-purple-400 px-4 py-2 rounded cursor-move" draggable="true" data-type="boolean">boolean</div>
                            <div class="draggable bg-red-600/20 border border-red-500 text-red-400 px-4 py-2 rounded cursor-move" draggable="true" data-type="any">any</div>
                        </div>
                        <div id="match-feedback" class="mt-4 text-sm"></div>
                    </div>
                </div>
            `;
            
            // Drag and drop logic
            let dragged = null;
            document.querySelectorAll('.draggable').forEach(el => {
                el.addEventListener('dragstart', (e) => {
                    dragged = el;
                    el.classList.add('dragging');
                });
                el.addEventListener('dragend', () => {
                    el.classList.remove('dragging');
                });
            });
            
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    const target = zone.querySelector('.drop-target');
                    const accepts = zone.dataset.accepts;
                    const type = dragged.dataset.type;
                    
                    if (accepts === type) {
                        target.textContent = type;
                        target.className = 'mt-2 h-8 rounded flex items-center justify-center text-xs font-bold bg-green-600/20 text-green-400 border border-green-500';
                        dragged.style.display = 'none';
                        document.getElementById('match-feedback').innerHTML += '<div class="text-green-400">‚úÖ Correct match!</div>';
                        addXP(5);
                    } else {
                        zone.classList.add('shake');
                        setTimeout(() => zone.classList.remove('shake'), 500);
                        document.getElementById('match-feedback').innerHTML += '<div class="text-red-400">‚ùå Try again!</div>';
                    }
                });
            });
        }

        function initInterfaceBuilder() {
            const container = document.querySelector('#interactive-interfaceBuilder .interactive-container');
            container.innerHTML = `
                <div class="space-y-4">
                    <div class="bg-gray-800 p-4 rounded-lg font-mono text-sm">
                        interface User {<br>
                        &nbsp;&nbsp;<span id="interface-content"></span><br>
                        }
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-bold mb-2">Available Properties</h4>
                            <div class="space-y-2">
                                <button onclick="addProp('id: number;')" class="w-full text-left p-2 bg-gray-800 rounded hover:bg-gray-700 text-sm">id: number;</button>
                                <button onclick="addProp('name: string;')" class="w-full text-left p-2 bg-gray-800 rounded hover:bg-gray-700 text-sm">name: string;</button>
                                <button onclick="addProp('email?: string;')" class="w-full text-left p-2 bg-gray-800 rounded hover:bg-gray-700 text-sm">email?: string; (optional)</button>
                                <button onclick="addProp('role: "admin" | "user";')" class="w-full text-left p-2 bg-gray-800 rounded hover:bg-gray-700 text-sm">role: "admin" | "user";</button>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-bold mb-2">Validation</h4>
                            <div id="interface-validation" class="text-sm text-gray-400">
                                Add properties to build a valid User interface...
                            </div>
                            <button onclick="validateInterface()" class="mt-4 bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded text-sm">Validate Interface</button>
                        </div>
                    </div>
                </div>
            `;
            
            window.interfaceProps = [];
            window.addProp = (prop) => {
                window.interfaceProps.push(prop);
                document.getElementById('interface-content').innerHTML = window.interfaceProps.join('<br>&nbsp;&nbsp;');
            };
            window.validateInterface = () => {
                const hasId = window.interfaceProps.some(p => p.includes('id'));
                const hasName = window.interfaceProps.some(p => p.includes('name'));
                const val = document.getElementById('interface-validation');
                
                if (hasId && hasName) {
                    val.innerHTML = '<span class="text-green-400">‚úÖ Valid! Good job including required fields.</span>';
                    addXP(10);
                } else {
                    val.innerHTML = '<span class="text-red-400">‚ö†Ô∏è Most User interfaces need at least id and name.</span>';
                }
            };
        }

        function initGenericConstraints() {
            const container = document.querySelector('#interactive-genericConstraints .interactive-container');
            container.innerHTML = `
                <div class="space-y-4">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="text-4xl">üì¶</div>
                        <div class="text-2xl font-mono text-green-400">Box&lt;<span id="generic-type">T</span>&gt;</div>
                        <div class="flex gap-2">
                            <button onclick="setGeneric('string')" class="px-3 py-1 bg-blue-600/20 border border-blue-500 rounded text-sm hover:bg-blue-600/40">string</button>
                            <button onclick="setGeneric('number')" class="px-3 py-1 bg-green-600/20 border border-green-500 rounded text-sm hover:bg-green-600/40">number</button>
                            <button onclick="setGeneric('boolean')" class="px-3 py-1 bg-purple-600/20 border border-purple-500 rounded text-sm hover:bg-purple-600/40">boolean</button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 p-4 rounded-lg font-mono text-sm space-y-2">
                        <div>function process&lt;T extends { length: number }&gt;(arg: T): T {</div>
                        <div>&nbsp;&nbsp;console.log(arg.length);</div>
                        <div>&nbsp;&nbsp;return arg;</div>
                        <div>}</div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-2 mt-4">
                        <button onclick="testGeneric('"hello"')" class="p-2 bg-gray-800 rounded text-sm hover:bg-gray-700">"hello"</button>
                        <button onclick="testGeneric('[1,2,3]')" class="p-2 bg-gray-800 rounded text-sm hover:bg-gray-700">[1,2,3]</button>
                        <button onclick="testGeneric('42')" class="p-2 bg-gray-800 rounded text-sm hover:bg-gray-700">42</button>
                        <button onclick="testGeneric('{length: 10}')" class="p-2 bg-gray-800 rounded text-sm hover:bg-gray-700">{length: 10}</button>
                    </div>
                    
                    <div id="generic-result" class="mt-4 p-3 rounded bg-gray-800/50 text-sm"></div>
                </div>
            `;
            
            window.setGeneric = (type) => {
                document.getElementById('generic-type').textContent = type;
            };
            window.testGeneric = (val) => {
                const result = document.getElementById('generic-result');
                if (val === '42') {
                    result.innerHTML = '<span class="text-red-400">‚ùå Error: number has no length property</span>';
                    state.stats.bugs++;
                    updateStats();
                } else {
                    result.innerHTML = `<span class="text-green-400">‚úÖ Valid! ${val} has a length property</span>`;
                    addXP(5);
                }
            };
        }

        function initStrictModeSimulator() {
            const container = document.querySelector('#interactive-strictModeSimulator .interactive-container');
            container.innerHTML = `
                <div class="space-y-6">
                    <div class="flex gap-4 mb-6">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="strict-any" class="w-4 h-4" onchange="updateStrictPreview()">
                            <span>noImplicitAny</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="strict-null" class="w-4 h-4" onchange="updateStrictPreview()">
                            <span>strictNullChecks</span>
                        </label>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-bold mb-2 text-sm text-gray-400">Source Code</h4>
                            <pre class="text-sm font-mono">function greet(name) {
  return "Hello " + name.toUpperCase();
}

greet(null);</pre>
                        </div>
                        <div class="bg-gray-800 p-4 rounded-lg">
                            <h4 class="font-bold mb-2 text-sm text-gray-400">Compiler Output</h4>
                            <div id="compiler-output" class="text-sm font-mono text-green-400">‚úÖ No errors (unsafe!)</div>
                        </div>
                    </div>
                    
                    <div id="strict-explanation" class="text-sm text-gray-400"></div>
                </div>
            `;
            
            window.updateStrictPreview = () => {
                const noAny = document.getElementById('strict-any').checked;
                const strictNull = document.getElementById('strict-null').checked;
                const output = document.getElementById('compiler-output');
                const expl = document.getElementById('strict-explanation');
                
                let errors = [];
                if (noAny) errors.push("Parameter 'name' implicitly has an 'any' type.");
                if (strictNull) errors.push("Argument of type 'null' is not assignable to parameter of type 'string'.");
                
                if (errors.length === 0) {
                    output.innerHTML = '<span class="text-yellow-400">‚ö†Ô∏è Compiles, but will crash at runtime if name is null</span>';
                    expl.textContent = "Without strict checks, this code compiles but explodes in production when greet(null) is called.";
                } else {
                    output.innerHTML = errors.map(e => `<div class="text-red-400">‚ùå ${e}</div>`).join('');
                    expl.textContent = "Strict mode catches these bugs before deployment!";
                    addXP(5);
                }
            };
        }

        // Code Checking Logic
        function checkCode(btn) {
            const editor = btn.previousElementSibling.previousElementSibling.querySelector('textarea');
            const result = btn.nextElementSibling;
            const code = editor.value;
            const validateStr = editor.dataset.validate;
            const solution = editor.dataset.solution;
            
            // Create function from string and execute
            const validate = new Function('code', `return (${validateStr})(code)`);
            
            result.classList.remove('hidden');
            state.stats.challenges++;
            
            if (validate(code)) {
                result.innerHTML = `
                    <div class="bg-green-900/30 border border-green-500/30 rounded-lg p-4">
                        <div class="flex items-center gap-2 text-green-400 font-bold mb-2">
                            <i class="fas fa-check-circle"></i> Correct!
                        </div>
                        <p class="text-sm text-gray-300 mb-2">Great job! Your solution:</p>
                        <pre class="bg-gray-900 p-2 rounded text-sm text-green-300">${solution}</pre>
                    </div>
                `;
                addXP(15);
                if (!state.completed.includes(state.currentModule)) {
                    state.completed.push(state.currentModule);
                    updateProgress();
                }
            } else {
                result.innerHTML = `
                    <div class="bg-red-900/30 border border-red-500/30 rounded-lg p-4">
                        <div class="flex items-center gap-2 text-red-400 font-bold mb-2">
                            <i class="fas fa-times-circle"></i> Not quite right
                        </div>
                        <p class="text-sm text-gray-300">Check your syntax. Remember: TypeScript types follow the variable name with a colon.</p>
                    </div>
                `;
                editor.parentElement.classList.add('shake');
                setTimeout(() => editor.parentElement.classList.remove('shake'), 500);
            }
            updateStats();
        }

        function resetCode(btn) {
            const editor = btn.closest('.code-editor').querySelector('textarea');
            editor.value = editor.dataset.initial;
        }

        function checkAnswer(btn, selected, correct, explanation) {
            const question = btn.closest('.quiz-question');
            if (question.dataset.answered === "true") return;
            
            question.dataset.answered = "true";
            const buttons = question.querySelectorAll('button');
            const explDiv = question.querySelector('.explanation');
            
            buttons.forEach((b, idx) => {
                b.disabled = true;
                if (idx === correct) {
                    b.classList.add('bg-green-600/20', 'border-green-500');
                    b.querySelector('i').classList.remove('opacity-0');
                } else if (idx === selected && selected !== correct) {
                    b.classList.add('bg-red-600/20', 'border-red-500');
                }
            });
            
            explDiv.innerHTML = `<strong class="${selected === correct ? 'text-green-400' : 'text-red-400'}">
                ${selected === correct ? 'Correct!' : 'Incorrect.'}
            </strong> ${explanation}`;
            explDiv.classList.remove('hidden');
            
            if (selected === correct) {
                addXP(10);
            } else {
                state.stats.bugs++;
                updateStats();
            }
        }

        function toggleHelp() {
            const modal = document.getElementById('help-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
        }

        function createConfetti() {
            for (let i = 0; i < 20; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = ['#3178C6', '#48BB78', '#D69E2E', '#9F7AEA'][Math.floor(Math.random() * 4)];
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }
        }

        // Initialize app
        init();
    </script>
</body>
</html>