<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ö° JS Advanced Functions Mastery</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0a0a1a;--bg2:#111128;--bg3:#1a1a3e;--bg4:#252550;
  --cyan:#00d4ff;--pink:#ff6b9d;--green:#51cf66;--yellow:#ffd43b;
  --purple:#da77f2;--orange:#ff922b;--red:#ff6b6b;--blue:#748ffc;
  --text:#e0e0e0;--text2:#a0a0c0;--text3:#6a6a8a;
  --radius:12px;--shadow:0 8px 32px rgba(0,0,0,.4);
}
html{scroll-behavior:smooth}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:var(--bg);color:var(--text);line-height:1.7;overflow-x:hidden}
::-webkit-scrollbar{width:8px}
::-webkit-scrollbar-track{background:var(--bg2)}
::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:4px}
::-webkit-scrollbar-thumb:hover{background:var(--purple)}

/* NAV */
.topbar{position:fixed;top:0;left:0;right:0;height:60px;background:rgba(10,10,26,.95);backdrop-filter:blur(20px);border-bottom:1px solid rgba(0,212,255,.15);display:flex;align-items:center;padding:0 24px;z-index:1000;gap:16px}
.topbar .logo{font-size:1.3em;font-weight:800;background:linear-gradient(135deg,var(--cyan),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.topbar .progress-wrap{flex:1;max-width:300px;height:6px;background:var(--bg3);border-radius:3px;overflow:hidden;margin-left:auto}
.topbar .progress-fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--purple));border-radius:3px;transition:width .5s;width:0%}
.topbar .progress-text{font-size:.8em;color:var(--cyan);min-width:40px;text-align:right}
.topbar .streak{font-size:.85em;color:var(--yellow)}

.sidebar{position:fixed;top:60px;left:0;width:260px;height:calc(100vh - 60px);background:var(--bg2);border-right:1px solid rgba(255,255,255,.05);overflow-y:auto;z-index:999;transition:transform .3s}
.sidebar .nav-section{padding:16px 0;border-bottom:1px solid rgba(255,255,255,.03)}
.sidebar .nav-label{padding:4px 20px;font-size:.7em;text-transform:uppercase;letter-spacing:2px;color:var(--text3)}
.sidebar .nav-item{display:flex;align-items:center;gap:12px;padding:10px 20px;cursor:pointer;transition:all .2s;color:var(--text2);font-size:.9em;border-left:3px solid transparent}
.sidebar .nav-item:hover{background:rgba(0,212,255,.05);color:var(--text)}
.sidebar .nav-item.active{background:rgba(0,212,255,.1);color:var(--cyan);border-left-color:var(--cyan)}
.sidebar .nav-item .icon{font-size:1.2em;width:24px;text-align:center}
.sidebar .nav-item .check{margin-left:auto;font-size:.8em;color:var(--green);opacity:0;transition:opacity .3s}
.sidebar .nav-item.completed .check{opacity:1}

.main{margin-left:260px;margin-top:60px;padding:32px;min-height:calc(100vh - 60px)}

.section{display:none;animation:fadeUp .4s ease}
.section.active{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

/* CARDS */
.card{background:var(--bg2);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);padding:28px;margin-bottom:24px;box-shadow:var(--shadow);transition:border-color .3s}
.card:hover{border-color:rgba(0,212,255,.15)}
.card.glow-cyan{border-color:rgba(0,212,255,.3);box-shadow:0 0 30px rgba(0,212,255,.05)}
.card.glow-pink{border-color:rgba(255,107,157,.3);box-shadow:0 0 30px rgba(255,107,157,.05)}
.card.glow-green{border-color:rgba(81,207,102,.3);box-shadow:0 0 30px rgba(81,207,102,.05)}
.card.glow-yellow{border-color:rgba(255,212,59,.3);box-shadow:0 0 30px rgba(255,212,59,.05)}

.section-title{font-size:2.2em;font-weight:800;margin-bottom:8px;background:linear-gradient(135deg,var(--cyan),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.section-subtitle{color:var(--text2);font-size:1.1em;margin-bottom:32px}
h3{font-size:1.3em;margin-bottom:16px;color:var(--text)}
h4{font-size:1.05em;margin-bottom:12px;color:var(--cyan)}

/* CODE BLOCKS */
.code-block{background:#0d0d22;border:1px solid rgba(255,255,255,.08);border-radius:8px;padding:20px;font-family:'Fira Code','Cascadia Code','Consolas',monospace;font-size:.88em;line-height:1.8;overflow-x:auto;margin:16px 0;position:relative}
.code-block .label{position:absolute;top:8px;right:12px;font-size:.7em;padding:2px 10px;border-radius:4px;color:var(--bg);font-weight:700;font-family:'Segoe UI',sans-serif}
.code-block .label.good{background:var(--green)}
.code-block .label.bad{background:var(--red)}
.code-block .label.info{background:var(--cyan)}
.kw{color:#c678dd}.fn{color:#61afef}.str{color:#98c379}.num{color:#d19a66}.cm{color:#5c6370;font-style:italic}.op{color:#56b6c2}.par{color:#e06c75}.const{color:#e5c07b}.method{color:#61afef}.prop{color:#e06c75}

/* COMPARISON */
.compare{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin:16px 0}
.compare>div{padding:20px;border-radius:8px;border:1px solid rgba(255,255,255,.08)}
.compare .vs-old{background:rgba(255,107,107,.05);border-color:rgba(255,107,107,.2)}
.compare .vs-new{background:rgba(81,207,102,.05);border-color:rgba(81,207,102,.2)}
.compare .vs-label{font-size:.75em;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;font-weight:700}
.compare .vs-old .vs-label{color:var(--red)}
.compare .vs-new .vs-label{color:var(--green)}

/* VISUAL DIAGRAMS */
.visual-box{background:var(--bg3);border-radius:var(--radius);padding:32px;margin:20px 0;position:relative;overflow:hidden}
.visual-box::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--cyan),var(--purple),var(--pink))}
.flow-diagram{display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap;padding:16px 0}
.flow-box{padding:12px 20px;border-radius:8px;font-size:.85em;font-weight:600;text-align:center;min-width:80px;transition:all .3s}
.flow-arrow{color:var(--cyan);font-size:1.5em;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:.4}50%{opacity:1}}
.flow-box.input{background:rgba(0,212,255,.15);border:1px solid var(--cyan);color:var(--cyan)}
.flow-box.process{background:rgba(218,119,242,.15);border:1px solid var(--purple);color:var(--purple)}
.flow-box.output{background:rgba(81,207,102,.15);border:1px solid var(--green);color:var(--green)}
.flow-box.func{background:rgba(255,146,43,.15);border:1px solid var(--orange);color:var(--orange)}

/* PLAYGROUND */
.playground{background:var(--bg2);border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);overflow:hidden;margin:20px 0}
.playground .pg-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--bg3);border-bottom:1px solid rgba(255,255,255,.05)}
.playground .pg-title{font-size:.85em;font-weight:600;color:var(--text2)}
.playground .pg-dots{display:flex;gap:6px}
.playground .pg-dots span{width:10px;height:10px;border-radius:50%}
.playground .pg-dots span:nth-child(1){background:var(--red)}
.playground .pg-dots span:nth-child(2){background:var(--yellow)}
.playground .pg-dots span:nth-child(3){background:var(--green)}
.playground textarea{width:100%;min-height:160px;background:#0a0a18;color:#e0e0e0;border:none;padding:20px;font-family:'Fira Code','Cascadia Code','Consolas',monospace;font-size:.88em;line-height:1.7;resize:vertical;outline:none}
.playground .pg-actions{padding:10px 16px;display:flex;gap:10px;background:var(--bg3);border-top:1px solid rgba(255,255,255,.05)}
.playground .pg-output{padding:16px;background:#060612;border-top:1px solid rgba(255,255,255,.05);font-family:monospace;font-size:.85em;color:var(--green);min-height:40px;white-space:pre-wrap}
.playground .pg-output.error{color:var(--red)}

/* BUTTONS */
.btn{padding:8px 20px;border-radius:6px;border:none;font-weight:600;cursor:pointer;font-size:.85em;transition:all .2s;display:inline-flex;align-items:center;gap:6px}
.btn:hover{transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn-cyan{background:var(--cyan);color:#000}
.btn-cyan:hover{background:#33ddff;box-shadow:0 4px 15px rgba(0,212,255,.3)}
.btn-green{background:var(--green);color:#000}
.btn-green:hover{box-shadow:0 4px 15px rgba(81,207,102,.3)}
.btn-purple{background:var(--purple);color:#000}
.btn-purple:hover{box-shadow:0 4px 15px rgba(218,119,242,.3)}
.btn-pink{background:var(--pink);color:#000}
.btn-outline{background:transparent;border:1px solid var(--cyan);color:var(--cyan)}
.btn-outline:hover{background:rgba(0,212,255,.1)}
.btn-sm{padding:5px 12px;font-size:.8em}

/* TAGS */
.tag{display:inline-block;padding:3px 10px;border-radius:4px;font-size:.75em;font-weight:600;margin:2px}
.tag-cyan{background:rgba(0,212,255,.15);color:var(--cyan)}
.tag-pink{background:rgba(255,107,157,.15);color:var(--pink)}
.tag-green{background:rgba(81,207,102,.15);color:var(--green)}
.tag-yellow{background:rgba(255,212,59,.15);color:var(--yellow)}
.tag-purple{background:rgba(218,119,242,.15);color:var(--purple)}
.tag-red{background:rgba(255,107,107,.15);color:var(--red)}

/* PITFALL BOX */
.pitfall{background:rgba(255,107,107,.05);border:1px solid rgba(255,107,107,.2);border-radius:var(--radius);padding:20px;margin:16px 0;position:relative;padding-left:52px}
.pitfall::before{content:'‚ö†Ô∏è';position:absolute;left:18px;top:20px;font-size:1.2em}
.pitfall .pitfall-title{color:var(--red);font-weight:700;margin-bottom:6px;font-size:.95em}

.tip{background:rgba(81,207,102,.05);border:1px solid rgba(81,207,102,.2);border-radius:var(--radius);padding:20px;margin:16px 0;position:relative;padding-left:52px}
.tip::before{content:'üí°';position:absolute;left:18px;top:20px;font-size:1.2em}
.tip .tip-title{color:var(--green);font-weight:700;margin-bottom:6px;font-size:.95em}

/* QUIZ */
.quiz-card{background:var(--bg2);border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);padding:28px;margin-bottom:20px;transition:all .3s}
.quiz-q{font-size:1.05em;margin-bottom:16px;font-weight:600}
.quiz-q .q-num{color:var(--cyan);margin-right:8px}
.quiz-options{display:flex;flex-direction:column;gap:10px}
.quiz-opt{padding:12px 16px;border:1px solid rgba(255,255,255,.1);border-radius:8px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:12px;font-size:.9em}
.quiz-opt:hover{border-color:var(--cyan);background:rgba(0,212,255,.05)}
.quiz-opt.selected{border-color:var(--cyan);background:rgba(0,212,255,.1)}
.quiz-opt.correct{border-color:var(--green)!important;background:rgba(81,207,102,.1)!important}
.quiz-opt.wrong{border-color:var(--red)!important;background:rgba(255,107,107,.1)!important}
.quiz-opt .opt-letter{width:28px;height:28px;border-radius:50%;border:2px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8em;flex-shrink:0}
.quiz-opt.correct .opt-letter{border-color:var(--green);background:var(--green);color:#000}
.quiz-opt.wrong .opt-letter{border-color:var(--red);background:var(--red);color:#000}
.quiz-explanation{margin-top:12px;padding:14px;border-radius:8px;font-size:.88em;display:none;line-height:1.6}
.quiz-explanation.show{display:block}
.quiz-explanation.right{background:rgba(81,207,102,.08);border:1px solid rgba(81,207,102,.2);color:var(--green)}
.quiz-explanation.wrong-exp{background:rgba(255,107,107,.08);border:1px solid rgba(255,107,107,.2);color:var(--red)}

/* EXERCISE */
.exercise{border:1px solid rgba(218,119,242,.2);border-radius:var(--radius);overflow:hidden;margin:20px 0}
.exercise .ex-header{padding:16px 20px;background:rgba(218,119,242,.08);display:flex;align-items:center;justify-content:space-between}
.exercise .ex-title{font-weight:700;color:var(--purple)}
.exercise .ex-diff{font-size:.75em}
.exercise .ex-desc{padding:16px 20px;font-size:.9em;color:var(--text2);border-bottom:1px solid rgba(255,255,255,.05)}
.exercise .ex-result{padding:14px 20px;font-size:.9em;display:none}
.exercise .ex-result.show{display:block}
.exercise .ex-result.pass{background:rgba(81,207,102,.08);color:var(--green)}
.exercise .ex-result.fail{background:rgba(255,107,107,.08);color:var(--red)}

/* TABS */
.tabs{display:flex;gap:4px;margin-bottom:20px;border-bottom:1px solid rgba(255,255,255,.06);padding-bottom:0}
.tab{padding:10px 20px;cursor:pointer;font-size:.88em;color:var(--text2);border-bottom:2px solid transparent;transition:all .2s;font-weight:600}
.tab:hover{color:var(--text)}
.tab.active{color:var(--cyan);border-bottom-color:var(--cyan)}

/* GRID */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px}

/* ANIMATIONS */
.bounce{animation:bounce .6s}
@keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
.shake{animation:shake .4s}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}

/* HOME HERO */
.hero{text-align:center;padding:60px 20px}
.hero h1{font-size:3em;font-weight:900;background:linear-gradient(135deg,var(--cyan),var(--purple),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:16px}
.hero p{color:var(--text2);font-size:1.1em;max-width:600px;margin:0 auto 32px}
.topic-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;max-width:900px;margin:0 auto}
.topic-card{background:var(--bg2);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);padding:24px;text-align:center;cursor:pointer;transition:all .3s}
.topic-card:hover{transform:translateY(-4px);border-color:var(--cyan);box-shadow:0 8px 30px rgba(0,212,255,.1)}
.topic-card .tc-icon{font-size:2.5em;margin-bottom:12px}
.topic-card .tc-title{font-weight:700;margin-bottom:6px}
.topic-card .tc-desc{font-size:.8em;color:var(--text3)}

/* SCORE BOARD */
.scoreboard{display:flex;gap:20px;justify-content:center;margin:20px 0;flex-wrap:wrap}
.score-item{text-align:center;padding:20px 30px;background:var(--bg3);border-radius:var(--radius);min-width:120px}
.score-num{font-size:2em;font-weight:800}
.score-label{font-size:.8em;color:var(--text3);margin-top:4px}

/* THIS DIAGRAM */
.this-demo{display:flex;gap:24px;align-items:stretch;margin:16px 0;flex-wrap:wrap}
.this-box{flex:1;min-width:250px;padding:20px;border-radius:var(--radius);text-align:center}
.this-box.regular{background:rgba(255,107,107,.08);border:1px solid rgba(255,107,107,.2)}
.this-box.arrow{background:rgba(81,207,102,.08);border:1px solid rgba(81,207,102,.2)}
.this-box h4{margin-bottom:12px}
.this-context{display:inline-block;padding:8px 16px;border-radius:6px;font-family:monospace;font-weight:700;margin:8px 0}
.this-box.regular .this-context{background:rgba(255,107,107,.15);color:var(--red)}
.this-box.arrow .this-context{background:rgba(81,207,102,.15);color:var(--green)}
.this-step{font-size:.85em;color:var(--text2);margin-top:8px;padding:8px;background:rgba(0,0,0,.2);border-radius:6px}

/* ANIMATION */
.anim-container{position:relative;height:180px;margin:20px 0;overflow:hidden}
.anim-ball{width:60px;height:60px;border-radius:50%;position:absolute;display:flex;align-items:center;justify-content:center;font-size:.7em;font-weight:700;transition:all 1s ease}

/* MOBILE */
.menu-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5em;cursor:pointer}
@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0}
  .menu-toggle{display:block}
  .compare,.grid-2{grid-template-columns:1fr}
  .hero h1{font-size:2em}
  .this-demo{flex-direction:column}
}

.inline-code{background:rgba(0,212,255,.1);color:var(--cyan);padding:2px 8px;border-radius:4px;font-family:monospace;font-size:.9em}
.highlight{background:rgba(255,212,59,.1);color:var(--yellow);padding:2px 8px;border-radius:4px}
.note{padding:16px;background:rgba(116,143,252,.08);border-left:3px solid var(--blue);border-radius:0 8px 8px 0;margin:16px 0;font-size:.9em}
ul{padding-left:20px;margin:8px 0}
li{margin:6px 0;color:var(--text2)}
li strong{color:var(--text)}
.mb-16{margin-bottom:16px}
.mb-24{margin-bottom:24px}
.mt-16{margin-top:16px}
.mt-24{margin-top:24px}
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <button class="menu-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">‚ò∞</button>
  <div class="logo">‚ö° FunctionMaster</div>
  <span class="streak" id="streakDisplay">üî• 0 streak</span>
  <div class="progress-wrap"><div class="progress-fill" id="progressFill"></div></div>
  <span class="progress-text" id="progressText">0%</span>
</div>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
  <div class="nav-section">
    <div class="nav-label">Start Here</div>
    <div class="nav-item active" data-section="home"><span class="icon">üè†</span>Home<span class="check">‚úì</span></div>
  </div>
  <div class="nav-section">
    <div class="nav-label">Core Concepts</div>
    <div class="nav-item" data-section="arrow"><span class="icon">‚û°Ô∏è</span>Arrow Functions<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="callbacks"><span class="icon">üîÑ</span>Callbacks<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="hof"><span class="icon">üéØ</span>Higher-Order Fns<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="composition"><span class="icon">üîó</span>Composition<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="currying"><span class="icon">üçõ</span>Currying<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="partial"><span class="icon">‚úÇÔ∏è</span>Partial Application<span class="check">‚úì</span></div>
  </div>
  <div class="nav-section">
    <div class="nav-label">Master It</div>
    <div class="nav-item" data-section="pitfalls"><span class="icon">‚ö†Ô∏è</span>Pitfalls & Mistakes<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="quiz"><span class="icon">üß™</span>Quiz Arena<span class="check">‚úì</span></div>
    <div class="nav-item" data-section="challenges"><span class="icon">üí™</span>Coding Challenges<span class="check">‚úì</span></div>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="main" id="mainContent">

<!-- ===== HOME ===== -->
<div class="section active" id="sec-home">
  <div class="hero">
    <h1>Advanced Functions<br>Mastery</h1>
    <p>Your complete interactive guide to mastering arrow functions, callbacks, higher-order functions, currying, partial application, and function composition.</p>
    <div class="scoreboard">
      <div class="score-item"><div class="score-num" style="color:var(--cyan)" id="topicsComplete">0</div><div class="score-label">Topics Done</div></div>
      <div class="score-item"><div class="score-num" style="color:var(--green)" id="exercisesComplete">0</div><div class="score-label">Exercises</div></div>
      <div class="score-item"><div class="score-num" style="color:var(--purple)" id="quizScore">0</div><div class="score-label">Quiz Score</div></div>
    </div>
  </div>
  <div class="topic-grid">
    <div class="topic-card" onclick="navigateTo('arrow')"><div class="tc-icon">‚û°Ô∏è</div><div class="tc-title">Arrow Functions</div><div class="tc-desc">Concise syntax & lexical this</div></div>
    <div class="topic-card" onclick="navigateTo('callbacks')"><div class="tc-icon">üîÑ</div><div class="tc-title">Callbacks</div><div class="tc-desc">Functions as arguments</div></div>
    <div class="topic-card" onclick="navigateTo('hof')"><div class="tc-icon">üéØ</div><div class="tc-title">Higher-Order Functions</div><div class="tc-desc">map, filter, reduce & beyond</div></div>
    <div class="topic-card" onclick="navigateTo('composition')"><div class="tc-icon">üîó</div><div class="tc-title">Composition</div><div class="tc-desc">Building pipelines</div></div>
    <div class="topic-card" onclick="navigateTo('currying')"><div class="tc-icon">üçõ</div><div class="tc-title">Currying</div><div class="tc-desc">One arg at a time</div></div>
    <div class="topic-card" onclick="navigateTo('partial')"><div class="tc-icon">‚úÇÔ∏è</div><div class="tc-title">Partial Application</div><div class="tc-desc">Pre-filling arguments</div></div>
  </div>
</div>

<!-- ===== ARROW FUNCTIONS ===== -->
<div class="section" id="sec-arrow">
  <h1 class="section-title">‚û°Ô∏è Arrow Functions</h1>
  <p class="section-subtitle">Concise, elegant, and lexically bound ‚Äî the modern way to write functions.</p>

  <div class="card glow-cyan">
    <h3>Syntax Variations</h3>
    <p class="mb-16">Arrow functions come in several flavors. Master all of them:</p>
    <div class="code-block"><span class="label info">SYNTAX</span>
<span class="cm">// 1. No parameters</span>
<span class="kw">const</span> <span class="fn">greet</span> = () <span class="op">=></span> <span class="str">'Hello!'</span>;

<span class="cm">// 2. Single parameter (parentheses optional)</span>
<span class="kw">const</span> <span class="fn">double</span> = <span class="par">x</span> <span class="op">=></span> <span class="par">x</span> * <span class="num">2</span>;
<span class="kw">const</span> <span class="fn">double2</span> = (<span class="par">x</span>) <span class="op">=></span> <span class="par">x</span> * <span class="num">2</span>;  <span class="cm">// also valid</span>

<span class="cm">// 3. Multiple parameters (parentheses required)</span>
<span class="kw">const</span> <span class="fn">add</span> = (<span class="par">a</span>, <span class="par">b</span>) <span class="op">=></span> <span class="par">a</span> + <span class="par">b</span>;

<span class="cm">// 4. Function body (curly braces + explicit return)</span>
<span class="kw">const</span> <span class="fn">calculate</span> = (<span class="par">a</span>, <span class="par">b</span>) <span class="op">=></span> {
  <span class="kw">const</span> result = <span class="par">a</span> * <span class="par">b</span> + <span class="num">10</span>;
  <span class="kw">return</span> result;
};

<span class="cm">// 5. Returning an object (wrap in parentheses!)</span>
<span class="kw">const</span> <span class="fn">makeUser</span> = (<span class="par">name</span>) <span class="op">=></span> ({ name: <span class="par">name</span>, id: <span class="num">1</span> });
</div>
  </div>

  <div class="card glow-cyan">
    <h3>Implicit vs Explicit Return</h3>
    <div class="compare">
      <div class="vs-new">
        <div class="vs-label">‚úÖ Implicit return (no braces)</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">square</span> = <span class="par">x</span> <span class="op">=></span> <span class="par">x</span> * <span class="par">x</span>;
<span class="cm">// Returns x * x automatically</span>
<span class="fn">square</span>(<span class="num">5</span>); <span class="cm">// 25</span>
        </div>
      </div>
      <div class="vs-old">
        <div class="vs-label">‚ö†Ô∏è Explicit return (with braces)</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">square</span> = <span class="par">x</span> <span class="op">=></span> {
  <span class="kw">return</span> <span class="par">x</span> * <span class="par">x</span>;
};
<span class="cm">// Must use return keyword!</span>
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">Common Trap: Forgetting return with braces</div>
      <div class="code-block"><span class="label bad">BUG</span>
<span class="kw">const</span> <span class="fn">square</span> = <span class="par">x</span> <span class="op">=></span> { <span class="par">x</span> * <span class="par">x</span> };
<span class="fn">square</span>(<span class="num">5</span>); <span class="cm">// undefined! ‚Üê No return statement</span></div>
    </div>
  </div>

  <div class="card glow-pink">
    <h3>üîë The <span class="inline-code">this</span> Context ‚Äî The BIG Difference</h3>
    <p class="mb-16">This is the <strong>most important</strong> thing to understand about arrow functions. They don't get their own <span class="inline-code">this</span> ‚Äî they inherit it from the enclosing scope.</p>

    <div class="visual-box">
      <h4 style="text-align:center;margin-bottom:16px">How <code>this</code> is Determined</h4>
      <div class="this-demo">
        <div class="this-box regular">
          <h4 style="color:var(--red)">Regular Function</h4>
          <div class="this-context">this = whoever CALLS me</div>
          <div class="this-step">üîç <code>this</code> is determined at <strong>call time</strong><br>Changes based on how the function is invoked</div>
        </div>
        <div class="this-box arrow">
          <h4 style="color:var(--green)">Arrow Function</h4>
          <div class="this-context">this = where I was DEFINED</div>
          <div class="this-step">üîí <code>this</code> is locked at <strong>definition time</strong><br>Inherits from the surrounding lexical scope</div>
        </div>
      </div>
    </div>

    <div class="code-block"><span class="label info">EXAMPLE</span>
<span class="kw">const</span> timer = {
  seconds: <span class="num">0</span>,

  <span class="cm">// ‚ùå Regular function: `this` = undefined (or window)</span>
  startBroken() {
    setInterval(<span class="kw">function</span>() {
      <span class="kw">this</span>.seconds++; <span class="cm">// ‚Üê `this` is NOT timer!</span>
      console.log(<span class="kw">this</span>.seconds); <span class="cm">// NaN</span>
    }, <span class="num">1000</span>);
  },

  <span class="cm">// ‚úÖ Arrow function: `this` = timer (inherited)</span>
  startFixed() {
    setInterval(() <span class="op">=></span> {
      <span class="kw">this</span>.seconds++; <span class="cm">// ‚Üê `this` IS timer! ‚úì</span>
      console.log(<span class="kw">this</span>.seconds); <span class="cm">// 1, 2, 3...</span>
    }, <span class="num">1000</span>);
  }
};</div>

    <div class="pitfall">
      <div class="pitfall-title">Never use arrow functions as object methods!</div>
      <div class="code-block"><span class="label bad">BUG</span>
<span class="kw">const</span> user = {
  name: <span class="str">'Alice'</span>,
  greet: () <span class="op">=></span> <span class="str">`Hi, I'm ${</span><span class="kw">this</span>.name<span class="str">}`</span>
  <span class="cm">// `this` = window/undefined, NOT user!</span>
};
user.greet(); <span class="cm">// "Hi, I'm undefined" üò±</span></div>
    </div>

    <div class="tip">
      <div class="tip-title">When to use which?</div>
      <ul>
        <li><strong>Arrow functions:</strong> callbacks, array methods, closures, anywhere you want to preserve <code>this</code></li>
        <li><strong>Regular functions:</strong> object methods, constructors, event handlers that need <code>this</code> = element, prototype methods</li>
      </ul>
    </div>
  </div>

  <!-- ARROW EXERCISE -->
  <div class="exercise" id="ex-arrow-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Arrow Function Syntax</span><span class="tag tag-green ex-diff">Beginner</span></div>
    <div class="ex-desc">Convert these regular functions to arrow functions. Use the most concise form possible.</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-arrow-1">// Convert these to arrow functions:

// 1. Convert to arrow
function multiply(a, b) {
  return a * b;
}

// 2. Convert to arrow
function isEven(n) {
  return n % 2 === 0;
}

// 3. Convert to arrow (return an object!)
function createPair(key, value) {
  return { key: key, value: value };
}

// Test your solutions:
console.log(multiply(3, 4));     // Should be 12
console.log(isEven(7));          // Should be false
console.log(createPair('a', 1)); // Should be {key:'a', value:1}</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-arrow-1','out-arrow-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-arrow-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-arrow-1"></div>
    </div>
    <div class="note mt-16" id="hint-arrow-1" style="display:none">
      <strong>Hint:</strong> For #1 use <code>(a, b) => a * b</code>. For #3, remember to wrap the object in parentheses: <code>(key, value) => ({ key, value })</code>
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('arrow');navigateTo('callbacks')">Next: Callbacks ‚Üí</button>
  </div>
</div>

<!-- ===== CALLBACKS ===== -->
<div class="section" id="sec-callbacks">
  <h1 class="section-title">üîÑ Callbacks</h1>
  <p class="section-subtitle">Functions passed to other functions ‚Äî the backbone of asynchronous JavaScript.</p>

  <div class="card glow-cyan">
    <h3>What Is a Callback?</h3>
    <p class="mb-16">A <strong>callback</strong> is simply a function passed as an argument to another function, to be called later.</p>

    <div class="visual-box">
      <h4 style="text-align:center;margin-bottom:16px">Callback Flow</h4>
      <div class="flow-diagram">
        <div class="flow-box input">yourFunction()</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box process">doWork(callback)</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box func">callback(result)</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box output">Result!</div>
      </div>
    </div>

    <div class="code-block"><span class="label info">BASICS</span>
<span class="cm">// Simple callback example</span>
<span class="kw">function</span> <span class="fn">greet</span>(<span class="par">name</span>, <span class="par">callback</span>) {
  <span class="kw">const</span> message = <span class="str">`Hello, ${</span><span class="par">name</span><span class="str">}!`</span>;
  <span class="par">callback</span>(message);  <span class="cm">// ‚Üê Call the callback with result</span>
}

<span class="fn">greet</span>(<span class="str">'Alice'</span>, (<span class="par">msg</span>) <span class="op">=></span> console.log(msg));
<span class="cm">// Output: "Hello, Alice!"</span>

<span class="fn">greet</span>(<span class="str">'Bob'</span>, (<span class="par">msg</span>) <span class="op">=></span> alert(msg));
<span class="cm">// Same function, different callback behavior!</span></div>
  </div>

  <div class="card glow-pink">
    <h3>Synchronous vs Asynchronous Callbacks</h3>
    <div class="compare">
      <div class="vs-new">
        <div class="vs-label">Synchronous</div>
        <p style="font-size:.9em;color:var(--text2)">Called immediately, in order</p>
        <div class="code-block">
[<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>].<span class="method">forEach</span>((<span class="par">n</span>) <span class="op">=></span> {
  console.log(n);
});
<span class="cm">// 1, 2, 3 ‚Äî runs right away</span>
        </div>
      </div>
      <div class="vs-old">
        <div class="vs-label">Asynchronous</div>
        <p style="font-size:.9em;color:var(--text2)">Called later, when something happens</p>
        <div class="code-block">
<span class="fn">setTimeout</span>(() <span class="op">=></span> {
  console.log(<span class="str">'Later!'</span>);
}, <span class="num">1000</span>);
<span class="cm">// Called after 1 second</span>

btn.<span class="method">addEventListener</span>(<span class="str">'click'</span>,
  () <span class="op">=></span> console.log(<span class="str">'Clicked!'</span>)
);
        </div>
      </div>
    </div>
  </div>

  <div class="card glow-yellow">
    <h3>‚ö†Ô∏è Callback Hell</h3>
    <p class="mb-16">When callbacks are nested too deeply, code becomes unreadable. This is called <strong>"callback hell"</strong> or the <strong>"pyramid of doom"</strong>.</p>
    <div class="code-block"><span class="label bad">CALLBACK HELL</span>
<span class="fn">getUser</span>(id, (<span class="par">user</span>) <span class="op">=></span> {
  <span class="fn">getOrders</span>(user.id, (<span class="par">orders</span>) <span class="op">=></span> {
    <span class="fn">getProduct</span>(orders[<span class="num">0</span>].productId, (<span class="par">product</span>) <span class="op">=></span> {
      <span class="fn">getReviews</span>(product.id, (<span class="par">reviews</span>) <span class="op">=></span> {
        console.log(reviews); <span class="cm">// üòµ 4 levels deep!</span>
      });
    });
  });
});</div>

    <div class="tip">
      <div class="tip-title">How to Avoid Callback Hell</div>
      <ul>
        <li><strong>Named functions:</strong> Extract callbacks into named functions</li>
        <li><strong>Promises:</strong> Use <code>.then()</code> chains</li>
        <li><strong>Async/Await:</strong> Write async code that looks synchronous</li>
        <li><strong>Modularize:</strong> Break into smaller, reusable functions</li>
      </ul>
    </div>
    <div class="code-block"><span class="label good">CLEANED UP</span>
<span class="cm">// Solution 1: Named functions</span>
<span class="kw">const</span> <span class="fn">handleReviews</span> = (<span class="par">reviews</span>) <span class="op">=></span> console.log(reviews);
<span class="kw">const</span> <span class="fn">handleProduct</span> = (<span class="par">product</span>) <span class="op">=></span> <span class="fn">getReviews</span>(product.id, handleReviews);
<span class="kw">const</span> <span class="fn">handleOrders</span> = (<span class="par">orders</span>) <span class="op">=></span> <span class="fn">getProduct</span>(orders[<span class="num">0</span>].productId, handleProduct);
<span class="kw">const</span> <span class="fn">handleUser</span> = (<span class="par">user</span>) <span class="op">=></span> <span class="fn">getOrders</span>(user.id, handleOrders);

<span class="fn">getUser</span>(id, handleUser); <span class="cm">// ‚úÖ Flat and readable!</span></div>
  </div>

  <!-- CALLBACK EXERCISE -->
  <div class="exercise" id="ex-cb-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Write Your Own Callback</span><span class="tag tag-cyan ex-diff">Intermediate</span></div>
    <div class="ex-desc">Create a function <code>transform(arr, callback)</code> that applies a callback to each element and returns a new array. Then use it to double all numbers.</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-cb-1">// Create the transform function
function transform(arr, callback) {
  // Your code here:
  // Loop through arr, apply callback to each element
  // Return a NEW array with the results

}

// Test it:
const numbers = [1, 2, 3, 4, 5];

const doubled = transform(numbers, x => x * 2);
console.log(doubled);  // Should be [2, 4, 6, 8, 10]

const squared = transform(numbers, x => x * x);
console.log(squared);  // Should be [1, 4, 9, 16, 25]

const stringed = transform(numbers, x => 'num_' + x);
console.log(stringed); // Should be ['num_1','num_2',...]</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-cb-1','out-cb-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-cb-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-cb-1"></div>
    </div>
    <div class="note mt-16" id="hint-cb-1" style="display:none">
      <strong>Hint:</strong> Create an empty results array, loop through <code>arr</code>, push <code>callback(arr[i])</code> to results, then return results.
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('callbacks');navigateTo('hof')">Next: Higher-Order Functions ‚Üí</button>
  </div>
</div>

<!-- ===== HIGHER ORDER FUNCTIONS ===== -->
<div class="section" id="sec-hof">
  <h1 class="section-title">üéØ Higher-Order Functions</h1>
  <p class="section-subtitle">Functions that take or return other functions ‚Äî the heart of functional JavaScript.</p>

  <div class="card glow-cyan">
    <h3>What Makes a Function "Higher-Order"?</h3>
    <p class="mb-16">A higher-order function (HOF) does at least one of these:</p>
    <div class="grid-2 mb-16">
      <div style="padding:20px;background:rgba(0,212,255,.05);border-radius:8px;border:1px solid rgba(0,212,255,.2)">
        <h4>1Ô∏è‚É£ Takes a function as argument</h4>
        <div class="code-block">
<span class="cm">// map, filter, forEach, etc.</span>
[<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>].<span class="method">map</span>(<span class="par">x</span> <span class="op">=></span> <span class="par">x</span> * <span class="num">2</span>);
        </div>
      </div>
      <div style="padding:20px;background:rgba(218,119,242,.05);border-radius:8px;border:1px solid rgba(218,119,242,.2)">
        <h4>2Ô∏è‚É£ Returns a function</h4>
        <div class="code-block">
<span class="kw">function</span> <span class="fn">multiplier</span>(<span class="par">factor</span>) {
  <span class="kw">return</span> <span class="par">x</span> <span class="op">=></span> <span class="par">x</span> * <span class="par">factor</span>;
}
        </div>
      </div>
    </div>

    <div class="visual-box">
      <h4 style="text-align:center;margin-bottom:16px">Higher-Order Function Pattern</h4>
      <div class="flow-diagram">
        <div class="flow-box input">Data</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box process">HOF</div>
        <div class="flow-arrow">‚Üï</div>
        <div class="flow-box func">fn()</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box output">Result</div>
      </div>
      <p style="text-align:center;color:var(--text3);font-size:.85em;margin-top:8px">The HOF orchestrates ‚Äî the callback does the work</p>
    </div>
  </div>

  <div class="card glow-green">
    <h3>The Big Three: map, filter, reduce</h3>

    <h4 style="color:var(--cyan)">üì¶ map() ‚Äî Transform each element</h4>
    <div class="code-block">
<span class="kw">const</span> prices = [<span class="num">10</span>, <span class="num">20</span>, <span class="num">30</span>];
<span class="kw">const</span> withTax = prices.<span class="method">map</span>(<span class="par">price</span> <span class="op">=></span> <span class="par">price</span> * <span class="num">1.2</span>);
<span class="cm">// [12, 24, 36]</span>

<span class="kw">const</span> users = [{name:<span class="str">'Alice'</span>}, {name:<span class="str">'Bob'</span>}];
<span class="kw">const</span> names = users.<span class="method">map</span>(<span class="par">u</span> <span class="op">=></span> <span class="par">u</span>.name);
<span class="cm">// ['Alice', 'Bob']</span></div>

    <h4 style="color:var(--green)" class="mt-16">üîç filter() ‚Äî Keep elements that pass a test</h4>
    <div class="code-block">
<span class="kw">const</span> nums = [<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>,<span class="num">4</span>,<span class="num">5</span>,<span class="num">6</span>,<span class="num">7</span>,<span class="num">8</span>];
<span class="kw">const</span> evens = nums.<span class="method">filter</span>(<span class="par">n</span> <span class="op">=></span> <span class="par">n</span> % <span class="num">2</span> === <span class="num">0</span>);
<span class="cm">// [2, 4, 6, 8]</span>

<span class="kw">const</span> adults = people.<span class="method">filter</span>(<span class="par">p</span> <span class="op">=></span> <span class="par">p</span>.age >= <span class="num">18</span>);</div>

    <h4 style="color:var(--purple)" class="mt-16">üßÆ reduce() ‚Äî Accumulate into a single value</h4>
    <div class="code-block">
<span class="kw">const</span> total = [<span class="num">10</span>,<span class="num">20</span>,<span class="num">30</span>].<span class="method">reduce</span>((<span class="par">acc</span>, <span class="par">curr</span>) <span class="op">=></span> <span class="par">acc</span> + <span class="par">curr</span>, <span class="num">0</span>);
<span class="cm">// 60</span>

<span class="cm">// Count occurrences</span>
<span class="kw">const</span> letters = [<span class="str">'a'</span>,<span class="str">'b'</span>,<span class="str">'a'</span>,<span class="str">'c'</span>,<span class="str">'b'</span>,<span class="str">'a'</span>];
<span class="kw">const</span> counts = letters.<span class="method">reduce</span>((<span class="par">acc</span>, <span class="par">letter</span>) <span class="op">=></span> {
  <span class="par">acc</span>[<span class="par">letter</span>] = (<span class="par">acc</span>[<span class="par">letter</span>] || <span class="num">0</span>) + <span class="num">1</span>;
  <span class="kw">return</span> <span class="par">acc</span>;
}, {});
<span class="cm">// { a: 3, b: 2, c: 1 }</span></div>
  </div>

  <div class="card glow-purple">
    <h3>Creating Your Own HOFs</h3>
    <p class="mb-16">The real power comes from <strong>functions that return functions</strong>:</p>
    <div class="code-block"><span class="label good">POWERFUL</span>
<span class="cm">// Factory function ‚Äî creates specialized functions</span>
<span class="kw">const</span> <span class="fn">createGreeter</span> = (<span class="par">greeting</span>) <span class="op">=></span> {
  <span class="kw">return</span> (<span class="par">name</span>) <span class="op">=></span> <span class="str">`${</span><span class="par">greeting</span><span class="str">}, ${</span><span class="par">name</span><span class="str">}!`</span>;
};

<span class="kw">const</span> <span class="fn">hello</span> = <span class="fn">createGreeter</span>(<span class="str">'Hello'</span>);
<span class="kw">const</span> <span class="fn">hola</span> = <span class="fn">createGreeter</span>(<span class="str">'Hola'</span>);

<span class="fn">hello</span>(<span class="str">'Alice'</span>); <span class="cm">// "Hello, Alice!"</span>
<span class="fn">hola</span>(<span class="str">'Bob'</span>);   <span class="cm">// "Hola, Bob!"</span>

<span class="cm">// Validator factory</span>
<span class="kw">const</span> <span class="fn">createValidator</span> = (<span class="par">min</span>, <span class="par">max</span>) <span class="op">=></span> {
  <span class="kw">return</span> (<span class="par">value</span>) <span class="op">=></span> <span class="par">value</span> >= <span class="par">min</span> && <span class="par">value</span> <= <span class="par">max</span>;
};

<span class="kw">const</span> <span class="fn">isValidAge</span> = <span class="fn">createValidator</span>(<span class="num">0</span>, <span class="num">120</span>);
<span class="kw">const</span> <span class="fn">isValidScore</span> = <span class="fn">createValidator</span>(<span class="num">0</span>, <span class="num">100</span>);

<span class="fn">isValidAge</span>(<span class="num">25</span>);    <span class="cm">// true</span>
<span class="fn">isValidScore</span>(<span class="num">150</span>); <span class="cm">// false</span></div>
  </div>

  <div class="exercise" id="ex-hof-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Build a HOF</span><span class="tag tag-yellow ex-diff">Intermediate</span></div>
    <div class="ex-desc">Create a higher-order function <code>unless(predicate, action)</code> that calls <code>action(item)</code> for each item that does NOT match the predicate. Then use it to log all odd numbers.</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-hof-1">// Create the 'unless' HOF
function unless(arr, predicate, action) {
  // Loop through arr
  // If predicate(item) is FALSE, call action(item)

}

// Test: log all odd numbers from 1-10
unless(
  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
  n => n % 2 === 0,   // predicate: is even?
  n => console.log(n) // action: log it
);
// Should log: 1, 3, 5, 7, 9</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-hof-1','out-hof-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-hof-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-hof-1"></div>
    </div>
    <div class="note mt-16" id="hint-hof-1" style="display:none">
      <strong>Hint:</strong> <code>for (const item of arr) { if (!predicate(item)) action(item); }</code>
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('hof');navigateTo('composition')">Next: Function Composition ‚Üí</button>
  </div>
</div>

<!-- ===== COMPOSITION ===== -->
<div class="section" id="sec-composition">
  <h1 class="section-title">üîó Function Composition</h1>
  <p class="section-subtitle">Combine simple functions to build complex behavior ‚Äî like LEGO for code.</p>

  <div class="card glow-cyan">
    <h3>What Is Composition?</h3>
    <p class="mb-16">Function composition means combining two or more functions where the output of one becomes the input of the next. Think of it as a <strong>pipeline</strong>.</p>

    <div class="visual-box">
      <h4 style="text-align:center;margin-bottom:20px">Composition Pipeline</h4>
      <div class="flow-diagram">
        <div class="flow-box input">"hello world"</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box func">trim()</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box func">toUpper()</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box func">exclaim()</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box output">"HELLO WORLD!"</div>
      </div>
      <p style="text-align:center;color:var(--text3);font-size:.85em;margin-top:12px">Each function transforms data and passes it along</p>
    </div>

    <div class="code-block"><span class="label info">MANUAL COMPOSITION</span>
<span class="cm">// Small, focused functions</span>
<span class="kw">const</span> <span class="fn">trim</span>    = <span class="par">str</span> <span class="op">=></span> <span class="par">str</span>.trim();
<span class="kw">const</span> <span class="fn">toUpper</span> = <span class="par">str</span> <span class="op">=></span> <span class="par">str</span>.toUpperCase();
<span class="kw">const</span> <span class="fn">exclaim</span> = <span class="par">str</span> <span class="op">=></span> <span class="par">str</span> + <span class="str">'!'</span>;

<span class="cm">// Manual composition (nested calls ‚Äî ugly)</span>
<span class="fn">exclaim</span>(<span class="fn">toUpper</span>(<span class="fn">trim</span>(<span class="str">'  hello  '</span>)));
<span class="cm">// "HELLO!"</span></div>
  </div>

  <div class="card glow-green">
    <h3>compose() and pipe()</h3>
    <p class="mb-16">Two utility functions that make composition clean and readable:</p>

    <div class="compare">
      <div class="vs-new">
        <div class="vs-label">compose (right ‚Üí left)</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">compose</span> = (...<span class="par">fns</span>) <span class="op">=></span>
  (<span class="par">x</span>) <span class="op">=></span> <span class="par">fns</span>.reduceRight(
    (<span class="par">acc</span>, <span class="par">fn</span>) <span class="op">=></span> <span class="fn">fn</span>(<span class="par">acc</span>), <span class="par">x</span>
  );

<span class="kw">const</span> <span class="fn">shout</span> = <span class="fn">compose</span>(exclaim, toUpper, trim);
<span class="fn">shout</span>(<span class="str">'  hi  '</span>); <span class="cm">// "HI!"</span>
        </div>
      </div>
      <div class="vs-old" style="background:rgba(0,212,255,.03);border-color:rgba(0,212,255,.2)">
        <div class="vs-label" style="color:var(--cyan)">pipe (left ‚Üí right)</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">pipe</span> = (...<span class="par">fns</span>) <span class="op">=></span>
  (<span class="par">x</span>) <span class="op">=></span> <span class="par">fns</span>.reduce(
    (<span class="par">acc</span>, <span class="par">fn</span>) <span class="op">=></span> <span class="fn">fn</span>(<span class="par">acc</span>), <span class="par">x</span>
  );

<span class="kw">const</span> <span class="fn">shout</span> = <span class="fn">pipe</span>(trim, toUpper, exclaim);
<span class="fn">shout</span>(<span class="str">'  hi  '</span>); <span class="cm">// "HI!"</span>
        </div>
      </div>
    </div>

    <div class="tip">
      <div class="tip-title">pipe() is usually preferred</div>
      It reads left-to-right, matching how we naturally read code and how data flows. <code>compose()</code> is more mathematically traditional (right-to-left).
    </div>
  </div>

  <div class="card glow-purple">
    <h3>Real-World Composition</h3>
    <div class="code-block"><span class="label good">REAL WORLD</span>
<span class="kw">const</span> <span class="fn">pipe</span> = (...<span class="par">fns</span>) <span class="op">=></span> (<span class="par">x</span>) <span class="op">=></span> <span class="par">fns</span>.reduce((<span class="par">v</span>, <span class="par">f</span>) <span class="op">=></span> <span class="fn">f</span>(<span class="par">v</span>), <span class="par">x</span>);

<span class="kw">const</span> <span class="fn">getActiveUserEmails</span> = <span class="fn">pipe</span>(
  <span class="par">users</span>  <span class="op">=></span> <span class="par">users</span>.filter(<span class="par">u</span> <span class="op">=></span> <span class="par">u</span>.active),
  <span class="par">active</span> <span class="op">=></span> <span class="par">active</span>.map(<span class="par">u</span> <span class="op">=></span> <span class="par">u</span>.email),
  <span class="par">emails</span> <span class="op">=></span> <span class="par">emails</span>.join(<span class="str">', '</span>)
);

<span class="cm">// Usage:</span>
<span class="kw">const</span> users = [
  { name: <span class="str">'Alice'</span>, active: <span class="kw">true</span>, email: <span class="str">'alice@example.com'</span> },
  { name: <span class="str">'Bob'</span>, active: <span class="kw">false</span>, email: <span class="str">'bob@example.com'</span> },
  { name: <span class="str">'Charlie'</span>, active: <span class="kw">true</span>, email: <span class="str">'charlie@example.com'</span> },
];
console.log(<span class="fn">getActiveUserEmails</span>(users));
<span class="cm">// Output: "alice@example.com, charlie@example.com"</span></div>
  </div>

  <div class="exercise" id="ex-composition-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Build a Pipeline</span><span class="tag tag-purple ex-diff">Advanced</span></div>
    <div class="ex-desc">Implement the <code>pipe</code> function yourself (if not already done) and use it to create a pipeline that takes a string, trims it, converts to lowercase, and then capitalizes the first letter.</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-composition-1">// Step 1: Implement pipe (if you haven't already)
function pipe(...fns) {
  return (x) => fns.reduce((acc, fn) => fn(acc), x);
}

// Step 2: Create helper functions
const trim = str => str.trim();
const toLower = str => str.toLowerCase();
const capitalize = str => str[0].toUpperCase() + str.slice(1);

// Step 3: Compose them into a pipeline
const formatString = pipe(trim, toLower, capitalize);

// Test it:
console.log(formatString('   hELLO WORLD  ')); // Should output "Hello world"
console.log(formatString('   javaSCRIPT   ')); // Should output "Javascript"</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-composition-1','out-composition-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-composition-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-composition-1"></div>
    </div>
    <div class="note mt-16" id="hint-composition-1" style="display:none">
      <strong>Hint:</strong> Make sure your <code>capitalize</code> function handles empty strings. The pipeline order matters: first trim, then toLower, then capitalize.
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('composition');navigateTo('currying')">Next: Currying ‚Üí</button>
  </div>
</div>

<!-- ===== CURRYING ===== -->
<div class="section" id="sec-currying">
  <h1 class="section-title">üçõ Currying</h1>
  <p class="section-subtitle">Transform a function that takes multiple arguments into a sequence of functions each taking a single argument.</p>

  <div class="card glow-cyan">
    <h3>What is Currying?</h3>
    <p class="mb-16">Currying is a technique where a function with multiple arguments is converted into a chain of functions, each taking one argument and returning the next function until all arguments are provided.</p>
    <div class="compare">
      <div class="vs-old">
        <div class="vs-label">Normal function</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">add</span> = (<span class="par">a</span>, <span class="par">b</span>, <span class="par">c</span>) <span class="op">=></span> <span class="par">a</span> + <span class="par">b</span> + <span class="par">c</span>;
<span class="fn">add</span>(<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>); <span class="cm">// 6</span>
        </div>
      </div>
      <div class="vs-new">
        <div class="vs-label">Curried version</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">curriedAdd</span> = (<span class="par">a</span>) <span class="op">=></span> (<span class="par">b</span>) <span class="op">=></span> (<span class="par">c</span>) <span class="op">=></span> <span class="par">a</span> + <span class="par">b</span> + <span class="par">c</span>;
<span class="fn">curriedAdd</span>(<span class="num">1</span>)(<span class="num">2</span>)(<span class="num">3</span>); <span class="cm">// 6</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card glow-pink">
    <h3>Why Curry?</h3>
    <ul>
      <li><strong>Partial application:</strong> Fix some arguments, get a more specific function.</li>
      <li><strong>Composition friendly:</strong> Curried functions work perfectly with <code>pipe</code> and <code>compose</code>.</li>
      <li><strong>Avoid repetition:</strong> Create specialized functions from a general one.</li>
    </ul>
    <div class="code-block"><span class="label good">EXAMPLE</span>
<span class="cm">// General curried logger</span>
<span class="kw">const</span> <span class="fn">log</span> = (<span class="par">level</span>) <span class="op">=></span> (<span class="par">message</span>) <span class="op">=></span> console.log(`[${level}] ${message}`);

<span class="kw">const</span> <span class="fn">info</span>  = <span class="fn">log</span>(<span class="str">'INFO'</span>);
<span class="kw">const</span> <span class="fn">warn</span>  = <span class="fn">log</span>(<span class="str">'WARN'</span>);
<span class="kw">const</span> <span class="fn">error</span> = <span class="fn">log</span>(<span class="str">'ERROR'</span>);

<span class="fn">info</span>(<span class="str">'Application started'</span>);
<span class="fn">warn</span>(<span class="str">'Low disk space'</span>);
<span class="fn">error</span>(<span class="str">'Something broke'</span>);</div>
  </div>

  <div class="card glow-green">
    <h3>Currying Utility</h3>
    <p>Often we have a normal function and want a curried version. Here's a helper to curry any function:</p>
    <div class="code-block"><span class="label info">CURRY HELPER</span>
<span class="kw">function</span> <span class="fn">curry</span>(<span class="par">fn</span>) {
  <span class="kw">return</span> <span class="kw">function</span> <span class="fn">curried</span>(...<span class="par">args</span>) {
    <span class="kw">if</span> (<span class="par">args</span>.length >= <span class="par">fn</span>.length) {
      <span class="kw">return</span> <span class="fn">fn</span>(...<span class="par">args</span>);
    } <span class="kw">else</span> {
      <span class="kw">return</span> (...<span class="par">nextArgs</span>) <span class="op">=></span> <span class="fn">curried</span>(...<span class="par">args</span>, ...<span class="par">nextArgs</span>);
    }
  };
}

<span class="kw">const</span> <span class="fn">add</span> = (<span class="par">a</span>, <span class="par">b</span>, <span class="par">c</span>) <span class="op">=></span> <span class="par">a</span> + <span class="par">b</span> + <span class="par">c</span>;
<span class="kw">const</span> <span class="fn">curriedAdd</span> = <span class="fn">curry</span>(add);
<span class="fn">curriedAdd</span>(<span class="num">1</span>)(<span class="num">2</span>)(<span class="num">3</span>); <span class="cm">// 6</span>
<span class="fn">curriedAdd</span>(<span class="num">1</span>, <span class="num">2</span>)(<span class="num">3</span>);  <span class="cm">// 6 (also works)</span></div>
  </div>

  <div class="exercise" id="ex-currying-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Write a Curried Function</span><span class="tag tag-yellow ex-diff">Intermediate</span></div>
    <div class="ex-desc">Create a curried function <code>multiply</code> that takes three numbers and returns their product. Then use it to create a function that doubles a number (by fixing the first factor to 2).</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-currying-1">// Write curriedMultiply: a => b => c => a * b * c
const curriedMultiply = a => b => c => a * b * c;

// Create double = curriedMultiply(2)(1)(?) but we want double(num) = 2 * num
// Actually, double should be a function that takes one number and multiplies it by 2.
// Using curriedMultiply, we can fix a=2, b=1, and leave c free:
const double = curriedMultiply(2)(1); // because 2 * 1 * c = 2c

// Test:
console.log(double(5));   // Should be 10
console.log(double(10));  // Should be 20

// Bonus: create triple (multiply by 3)
const triple = curriedMultiply(3)(1);
console.log(triple(5));   // 15</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-currying-1','out-currying-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-currying-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-currying-1"></div>
    </div>
    <div class="note mt-16" id="hint-currying-1" style="display:none">
      <strong>Hint:</strong> For <code>double</code>, you need to fix the first two arguments to 2 and 1, leaving the third free: <code>curriedMultiply(2)(1)</code> returns a function waiting for the last argument.
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('currying');navigateTo('partial')">Next: Partial Application ‚Üí</button>
  </div>
</div>

<!-- ===== PARTIAL APPLICATION ===== -->
<div class="section" id="sec-partial">
  <h1 class="section-title">‚úÇÔ∏è Partial Application</h1>
  <p class="section-subtitle">Fix a few arguments of a function, producing a new function that expects the remaining arguments.</p>

  <div class="card glow-cyan">
    <h3>Partial vs Currying</h3>
    <p class="mb-16">Partial application <strong>fixes a specific number of arguments</strong> (not necessarily one at a time). Currying transforms a function so it can be called with one argument at a time.</p>
    <div class="compare">
      <div class="vs-old">
        <div class="vs-label">Currying</div>
        <div class="code-block">
<span class="fn">curriedAdd</span>(<span class="num">1</span>)(<span class="num">2</span>)(<span class="num">3</span>);
<span class="cm">// Always one argument per call</span>
        </div>
      </div>
      <div class="vs-new">
        <div class="vs-label">Partial Application</div>
        <div class="code-block">
<span class="kw">const</span> <span class="fn">add5</span> = <span class="fn">partial</span>(add, <span class="num">5</span>);
<span class="fn">add5</span>(<span class="num">10</span>, <span class="num">20</span>); <span class="cm">// 5 + 10 + 20 = 35</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card glow-pink">
    <h3>Partial Application in Action</h3>
    <div class="code-block"><span class="label good">PARTIAL HELPER</span>
<span class="kw">function</span> <span class="fn">partial</span>(<span class="par">fn</span>, ...<span class="par">fixedArgs</span>) {
  <span class="kw">return</span> <span class="kw">function</span>(...<span class="par">remainingArgs</span>) {
    <span class="kw">return</span> <span class="fn">fn</span>(...<span class="par">fixedArgs</span>, ...<span class="par">remainingArgs</span>);
  };
}

<span class="cm">// Example: creating specialized functions</span>
<span class="kw">const</span> <span class="fn">multiply</span> = (<span class="par">x</span>, <span class="par">y</span>, <span class="par">z</span>) <span class="op">=></span> <span class="par">x</span> * <span class="par">y</span> * <span class="par">z</span>;
<span class="kw">const</span> <span class="fn">double</span> = <span class="fn">partial</span>(multiply, <span class="num">2</span>, <span class="num">1</span>); <span class="cm">// fix x=2, y=1, leave z free</span>
<span class="fn">double</span>(<span class="num">5</span>); <span class="cm">// 10</span>

<span class="cm">// Partial with more than one fixed arg</span>
<span class="kw">const</span> <span class="fn">greet</span> = (<span class="par">greeting</span>, <span class="par">name</span>, <span class="par">punctuation</span>) <span class="op">=></span> <span class="str">`${greeting}, ${name}${punctuation}`</span>;
<span class="kw">const</span> <span class="fn">sayHelloToAlice</span> = <span class="fn">partial</span>(greet, <span class="str">'Hello'</span>, <span class="str">'Alice'</span>);
<span class="fn">sayHelloToAlice</span>(<span class="str">'!'</span>); <span class="cm">// "Hello, Alice!"</span></div>
  </div>

  <div class="exercise" id="ex-partial-1">
    <div class="ex-header"><span class="ex-title">üèãÔ∏è Exercise: Use Partial Application</span><span class="tag tag-cyan ex-diff">Intermediate</span></div>
    <div class="ex-desc">Write a <code>partial</code> function and use it to create a function <code>addTax</code> that takes a price and adds 20% tax.</div>
    <div class="playground">
      <div class="pg-header"><span class="pg-title">Your Code</span><div class="pg-dots"><span></span><span></span><span></span></div></div>
      <textarea id="code-partial-1">// Implement partial
function partial(fn, ...fixed) {
  return (...remaining) => fn(...fixed, ...remaining);
}

// The base function: priceWithTax(basePrice, taxRate)
function priceWithTax(basePrice, taxRate) {
  return basePrice * (1 + taxRate);
}

// Create addTax: fix taxRate = 0.2 (20%)
const addTax = partial(priceWithTax, 0.2); // Note: taxRate is first? Wait, basePrice comes first.
// Actually priceWithTax(basePrice, taxRate). We want to fix taxRate, so we need to fix the second argument.
// Our partial fixes from the left. So we need to reorder or use a different helper.
// For simplicity, let's create a version where taxRate is first: priceWithTax(taxRate, basePrice)
const priceWithTaxReversed = (taxRate, basePrice) => basePrice * (1 + taxRate);
const addTax20 = partial(priceWithTaxReversed, 0.2);

// Test:
console.log(addTax20(100)); // Should be 120
console.log(addTax20(50));  // Should be 60</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-partial-1','out-partial-1')">‚ñ∂ Run</button>
        <button class="btn btn-outline btn-sm" onclick="showHint('hint-partial-1')">üí° Hint</button>
      </div>
      <div class="pg-output" id="out-partial-1"></div>
    </div>
    <div class="note mt-16" id="hint-partial-1" style="display:none">
      <strong>Hint:</strong> Our <code>partial</code> fixes arguments from left to right. If you want to fix the tax rate (second argument), either reorder the function parameters or use a more flexible partial that can fix at any position. The provided solution uses reversed order.
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('partial');navigateTo('pitfalls')">Next: Pitfalls ‚Üí</button>
  </div>
</div>

<!-- ===== PITFALLS & MISTAKES ===== -->
<div class="section" id="sec-pitfalls">
  <h1 class="section-title">‚ö†Ô∏è Pitfalls & Mistakes</h1>
  <p class="section-subtitle">Common errors even experienced developers make with advanced functions.</p>

  <div class="card glow-red">
    <h3>1. Forgetting `return` in arrow functions with `{}`</h3>
    <div class="pitfall">
      <div class="code-block"><span class="label bad">WRONG</span>
<span class="kw">const</span> <span class="fn">square</span> = (<span class="par">n</span>) <span class="op">=></span> { <span class="par">n</span> * <span class="par">n</span> };
<span class="fn">square</span>(<span class="num">5</span>); <span class="cm">// undefined</span></div>
      <div class="code-block"><span class="label good">CORRECT</span>
<span class="kw">const</span> <span class="fn">square</span> = (<span class="par">n</span>) <span class="op">=></span> <span class="par">n</span> * <span class="par">n</span>;
<span class="cm">// or with braces: { return n * n; }</span></div>
    </div>
  </div>

  <div class="card glow-red">
    <h3>2. `this` in arrow functions as object methods</h3>
    <div class="pitfall">
      <div class="code-block"><span class="label bad">WRONG</span>
<span class="kw">const</span> obj = {
  value: <span class="num">42</span>,
  getValue: () <span class="op">=></span> <span class="kw">this</span>.value
};
<span class="fn">obj.getValue</span>(); <span class="cm">// undefined (this = global)</span></div>
      <div class="code-block"><span class="label good">CORRECT</span>
<span class="kw">const</span> obj = {
  value: <span class="num">42</span>,
  getValue() { <span class="kw">return</span> <span class="kw">this</span>.value; }
};</div>
    </div>
  </div>

  <div class="card glow-red">
    <h3>3. Confusing currying with partial application</h3>
    <div class="pitfall">
      <p><strong>Currying:</strong> each call takes exactly one argument.<br>
      <strong>Partial application:</strong> pre-fill any number of arguments.</p>
      <p>Don't use them interchangeably ‚Äì they have different use cases.</p>
    </div>
  </div>

  <div class="card glow-red">
    <h3>4. Callback hell (excessive nesting)</h3>
    <div class="pitfall">
      <p>Nested callbacks lead to unreadable code. Refactor with named functions, Promises, or async/await.</p>
    </div>
  </div>

  <div class="card glow-red">
    <h3>5. Mutating data in composition pipelines</h3>
    <div class="pitfall">
      <div class="code-block"><span class="label bad">MUTATION</span>
<span class="kw">const</span> <span class="fn">addProp</span> = (<span class="par">obj</span>) <span class="op">=></span> {
  <span class="par">obj</span>.newProp = <span class="num">1</span>; <span class="cm">// mutation!</span>
  <span class="kw">return</span> <span class="par">obj</span>;
};</div>
      <div class="code-block"><span class="label good">IMMUTABLE</span>
<span class="kw">const</span> <span class="fn">addProp</span> = (<span class="par">obj</span>) <span class="op">=></span> ({ ...<span class="par">obj</span>, newProp: <span class="num">1</span> });</div>
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('pitfalls');navigateTo('quiz')">Next: Quiz Arena ‚Üí</button>
  </div>
</div>

<!-- ===== QUIZ ARENA ===== -->
<div class="section" id="sec-quiz">
  <h1 class="section-title">üß™ Quiz Arena</h1>
  <p class="section-subtitle">Test your knowledge with these interactive questions.</p>

  <div class="quiz-card" id="quiz1">
    <div class="quiz-q"><span class="q-num">1.</span> What will this code output?</div>
    <div class="code-block">
<span class="kw">const</span> obj = {
  name: <span class="str">'Alice'</span>,
  greet: () <span class="op">=></span> <span class="str">`Hi, I'm ${</span><span class="kw">this</span>.name<span class="str">}`</span>
};
console.log(obj.greet());
    </div>
    <div class="quiz-options">
      <div class="quiz-opt" data-quiz="1" data-opt="A"><span class="opt-letter">A</span>"Hi, I'm Alice"</div>
      <div class="quiz-opt" data-quiz="1" data-opt="B"><span class="opt-letter">B</span>"Hi, I'm undefined"</div>
      <div class="quiz-opt" data-quiz="1" data-opt="C"><span class="opt-letter">C</span>Error</div>
      <div class="quiz-opt" data-quiz="1" data-opt="D"><span class="opt-letter">D</span>"Hi, I'm [object Window]"</div>
    </div>
    <div class="quiz-explanation" id="exp-quiz1"></div>
  </div>

  <div class="quiz-card" id="quiz2">
    <div class="quiz-q"><span class="q-num">2.</span> Which of these is a higher-order function?</div>
    <div class="quiz-options">
      <div class="quiz-opt" data-quiz="2" data-opt="A"><span class="opt-letter">A</span><code>const add = (a,b) => a+b;</code></div>
      <div class="quiz-opt" data-quiz="2" data-opt="B"><span class="opt-letter">B</span><code>function map(arr, fn) { ... }</code></div>
      <div class="quiz-opt" data-quiz="2" data-opt="C"><span class="opt-letter">C</span><code>setTimeout(() => {}, 1000);</code></div>
      <div class="quiz-opt" data-quiz="2" data-opt="D"><span class="opt-letter">D</span>Both B and C</div>
    </div>
    <div class="quiz-explanation" id="exp-quiz2"></div>
  </div>

  <div class="quiz-card" id="quiz3">
    <div class="quiz-q"><span class="q-num">3.</span> What is the result of <code>pipe(trim, toUpper, exclaim)("  hello  ")</code> if <code>pipe</code> is left-to-right?</div>
    <div class="code-block">
trim = s => s.trim();
toUpper = s => s.toUpperCase();
exclaim = s => s + '!';
    </div>
    <div class="quiz-options">
      <div class="quiz-opt" data-quiz="3" data-opt="A"><span class="opt-letter">A</span>"  HELLO  !"</div>
      <div class="quiz-opt" data-quiz="3" data-opt="B"><span class="opt-letter">B</span>"HELLO!"</div>
      <div class="quiz-opt" data-quiz="3" data-opt="C"><span class="opt-letter">C</span>"  hello  !"</div>
      <div class="quiz-opt" data-quiz="3" data-opt="D"><span class="opt-letter">D</span>"hello!"</div>
    </div>
    <div class="quiz-explanation" id="exp-quiz3"></div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('quiz');navigateTo('challenges')">Next: Coding Challenges ‚Üí</button>
  </div>
</div>

<!-- ===== CODING CHALLENGES ===== -->
<div class="section" id="sec-challenges">
  <h1 class="section-title">üí™ Coding Challenges</h1>
  <p class="section-subtitle">Put your skills to the test with these exercises.</p>

  <div class="exercise" id="challenge1">
    <div class="ex-header"><span class="ex-title">Challenge 1: Compose a validator</span><span class="tag tag-red ex-diff">Hard</span></div>
    <div class="ex-desc">Write a function <code>composeValidators</code> that takes multiple predicate functions and returns a new predicate that returns true only if all inner predicates return true. Then use it to check if a number is positive and even.</div>
    <div class="playground">
      <textarea id="code-challenge1">function composeValidators(...validators) {
  return (value) => validators.every(v => v(value));
}

const isPositive = x => x > 0;
const isEven = x => x % 2 === 0;

const isPositiveEven = composeValidators(isPositive, isEven);

console.log(isPositiveEven(4));   // true
console.log(isPositiveEven(-2));  // false
console.log(isPositiveEven(3));   // false</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-challenge1','out-challenge1')">‚ñ∂ Run</button>
      </div>
      <div class="pg-output" id="out-challenge1"></div>
    </div>
  </div>

  <div class="exercise" id="challenge2">
    <div class="ex-header"><span class="ex-title">Challenge 2: Memoize a function</span><span class="tag tag-red ex-diff">Hard</span></div>
    <div class="ex-desc">Create a <code>memoize</code> HOF that caches the results of a pure function to avoid recomputation.</div>
    <div class="playground">
      <textarea id="code-challenge2">function memoize(fn) {
  const cache = new Map();
  return function(...args) {
    const key = JSON.stringify(args);
    if (cache.has(key)) return cache.get(key);
    const result = fn(...args);
    cache.set(key, result);
    return result;
  };
}

// Test with a slow function
function slowSquare(n) {
  console.log('Computing...');
  return n * n;
}

const fastSquare = memoize(slowSquare);
console.log(fastSquare(5)); // Computing... 25
console.log(fastSquare(5)); // 25 (cached, no log)</textarea>
      <div class="pg-actions">
        <button class="btn btn-cyan" onclick="runCode('code-challenge2','out-challenge2')">‚ñ∂ Run</button>
      </div>
      <div class="pg-output" id="out-challenge2"></div>
    </div>
  </div>

  <div class="mt-24" style="text-align:right">
    <button class="btn btn-cyan" onclick="completeSection('challenges');navigateTo('home')">üèÅ Back to Home</button>
  </div>
</div>

</div> <!-- mainContent -->

<!-- JavaScript -->
<script>
// Global state
let completedSections = new Set();
let quizScores = {1:0, 2:0, 3:0}; // 0 = not answered, 1 = correct, -1 = wrong
let totalQuizScore = 0;
const sectionNames = ['arrow', 'callbacks', 'hof', 'composition', 'currying', 'partial', 'pitfalls', 'quiz', 'challenges'];

// Navigation
function navigateTo(sectionId) {
  // Hide all sections
  document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
  // Show selected
  document.getElementById(`sec-${sectionId}`).classList.add('active');
  // Update sidebar active class
  document.querySelectorAll('.sidebar .nav-item').forEach(item => item.classList.remove('active'));
  document.querySelector(`.sidebar .nav-item[data-section="${sectionId}"]`).classList.add('active');
  // On mobile close sidebar
  document.getElementById('sidebar').classList.remove('open');
  // Update progress
  updateProgress();
}

// Run code in playground
function runCode(textareaId, outputId) {
  const code = document.getElementById(textareaId).value;
  const outputDiv = document.getElementById(outputId);
  outputDiv.classList.remove('error');
  try {
    // Capture console.log output
    let logs = [];
    const originalLog = console.log;
    console.log = (...args) => {
      logs.push(args.map(arg => 
        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
      ).join(' '));
    };
    
    // Evaluate the code (use eval in a safe context? This is an educational demo)
    const result = eval(code);
    if (result !== undefined) logs.push(String(result));
    
    console.log = originalLog;
    outputDiv.textContent = logs.join('\n') || '(no output)';
  } catch (e) {
    outputDiv.textContent = 'Error: ' + e.message;
    outputDiv.classList.add('error');
  }
}

// Show hint
function showHint(hintId) {
  const hint = document.getElementById(hintId);
  hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
}

// Complete a section (mark as done)
function completeSection(section) {
  if (!completedSections.has(section)) {
    completedSections.add(section);
    document.querySelector(`.sidebar .nav-item[data-section="${section}"]`).classList.add('completed');
    updateProgress();
  }
}

// Update progress bar and home stats
function updateProgress() {
  const totalTopics = sectionNames.length;
  const completedCount = completedSections.size;
  const percent = (completedCount / totalTopics) * 100;
  document.getElementById('progressFill').style.width = percent + '%';
  document.getElementById('progressText').textContent = Math.round(percent) + '%';
  document.getElementById('topicsComplete').textContent = completedCount;
  
  // Update exercises count (pretend each section has at least one exercise)
  document.getElementById('exercisesComplete').textContent = completedCount * 2; // placeholder
  
  // Update quiz score
  let correct = 0;
  for (let q in quizScores) {
    if (quizScores[q] === 1) correct++;
  }
  totalQuizScore = correct;
  document.getElementById('quizScore').textContent = totalQuizScore + '/' + Object.keys(quizScores).length;
  
  // Streak (simple)
  document.getElementById('streakDisplay').textContent = `üî• ${completedCount} streak`;
}

// Quiz handling
document.querySelectorAll('.quiz-opt').forEach(opt => {
  opt.addEventListener('click', function() {
    const quizId = this.dataset.quiz;
    const selected = this.dataset.opt;
    const quizCard = this.closest('.quiz-card');
    const explanationDiv = quizCard.querySelector('.quiz-explanation');
    
    // Correct answers
    const correctAnswers = {1: 'B', 2: 'D', 3: 'B'};
    const isCorrect = (selected === correctAnswers[quizId]);
    
    // Remove previous selected/correct/wrong classes
    quizCard.querySelectorAll('.quiz-opt').forEach(o => {
      o.classList.remove('selected', 'correct', 'wrong');
    });
    
    // Mark selected
    this.classList.add('selected');
    
    // Show explanation
    if (isCorrect) {
      this.classList.add('correct');
      explanationDiv.textContent = '‚úÖ Correct! ' + getExplanation(quizId, selected);
      explanationDiv.classList.add('right');
      explanationDiv.classList.remove('wrong-exp');
      quizScores[quizId] = 1;
    } else {
      this.classList.add('wrong');
      explanationDiv.textContent = '‚ùå Wrong. ' + getExplanation(quizId, selected);
      explanationDiv.classList.add('wrong-exp');
      explanationDiv.classList.remove('right');
      quizScores[quizId] = -1;
    }
    
    // Highlight correct answer
    quizCard.querySelectorAll('.quiz-opt').forEach(o => {
      if (o.dataset.opt === correctAnswers[quizId]) {
        o.classList.add('correct');
      }
    });
    
    explanationDiv.classList.add('show');
    updateProgress();
  });
});

function getExplanation(quizId, selected) {
  const explanations = {
    1: { B: 'Arrow functions do not have their own `this`; they inherit from the surrounding scope (global/window).' },
    2: { D: 'A higher-order function either takes a function as argument or returns a function. Both B (map) and C (setTimeout) qualify.' },
    3: { B: 'Left-to-right pipe applies trim first (removes spaces), then toUpper, then exclaim: "hello" ‚Üí "HELLO" ‚Üí "HELLO!"' }
  };
  const correctAnswers = {1: 'B', 2: 'D', 3: 'B'};
  return explanations[quizId][correctAnswers[quizId]] || '';
}

// Initialization
window.onload = function() {
  updateProgress();
  // Add click handlers for sidebar nav
  document.querySelectorAll('.sidebar .nav-item').forEach(item => {
    item.addEventListener('click', function(e) {
      const section = this.dataset.section;
      if (section) navigateTo(section);
    });
  });
  
  // Topic cards
  document.querySelectorAll('.topic-card').forEach(card => {
    card.addEventListener('click', function() {
      // already inline onclick
    });
  });
};
</script>

</body>
</html>