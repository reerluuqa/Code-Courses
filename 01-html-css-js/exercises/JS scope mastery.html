<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ JavaScript Scope Mastery - The Ultimate Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a2e;
            color: #e0e0e0;
            line-height: 1.7;
        }

        /* Navigation */
        .nav-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: #0d0d35;
            border-right: 2px solid #1a1a5e;
            overflow-y: auto;
            z-index: 100;
            padding: 20px 0;
            transition: transform 0.3s;
        }

        .nav-sidebar.collapsed {
            transform: translateX(-280px);
        }

        .nav-toggle {
            position: fixed;
            left: 280px;
            top: 10px;
            z-index: 101;
            background: #6c5ce7;
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            font-size: 18px;
            transition: left 0.3s;
        }

        .nav-toggle.collapsed {
            left: 0;
        }

        .nav-title {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #a29bfe;
            padding: 10px 15px 20px;
            border-bottom: 1px solid #1a1a5e;
        }

        .nav-section {
            padding: 10px 0;
        }

        .nav-section-title {
            font-size: 0.75em;
            text-transform: uppercase;
            color: #6c5ce7;
            padding: 5px 20px;
            letter-spacing: 1px;
        }

        .nav-item {
            padding: 8px 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-item:hover {
            background: #1a1a5e;
            color: #a29bfe;
        }

        .nav-item.active {
            background: #6c5ce7;
            color: white;
        }

        .nav-item .badge {
            margin-left: auto;
            font-size: 0.7em;
            padding: 2px 8px;
            border-radius: 10px;
            background: #2d2d6e;
        }

        .nav-item.completed .badge {
            background: #00b894;
        }

        /* Progress Bar */
        .progress-container {
            padding: 15px 20px;
            border-bottom: 1px solid #1a1a5e;
        }

        .progress-bar {
            height: 8px;
            background: #1a1a5e;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6c5ce7, #a29bfe);
            border-radius: 4px;
            transition: width 0.5s;
            width: 0%;
        }

        .progress-text {
            font-size: 0.8em;
            color: #888;
            margin-top: 5px;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 40px;
            max-width: 1000px;
            transition: margin-left 0.3s;
        }

        .main-content.expanded {
            margin-left: 40px;
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 30px;
        }

        .section-header h1 {
            font-size: 2.5em;
            color: #a29bfe;
            margin-bottom: 10px;
        }

        .section-header h2 {
            font-size: 1.8em;
            color: #a29bfe;
            margin-bottom: 10px;
        }

        .section-header .subtitle {
            color: #888;
            font-size: 1.1em;
        }

        /* Content Cards */
        .card {
            background: #12123e;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #1a1a5e;
        }

        .card h3 {
            color: #a29bfe;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .card h4 {
            color: #74b9ff;
            margin: 15px 0 10px;
        }

        /* Analogy Box */
        .analogy-box {
            background: linear-gradient(135deg, #1a1a5e, #2d1b69);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid #6c5ce7;
        }

        .analogy-box .emoji {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .analogy-box h4 {
            color: #dfe6e9;
            margin-bottom: 10px;
        }

        /* Code Blocks */
        .code-container {
            position: relative;
            margin: 15px 0;
        }

        .code-block {
            background: #0a0a20;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
            border: 1px solid #1a1a5e;
            line-height: 1.8;
        }

        .code-block .comment {
            color: #636e72;
        }

        .code-block .keyword {
            color: #e056a0;
        }

        .code-block .string {
            color: #a8e6cf;
        }

        .code-block .variable {
            color: #74b9ff;
        }

        .code-block .function {
            color: #ffeaa7;
        }

        .code-block .number {
            color: #fd79a8;
        }

        .code-block .error-line {
            background: rgba(255, 0, 0, 0.15);
            display: inline-block;
            width: 100%;
            padding: 0 5px;
            border-radius: 3px;
        }

        .code-block .highlight-line {
            background: rgba(108, 92, 231, 0.2);
            display: inline-block;
            width: 100%;
            padding: 0 5px;
            border-radius: 3px;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #6c5ce7;
            border: none;
            color: white;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .copy-btn:hover {
            background: #a29bfe;
        }

        /* Run Button & Output */
        .run-btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            border: none;
            color: white;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            margin: 10px 0;
            transition: all 0.2s;
        }

        .run-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }

        .output-box {
            background: #050515;
            border: 1px solid #1a1a5e;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            min-height: 50px;
            white-space: pre-wrap;
        }

        .output-box .output-success {
            color: #00b894;
        }

        .output-box .output-error {
            color: #e74c3c;
        }

        .output-box .output-warn {
            color: #fdcb6e;
        }

        .output-box .output-info {
            color: #74b9ff;
        }

        /* Visual Scope Diagram */
        .scope-visual {
            margin: 20px 0;
            padding: 20px;
        }

        .scope-box {
            border: 2px dashed;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
            position: relative;
        }

        .scope-box.global {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.05);
        }

        .scope-box.function-scope {
            border-color: #6c5ce7;
            background: rgba(108, 92, 231, 0.05);
            margin: 15px;
        }

        .scope-box.block-scope {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.05);
            margin: 15px;
        }

        .scope-label {
            position: absolute;
            top: -12px;
            left: 15px;
            padding: 2px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .scope-label.global { background: #e74c3c; color: white; }
        .scope-label.function-scope { background: #6c5ce7; color: white; }
        .scope-label.block-scope { background: #00b894; color: white; }

        .scope-var {
            display: inline-block;
            padding: 5px 15px;
            margin: 5px;
            border-radius: 20px;
            font-family: monospace;
            font-size: 0.9em;
        }

        .scope-var.var-type { background: #e74c3c33; color: #e74c3c; border: 1px solid #e74c3c; }
        .scope-var.let-type { background: #6c5ce733; color: #a29bfe; border: 1px solid #6c5ce7; }
        .scope-var.const-type { background: #00b89433; color: #00b894; border: 1px solid #00b894; }

        /* Interactive Playground */
        .playground {
            background: #0d0d35;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #1a1a5e;
        }

        .playground h4 {
            color: #ffeaa7;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .playground textarea {
            width: 100%;
            min-height: 150px;
            background: #0a0a20;
            color: #e0e0e0;
            border: 1px solid #1a1a5e;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            resize: vertical;
            line-height: 1.6;
        }

        .playground textarea:focus {
            outline: none;
            border-color: #6c5ce7;
        }

        /* Quiz Styles */
        .quiz-container {
            background: #12123e;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid #1a1a5e;
        }

        .quiz-question {
            font-size: 1.1em;
            margin-bottom: 20px;
            color: #dfe6e9;
        }

        .quiz-question .question-number {
            color: #6c5ce7;
            font-weight: bold;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px 20px;
            background: #0a0a2e;
            border: 2px solid #1a1a5e;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: monospace;
        }

        .quiz-option:hover {
            border-color: #6c5ce7;
            background: #1a1a5e;
        }

        .quiz-option.correct {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.15);
        }

        .quiz-option.wrong {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.15);
        }

        .quiz-option.disabled {
            pointer-events: none;
        }

        .quiz-explanation {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .quiz-explanation.show {
            display: block;
        }

        .quiz-explanation.correct-exp {
            background: rgba(0, 184, 148, 0.1);
            border: 1px solid #00b894;
        }

        .quiz-explanation.wrong-exp {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid #e74c3c;
        }

        /* Pitfall Box */
        .pitfall-box {
            background: rgba(231, 76, 60, 0.08);
            border: 1px solid #e74c3c;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .pitfall-box h4 {
            color: #e74c3c;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        /* Tip Box */
        .tip-box {
            background: rgba(0, 184, 148, 0.08);
            border: 1px solid #00b894;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .tip-box h4 {
            color: #00b894;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        /* Warning Box */
        .warning-box {
            background: rgba(253, 203, 110, 0.08);
            border: 1px solid #fdcb6e;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .warning-box h4 {
            color: #fdcb6e;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .comparison-table th {
            background: #1a1a5e;
            padding: 12px 15px;
            text-align: left;
            color: #a29bfe;
            border: 1px solid #2d2d6e;
        }

        .comparison-table td {
            padding: 12px 15px;
            border: 1px solid #1a1a5e;
            background: #0a0a2e;
        }

        .comparison-table tr:hover td {
            background: #12123e;
        }

        .check { color: #00b894; }
        .cross { color: #e74c3c; }

        /* Exercise Box */
        .exercise-box {
            background: linear-gradient(135deg, #0d0d35, #1a0d35);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid #6c5ce7;
        }

        .exercise-box h4 {
            color: #ffeaa7;
            margin-bottom: 15px;
        }

        .exercise-box .difficulty {
            display: inline-block;
            padding: 3px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-bottom: 10px;
        }

        .difficulty.easy { background: #00b89433; color: #00b894; }
        .difficulty.medium { background: #fdcb6e33; color: #fdcb6e; }
        .difficulty.hard { background: #e74c3c33; color: #e74c3c; }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #1a1a5e;
        }

        .nav-btn {
            padding: 12px 30px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.2s;
        }

        .nav-btn.prev {
            background: #1a1a5e;
            color: #a29bfe;
        }

        .nav-btn.next {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Score Display */
        .score-display {
            text-align: center;
            padding: 30px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            font-size: 2.5em;
            font-weight: bold;
        }

        .score-circle.excellent { border: 5px solid #00b894; color: #00b894; }
        .score-circle.good { border: 5px solid #fdcb6e; color: #fdcb6e; }
        .score-circle.needs-work { border: 5px solid #e74c3c; color: #e74c3c; }

        /* Animation for scope visualization */
        .scope-animate {
            transition: all 0.5s ease;
        }

        .scope-animate.highlight {
            box-shadow: 0 0 20px rgba(108, 92, 231, 0.5);
            transform: scale(1.02);
        }

        /* Real-world example styling */
        .real-world {
            background: linear-gradient(135deg, #12123e, #1a1250);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid #2d2d6e;
        }

        .real-world h4 {
            color: #74b9ff;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a2e;
        }

        ::-webkit-scrollbar-thumb {
            background: #1a1a5e;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6c5ce7;
        }

        /* Mini game */
        .drag-zone {
            min-height: 60px;
            border: 2px dashed #1a1a5e;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            align-items: center;
        }

        .drag-zone.highlight-drop {
            border-color: #6c5ce7;
            background: rgba(108, 92, 231, 0.1);
        }

        .drag-item {
            padding: 8px 16px;
            background: #6c5ce7;
            color: white;
            border-radius: 6px;
            cursor: grab;
            font-family: monospace;
            user-select: none;
        }

        .drag-item:active {
            cursor: grabbing;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .tab {
            padding: 8px 20px;
            background: #1a1a5e;
            border: none;
            color: #888;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab.active {
            background: #6c5ce7;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Flowchart */
        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            margin: 20px 0;
        }

        .flow-box {
            padding: 12px 24px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }

        .flow-arrow {
            font-size: 1.5em;
            color: #6c5ce7;
        }

        .flow-decision {
            transform: rotate(0deg);
            padding: 15px 25px;
            border: 2px solid #fdcb6e;
            color: #fdcb6e;
            border-radius: 8px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-sidebar {
                transform: translateX(-280px);
            }

            .nav-sidebar.open {
                transform: translateX(0);
            }

            .nav-toggle {
                left: 0;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }

        .chapter-intro {
            font-size: 1.15em;
            color: #b2bec3;
            margin-bottom: 20px;
        }

        .inline-code {
            background: #1a1a5e;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            color: #a29bfe;
        }

        ul, ol {
            margin: 10px 0 10px 25px;
        }

        li {
            margin: 5px 0;
        }

        .memory-diagram {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }

        .memory-slot {
            background: #0a0a2e;
            border: 2px solid #1a1a5e;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            min-width: 120px;
        }

        .memory-slot .slot-name {
            font-family: monospace;
            color: #a29bfe;
            font-weight: bold;
        }

        .memory-slot .slot-value {
            margin-top: 8px;
            padding: 5px 10px;
            background: #12123e;
            border-radius: 4px;
            font-family: monospace;
        }

        .memory-slot .slot-type {
            font-size: 0.7em;
            color: #888;
            margin-top: 5px;
        }

        .step-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 15px 0;
        }

        .step-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
        }

        .step-dot.active {
            background: #6c5ce7;
            color: white;
        }

        .step-dot.completed {
            background: #00b894;
            color: white;
        }

        .step-dot.pending {
            background: #1a1a5e;
            color: #888;
        }

        .step-line {
            flex: 1;
            height: 2px;
            background: #1a1a5e;
        }

        .step-line.completed {
            background: #00b894;
        }

        .interactive-demo {
            background: #0d0d35;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #6c5ce7;
        }

        .interactive-demo h4 {
            color: #ffeaa7;
            margin-bottom: 15px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .demo-btn {
            padding: 8px 18px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .demo-btn:hover {
            transform: translateY(-2px);
        }

        .demo-btn.primary { background: #6c5ce7; color: white; }
        .demo-btn.success { background: #00b894; color: white; }
        .demo-btn.danger { background: #e74c3c; color: white; }
        .demo-btn.warning { background: #fdcb6e; color: #333; }
        .demo-btn.info { background: #74b9ff; color: #333; }

        .hidden {
            display: none;
        }

        .fade-in {
            animation: fadeIn 0.5s;
        }
    </style>
</head>
<body>

<!-- Navigation Sidebar -->
<nav class="nav-sidebar" id="navSidebar">
    <div class="nav-title">üéØ JS Scope Mastery</div>
    
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">0 / 12 sections completed</div>
    </div>

    <div class="nav-section">
        <div class="nav-section-title">üìö Fundamentals</div>
        <div class="nav-item active" data-section="intro" onclick="navigateTo('intro')">
            <span>üè†</span> What is Scope?
            <span class="badge">Start</span>
        </div>
        <div class="nav-item" data-section="why-scope" onclick="navigateTo('why-scope')">
            <span>ü§î</span> Why Does Scope Exist?
        </div>
        <div class="nav-item" data-section="global-scope" onclick="navigateTo('global-scope')">
            <span>üåç</span> Global Scope
        </div>
        <div class="nav-item" data-section="function-scope" onclick="navigateTo('function-scope')">
            <span>üì¶</span> Function Scope
        </div>
        <div class="nav-item" data-section="block-scope" onclick="navigateTo('block-scope')">
            <span>üß±</span> Block Scope
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-section-title">‚ö° Deep Dive</div>
        <div class="nav-item" data-section="var-let-const" onclick="navigateTo('var-let-const')">
            <span>‚öñÔ∏è</span> var vs let vs const
        </div>
        <div class="nav-item" data-section="scope-chain" onclick="navigateTo('scope-chain')">
            <span>üîó</span> Scope Chain & Lookup
        </div>
        <div class="nav-item" data-section="hoisting" onclick="navigateTo('hoisting')">
            <span>üèóÔ∏è</span> Hoisting & TDZ
        </div>
        <div class="nav-item" data-section="closures" onclick="navigateTo('closures')">
            <span>üîí</span> Closures
        </div>
    </div>

    <div class="nav-section">
        <div class="nav-section-title">üèÜ Practice</div>
        <div class="nav-item" data-section="real-world" onclick="navigateTo('real-world')">
            <span>üåê</span> Real-World Examples
        </div>
        <div class="nav-item" data-section="pitfalls" onclick="navigateTo('pitfalls')">
            <span>üíÄ</span> Pitfalls & Bugs
        </div>
        <div class="nav-item" data-section="final-quiz" onclick="navigateTo('final-quiz')">
            <span>üèÜ</span> Final Quiz
        </div>
    </div>
</nav>

<button class="nav-toggle" id="navToggle" onclick="toggleNav()">‚ò∞</button>

<!-- Main Content -->
<main class="main-content" id="mainContent">

    <!-- ============ SECTION 1: INTRO ============ -->
    <div class="section active" id="section-intro">
        <div class="section-header">
            <h1>üéØ What is Scope?</h1>
            <p class="subtitle">The most fundamental concept you need to understand in JavaScript</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üè†üèòÔ∏èüåç</div>
            <h4>Think of Scope Like Rooms in a House</h4>
            <p>Imagine you live in a house with multiple rooms. Each room has its own stuff (variables). 
            The <strong>living room</strong> (global scope) is accessible to everyone. 
            Your <strong>bedroom</strong> (function scope) is private - only you can access your stuff there. 
            Your <strong>desk drawer</strong> (block scope) inside your bedroom is even more private.</p>
            <br>
            <p>üîë <strong>Key insight:</strong> You can always look OUT from your room to the hallway and living room, but nobody can look INTO your room from outside!</p>
        </div>

        <div class="card">
            <h3>üìñ The Simple Definition</h3>
            <p><strong>Scope</strong> determines where variables are <em>accessible</em> (visible/usable) in your code. It defines the "visibility boundary" of your variables.</p>
            
            <br>
            <p>There are <strong>3 types</strong> of scope in JavaScript:</p>
            <br>

            <div class="memory-diagram">
                <div class="memory-slot" style="border-color: #e74c3c;">
                    <div class="slot-name">üåç Global Scope</div>
                    <div class="slot-value">Everywhere</div>
                    <div class="slot-type">var, let, const (outside functions)</div>
                </div>
                <div class="memory-slot" style="border-color: #6c5ce7;">
                    <div class="slot-name">üì¶ Function Scope</div>
                    <div class="slot-value">Inside function only</div>
                    <div class="slot-type">var, let, const (inside functions)</div>
                </div>
                <div class="memory-slot" style="border-color: #00b894;">
                    <div class="slot-name">üß± Block Scope</div>
                    <div class="slot-value">Inside { } only</div>
                    <div class="slot-type">let, const (inside { })</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üëÅÔ∏è Visual: The Scope Onion</h3>
            <p>Think of scopes as layers of an onion - inner layers can see outer layers, but NOT the other way around:</p>
            
            <div class="scope-visual">
                <div class="scope-box global">
                    <span class="scope-label global">üåç GLOBAL SCOPE</span>
                    <span class="scope-var var-type">var appName = "MyApp"</span>
                    <span class="scope-var let-type">let version = "1.0"</span>
                    
                    <div class="scope-box function-scope">
                        <span class="scope-label function-scope">üì¶ FUNCTION SCOPE (greetUser)</span>
                        <span class="scope-var var-type">var greeting = "Hello"</span>
                        <span class="scope-var let-type">let userName = "Alice"</span>
                        <p style="font-size:0.85em; color:#888; margin-top:8px">‚úÖ Can access: appName, version, greeting, userName</p>
                        
                        <div class="scope-box block-scope">
                            <span class="scope-label block-scope">üß± BLOCK SCOPE (if statement)</span>
                            <span class="scope-var let-type">let message = "Welcome!"</span>
                            <span class="scope-var const-type">const emoji = "üëã"</span>
                            <p style="font-size:0.85em; color:#888; margin-top:8px">‚úÖ Can access: EVERYTHING above + message, emoji</p>
                        </div>
                        <p style="font-size:0.85em; color:#e74c3c; margin-top:8px">‚ùå Cannot access: message, emoji (block scoped!)</p>
                    </div>
                    <p style="font-size:0.85em; color:#e74c3c; margin-top:8px">‚ùå Cannot access: greeting, userName, message, emoji</p>
                </div>
            </div>
        </div>

        <div class="interactive-demo">
            <h4>üéÆ Try It Yourself - Your First Scope Experiment</h4>
            <p>Click "Run" to see what happens when you try to access variables from different scopes:</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// üåç Global Scope</span>
<span class="keyword">var</span> <span class="variable">globalVar</span> = <span class="string">"I'm global! Everyone can see me! üåç"</span>;

<span class="keyword">function</span> <span class="function">myFunction</span>() {
    <span class="comment">// üì¶ Function Scope</span>
    <span class="keyword">var</span> <span class="variable">functionVar</span> = <span class="string">"I'm function-scoped! Only visible inside this function üì¶"</span>;
    
    console.log(<span class="variable">globalVar</span>);    <span class="comment">// ‚úÖ Can see global</span>
    console.log(<span class="variable">functionVar</span>);  <span class="comment">// ‚úÖ Can see own variable</span>
    
    <span class="keyword">if</span> (<span class="keyword">true</span>) {
        <span class="comment">// üß± Block Scope</span>
        <span class="keyword">let</span> <span class="variable">blockVar</span> = <span class="string">"I'm block-scoped! Only visible inside these curly braces üß±"</span>;
        console.log(<span class="variable">blockVar</span>);    <span class="comment">// ‚úÖ Can see own variable</span>
        console.log(<span class="variable">functionVar</span>); <span class="comment">// ‚úÖ Can see parent function var</span>
        console.log(<span class="variable">globalVar</span>);   <span class="comment">// ‚úÖ Can see global var</span>
    }
    
    <span class="comment">// console.log(blockVar); // ‚ùå ERROR! blockVar is not visible here</span>
}

<span class="function">myFunction</span>();
<span class="comment">// console.log(functionVar); // ‚ùå ERROR! functionVar is not visible here</span>
                </div>
            </div>
            <button class="run-btn" onclick="runDemo1()">‚ñ∂ Run This Code</button>
            <div class="output-box" id="demo1-output"></div>
        </div>

        <div class="tip-box">
            <h4>üí° The Golden Rule of Scope</h4>
            <p><strong>Inner scopes can access outer scopes, but outer scopes CANNOT access inner scopes.</strong></p>
            <p>Think of it like one-way glass: you can see OUT but nobody can see IN.</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" disabled>‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('why-scope')">Next: Why Does Scope Exist? ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 2: WHY SCOPE ============ -->
    <div class="section" id="section-why-scope">
        <div class="section-header">
            <h1>ü§î Why Does Scope Exist?</h1>
            <p class="subtitle">Understanding the REAL reasons scope matters in everyday coding</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üè•</div>
            <h4>Imagine a Hospital Without Rooms</h4>
            <p>What if a hospital had no rooms, no walls, no partitions? Every patient, doctor, nurse, and visitor in one giant open space. Chaos! Patient records would get mixed up, surgeries would interfere with each other, and private information would be visible to everyone.</p>
            <br>
            <p><strong>Scope = Walls and rooms in your code.</strong> It prevents variables from interfering with each other and keeps things organized and safe.</p>
        </div>

        <div class="card">
            <h3>üéØ Reason 1: Avoiding Name Collisions</h3>
            <p>Without scope, you could never reuse variable names. Imagine having thousands of uniquely named variables!</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå WITHOUT SCOPE (imagine everything is global) - NIGHTMARE!</span>
<span class="keyword">var</span> <span class="variable">name</span> = <span class="string">"Alice"</span>;         <span class="comment">// User's name</span>
<span class="keyword">var</span> <span class="variable">name</span> = <span class="string">"ProductWidget"</span>;  <span class="comment">// Oops! Overwrote Alice! üí•</span>
<span class="keyword">var</span> <span class="variable">name</span> = <span class="string">"checkout-form"</span>;  <span class="comment">// Overwrote again! üí•üí•</span>

<span class="comment">// ‚úÖ WITH SCOPE - Everyone can use 'name' independently!</span>
<span class="keyword">function</span> <span class="function">getUserProfile</span>() {
    <span class="keyword">let</span> <span class="variable">name</span> = <span class="string">"Alice"</span>;     <span class="comment">// Safe in its own scope</span>
    <span class="keyword">return</span> <span class="variable">name</span>;
}

<span class="keyword">function</span> <span class="function">getWidgetName</span>() {
    <span class="keyword">let</span> <span class="variable">name</span> = <span class="string">"ProductWidget"</span>;  <span class="comment">// Different 'name', no conflict!</span>
    <span class="keyword">return</span> <span class="variable">name</span>;
}

<span class="keyword">function</span> <span class="function">getFormId</span>() {
    <span class="keyword">let</span> <span class="variable">name</span> = <span class="string">"checkout-form"</span>;  <span class="comment">// Another 'name', still safe!</span>
    <span class="keyword">return</span> <span class="variable">name</span>;
}
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üîê Reason 2: Data Privacy & Security</h3>
            <p>Scope lets you hide data that shouldn't be accessed from outside:</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">createBankAccount</span>(<span class="variable">initialBalance</span>) {
    <span class="comment">// üîí These are PRIVATE - no one outside can touch them!</span>
    <span class="keyword">let</span> <span class="variable">balance</span> = <span class="variable">initialBalance</span>;
    <span class="keyword">let</span> <span class="variable">pin</span> = <span class="string">"1234"</span>;
    <span class="keyword">let</span> <span class="variable">transactionHistory</span> = [];

    <span class="keyword">return</span> {
        <span class="comment">// üîì Public methods - controlled access only</span>
        <span class="function">getBalance</span>: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="variable">balance</span>; <span class="comment">// Can read but not directly modify</span>
        },
        <span class="function">deposit</span>: <span class="keyword">function</span>(<span class="variable">amount</span>) {
            <span class="keyword">if</span> (<span class="variable">amount</span> > <span class="number">0</span>) {
                <span class="variable">balance</span> += <span class="variable">amount</span>;
                <span class="variable">transactionHistory</span>.push(<span class="string">`+$${amount}`</span>);
            }
        },
        <span class="function">withdraw</span>: <span class="keyword">function</span>(<span class="variable">amount</span>, <span class="variable">userPin</span>) {
            <span class="keyword">if</span> (<span class="variable">userPin</span> === <span class="variable">pin</span> && <span class="variable">amount</span> <= <span class="variable">balance</span>) {
                <span class="variable">balance</span> -= <span class="variable">amount</span>;
                <span class="keyword">return</span> <span class="variable">amount</span>;
            }
            <span class="keyword">return</span> <span class="string">"Access denied!"</span>;
        }
    };
}

<span class="keyword">const</span> <span class="variable">myAccount</span> = <span class="function">createBankAccount</span>(<span class="number">1000</span>);
console.log(<span class="variable">myAccount</span>.<span class="function">getBalance</span>());  <span class="comment">// 1000 ‚úÖ</span>
<span class="comment">// console.log(balance);   // ‚ùå ReferenceError - can't access!</span>
<span class="comment">// console.log(pin);       // ‚ùå ReferenceError - PIN is safe!</span>
                </div>
            </div>
            <button class="run-btn" onclick="runBankDemo()">‚ñ∂ Run Bank Account Demo</button>
            <div class="output-box" id="bank-output"></div>
        </div>

        <div class="card">
            <h3>üßπ Reason 3: Memory Management</h3>
            <p>Variables in local scope are automatically cleaned up (garbage collected) when the function finishes. Global variables stick around forever, eating up memory!</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå BAD: This huge array stays in memory FOREVER</span>
<span class="keyword">var</span> <span class="variable">globalData</span> = <span class="keyword">new</span> Array(<span class="number">1000000</span>).fill(<span class="string">"data"</span>);

<span class="comment">// ‚úÖ GOOD: This array is cleaned up after function runs</span>
<span class="keyword">function</span> <span class="function">processData</span>() {
    <span class="keyword">let</span> <span class="variable">tempData</span> = <span class="keyword">new</span> Array(<span class="number">1000000</span>).fill(<span class="string">"data"</span>);
    <span class="comment">// ... do processing ...</span>
    <span class="keyword">return</span> <span class="variable">result</span>;
    <span class="comment">// tempData is automatically garbage collected! üóëÔ∏è</span>
}
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üß© Reason 4: Modularity & Maintainability</h3>
            <p>Scope lets different parts of your code work independently without worrying about stepping on each other's toes.</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// Team member 1 writes this</span>
<span class="keyword">function</span> <span class="function">calculateShipping</span>(<span class="variable">weight</span>) {
    <span class="keyword">let</span> <span class="variable">rate</span> = <span class="number">2.5</span>;
    <span class="keyword">let</span> <span class="variable">total</span> = <span class="variable">weight</span> * <span class="variable">rate</span>;
    <span class="keyword">return</span> <span class="variable">total</span>;
}

<span class="comment">// Team member 2 writes this - same variable names, NO conflict!</span>
<span class="keyword">function</span> <span class="function">calculateTax</span>(<span class="variable">price</span>) {
    <span class="keyword">let</span> <span class="variable">rate</span> = <span class="number">0.08</span>;     <span class="comment">// Different 'rate', no problem!</span>
    <span class="keyword">let</span> <span class="variable">total</span> = <span class="variable">price</span> * <span class="variable">rate</span>;  <span class="comment">// Different 'total', no problem!</span>
    <span class="keyword">return</span> <span class="variable">total</span>;
}
                </div>
            </div>
        </div>

        <div class="warning-box">
            <h4>‚ö†Ô∏è What Happens Without Proper Scope?</h4>
            <ul>
                <li>üêõ Mysterious bugs where variables change unexpectedly</li>
                <li>üí• Name collisions when your project grows</li>
                <li>üîì Security vulnerabilities (exposed sensitive data)</li>
                <li>üêå Memory leaks (global variables never get cleaned up)</li>
                <li>üò± Nightmare debugging sessions at 3 AM</li>
            </ul>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('intro')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('global-scope')">Next: Global Scope ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 3: GLOBAL SCOPE ============ -->
    <div class="section" id="section-global-scope">
        <div class="section-header">
            <h1>üåç Global Scope</h1>
            <p class="subtitle">The outermost scope - visible everywhere, for better or worse</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üì¢</div>
            <h4>The Town Square Analogy</h4>
            <p>Global scope is like a town square bulletin board. <strong>Everyone</strong> in town can read it, and <strong>anyone</strong> can change what's on it. That's powerful... but also dangerous. What if someone accidentally erases the meeting schedule?</p>
        </div>

        <div class="card">
            <h3>üìñ What is Global Scope?</h3>
            <p>A variable is in the <strong>global scope</strong> when it's declared <em>outside</em> of any function or block. It becomes accessible from <strong>anywhere</strong> in your code.</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// All of these are GLOBAL variables</span>
<span class="keyword">var</span> <span class="variable">appName</span> = <span class="string">"MyApp"</span>;        <span class="comment">// Global with var</span>
<span class="keyword">let</span> <span class="variable">version</span> = <span class="string">"2.0"</span>;           <span class="comment">// Global with let</span>
<span class="keyword">const</span> <span class="variable">MAX_USERS</span> = <span class="number">1000</span>;         <span class="comment">// Global with const</span>
<span class="variable">oops</span> = <span class="string">"I forgot a keyword!"</span>;    <span class="comment">// üò± Also global (accidental!)</span>

<span class="keyword">function</span> <span class="function">anyFunction</span>() {
    console.log(<span class="variable">appName</span>);    <span class="comment">// ‚úÖ "MyApp" - accessible!</span>
    console.log(<span class="variable">version</span>);    <span class="comment">// ‚úÖ "2.0" - accessible!</span>
    console.log(<span class="variable">MAX_USERS</span>);  <span class="comment">// ‚úÖ 1000 - accessible!</span>
}

<span class="keyword">if</span> (<span class="keyword">true</span>) {
    console.log(<span class="variable">appName</span>);    <span class="comment">// ‚úÖ Still accessible here too!</span>
}
                </div>
            </div>
        </div>

        <div class="card">
            <h3>ü™ü The Window Object (Browser)</h3>
            <p>In browsers, global variables declared with <span class="inline-code">var</span> become properties of the <span class="inline-code">window</span> object. <span class="inline-code">let</span> and <span class="inline-code">const</span> do NOT.</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">var</span> <span class="variable">myVar</span> = <span class="string">"I'm on window!"</span>;
<span class="keyword">let</span> <span class="variable">myLet</span> = <span class="string">"I'm NOT on window"</span>;
<span class="keyword">const</span> <span class="variable">myConst</span> = <span class="string">"I'm NOT on window either"</span>;

console.log(window.<span class="variable">myVar</span>);    <span class="comment">// ‚úÖ "I'm on window!"</span>
console.log(window.<span class="variable">myLet</span>);    <span class="comment">// ‚ùå undefined</span>
console.log(window.<span class="variable">myConst</span>);  <span class="comment">// ‚ùå undefined</span>
                </div>
            </div>
            <button class="run-btn" onclick="runWindowDemo()">‚ñ∂ Run Window Demo</button>
            <div class="output-box" id="window-output"></div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall: Accidental Globals</h4>
            <p>Forgetting <span class="inline-code">var</span>, <span class="inline-code">let</span>, or <span class="inline-code">const</span> creates an accidental global variable!</p>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">calculateTotal</span>() {
    <span class="error-line"><span class="variable">total</span> = <span class="number">100</span>;</span>  <span class="comment">// üò± No keyword! This is now GLOBAL!</span>
    <span class="keyword">let</span> <span class="variable">tax</span> = <span class="number">8</span>;    <span class="comment">// ‚úÖ This is properly scoped</span>
}

<span class="function">calculateTotal</span>();
console.log(<span class="variable">total</span>);  <span class="comment">// 100 - Leaked outside! üí•</span>
<span class="comment">// console.log(tax);  // ReferenceError - properly contained ‚úÖ</span>
                </div>
            </div>
            <p><strong>Fix:</strong> Always use <span class="inline-code">let</span> or <span class="inline-code">const</span>. Add <span class="inline-code">"use strict";</span> at the top of your files to catch this error.</p>
        </div>

        <div class="tip-box">
            <h4>‚úÖ When IS Global Scope Appropriate?</h4>
            <ul>
                <li>App-wide configuration: <span class="inline-code">const API_URL = "https://api.example.com"</span></li>
                <li>Constants that truly never change: <span class="inline-code">const MAX_RETRIES = 3</span></li>
                <li>App state that needs to be accessible everywhere (but consider state management instead)</li>
            </ul>
        </div>

        <div class="real-world">
            <h4>üåê Real-World Example: Configuration</h4>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚úÖ Good use of global scope - app configuration</span>
<span class="keyword">const</span> <span class="variable">CONFIG</span> = {
    apiUrl: <span class="string">"https://api.myapp.com"</span>,
    maxRetries: <span class="number">3</span>,
    timeout: <span class="number">5000</span>,
    debug: <span class="keyword">false</span>
};

<span class="comment">// Now any function anywhere can use CONFIG</span>
<span class="keyword">function</span> <span class="function">fetchData</span>(<span class="variable">endpoint</span>) {
    <span class="keyword">return</span> fetch(<span class="variable">CONFIG</span>.apiUrl + <span class="variable">endpoint</span>, {
        timeout: <span class="variable">CONFIG</span>.timeout
    });
}

<span class="keyword">function</span> <span class="function">logError</span>(<span class="variable">error</span>) {
    <span class="keyword">if</span> (<span class="variable">CONFIG</span>.debug) {
        console.error(<span class="variable">error</span>);
    }
}
                </div>
            </div>
        </div>

        <!-- Quiz -->
        <div class="quiz-container" id="quiz-global-1">
            <div class="quiz-question">
                <span class="question-number">Quiz 1:</span> What will this code output?
                <div class="code-block" style="margin-top:10px">
<span class="keyword">var</span> <span class="variable">color</span> = <span class="string">"red"</span>;
<span class="keyword">function</span> <span class="function">paint</span>() { 
    console.log(<span class="variable">color</span>); 
}
<span class="variable">color</span> = <span class="string">"blue"</span>;
<span class="function">paint</span>();
                </div>
            </div>
            <div class="quiz-options">
                <div class="quiz-option" onclick="checkQuiz('quiz-global-1', this, false)">"red"</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-global-1', this, true)">"blue"</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-global-1', this, false)">undefined</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-global-1', this, false)">ReferenceError</div>
            </div>
            <div class="quiz-explanation correct-exp" id="quiz-global-1-correct">
                ‚úÖ <strong>Correct!</strong> The function reads <code>color</code> when it's CALLED, not when it's defined. By the time <code>paint()</code> runs, <code>color</code> has been changed to "blue". This is because <code>color</code> is global and the function always looks up the current value.
            </div>
            <div class="quiz-explanation wrong-exp" id="quiz-global-1-wrong">
                ‚ùå <strong>Not quite!</strong> The answer is "blue". The function accesses the global <code>color</code> when called (not when defined). Since <code>color</code> was changed to "blue" before the function call, that's what it reads.
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('why-scope')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('function-scope')">Next: Function Scope ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 4: FUNCTION SCOPE ============ -->
    <div class="section" id="section-function-scope">
        <div class="section-header">
            <h1>üì¶ Function Scope</h1>
            <p class="subtitle">Your own private room - what happens in the function, stays in the function</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üéí</div>
            <h4>The Backpack Analogy</h4>
            <p>Function scope is like a backpack. When you enter a function, you open a new backpack and put variables in it. When the function ends, you close the backpack and throw it away. Nobody else can look inside your backpack!</p>
        </div>

        <div class="card">
            <h3>üìñ How Function Scope Works</h3>
            <p>Any variable declared inside a function with <span class="inline-code">var</span>, <span class="inline-code">let</span>, or <span class="inline-code">const</span> is only accessible within that function.</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">makeBreakfast</span>() {
    <span class="keyword">var</span> <span class="variable">eggs</span> = <span class="number">3</span>;
    <span class="keyword">let</span> <span class="variable">toast</span> = <span class="number">2</span>;
    <span class="keyword">const</span> <span class="variable">coffee</span> = <span class="string">"black"</span>;

    console.log(<span class="string">`Making ${eggs} eggs, ${toast} toast, and ${coffee} coffee`</span>);
    <span class="comment">// ‚úÖ All accessible here inside the function</span>
}

<span class="function">makeBreakfast</span>(); <span class="comment">// Works fine!</span>

<span class="comment">// ‚ùå NONE of these work outside the function:</span>
<span class="comment">// console.log(eggs);   ‚Üí ReferenceError</span>
<span class="comment">// console.log(toast);  ‚Üí ReferenceError</span>
<span class="comment">// console.log(coffee); ‚Üí ReferenceError</span>
                </div>
            </div>
            <button class="run-btn" onclick="runFunctionScopeDemo()">‚ñ∂ Run This Code</button>
            <div class="output-box" id="func-scope-output"></div>
        </div>

        <div class="card">
            <h3>üîÑ Each Call Creates a NEW Scope</h3>
            <p>Every time you call a function, a brand new scope is created. Variables from previous calls are gone!</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">counter</span>() {
    <span class="keyword">let</span> <span class="variable">count</span> = <span class="number">0</span>;  <span class="comment">// Fresh 'count' each time!</span>
    <span class="variable">count</span>++;
    console.log(<span class="string">`Count: ${count}`</span>);
}

<span class="function">counter</span>(); <span class="comment">// Count: 1  (new scope created)</span>
<span class="function">counter</span>(); <span class="comment">// Count: 1  (ANOTHER new scope created, count resets!)</span>
<span class="function">counter</span>(); <span class="comment">// Count: 1  (and again!)</span>

<span class="comment">// Each call gets its own fresh 'count' variable</span>
<span class="comment">// The old one is thrown away when the function ends</span>
                </div>
            </div>
            <button class="run-btn" onclick="runCounterDemo()">‚ñ∂ Run This Code</button>
            <div class="output-box" id="counter-output"></div>
        </div>

        <div class="card">
            <h3>üì• Parameters are Function-Scoped Too!</h3>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">greet</span>(<span class="variable">name</span>) {     <span class="comment">// 'name' is function-scoped</span>
    <span class="keyword">let</span> <span class="variable">message</span> = <span class="string">`Hello, ${name}!`</span>;
    console.log(<span class="variable">message</span>);
}

<span class="function">greet</span>(<span class="string">"Alice"</span>);  <span class="comment">// "Hello, Alice!"</span>
<span class="function">greet</span>(<span class="string">"Bob"</span>);    <span class="comment">// "Hello, Bob!"</span>

<span class="comment">// console.log(name);    // ‚ùå ReferenceError</span>
<span class="comment">// console.log(message); // ‚ùå ReferenceError</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>ü™Ü Nested Functions</h3>
            <p>Functions inside functions create nested scopes. Inner functions can access outer function's variables!</p>

            <div class="scope-visual">
                <div class="scope-box global">
                    <span class="scope-label global">üåç GLOBAL</span>
                    <span class="scope-var let-type">let app = "MyApp"</span>
                    
                    <div class="scope-box function-scope">
                        <span class="scope-label function-scope">üì¶ outer()</span>
                        <span class="scope-var let-type">let x = 10</span>
                        
                        <div class="scope-box function-scope" style="border-color: #fd79a8;">
                            <span class="scope-label function-scope" style="background: #fd79a8;">üì¶ inner()</span>
                            <span class="scope-var let-type">let y = 20</span>
                            <p style="font-size:0.85em; color:#888; margin-top:8px">‚úÖ Can see: app, x, y</p>
                        </div>
                        <p style="font-size:0.85em; color:#e74c3c; margin-top:8px">‚ùå Cannot see: y</p>
                    </div>
                </div>
            </div>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">outer</span>() {
    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">10</span>;

    <span class="keyword">function</span> <span class="function">inner</span>() {
        <span class="keyword">let</span> <span class="variable">y</span> = <span class="number">20</span>;
        console.log(<span class="variable">x</span> + <span class="variable">y</span>);  <span class="comment">// ‚úÖ 30 - inner can see outer's 'x'</span>
    }

    <span class="function">inner</span>();
    <span class="comment">// console.log(y);  // ‚ùå ReferenceError - outer can't see inner's 'y'</span>
}

<span class="function">outer</span>();
                </div>
            </div>
            <button class="run-btn" onclick="runNestedDemo()">‚ñ∂ Run This Code</button>
            <div class="output-box" id="nested-output"></div>
        </div>

        <!-- Quiz -->
        <div class="quiz-container" id="quiz-func-1">
            <div class="quiz-question">
                <span class="question-number">Quiz 2:</span> What will this code output?
                <div class="code-block" style="margin-top:10px">
<span class="keyword">let</span> <span class="variable">x</span> = <span class="number">1</span>;
<span class="keyword">function</span> <span class="function">foo</span>() {
    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">2</span>;
    console.log(<span class="variable">x</span>);
}
<span class="function">foo</span>();
console.log(<span class="variable">x</span>);
                </div>
            </div>
            <div class="quiz-options">
                <div class="quiz-option" onclick="checkQuiz('quiz-func-1', this, false)">2, 2</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-func-1', this, true)">2, 1</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-func-1', this, false)">1, 1</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-func-1', this, false)">1, 2</div>
            </div>
            <div class="quiz-explanation correct-exp" id="quiz-func-1-correct">
                ‚úÖ <strong>Correct!</strong> Inside <code>foo()</code>, the local <code>x = 2</code> <strong>shadows</strong> (hides) the global <code>x = 1</code>. But the global <code>x</code> was never changed, so the second <code>console.log(x)</code> still prints 1. These are TWO different variables that happen to share the same name!
            </div>
            <div class="quiz-explanation wrong-exp" id="quiz-func-1-wrong">
                ‚ùå The answer is <strong>2, 1</strong>. The <code>let x = 2</code> inside the function creates a NEW variable that "shadows" the global one. The global <code>x</code> remains unchanged at 1.
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('global-scope')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('block-scope')">Next: Block Scope ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 5: BLOCK SCOPE ============ -->
    <div class="section" id="section-block-scope">
        <div class="section-header">
            <h1>üß± Block Scope</h1>
            <p class="subtitle">The most precise level of scoping - introduced with let and const in ES6</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üìù</div>
            <h4>The Sticky Note Analogy</h4>
            <p>Block scope is like writing a note on a sticky pad during a meeting. The note exists only during that meeting (the block <code>{ }</code>). Once the meeting is over (the block ends), the sticky note is tossed in the trash. You can't reference it after the meeting!</p>
        </div>

        <div class="card">
            <h3>üìñ What is a "Block"?</h3>
            <p>A <strong>block</strong> is any code between curly braces <span class="inline-code">{ }</span>. This includes:</p>
            <ul>
                <li><span class="inline-code">if / else</span> statements</li>
                <li><span class="inline-code">for</span> loops</li>
                <li><span class="inline-code">while</span> loops</li>
                <li><span class="inline-code">switch</span> statements</li>
                <li><span class="inline-code">try / catch</span> blocks</li>
                <li>Even standalone <span class="inline-code">{ }</span> blocks!</li>
            </ul>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// Each of these creates a BLOCK:</span>

<span class="keyword">if</span> (<span class="keyword">true</span>) {
    <span class="keyword">let</span> <span class="variable">a</span> = <span class="number">1</span>;  <span class="comment">// Only exists inside this if-block</span>
}

<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">5</span>; <span class="variable">i</span>++) {
    <span class="keyword">let</span> <span class="variable">b</span> = <span class="variable">i</span>;  <span class="comment">// Only exists inside this for-block</span>
}

{
    <span class="keyword">let</span> <span class="variable">c</span> = <span class="number">3</span>;  <span class="comment">// Even this standalone block works!</span>
}

<span class="comment">// console.log(a, b, c);  // ‚ùå ALL are ReferenceError!</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>‚ö° The BIG Difference: var vs let/const in Blocks</h3>
            <p>This is where it gets really important. <span class="inline-code">var</span> does NOT respect block scope!</p>

            <div class="scope-visual">
                <div class="scope-box global">
                    <span class="scope-label global">üåç GLOBAL</span>
                    
                    <div class="code-block" style="margin:10px 0">
<span class="keyword">if</span> (<span class="keyword">true</span>) {
    <span class="keyword">var</span> <span class="variable">x</span> = <span class="string">"I LEAK OUT! üíß"</span>;      <span class="comment">// var ignores block scope!</span>
    <span class="keyword">let</span> <span class="variable">y</span> = <span class="string">"I stay inside! üîí"</span>;    <span class="comment">// let respects block scope</span>
    <span class="keyword">const</span> <span class="variable">z</span> = <span class="string">"Me too! üîí"</span>;         <span class="comment">// const respects block scope</span>
}

console.log(<span class="variable">x</span>); <span class="comment">// ‚úÖ "I LEAK OUT!" - var escaped the block!</span>
console.log(<span class="variable">y</span>); <span class="comment">// ‚ùå ReferenceError - let stayed inside</span>
console.log(<span class="variable">z</span>); <span class="comment">// ‚ùå ReferenceError - const stayed inside</span>
                    </div>
                </div>
            </div>
            <button class="run-btn" onclick="runBlockVarDemo()">‚ñ∂ Run This Demo</button>
            <div class="output-box" id="block-var-output"></div>
        </div>

        <div class="card">
            <h3>üîÑ Block Scope in Loops - The Classic Interview Question!</h3>
            <p>This is one of the most famous scope bugs in JavaScript history:</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå THE BUG (using var)</span>
<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">3</span>; <span class="variable">i</span>++) {
    setTimeout(<span class="keyword">function</span>() {
        console.log(<span class="string">"var i ="</span>, <span class="variable">i</span>);
    }, <span class="number">100</span>);
}
<span class="comment">// Output: 3, 3, 3  üò± (not 0, 1, 2!)</span>

<span class="comment">// ‚úÖ THE FIX (using let)</span>
<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">j</span> = <span class="number">0</span>; <span class="variable">j</span> &lt; <span class="number">3</span>; <span class="variable">j</span>++) {
    setTimeout(<span class="keyword">function</span>() {
        console.log(<span class="string">"let j ="</span>, <span class="variable">j</span>);
    }, <span class="number">200</span>);
}
<span class="comment">// Output: 0, 1, 2  ‚úÖ (correct!)</span>
                </div>
            </div>
            <button class="run-btn" onclick="runLoopDemo()">‚ñ∂ Run Loop Demo (watch the difference!)</button>
            <div class="output-box" id="loop-output"></div>

            <div class="tip-box" style="margin-top:15px">
                <h4>üí° Why does this happen?</h4>
                <p><strong>With <code>var</code>:</strong> There's only ONE <code>i</code> variable (function/global scoped). By the time setTimeout fires, the loop has finished and <code>i</code> is 3.</p>
                <p><strong>With <code>let</code>:</strong> Each loop iteration gets its OWN <code>j</code> variable (block scoped). Each setTimeout captures its own copy.</p>
            </div>
        </div>

        <!-- Quiz -->
        <div class="quiz-container" id="quiz-block-1">
            <div class="quiz-question">
                <span class="question-number">Quiz 3:</span> What does this code output?
                <div class="code-block" style="margin-top:10px">
<span class="keyword">let</span> <span class="variable">x</span> = <span class="number">10</span>;
<span class="keyword">if</span> (<span class="keyword">true</span>) {
    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">20</span>;
}
console.log(<span class="variable">x</span>);
                </div>
            </div>
            <div class="quiz-options">
                <div class="quiz-option" onclick="checkQuiz('quiz-block-1', this, true)">10</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-block-1', this, false)">20</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-block-1', this, false)">undefined</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-block-1', this, false)">ReferenceError</div>
            </div>
            <div class="quiz-explanation correct-exp" id="quiz-block-1-correct">
                ‚úÖ <strong>Correct!</strong> The <code>let x = 20</code> inside the block creates a completely NEW variable that only exists within those curly braces. The outer <code>x = 10</code> is untouched and is what gets printed.
            </div>
            <div class="quiz-explanation wrong-exp" id="quiz-block-1-wrong">
                ‚ùå The answer is <strong>10</strong>. The <code>let x = 20</code> inside the <code>if</code> block is a brand new variable. It shadows the outer <code>x</code> inside the block but doesn't change it. Once the block ends, that inner <code>x</code> is gone.
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('function-scope')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('var-let-const')">Next: var vs let vs const ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 6: VAR VS LET VS CONST ============ -->
    <div class="section" id="section-var-let-const">
        <div class="section-header">
            <h1>‚öñÔ∏è var vs let vs const</h1>
            <p class="subtitle">The complete comparison - know exactly when to use each one</p>
        </div>

        <div class="card">
            <h3>üìä The Complete Comparison Table</h3>
            <table class="comparison-table">
                <tr>
                    <th>Feature</th>
                    <th style="color:#e74c3c">var</th>
                    <th style="color:#6c5ce7">let</th>
                    <th style="color:#00b894">const</th>
                </tr>
                <tr>
                    <td>Scope</td>
                    <td>Function scope</td>
                    <td>Block scope</td>
                    <td>Block scope</td>
                </tr>
                <tr>
                    <td>Hoisted?</td>
                    <td><span class="check">‚úÖ Yes</span> (initialized as undefined)</td>
                    <td><span class="check">‚úÖ Yes</span> (but in TDZ)</td>
                    <td><span class="check">‚úÖ Yes</span> (but in TDZ)</td>
                </tr>
                <tr>
                    <td>Re-declarable?</td>
                    <td><span class="check">‚úÖ Yes</span></td>
                    <td><span class="cross">‚ùå No</span></td>
                    <td><span class="cross">‚ùå No</span></td>
                </tr>
                <tr>
                    <td>Re-assignable?</td>
                    <td><span class="check">‚úÖ Yes</span></td>
                    <td><span class="check">‚úÖ Yes</span></td>
                    <td><span class="cross">‚ùå No</span></td>
                </tr>
                <tr>
                    <td>Added to window?</td>
                    <td><span class="check">‚úÖ Yes</span> (if global)</td>
                    <td><span class="cross">‚ùå No</span></td>
                    <td><span class="cross">‚ùå No</span></td>
                </tr>
                <tr>
                    <td>Recommendation</td>
                    <td>üö´ Avoid</td>
                    <td>‚úÖ Use when value changes</td>
                    <td>‚≠ê Use by default</td>
                </tr>
            </table>
        </div>

        <div class="card">
            <h3>üîë The Modern Best Practice</h3>
            <div class="flowchart">
                <div class="flow-box" style="background:#6c5ce7; color:white;">Start: Declare a variable</div>
                <div class="flow-arrow">‚Üì</div>
                <div class="flow-decision">Will the value ever change?</div>
                <div style="display:flex; gap:40px; align-items:flex-start; margin-top:10px;">
                    <div style="text-align:center;">
                        <div style="color:#e74c3c; font-weight:bold">NO</div>
                        <div class="flow-arrow">‚Üì</div>
                        <div class="flow-box" style="background:#00b894; color:white;">Use const ‚≠ê</div>
                        <p style="font-size:0.8em; color:#888; margin-top:5px">Default choice!</p>
                    </div>
                    <div style="text-align:center;">
                        <div style="color:#00b894; font-weight:bold">YES</div>
                        <div class="flow-arrow">‚Üì</div>
                        <div class="flow-box" style="background:#6c5ce7; color:white;">Use let</div>
                        <p style="font-size:0.8em; color:#888; margin-top:5px">Counters, accumulators, etc.</p>
                    </div>
                </div>
            </div>
            <p style="text-align:center; color:#e74c3c; font-weight:bold; margin-top:15px;">üö´ Never use var in modern JavaScript</p>
        </div>

        <div class="card">
            <h3>üéØ Practical Examples</h3>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚≠ê USE CONST - for things that don't change</span>
<span class="keyword">const</span> <span class="variable">API_KEY</span> = <span class="string">"abc123"</span>;
<span class="keyword">const</span> <span class="variable">MAX_ITEMS</span> = <span class="number">50</span>;
<span class="keyword">const</span> <span class="variable">user</span> = { name: <span class="string">"Alice"</span> };  <span class="comment">// Object ref is const, properties can change!</span>
<span class="keyword">const</span> <span class="variable">colors</span> = [<span class="string">"red"</span>, <span class="string">"blue"</span>];   <span class="comment">// Array ref is const, items can change!</span>

<span class="variable">user</span>.name = <span class="string">"Bob"</span>;       <span class="comment">// ‚úÖ OK! Changing property, not the reference</span>
<span class="variable">colors</span>.push(<span class="string">"green"</span>);     <span class="comment">// ‚úÖ OK! Modifying array, not the reference</span>
<span class="comment">// user = { name: "Charlie" };  // ‚ùå Error! Can't reassign const</span>

<span class="comment">// ‚úÖ USE LET - for things that change</span>
<span class="keyword">let</span> <span class="variable">score</span> = <span class="number">0</span>;
<span class="variable">score</span> += <span class="number">10</span>;  <span class="comment">// ‚úÖ Reassigning is fine</span>

<span class="keyword">let</span> <span class="variable">isLoggedIn</span> = <span class="keyword">false</span>;
<span class="variable">isLoggedIn</span> = <span class="keyword">true</span>;  <span class="comment">// ‚úÖ Value changes</span>

<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">10</span>; <span class="variable">i</span>++) {  <span class="comment">// ‚úÖ Counter changes</span>
    <span class="comment">// ...</span>
}
                </div>
            </div>
            <button class="run-btn" onclick="runVarLetConstDemo()">‚ñ∂ Run Examples</button>
            <div class="output-box" id="vlc-output"></div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall: const with Objects and Arrays</h4>
            <p>A common mistake is thinking <span class="inline-code">const</span> makes objects/arrays immutable. It doesn't! It only prevents <em>reassignment</em> of the variable itself.</p>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">const</span> <span class="variable">person</span> = { name: <span class="string">"Alice"</span>, age: <span class="number">30</span> };

<span class="variable">person</span>.age = <span class="number">31</span>;        <span class="comment">// ‚úÖ This works! You changed a property</span>
<span class="variable">person</span>.email = <span class="string">"a@b.c"</span>;  <span class="comment">// ‚úÖ This works! You added a property</span>

<span class="comment">// person = { name: "Bob" }; // ‚ùå TypeError! Can't reassign the variable</span>

<span class="comment">// If you need truly immutable, use Object.freeze():</span>
<span class="keyword">const</span> <span class="variable">frozen</span> = Object.freeze({ x: <span class="number">1</span>, y: <span class="number">2</span> });
<span class="variable">frozen</span>.x = <span class="number">99</span>;  <span class="comment">// Silently fails (or error in strict mode)</span>
console.log(<span class="variable">frozen</span>.x); <span class="comment">// Still 1</span>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('block-scope')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('scope-chain')">Next: Scope Chain ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 7: SCOPE CHAIN ============ -->
    <div class="section" id="section-scope-chain">
        <div class="section-header">
            <h1>üîó Scope Chain & Lookup</h1>
            <p class="subtitle">How JavaScript finds your variables - the search process</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üîç</div>
            <h4>The Lost Keys Analogy</h4>
            <p>Imagine you lost your keys. You first check your <strong>pockets</strong> (current scope). Not there? You check your <strong>desk</strong> (parent scope). Still not there? You check the <strong>kitchen table</strong> (grandparent scope). Finally, you check the <strong>front door hook</strong> (global scope). If they're nowhere, you panic (ReferenceError)!</p>
        </div>

        <div class="card">
            <h3>üìñ How the Scope Chain Works</h3>
            <p>When JavaScript encounters a variable, it follows these steps:</p>
            
            <div class="step-indicator">
                <div class="step-dot active">1</div>
                <div class="step-line"></div>
                <div class="step-dot pending">2</div>
                <div class="step-line"></div>
                <div class="step-dot pending">3</div>
                <div class="step-line"></div>
                <div class="step-dot pending">4</div>
            </div>

            <ol>
                <li><strong>Check current scope</strong> ‚Üí Is the variable here? If yes, use it!</li>
                <li><strong>Check parent scope</strong> ‚Üí Move up one level. Found it? Use it!</li>
                <li><strong>Keep going up...</strong> ‚Üí Through all ancestor scopes</li>
                <li><strong>Check global scope</strong> ‚Üí Last stop. Not here? ‚Üí <span style="color:#e74c3c">ReferenceError!</span></li>
            </ol>
        </div>

        <div class="interactive-demo">
            <h4>üéÆ Interactive: Watch the Scope Chain in Action</h4>
            <p>Click "Run" to see exactly how JavaScript searches for each variable:</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">let</span> <span class="variable">planet</span> = <span class="string">"Earth"</span>;           <span class="comment">// üåç Global scope</span>

<span class="keyword">function</span> <span class="function">country</span>() {
    <span class="keyword">let</span> <span class="variable">countryName</span> = <span class="string">"Japan"</span>;   <span class="comment">// üì¶ Country scope</span>

    <span class="keyword">function</span> <span class="function">city</span>() {
        <span class="keyword">let</span> <span class="variable">cityName</span> = <span class="string">"Tokyo"</span>;  <span class="comment">// üì¶ City scope</span>

        <span class="keyword">function</span> <span class="function">street</span>() {
            <span class="keyword">let</span> <span class="variable">streetName</span> = <span class="string">"Shibuya"</span>;  <span class="comment">// üì¶ Street scope</span>

            <span class="comment">// JavaScript searches: street ‚Üí city ‚Üí country ‚Üí global</span>
            console.log(<span class="string">`üìç ${streetName}, ${cityName}, ${countryName}, ${planet}`</span>);
        }
        <span class="function">street</span>();
    }
    <span class="function">city</span>();
}
<span class="function">country</span>();
                </div>
            </div>
            <button class="run-btn" onclick="runChainDemo()">‚ñ∂ Run Scope Chain Demo</button>
            <div class="output-box" id="chain-output"></div>
        </div>

        <div class="card">
            <h3>üé≠ Variable Shadowing</h3>
            <p>When an inner scope has a variable with the same name as an outer scope, the inner one "shadows" (hides) the outer one:</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">let</span> <span class="variable">color</span> = <span class="string">"red"</span>;  <span class="comment">// üåç Global</span>

<span class="keyword">function</span> <span class="function">paint</span>() {
    <span class="keyword">let</span> <span class="variable">color</span> = <span class="string">"blue"</span>;  <span class="comment">// üì¶ Shadows the global 'color'</span>
    console.log(color);   <span class="comment">// "blue" ‚Üê Found in current scope, stops looking!</span>
    
    <span class="keyword">function</span> <span class="function">detail</span>() {
        <span class="keyword">let</span> <span class="variable">color</span> = <span class="string">"green"</span>;  <span class="comment">// üì¶ Shadows paint's 'color'</span>
        console.log(color);   <span class="comment">// "green" ‚Üê Found in current scope!</span>
    }
    <span class="function">detail</span>();
}

<span class="function">paint</span>();
console.log(<span class="variable">color</span>);  <span class="comment">// "red" ‚Üê Global 'color' was never touched!</span>
                </div>
            </div>
            <button class="run-btn" onclick="runShadowDemo()">‚ñ∂ Run Shadowing Demo</button>
            <div class="output-box" id="shadow-output"></div>
        </div>

        <div class="warning-box">
            <h4>‚ö†Ô∏è Shadowing Can Be Confusing</h4>
            <p>While shadowing is valid, it can make code hard to read. Prefer unique variable names when possible!</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('var-let-const')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('hoisting')">Next: Hoisting & TDZ ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 8: HOISTING ============ -->
    <div class="section" id="section-hoisting">
        <div class="section-header">
            <h1>üèóÔ∏è Hoisting & the Temporal Dead Zone</h1>
            <p class="subtitle">JavaScript's sneaky behavior that trips up even experienced developers</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üèóÔ∏è</div>
            <h4>The Construction Site Analogy</h4>
            <p>Before a building opens, the architect (JavaScript engine) reviews all blueprints first and <strong>reserves space</strong> for everything. With <code>var</code>, it puts up a "RESERVED" sign (undefined). With <code>let/const</code>, it puts up a "DO NOT ENTER" tape (Temporal Dead Zone) until construction reaches that floor.</p>
        </div>

        <div class="card">
            <h3>üìñ What is Hoisting?</h3>
            <p>Before executing code, JavaScript <strong>moves declarations to the top of their scope</strong> (conceptually). But it behaves differently for <code>var</code> vs <code>let/const</code>:</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// What you WRITE:</span>
console.log(<span class="variable">myVar</span>);   <span class="comment">// ???</span>
console.log(<span class="variable">myLet</span>);   <span class="comment">// ???</span>

<span class="keyword">var</span> <span class="variable">myVar</span> = <span class="string">"hello"</span>;
<span class="keyword">let</span> <span class="variable">myLet</span> = <span class="string">"world"</span>;

<span class="comment">// What JavaScript SEES (conceptually):</span>
<span class="keyword">var</span> <span class="variable">myVar</span>;  <span class="comment">// ‚Üê Hoisted AND initialized as undefined</span>
<span class="comment">// let myLet; ‚Üê Hoisted but NOT initialized (TDZ starts here)</span>

console.log(<span class="variable">myVar</span>);  <span class="comment">// undefined (exists but no value yet)</span>
console.log(<span class="variable">myLet</span>);  <span class="comment">// üí• ReferenceError: Cannot access before initialization</span>

<span class="variable">myVar</span> = <span class="string">"hello"</span>;    <span class="comment">// ‚Üê NOW var gets its value</span>
<span class="variable">myLet</span> = <span class="string">"world"</span>;    <span class="comment">// ‚Üê NOW let exits TDZ and gets its value</span>
                </div>
            </div>
            <button class="run-btn" onclick="runHoistingDemo()">‚ñ∂ Run Hoisting Demo</button>
            <div class="output-box" id="hoist-output"></div>
        </div>

        <div class="card">
            <h3>‚ò†Ô∏è Temporal Dead Zone (TDZ)</h3>
            <p>The TDZ is the period between the start of a scope and where <code>let</code>/<code>const</code> is declared. Accessing the variable during this period throws an error.</p>

            <div class="scope-visual">
                <div class="scope-box block-scope">
                    <span class="scope-label block-scope">Block Scope</span>
                    <div style="background:rgba(231,76,60,0.15); padding:10px; border-radius:6px; margin:5px 0; border-left:3px solid #e74c3c;">
                        <span style="color:#e74c3c; font-weight:bold;">‚ò†Ô∏è TEMPORAL DEAD ZONE</span><br>
                        <code style="color:#888;">// x exists but CANNOT be accessed here</code><br>
                        <code style="color:#888;">console.log(x); // üí• ReferenceError!</code>
                    </div>
                    <div style="background:rgba(0,184,148,0.15); padding:10px; border-radius:6px; margin:5px 0; border-left:3px solid #00b894;">
                        <span style="color:#00b894; font-weight:bold;">‚úÖ SAFE ZONE</span><br>
                        <code>let x = 42; // ‚Üê TDZ ends here</code><br>
                        <code>console.log(x); // ‚úÖ 42</code>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üèóÔ∏è Function Hoisting</h3>
            <p>Function <em>declarations</em> are fully hoisted (you can call them before they appear in code). Function <em>expressions</em> are NOT.</p>

            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚úÖ Function DECLARATION - fully hoisted</span>
<span class="function">sayHello</span>();  <span class="comment">// ‚úÖ Works! "Hello!"</span>

<span class="keyword">function</span> <span class="function">sayHello</span>() {
    console.log(<span class="string">"Hello!"</span>);
}

<span class="comment">// ‚ùå Function EXPRESSION - NOT hoisted</span>
<span class="function">sayGoodbye</span>();  <span class="comment">// üí• TypeError: sayGoodbye is not a function</span>

<span class="keyword">var</span> <span class="variable">sayGoodbye</span> = <span class="keyword">function</span>() {
    console.log(<span class="string">"Goodbye!"</span>);
};

<span class="comment">// ‚ùå Arrow function - NOT hoisted either</span>
<span class="function">greet</span>();  <span class="comment">// üí• ReferenceError (const is in TDZ)</span>

<span class="keyword">const</span> <span class="variable">greet</span> = () => console.log(<span class="string">"Hi!"</span>);
                </div>
            </div>
            <button class="run-btn" onclick="runFuncHoistDemo()">‚ñ∂ Run Function Hoisting Demo</button>
            <div class="output-box" id="func-hoist-output"></div>
        </div>

        <div class="tip-box">
            <h4>üí° Best Practice</h4>
            <p>Always declare your variables at the TOP of their scope. This makes hoisting irrelevant and your code much clearer!</p>
        </div>

        <!-- Quiz -->
        <div class="quiz-container" id="quiz-hoist-1">
            <div class="quiz-question">
                <span class="question-number">Quiz 4:</span> What does this code output?
                <div class="code-block" style="margin-top:10px">
console.log(<span class="variable">a</span>);
console.log(<span class="variable">b</span>);
<span class="keyword">var</span> <span class="variable">a</span> = <span class="number">1</span>;
<span class="keyword">let</span> <span class="variable">b</span> = <span class="number">2</span>;
                </div>
            </div>
            <div class="quiz-options">
                <div class="quiz-option" onclick="checkQuiz('quiz-hoist-1', this, false)">1, 2</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-hoist-1', this, false)">undefined, undefined</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-hoist-1', this, true)">undefined, then ReferenceError</div>
                <div class="quiz-option" onclick="checkQuiz('quiz-hoist-1', this, false)">ReferenceError, ReferenceError</div>
            </div>
            <div class="quiz-explanation correct-exp" id="quiz-hoist-1-correct">
                ‚úÖ <strong>Correct!</strong> <code>var a</code> is hoisted and initialized as <code>undefined</code>, so the first log works. <code>let b</code> is hoisted but stays in the Temporal Dead Zone, causing a <code>ReferenceError</code> before the second log can complete.
            </div>
            <div class="quiz-explanation wrong-exp" id="quiz-hoist-1-wrong">
                ‚ùå The answer is <strong>undefined, then ReferenceError</strong>. <code>var</code> gets hoisted as <code>undefined</code>. <code>let</code> is in the TDZ (Temporal Dead Zone) and throws a ReferenceError when accessed before declaration.
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('scope-chain')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('closures')">Next: Closures ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 9: CLOSURES ============ -->
    <div class="section" id="section-closures">
        <div class="section-header">
            <h1>üîí Closures</h1>
            <p class="subtitle">The most powerful concept that emerges from scope - and it's simpler than you think!</p>
        </div>

        <div class="analogy-box">
            <div class="emoji">üéíüì∏</div>
            <h4>The Snapshot Backpack Analogy</h4>
            <p>Imagine taking a photo inside a room and putting it in your backpack. Even after you leave the room, you still have that photo ‚Äî you "remember" what was in the room. A <strong>closure</strong> is a function that "remembers" the variables from the scope where it was created, even after that scope is gone!</p>
        </div>

        <div class="card">
            <h3>üìñ What is a Closure?</h3>
            <p>A <strong>closure</strong> is created when a function is defined inside another function and the inner function references variables from the outer function. The inner function "closes over" those variables.</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">createGreeter</span>(<span class="variable">greeting</span>) {
    <span class="comment">// 'greeting' lives in createGreeter's scope</span>
    
    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="variable">name</span>) {
        <span class="comment">// This inner function "closes over" greeting</span>
        console.log(<span class="string">`${greeting}, ${name}!`</span>);
    };
}

<span class="comment">// createGreeter finishes executing, but...</span>
<span class="keyword">const</span> <span class="variable">sayHello</span> = <span class="function">createGreeter</span>(<span class="string">"Hello"</span>);
<span class="keyword">const</span> <span class="variable">sayHola</span> = <span class="function">createGreeter</span>(<span class="string">"Hola"</span>);

<span class="comment">// The returned functions still remember their 'greeting'!</span>
<span class="variable">sayHello</span>(<span class="string">"Alice"</span>);  <span class="comment">// "Hello, Alice!" üéâ</span>
<span class="variable">sayHola</span>(<span class="string">"Bob"</span>);    <span class="comment">// "Hola, Bob!" üéâ</span>
                </div>
            </div>
            <button class="run-btn" onclick="runClosureDemo()">‚ñ∂ Run Closure Demo</button>
            <div class="output-box" id="closure-output"></div>
        </div>

        <div class="card">
            <h3>üßÆ Real-World Closure: Counter</h3>
            <p>Remember how a regular function's count kept resetting? Closures fix that!</p>

            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">createCounter</span>() {
    <span class="keyword">let</span> <span class="variable">count</span> = <span class="number">0</span>;  <span class="comment">// üîí Private variable, enclosed!</span>
    
    <span class="keyword">return</span> {
        <span class="function">increment</span>: <span class="keyword">function</span>() { <span class="variable">count</span>++; <span class="keyword">return</span> <span class="variable">count</span>; },
        <span class="function">decrement</span>: <span class="keyword">function</span>() { <span class="variable">count</span>--; <span class="keyword">return</span> <span class="variable">count</span>; },
        <span class="function">getCount</span>:  <span class="keyword">function</span>() { <span class="keyword">return</span> <span class="variable">count</span>; }
    };
}

<span class="keyword">const</span> <span class="variable">counter</span> = <span class="function">createCounter</span>();
console.log(<span class="variable">counter</span>.<span class="function">increment</span>()); <span class="comment">// 1</span>
console.log(<span class="variable">counter</span>.<span class="function">increment</span>()); <span class="comment">// 2</span>
console.log(<span class="variable">counter</span>.<span class="function">increment</span>()); <span class="comment">// 3</span>
console.log(<span class="variable">counter</span>.<span class="function">decrement</span>()); <span class="comment">// 2</span>

<span class="comment">// count is PRIVATE - can't be accessed directly!</span>
<span class="comment">// console.log(count);         // ‚ùå ReferenceError</span>
<span class="comment">// console.log(counter.count); // ‚ùå undefined</span>
                </div>
            </div>
            <button class="run-btn" onclick="runCounterClosureDemo()">‚ñ∂ Run Counter Demo</button>
            <div class="output-box" id="counter-closure-output"></div>
        </div>

        <div class="card">
            <h3>üõí Real-World Closure: Shopping Cart</h3>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">createCart</span>() {
    <span class="keyword">const</span> <span class="variable">items</span> = [];  <span class="comment">// üîí Private</span>
    
    <span class="keyword">return</span> {
        <span class="function">addItem</span>(<span class="variable">name</span>, <span class="variable">price</span>) {
            <span class="variable">items</span>.push({ <span class="variable">name</span>, <span class="variable">price</span> });
            console.log(<span class="string">`Added: ${name} ($${price})`</span>);
        },
        <span class="function">getTotal</span>() {
            <span class="keyword">return</span> <span class="variable">items</span>.reduce((<span class="variable">sum</span>, <span class="variable">item</span>) => <span class="variable">sum</span> + <span class="variable">item</span>.price, <span class="number">0</span>);
        },
        <span class="function">showCart</span>() {
            console.log(<span class="string">"üõí Cart:"</span>, <span class="variable">items</span>.map(<span class="variable">i</span> => <span class="variable">i</span>.name).join(<span class="string">", "</span>));
            console.log(<span class="string">`üí∞ Total: $${<span class="keyword">this</span>.getTotal()}`</span>);
        }
    };
}

<span class="keyword">const</span> <span class="variable">cart</span> = <span class="function">createCart</span>();
<span class="variable">cart</span>.<span class="function">addItem</span>(<span class="string">"Laptop"</span>, <span class="number">999</span>);
<span class="variable">cart</span>.<span class="function">addItem</span>(<span class="string">"Mouse"</span>, <span class="number">29</span>);
<span class="variable">cart</span>.<span class="function">showCart</span>();
                </div>
            </div>
            <button class="run-btn" onclick="runCartDemo()">‚ñ∂ Run Shopping Cart Demo</button>
            <div class="output-box" id="cart-output"></div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('hoisting')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('real-world')">Next: Real-World Examples ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 10: REAL-WORLD EXAMPLES ============ -->
    <div class="section" id="section-real-world">
        <div class="section-header">
            <h1>üåê Real-World Examples</h1>
            <p class="subtitle">How scope is used in actual web development projects</p>
        </div>

        <div class="real-world">
            <h4>üåê Example 1: User Authentication Module</h4>
            <p>Using closures and scope to create a secure auth module:</p>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">const</span> <span class="variable">AuthModule</span> = (<span class="keyword">function</span>() {
    <span class="comment">// üîí ALL of these are PRIVATE (function scope)</span>
    <span class="keyword">let</span> <span class="variable">currentUser</span> = <span class="keyword">null</span>;
    <span class="keyword">let</span> <span class="variable">token</span> = <span class="keyword">null</span>;
    <span class="keyword">let</span> <span class="variable">loginAttempts</span> = <span class="number">0</span>;
    <span class="keyword">const</span> <span class="variable">MAX_ATTEMPTS</span> = <span class="number">3</span>;
    
    <span class="keyword">function</span> <span class="function">validatePassword</span>(<span class="variable">password</span>) {
        <span class="keyword">return</span> <span class="variable">password</span>.length >= <span class="number">8</span>;
    }

    <span class="comment">// üîì Return only PUBLIC methods</span>
    <span class="keyword">return</span> {
        <span class="function">login</span>(<span class="variable">username</span>, <span class="variable">password</span>) {
            <span class="keyword">if</span> (<span class="variable">loginAttempts</span> >= <span class="variable">MAX_ATTEMPTS</span>) {
                <span class="keyword">return</span> <span class="string">"Account locked! Too many attempts."</span>;
            }
            <span class="keyword">if</span> (<span class="function">validatePassword</span>(<span class="variable">password</span>)) {
                <span class="variable">currentUser</span> = <span class="variable">username</span>;
                <span class="variable">token</span> = <span class="string">"jwt_"</span> + Math.random().toString(<span class="number">36</span>);
                <span class="variable">loginAttempts</span> = <span class="number">0</span>;
                <span class="keyword">return</span> <span class="string">`Welcome, ${username}!`</span>;
            }
            <span class="variable">loginAttempts</span>++;
            <span class="keyword">return</span> <span class="string">`Login failed. ${MAX_ATTEMPTS - loginAttempts} attempts left.`</span>;
        },
        <span class="function">logout</span>() {
            <span class="variable">currentUser</span> = <span class="keyword">null</span>;
            <span class="variable">token</span> = <span class="keyword">null</span>;
            <span class="keyword">return</span> <span class="string">"Logged out."</span>;
        },
        <span class="function">isLoggedIn</span>() {
            <span class="keyword">return</span> <span class="variable">currentUser</span> !== <span class="keyword">null</span>;
        }
    };
})();

<span class="comment">// Usage:</span>
console.log(<span class="variable">AuthModule</span>.<span class="function">login</span>(<span class="string">"alice"</span>, <span class="string">"mypassword123"</span>));
console.log(<span class="variable">AuthModule</span>.<span class="function">isLoggedIn</span>());
<span class="comment">// console.log(token);        // ‚ùå Can't access private data!</span>
<span class="comment">// console.log(currentUser);  // ‚ùå Can't access private data!</span>
                </div>
            </div>
            <button class="run-btn" onclick="runAuthDemo()">‚ñ∂ Run Auth Demo</button>
            <div class="output-box" id="auth-output"></div>
        </div>

        <div class="real-world">
            <h4>üåê Example 2: Event Handlers with Closures</h4>
            <p>One of the most common real-world uses - creating event handlers that remember data:</p>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// Creating buttons that remember their own data</span>
<span class="keyword">function</span> <span class="function">createButtonHandlers</span>() {
    <span class="keyword">const</span> <span class="variable">buttons</span> = [<span class="string">"Save"</span>, <span class="string">"Delete"</span>, <span class="string">"Edit"</span>];
    
    <span class="variable">buttons</span>.forEach(<span class="keyword">function</span>(<span class="variable">buttonName</span>) {
        <span class="comment">// Each iteration creates a NEW closure!</span>
        <span class="comment">// Each handler remembers its own 'buttonName'</span>
        console.log(<span class="string">`Button "${buttonName}" handler created`</span>);
        
        <span class="comment">// In real code: document.getElementById(buttonName)</span>
        <span class="comment">//   .addEventListener('click', function() {</span>
        <span class="comment">//     console.log(`${buttonName} button clicked!`);</span>
        <span class="comment">//   });</span>
    });
}

<span class="function">createButtonHandlers</span>();
                </div>
            </div>
        </div>

        <div class="real-world">
            <h4>üåê Example 3: API Rate Limiter</h4>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">createRateLimiter</span>(<span class="variable">maxCalls</span>, <span class="variable">timeWindow</span>) {
    <span class="keyword">let</span> <span class="variable">calls</span> = [];  <span class="comment">// üîí Private: tracks call timestamps</span>
    
    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="variable">apiCall</span>) {
        <span class="keyword">const</span> <span class="variable">now</span> = Date.now();
        <span class="comment">// Remove old calls outside time window</span>
        <span class="variable">calls</span> = <span class="variable">calls</span>.filter(<span class="variable">time</span> => <span class="variable">now</span> - <span class="variable">time</span> < <span class="variable">timeWindow</span>);
        
        <span class="keyword">if</span> (<span class="variable">calls</span>.length < <span class="variable">maxCalls</span>) {
            <span class="variable">calls</span>.push(<span class="variable">now</span>);
            console.log(<span class="string">`‚úÖ API call allowed (${calls.length}/${maxCalls})`</span>);
            <span class="keyword">return</span> <span class="variable">apiCall</span>();
        } <span class="keyword">else</span> {
            console.log(<span class="string">`‚ùå Rate limited! Try again later.`</span>);
            <span class="keyword">return</span> <span class="keyword">null</span>;
        }
    };
}

<span class="keyword">const</span> <span class="variable">limitedFetch</span> = <span class="function">createRateLimiter</span>(<span class="number">3</span>, <span class="number">5000</span>); <span class="comment">// 3 calls per 5 seconds</span>

<span class="variable">limitedFetch</span>(() => <span class="string">"data1"</span>);  <span class="comment">// ‚úÖ Allowed</span>
<span class="variable">limitedFetch</span>(() => <span class="string">"data2"</span>);  <span class="comment">// ‚úÖ Allowed</span>
<span class="variable">limitedFetch</span>(() => <span class="string">"data3"</span>);  <span class="comment">// ‚úÖ Allowed</span>
<span class="variable">limitedFetch</span>(() => <span class="string">"data4"</span>);  <span class="comment">// ‚ùå Rate limited!</span>
                </div>
            </div>
            <button class="run-btn" onclick="runRateLimiterDemo()">‚ñ∂ Run Rate Limiter Demo</button>
            <div class="output-box" id="rate-output"></div>
        </div>

        <div class="real-world">
            <h4>üåê Example 4: Memoization (Caching)</h4>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">memoize</span>(<span class="variable">fn</span>) {
    <span class="keyword">const</span> <span class="variable">cache</span> = {};  <span class="comment">// üîí Private cache via closure</span>
    
    <span class="keyword">return</span> <span class="keyword">function</span>(...<span class="variable">args</span>) {
        <span class="keyword">const</span> <span class="variable">key</span> = JSON.stringify(<span class="variable">args</span>);
        
        <span class="keyword">if</span> (<span class="variable">cache</span>[<span class="variable">key</span>]) {
            console.log(<span class="string">`‚ö° Cache hit for ${key}`</span>);
            <span class="keyword">return</span> <span class="variable">cache</span>[<span class="variable">key</span>];
        }
        
        console.log(<span class="string">`üîÑ Computing for ${key}...`</span>);
        <span class="keyword">const</span> <span class="variable">result</span> = <span class="variable">fn</span>(...<span class="variable">args</span>);
        <span class="variable">cache</span>[<span class="variable">key</span>] = <span class="variable">result</span>;
        <span class="keyword">return</span> <span class="variable">result</span>;
    };
}

<span class="keyword">const</span> <span class="variable">expensiveSquare</span> = <span class="function">memoize</span>(<span class="keyword">function</span>(<span class="variable">n</span>) {
    <span class="keyword">return</span> <span class="variable">n</span> * <span class="variable">n</span>;
});

console.log(<span class="variable">expensiveSquare</span>(<span class="number">5</span>));  <span class="comment">// Computing... 25</span>
console.log(<span class="variable">expensiveSquare</span>(<span class="number">5</span>));  <span class="comment">// Cache hit! 25</span>
console.log(<span class="variable">expensiveSquare</span>(<span class="number">10</span>)); <span class="comment">// Computing... 100</span>
console.log(<span class="variable">expensiveSquare</span>(<span class="number">10</span>)); <span class="comment">// Cache hit! 100</span>
                </div>
            </div>
            <button class="run-btn" onclick="runMemoDemo()">‚ñ∂ Run Memoization Demo</button>
            <div class="output-box" id="memo-output"></div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('closures')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('pitfalls')">Next: Pitfalls & Bugs ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 11: PITFALLS ============ -->
    <div class="section" id="section-pitfalls">
        <div class="section-header">
            <h1>üíÄ Common Pitfalls & Mistakes</h1>
            <p class="subtitle">Learn from the mistakes that catch every developer at least once</p>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall 1: The Loop + var + setTimeout Bug</h4>
            <p>This has caused more headaches than any other scope bug:</p>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå THE BUG - everyone gets this wrong the first time</span>
<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">5</span>; <span class="variable">i</span>++) {
    setTimeout(<span class="keyword">function</span>() {
        console.log(<span class="string">"‚ùå var i ="</span>, <span class="variable">i</span>);
    }, <span class="number">100</span>);
}
<span class="comment">// Prints: 5, 5, 5, 5, 5  (NOT 0, 1, 2, 3, 4)</span>
<span class="comment">// Because there's only ONE 'i' and it's 5 by the time callbacks fire</span>

<span class="comment">// ‚úÖ FIX 1: Use let (creates new variable per iteration)</span>
<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">5</span>; <span class="variable">i</span>++) {
    setTimeout(<span class="keyword">function</span>() {
        console.log(<span class="string">"‚úÖ let i ="</span>, <span class="variable">i</span>);
    }, <span class="number">300</span>);
}
<span class="comment">// Prints: 0, 1, 2, 3, 4 ‚úÖ</span>
                </div>
            </div>
            <button class="run-btn" onclick="runPitfall1()">‚ñ∂ See the Bug in Action</button>
            <div class="output-box" id="pitfall1-output"></div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall 2: Accidentally Creating Global Variables</h4>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">function</span> <span class="function">processOrder</span>() {
    <span class="error-line"><span class="variable">total</span> = <span class="number">0</span>;</span>  <span class="comment">// üò± No let/const/var = GLOBAL variable!</span>
    <span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">5</span>; <span class="variable">i</span>++) {
        <span class="error-line"><span class="variable">subtotal</span> = <span class="variable">i</span> * <span class="number">10</span>;</span>  <span class="comment">// üò± Another accidental global!</span>
        <span class="variable">total</span> += <span class="variable">subtotal</span>;
    }
}

<span class="function">processOrder</span>();
console.log(<span class="variable">total</span>);     <span class="comment">// 100 - leaked! üíß</span>
console.log(<span class="variable">subtotal</span>);  <span class="comment">// 40 - leaked! üíß</span>

<span class="comment">// ‚úÖ FIX: Always use let or const</span>
<span class="keyword">function</span> <span class="function">processOrderFixed</span>() {
    <span class="highlight-line"><span class="keyword">let</span> <span class="variable">total</span> = <span class="number">0</span>;</span>        <span class="comment">// ‚úÖ Properly scoped</span>
    <span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="number">5</span>; <span class="variable">i</span>++) {
        <span class="highlight-line"><span class="keyword">const</span> <span class="variable">subtotal</span> = <span class="variable">i</span> * <span class="number">10</span>;</span>  <span class="comment">// ‚úÖ Properly scoped</span>
        <span class="variable">total</span> += <span class="variable">subtotal</span>;
    }
}
                </div>
            </div>
            <button class="run-btn" onclick="runPitfall2()">‚ñ∂ See the Bug</button>
            <div class="output-box" id="pitfall2-output"></div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall 3: Overwriting Global Built-ins</h4>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå NEVER do this - overwriting built-in globals!</span>
<span class="error-line"><span class="keyword">var</span> <span class="variable">undefined</span> = <span class="string">"oops"</span>;</span>   <span class="comment">// Yes, var allows this! üò±</span>
<span class="error-line"><span class="keyword">var</span> <span class="variable">NaN</span> = <span class="number">42</span>;</span>             <span class="comment">// üò±</span>
<span class="error-line"><span class="keyword">var</span> <span class="variable">Array</span> = <span class="string">"not an array"</span>;</span> <span class="comment">// üò±</span>

<span class="comment">// ‚úÖ let and const prevent this in some cases:</span>
<span class="comment">// let undefined = "test";  // SyntaxError! ‚úÖ Protected</span>
                </div>
            </div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall 4: Variable Shadowing Confusion</h4>
            <div class="code-container">
                <div class="code-block">
<span class="keyword">let</span> <span class="variable">user</span> = <span class="string">"Alice"</span>;

<span class="keyword">function</span> <span class="function">updateUser</span>() {
    <span class="comment">// Programmer THINKS they're updating the global 'user'</span>
    <span class="error-line"><span class="keyword">let</span> <span class="variable">user</span> = <span class="string">"Bob"</span>;</span>  <span class="comment">// üò± Oops! Created a NEW local 'user' instead!</span>
    console.log(<span class="string">"Inside:"</span>, <span class="variable">user</span>);  <span class="comment">// "Bob"</span>
}

<span class="function">updateUser</span>();
console.log(<span class="string">"Outside:"</span>, <span class="variable">user</span>);  <span class="comment">// Still "Alice"! The global was never changed üò±</span>

<span class="comment">// ‚úÖ FIX: Don't redeclare if you want to modify the outer variable</span>
<span class="keyword">function</span> <span class="function">updateUserFixed</span>() {
    <span class="highlight-line"><span class="variable">user</span> = <span class="string">"Bob"</span>;</span>  <span class="comment">// ‚úÖ No 'let' = modifies the outer 'user'</span>
}
                </div>
            </div>
            <button class="run-btn" onclick="runPitfall4()">‚ñ∂ See the Bug</button>
            <div class="output-box" id="pitfall4-output"></div>
        </div>

        <div class="pitfall-box">
            <h4>üíÄ Pitfall 5: Closures in Loops (Event Listeners)</h4>
            <div class="code-container">
                <div class="code-block">
<span class="comment">// ‚ùå Common bug with event listeners</span>
<span class="keyword">const</span> <span class="variable">buttons</span> = document.querySelectorAll(<span class="string">'.btn'</span>);

<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="variable">buttons</span>.length; <span class="variable">i</span>++) {
    <span class="variable">buttons</span>[<span class="variable">i</span>].addEventListener(<span class="string">'click'</span>, <span class="keyword">function</span>() {
        console.log(<span class="string">'Button'</span>, <span class="variable">i</span>, <span class="string">'clicked'</span>);
        <span class="comment">// üò± Every button says the SAME number!</span>
    });
}

<span class="comment">// ‚úÖ FIX: Use let</span>
<span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">0</span>; <span class="variable">i</span> &lt; <span class="variable">buttons</span>.length; <span class="variable">i</span>++) {
    <span class="variable">buttons</span>[<span class="variable">i</span>].addEventListener(<span class="string">'click'</span>, <span class="keyword">function</span>() {
        console.log(<span class="string">'Button'</span>, <span class="variable">i</span>, <span class="string">'clicked'</span>);
        <span class="comment">// ‚úÖ Each button correctly reports its index!</span>
    });
}
                </div>
            </div>
        </div>

        <div class="tip-box">
            <h4>üõ°Ô∏è The Safety Checklist</h4>
            <ol>
                <li>‚úÖ Always use <span class="inline-code">"use strict";</span> at the top of files</li>
                <li>‚úÖ Default to <span class="inline-code">const</span>, use <span class="inline-code">let</span> only when needed</li>
                <li>‚úÖ Never use <span class="inline-code">var</span> in modern code</li>
                <li>‚úÖ Declare variables at the top of their scope</li>
                <li>‚úÖ Use <span class="inline-code">let</span> in <span class="inline-code">for</span> loops, never <span class="inline-code">var</span></li>
                <li>‚úÖ Keep global variables to an absolute minimum</li>
                <li>‚úÖ Use ESLint to catch scope issues automatically</li>
            </ol>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('real-world')">‚Üê Previous</button>
            <button class="nav-btn next" onclick="navigateTo('final-quiz')">Next: Final Quiz üèÜ ‚Üí</button>
        </div>
    </div>

    <!-- ============ SECTION 12: FINAL QUIZ ============ -->
    <div class="section" id="section-final-quiz">
        <div class="section-header">
            <h1>üèÜ Final Quiz</h1>
            <p class="subtitle">Test your scope mastery! 10 questions covering everything you've learned</p>
        </div>

        <div id="final-quiz-container">
            <!-- Questions will be dynamically generated -->
        </div>

        <div id="quiz-results" class="hidden">
            <div class="score-display">
                <h2>Your Score</h2>
                <div class="score-circle" id="score-circle">
                    <span id="score-text">0/10</span>
                </div>
                <p id="score-message"></p>
                <button class="run-btn" onclick="resetFinalQuiz()" style="margin-top:20px">üîÑ Retake Quiz</button>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="navigateTo('pitfalls')">‚Üê Previous</button>
            <button class="nav-btn next" disabled>üéâ You've completed the guide!</button>
        </div>
    </div>

</main>

<script>
    // ============ NAVIGATION ============
    let currentSection = 'intro';
    let completedSections = new Set();
    const allSections = ['intro', 'why-scope', 'global-scope', 'function-scope', 'block-scope', 'var-let-const', 'scope-chain', 'hoisting', 'closures', 'real-world', 'pitfalls', 'final-quiz'];

    function navigateTo(sectionId) {
        // Mark current as completed
        completedSections.add(currentSection);
        
        // Hide all sections
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        
        // Show target section
        const target = document.getElementById('section-' + sectionId);
        if (target) {
            target.classList.add('active');
            currentSection = sectionId;
        }
        
        // Update nav
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
            if (item.dataset.section === sectionId) {
                item.classList.add('active');
            }
            if (completedSections.has(item.dataset.section)) {
                item.classList.add('completed');
            }
        });
        
        // Update progress
        updateProgress();
        
        // Scroll to top
        window.scrollTo(0, 0);

        // Generate final quiz if needed
        if (sectionId === 'final-quiz') {
            generateFinalQuiz();
        }
    }

    function updateProgress() {
        const total = allSections.length;
        const completed = completedSections.size;
        const pct = (completed / total) * 100;
        document.getElementById('progressFill').style.width = pct + '%';
        document.getElementById('progressText').textContent = `${completed} / ${total} sections completed`;
    }

    function toggleNav() {
        const sidebar = document.getElementById('navSidebar');
        const toggle = document.getElementById('navToggle');
        const main = document.getElementById('mainContent');
        sidebar.classList.toggle('collapsed');
        toggle.classList.toggle('collapsed');
        main.classList.toggle('expanded');
    }

    // ============ OUTPUT HELPER ============
    function output(elementId, text, type = 'success') {
        const el = document.getElementById(elementId);
        el.innerHTML += `<span class="output-${type}">${text}</span>\n`;
    }

    function clearOutput(elementId) {
        document.getElementById(elementId).innerHTML = '';
    }

    // ============ DEMO RUNNERS ============
    function runDemo1() {
        clearOutput('demo1-output');
        output('demo1-output', 'üåç Global scope variables:', 'info');
        
        var globalVar = "I'm global! Everyone can see me! üåç";
        
        function myFunction() {
            var functionVar = "I'm function-scoped! Only visible inside this function üì¶";
            
            output('demo1-output', '  ‚úÖ globalVar: ' + globalVar, 'success');
            output('demo1-output', '  ‚úÖ functionVar: ' + functionVar, 'success');
            
            if (true) {
                let blockVar = "I'm block-scoped! Only visible inside these curly braces üß±";
                output('demo1-output', '  ‚úÖ blockVar (inside block): ' + blockVar, 'success');
                output('demo1-output', '  ‚úÖ functionVar (from block): ' + functionVar, 'success');
                output('demo1-output', '  ‚úÖ globalVar (from block): ' + globalVar, 'success');
            }
            
            try {
                // blockVar is not accessible here
                output('demo1-output', '  ‚ùå blockVar (outside block): ' + blockVar, 'error');
            } catch(e) {
                output('demo1-output', '  ‚ùå blockVar (outside block): ReferenceError - not accessible!', 'error');
            }
        }
        
        myFunction();
        
        try {
            output('demo1-output', '  ‚ùå functionVar (outside function): ' + functionVar, 'error');
        } catch(e) {
            output('demo1-output', '  ‚ùå functionVar (outside function): ReferenceError - not accessible!', 'error');
        }
    }

    function runBankDemo() {
        clearOutput('bank-output');
        
        function createBankAccount(initialBalance) {
            let balance = initialBalance;
            let pin = "1234";
            
            return {
                getBalance() { return balance; },
                deposit(amount) {
                    if (amount > 0) { balance += amount; }
                },
                withdraw(amount, userPin) {
                    if (userPin === pin && amount <= balance) {
                        balance -= amount;
                        return amount;
                    }
                    return "Access denied!";
                }
            };
        }
        
        const account = createBankAccount(1000);
        output('bank-output', 'üí∞ Initial balance: $' + account.getBalance(), 'info');
        account.deposit(500);
        output('bank-output', 'üí≥ Deposited $500. Balance: $' + account.getBalance(), 'success');
        const withdrawn = account.withdraw(200, "1234");
        output('bank-output', 'üèß Withdrew $' + withdrawn + '. Balance: $' + account.getBalance(), 'success');
        const denied = account.withdraw(200, "wrong");
        output('bank-output', 'üîí Wrong PIN: ' + denied, 'error');
        output('bank-output', '', 'info');
        output('bank-output', 'üîê Trying to access private variables directly:', 'warn');
        output('bank-output', '   account.balance ‚Üí ' + account.balance + ' (undefined - private!)', 'error');
        output('bank-output', '   account.pin ‚Üí ' + account.pin + ' (undefined - safe!)', 'error');
    }

    function runWindowDemo() {
        clearOutput('window-output');
        // Note: We'll simulate this since we don't want to actually pollute global scope
        output('window-output', 'üìù In browsers, var global ‚Üí added to window object', 'info');
        output('window-output', '   var myVar = "hello"  ‚Üí  window.myVar = "hello" ‚úÖ', 'success');
        output('window-output', '   let myLet = "world"  ‚Üí  window.myLet = undefined ‚ùå', 'warn');
        output('window-output', '   const myConst = "!"  ‚Üí  window.myConst = undefined ‚ùå', 'warn');
        output('window-output', '', 'info');
        output('window-output', 'üí° This is why let/const are safer - they don\'t clutter the window object!', 'info');
    }

    function runFunctionScopeDemo() {
        clearOutput('func-scope-output');
        
        function makeBreakfast() {
            var eggs = 3;
            let toast = 2;
            const coffee = "black";
            output('func-scope-output', `‚úÖ Inside function: Making ${eggs} eggs, ${toast} toast, and ${coffee} coffee`, 'success');
        }
        
        makeBreakfast();
        
        output('func-scope-output', '', 'info');
        output('func-scope-output', '‚ùå Trying to access from outside the function:', 'warn');
        try { eval('eggs'); } catch(e) { 
            output('func-scope-output', '   eggs ‚Üí ReferenceError (not accessible)', 'error');
        }
        try { eval('toast_test_var'); } catch(e) { 
            output('func-scope-output', '   toast ‚Üí ReferenceError (not accessible)', 'error');
        }
        try { eval('coffee_test_var'); } catch(e) { 
            output('func-scope-output', '   coffee ‚Üí ReferenceError (not accessible)', 'error');
        }
    }

    function runCounterDemo() {
        clearOutput('counter-output');
        
        function counter() {
            let count = 0;
            count++;
            return count;
        }
        
        output('counter-output', 'Call 1: count = ' + counter(), 'info');
        output('counter-output', 'Call 2: count = ' + counter(), 'info');
        output('counter-output', 'Call 3: count = ' + counter(), 'info');
        output('counter-output', '', 'info');
        output('counter-output', 'üí° Each call creates a NEW scope with a fresh "count" variable!', 'warn');
        output('counter-output', '   The old count is garbage collected when the function ends.', 'warn');
    }

    function runNestedDemo() {
        clearOutput('nested-output');
        
        function outer() {
            let x = 10;
            output('nested-output', 'üì¶ outer() - x = ' + x, 'info');
            
            function inner() {
                let y = 20;
                output('nested-output', '  üì¶ inner() - x + y = ' + (x + y) + ' (inner can see outer\'s x!)', 'success');
            }
            
            inner();
            
            output('nested-output', 'üì¶ outer() - trying to access y...', 'warn');
            output('nested-output', '  ‚ùå y is not accessible here (inner scope only)', 'error');
        }
        
        outer();
    }

    function runBlockVarDemo() {
        clearOutput('block-var-output');
        
        if (true) {
            var x = "I LEAK OUT! üíß (var)";
            let y = "I stay inside! üîí (let)";
            // const z would also stay inside
            output('block-var-output', 'üì¶ Inside block:', 'info');
            output('block-var-output', '  var x = "' + x + '"', 'success');
            output('block-var-output', '  let y = "' + y + '"', 'success');
        }
        
        output('block-var-output', '', 'info');
        output('block-var-output', 'üîç Outside block:', 'warn');
        output('block-var-output', '  ‚úÖ x (var): "' + x + '"  ‚Üê LEAKED OUT!', 'error');
        try {
            eval('y_test');
        } catch(e) {
            output('block-var-output', '  ‚ùå y (let): ReferenceError  ‚Üê Properly contained!', 'success');
        }
    }

    function runLoopDemo() {
        clearOutput('loop-output');
        output('loop-output', '‚è≥ Running... (callbacks fire after 100ms & 200ms)', 'info');
        output('loop-output', '', 'info');
        
        // var version
        for (var i = 0; i < 3; i++) {
            setTimeout(function() {
                output('loop-output', '‚ùå var i = ' + i + '  (all show 3!)', 'error');
            }, 100);
        }
        
        // let version
        for (let j = 0; j < 3; j++) {
            setTimeout(function() {
                output('loop-output', '‚úÖ let j = ' + j + '  (correct!)', 'success');
            }, 250);
        }
    }

    function runVarLetConstDemo() {
        clearOutput('vlc-output');
        
        const API_KEY = "abc123";
        const MAX_ITEMS = 50;
        const user = { name: "Alice" };
        
        output('vlc-output', 'üìå const API_KEY = "' + API_KEY + '"', 'info');
        output('vlc-output', 'üìå const MAX_ITEMS = ' + MAX_ITEMS, 'info');
        output('vlc-output', 'üìå const user = { name: "' + user.name + '" }', 'info');
        
        user.name = "Bob";
        output('vlc-output', '', 'info');
        output('vlc-output', '‚úÖ user.name = "Bob" ‚Üí Works! (changing property, not reference)', 'success');
        output('vlc-output', '   user is now: { name: "' + user.name + '" }', 'success');
        
        output('vlc-output', '', 'info');
        output('vlc-output', '‚ùå user = {} ‚Üí Would throw TypeError (can\'t reassign const)', 'error');
        
        let score = 0;
        score += 10;
        output('vlc-output', '', 'info');
        output('vlc-output', '‚úÖ let score = 0; score += 10; ‚Üí score is now ' + score, 'success');
    }

    function runChainDemo() {
        clearOutput('chain-output');
        
        let planet = "Earth";
        
        function country() {
            let countryName = "Japan";
            
            function city() {
                let cityName = "Tokyo";
                
                function street() {
                    let streetName = "Shibuya";
                    
                    output('chain-output', 'üîç Looking for streetName ‚Üí Found in current scope (street) ‚úÖ', 'success');
                    output('chain-output', 'üîç Looking for cityName ‚Üí Not here, go up to city() ‚Üí Found! ‚úÖ', 'success');
                    output('chain-output', 'üîç Looking for countryName ‚Üí Not here, go up to city(), then country() ‚Üí Found! ‚úÖ', 'success');
                    output('chain-output', 'üîç Looking for planet ‚Üí Not here, go up to city(), country(), then global ‚Üí Found! ‚úÖ', 'success');
                    output('chain-output', '', 'info');
                    output('chain-output', `üìç ${streetName}, ${cityName}, ${countryName}, ${planet}`, 'info');
                }
                street();
            }
            city();
        }
        country();
    }

    function runShadowDemo() {
        clearOutput('shadow-output');
        
        let color = "red";
        output('shadow-output', 'üåç Global: color = "' + color + '"', 'info');
        
        function paint() {
            let color = "blue";
            output('shadow-output', '  üì¶ paint(): color = "' + color + '" (shadows global)', 'warn');
            
            function detail() {
                let color = "green";
                output('shadow-output', '    üì¶ detail(): color = "' + color + '" (shadows paint\'s)', 'warn');
            }
            detail();
        }
        
        paint();
        output('shadow-output', 'üåç Global (after): color = "' + color + '" (unchanged!)', 'success');
    }

    function runHoistingDemo() {
        clearOutput('hoist-output');
        
        output('hoist-output', 'üìù Testing var hoisting:', 'info');
        // Simulate hoisting behavior
        output('hoist-output', '  console.log(myVar) before declaration ‚Üí undefined', 'warn');
        output('hoist-output', '  (var is hoisted and initialized as undefined)', 'warn');
        
        output('hoist-output', '', 'info');
        output('hoist-output', 'üìù Testing let hoisting:', 'info');
        output('hoist-output', '  console.log(myLet) before declaration ‚Üí üí• ReferenceError!', 'error');
        output('hoist-output', '  (let is in the Temporal Dead Zone until its declaration)', 'error');
        
        output('hoist-output', '', 'info');
        output('hoist-output', 'üìù After declarations:', 'info');
        var myVar = "hello";
        let myLet = "world";
        output('hoist-output', '  myVar = "' + myVar + '" ‚úÖ', 'success');
        output('hoist-output', '  myLet = "' + myLet + '" ‚úÖ', 'success');
    }

    function runFuncHoistDemo() {
        clearOutput('func-hoist-output');
        
        // Function declaration - hoisted
        try {
            sayHello();
            function sayHello() {
                output('func-hoist-output', '‚úÖ Function DECLARATION works before its line! "Hello!"', 'success');
            }
        } catch(e) {
            output('func-hoist-output', '‚ùå ' + e.message, 'error');
        }
        
        output('func-hoist-output', '', 'info');
        
        // Function expression - not hoisted
        output('func-hoist-output', '‚ùå Function EXPRESSION (var sayGoodbye = function()...) ‚Üí TypeError!', 'error');
        output('func-hoist-output', '   Because var is hoisted as undefined, and undefined() is not a function', 'error');
        
        output('func-hoist-output', '', 'info');
        
        output('func-hoist-output', '‚ùå Arrow function (const greet = () => ...) ‚Üí ReferenceError!', 'error');
        output('func-hoist-output', '   Because const is in the Temporal Dead Zone', 'error');
    }

    function runClosureDemo() {
        clearOutput('closure-output');
        
        function createGreeter(greeting) {
            return function(name) {
                output('closure-output', `${greeting}, ${name}!`, 'success');
            };
        }
        
        const sayHello = createGreeter("Hello");
        const sayHola = createGreeter("Hola");
        const sayBonjour = createGreeter("Bonjour");
        
        output('closure-output', 'üìù Created 3 greeters with different greetings:', 'info');
        output('closure-output', '', 'info');
        sayHello("Alice");
        sayHola("Bob");
        sayBonjour("Charlie");
        output('closure-output', '', 'info');
        output('closure-output', 'üí° Each function "remembers" its own greeting via closure!', 'warn');
    }

    function runCounterClosureDemo() {
        clearOutput('counter-closure-output');
        
        function createCounter() {
            let count = 0;
            return {
                increment() { count++; return count; },
                decrement() { count--; return count; },
                getCount() { return count; }
            };
        }
        
        const counter = createCounter();
        output('counter-closure-output', 'üßÆ Counter created with private count = 0', 'info');
        output('counter-closure-output', '  increment() ‚Üí ' + counter.increment(), 'success');
        output('counter-closure-output', '  increment() ‚Üí ' + counter.increment(), 'success');
        output('counter-closure-output', '  increment() ‚Üí ' + counter.increment(), 'success');
        output('counter-closure-output', '  decrement() ‚Üí ' + counter.decrement(), 'warn');
        output('counter-closure-output', '  getCount()  ‚Üí ' + counter.getCount(), 'info');
        output('counter-closure-output', '', 'info');
        output('counter-closure-output', 'üîí counter.count ‚Üí ' + counter.count + ' (private!)', 'error');
    }

    function runCartDemo() {
        clearOutput('cart-output');
        
        function createCart() {
            const items = [];
            return {
                addItem(name, price) {
                    items.push({ name, price });
                    output('cart-output', `  ‚ûï Added: ${name} ($${price})`, 'success');
                },
                getTotal() {
                    return items.reduce((sum, item) => sum + item.price, 0);
                },
                showCart() {
                    output('cart-output', 'üõí Cart: ' + items.map(i => i.name).join(', '), 'info');
                    output('cart-output', 'üí∞ Total: $' + this.getTotal(), 'info');
                }
            };
        }
        
        const cart = createCart();
        output('cart-output', 'üõí New shopping cart created:', 'info');
        cart.addItem("Laptop", 999);
        cart.addItem("Mouse", 29);
        cart.addItem("Keyboard", 79);
        output('cart-output', '', 'info');
        cart.showCart();
    }

    function runAuthDemo() {
        clearOutput('auth-output');
        
        const AuthModule = (function() {
            let currentUser = null;
            let token = null;
            let loginAttempts = 0;
            const MAX_ATTEMPTS = 3;
            
            function validatePassword(password) {
                return password.length >= 8;
            }
            
            return {
                login(username, password) {
                    if (loginAttempts >= MAX_ATTEMPTS) {
                        return "Account locked! Too many attempts.";
                    }
                    if (validatePassword(password)) {
                        currentUser = username;
                        token = "jwt_" + Math.random().toString(36).substr(2, 9);
                        loginAttempts = 0;
                        return `Welcome, ${username}! Token: ${token}`;
                    }
                    loginAttempts++;
                    return `Login failed. ${MAX_ATTEMPTS - loginAttempts} attempts left.`;
                },
                logout() {
                    currentUser = null;
                    token = null;
                    return "Logged out successfully.";
                },
                isLoggedIn() {
                    return currentUser !== null;
                }
            };
        })();
        
        output('auth-output', 'üîê Auth Module Demo:', 'info');
        output('auth-output', '  ' + AuthModule.login("alice", "short"), 'error');
        output('auth-output', '  ' + AuthModule.login("alice", "mypassword123"), 'success');
        output('auth-output', '  Is logged in: ' + AuthModule.isLoggedIn(), 'info');
        output('auth-output', '  ' + AuthModule.logout(), 'warn');
        output('auth-output', '  Is logged in: ' + AuthModule.isLoggedIn(), 'info');
        output('auth-output', '', 'info');
        output('auth-output', 'üîí Trying to access private data:', 'warn');
        output('auth-output', '  AuthModule.token ‚Üí ' + AuthModule.token + ' (hidden!)', 'error');
        output('auth-output', '  AuthModule.currentUser ‚Üí ' + AuthModule.currentUser + ' (hidden!)', 'error');
    }

    function runRateLimiterDemo() {
        clearOutput('rate-output');
        
        function createRateLimiter(maxCalls, timeWindow) {
            let calls = [];
            return function(apiCall) {
                const now = Date.now();
                calls = calls.filter(time => now - time < timeWindow);
                if (calls.length < maxCalls) {
                    calls.push(now);
                    output('rate-output', `‚úÖ API call allowed (${calls.length}/${maxCalls})`, 'success');
                    return apiCall();
                } else {
                    output('rate-output', `‚ùå Rate limited! (${calls.length}/${maxCalls}) Try again later.`, 'error');
                    return null;
                }
            };
        }
        
        const limitedFetch = createRateLimiter(3, 5000);
        output('rate-output', 'üì° Rate limiter: max 3 calls per 5 seconds', 'info');
        output('rate-output', '', 'info');
        limitedFetch(() => "data1");
        limitedFetch(() => "data2");
        limitedFetch(() => "data3");
        limitedFetch(() => "data4");
        limitedFetch(() => "data5");
    }

    function runMemoDemo() {
        clearOutput('memo-output');
        
        function memoize(fn) {
            const cache = {};
            return function(...args) {
                const key = JSON.stringify(args);
                if (cache[key] !== undefined) {
                    output('memo-output', `‚ö° Cache HIT for (${args}) ‚Üí ${cache[key]}`, 'success');
                    return cache[key];
                }
                output('memo-output', `üîÑ Computing for (${args})...`, 'warn');
                const result = fn(...args);
                cache[key] = result;
                output('memo-output', `   Result: ${result} (cached!)`, 'info');
                return result;
            };
        }
        
        const expensiveSquare = memoize(function(n) {
            return n * n;
        });
        
        output('memo-output', 'üìù Memoized square function:', 'info');
        output('memo-output', '', 'info');
        expensiveSquare(5);
        expensiveSquare(5);
        expensiveSquare(10);
        expensiveSquare(10);
        expensiveSquare(5);
    }

    function runPitfall1() {
        clearOutput('pitfall1-output');
        output('pitfall1-output', '‚è≥ Running... watch the output in 200ms', 'info');
        output('pitfall1-output', '', 'info');
        
        for (var i = 0; i < 5; i++) {
            setTimeout(function() {
                output('pitfall1-output', '‚ùå var i = ' + i, 'error');
            }, 100);
        }
        
        setTimeout(function() {
            output('pitfall1-output', '', 'info');
            output('pitfall1-output', '--- Now with let ---', 'info');
        }, 150);
        
        for (let j = 0; j < 5; j++) {
            setTimeout(function() {
                output('pitfall1-output', '‚úÖ let j = ' + j, 'success');
            }, 200);
        }
    }

    function runPitfall2() {
        clearOutput('pitfall2-output');
        
        // Demonstrate the accidental global
        function processOrder() {
            total_demo = 0;  // intentionally no keyword for demo
            for (let i = 0; i < 5; i++) {
                subtotal_demo = i * 10;
                total_demo += subtotal_demo;
            }
        }
        
        processOrder();
        output('pitfall2-output', 'üò± After processOrder():', 'warn');
        output('pitfall2-output', '  total_demo (leaked global) = ' + total_demo, 'error');
        output('pitfall2-output', '  subtotal_demo (leaked global) = ' + subtotal_demo, 'error');
        output('pitfall2-output', '', 'info');
        output('pitfall2-output', 'üí° These should NOT be accessible outside the function!', 'warn');
        output('pitfall2-output', '   Always use let/const to prevent this.', 'info');
        
        // Clean up
        delete window.total_demo;
        delete window.subtotal_demo;
    }

    function runPitfall4() {
        clearOutput('pitfall4-output');
        
        let user = "Alice";
        output('pitfall4-output', 'üåç Global user = "' + user + '"', 'info');
        
        function updateUser() {
            let user = "Bob";  // Creates NEW local variable!
            output('pitfall4-output', 'üì¶ Inside updateUser(): user = "' + user + '"', 'warn');
        }
        
        updateUser();
        output('pitfall4-output', 'üåç After updateUser(): user = "' + user + '"', 'info');
        output('pitfall4-output', '', 'info');
        output('pitfall4-output', 'üò± Global user is STILL "Alice"!', 'error');
        output('pitfall4-output', '   The "let user" inside created a NEW variable,', 'error');
        output('pitfall4-output', '   it did NOT modify the outer one!', 'error');
    }

    // ============ QUIZ SYSTEM ============
    function checkQuiz(quizId, element, isCorrect) {
        const container = document.getElementById(quizId);
        const options = container.querySelectorAll('.quiz-option');
        
        options.forEach(opt => {
            opt.classList.add('disabled');
        });
        
        if (isCorrect) {
            element.classList.add('correct');
            document.getElementById(quizId + '-correct').classList.add('show');
        } else {
            element.classList.add('wrong');
            // Find and highlight correct answer
            options.forEach(opt => {
                if (opt.onclick && opt.onclick.toString().includes('true')) {
                    opt.classList.add('correct');
                }
            });
            document.getElementById(quizId + '-wrong').classList.add('show');
        }
    }

    // ============ FINAL QUIZ ============
    const finalQuizQuestions = [
        {
            question: 'What is the output?\n\nvar x = 1;\nfunction test() {\n  console.log(x);\n  var x = 2;\n}\ntest();',
            options: ['1', '2', 'undefined', 'ReferenceError'],
            correct: 2,
            explanation: 'var x inside the function is hoisted to the top of the function scope as "var x; // undefined". So when console.log(x) runs, the local hoisted x is undefined, shadowing the global x.'
        },
        {
            question: 'Which keyword does NOT create block scope?',
            options: ['let', 'const', 'var', 'All create block scope'],
            correct: 2,
            explanation: 'var is function-scoped, not block-scoped. It ignores blocks like if, for, while. Only let and const are block-scoped.'
        },
        {
            question: 'What is a closure?',
            options: [
                'A way to close a function',
                'A function that remembers variables from its outer scope',
                'A method to prevent memory leaks',
                'A type of loop'
            ],
            correct: 1,
            explanation: 'A closure is a function that retains access to variables from its parent/outer scope even after the parent function has finished executing.'
        },
        {
            question: 'What does this output?\n\nfor (let i = 0; i < 3; i++) {\n  setTimeout(() => console.log(i), 100);\n}',
            options: ['3, 3, 3', '0, 1, 2', 'undefined, undefined, undefined', 'Error'],
            correct: 1,
            explanation: 'With "let", each loop iteration creates a new block-scoped "i". Each setTimeout callback captures its own "i", so it correctly prints 0, 1, 2.'
        },
        {
            question: 'What is the Temporal Dead Zone (TDZ)?',
            options: [
                'The time it takes for JavaScript to execute',
                'The period between scope start and let/const declaration where the variable cannot be accessed',
                'A place where deleted variables go',
                'The gap between function calls'
            ],
            correct: 1,
            explanation: 'The TDZ is the region from the start of a block scope until the let/const declaration is reached. Accessing the variable during this period throws a ReferenceError.'
        },
        {
            question: 'What happens when you assign a value without var, let, or const?\n\nfunction test() {\n  oops = "hello";\n}',
            options: [
                'Creates a local variable',
                'Creates a global variable (accidental!)',
                'Throws a ReferenceError',
                'Nothing happens'
            ],
            correct: 1,
            explanation: 'Without strict mode, assigning without a keyword creates an implicit global variable. This is a common bug! Use "use strict" to catch this error.'
        },
        {
            question: 'What is the output?\n\nconst obj = { a: 1 };\nobj.a = 2;\nconsole.log(obj.a);',
            options: ['1', '2', 'TypeError', 'undefined'],
            correct: 1,
            explanation: 'const prevents reassigning the variable (obj = ...), but it does NOT make the object immutable. You can still modify properties of a const object. obj.a = 2 is perfectly valid.'
        },
        {
            question: 'How does the scope chain search work?',
            options: [
                'Global ‚Üí Function ‚Üí Block (outer to inner)',
                'Current scope ‚Üí Parent ‚Üí Grandparent ‚Üí ... ‚Üí Global (inner to outer)',
                'Randomly checks all scopes',
                'Only checks the current scope'
            ],
            correct: 1,
            explanation: 'JavaScript looks for a variable starting from the current (innermost) scope and works outward through parent scopes until it reaches global scope. If not found anywhere, it throws a ReferenceError.'
        },
        {
            question: 'What is the output?\n\nfunction outer() {\n  let x = 10;\n  function inner() {\n    let x = 20;\n    console.log(x);\n  }\n  inner();\n  console.log(x);\n}  \nouter();',
            options: ['10, 10', '20, 20', '20, 10', '10, 20'],
            correct: 2,
            explanation: 'Inside inner(), the local x = 20 shadows the outer x = 10. So inner\'s console.log prints 20. After inner() finishes, outer\'s console.log sees its own x = 10 (unchanged). Variable shadowing does NOT modify the outer variable.'
        },
        {
            question: 'Which is the BEST modern practice?',
            options: [
                'Use var for everything',
                'Use let for everything',
                'Use const by default, let when reassignment needed, never var',
                'Use global variables for easy access'
            ],
            correct: 2,
            explanation: 'Modern best practice: const by default (signals immutable reference), let when you need to reassign (loops, accumulators), never var (legacy, function-scoped, hoisting bugs).'
        }
    ];

    let finalQuizAnswers = {};
    let finalQuizGenerated = false;

    function generateFinalQuiz() {
        if (finalQuizGenerated) return;
        finalQuizGenerated = true;
        
        const container = document.getElementById('final-quiz-container');
        container.innerHTML = '';
        
        finalQuizQuestions.forEach((q, index) => {
            const quizHTML = `
                <div class="quiz-container" id="final-q-${index}" style="margin-bottom: 20px;">
                    <div class="quiz-question">
                        <span class="question-number">Question ${index + 1} of ${finalQuizQuestions.length}:</span>
                        <pre class="code-block" style="margin-top:10px; white-space:pre-wrap;">${q.question}</pre>
                    </div>
                    <div class="quiz-options">
                        ${q.options.map((opt, optIndex) => `
                            <div class="quiz-option" onclick="answerFinalQuiz(${index}, ${optIndex}, this)">
                                ${String.fromCharCode(65 + optIndex)}) ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div class="quiz-explanation" id="final-q-${index}-exp" style="display:none;">
                        ${q.explanation}
                    </div>
                </div>
            `;
            container.innerHTML += quizHTML;
        });
        
        container.innerHTML += `
            <div style="text-align:center; margin-top:30px;">
                <button class="run-btn" onclick="submitFinalQuiz()" id="submit-quiz-btn" style="font-size:1.2em; padding:15px 40px;">
                    üìä Submit & See Results
                </button>
            </div>
        `;
    }

    function answerFinalQuiz(questionIndex, optionIndex, element) {
        const container = document.getElementById(`final-q-${questionIndex}`);
        const options = container.querySelectorAll('.quiz-option');
        
        // Remove previous selection
        options.forEach(opt => opt.classList.remove('correct', 'wrong'));
        
        // Mark selected
        element.style.border = '2px solid #6c5ce7';
        element.style.background = 'rgba(108, 92, 231, 0.2)';
        
        // Reset others
        options.forEach((opt, idx) => {
            if (idx !== optionIndex) {
                opt.style.border = '2px solid #1a1a5e';
                opt.style.background = '#0a0a2e';
            }
        });
        
        finalQuizAnswers[questionIndex] = optionIndex;
    }

    function submitFinalQuiz() {
        let score = 0;
        
        finalQuizQuestions.forEach((q, index) => {
            const container = document.getElementById(`final-q-${index}`);
            const options = container.querySelectorAll('.quiz-option');
            const expEl = document.getElementById(`final-q-${index}-exp`);
            
            options.forEach(opt => opt.classList.add('disabled'));
            
            if (finalQuizAnswers[index] === q.correct) {
                score++;
                options[q.correct].classList.add('correct');
                expEl.style.display = 'block';
                expEl.className = 'quiz-explanation show correct-exp';
                expEl.innerHTML = '‚úÖ Correct! ' + q.explanation;
            } else {
                if (finalQuizAnswers[index] !== undefined) {
                    options[finalQuizAnswers[index]].classList.add('wrong');
                }
                options[q.correct].classList.add('correct');
                expEl.style.display = 'block';
                expEl.className = 'quiz-explanation show wrong-exp';
                expEl.innerHTML = '‚ùå ' + q.explanation;
            }
        });
        
        // Show results
        const resultsDiv = document.getElementById('quiz-results');
        resultsDiv.classList.remove('hidden');
        
        const scoreCircle = document.getElementById('score-circle');
        const scoreText = document.getElementById('score-text');
        const scoreMessage = document.getElementById('score-message');
        
        scoreText.textContent = `${score}/${finalQuizQuestions.length}`;
        
        const pct = (score / finalQuizQuestions.length) * 100;
        
        if (pct >= 80) {
            scoreCircle.className = 'score-circle excellent';
            scoreMessage.innerHTML = 'üéâ <strong>Excellent!</strong> You\'ve mastered JavaScript scope! You\'re ready to write clean, bug-free code.';
        } else if (pct >= 50) {
            scoreCircle.className = 'score-circle good';
            scoreMessage.innerHTML = 'üëç <strong>Good job!</strong> You have a solid understanding. Review the sections for the questions you missed.';
        } else {
            scoreCircle.className = 'score-circle needs-work';
            scoreMessage.innerHTML = 'üìö <strong>Keep learning!</strong> Go through the sections again, especially the ones with visual diagrams. You\'ll get it!';
        }
        
        // Hide submit button
        document.getElementById('submit-quiz-btn').style.display = 'none';
        
        // Scroll to results
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
    }

    function resetFinalQuiz() {
        finalQuizGenerated = false;
        finalQuizAnswers = {};
        document.getElementById('quiz-results').classList.add('hidden');
        generateFinalQuiz();
    }

    // ============ PLAYGROUND ============
    function runPlayground(textareaId, outputId) {
        clearOutput(outputId);
        const code = document.getElementById(textareaId).value;
        
        const originalLog = console.log;
        console.log = function(...args) {
            output(outputId, args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' '), 'success');
        };
        
        try {
            eval(code);
        } catch(e) {
            output(outputId, '‚ùå ' + e.name + ': ' + e.message, 'error');
        }
        
        console.log = originalLog;
    }

    // Initialize
    updateProgress();
</script>

</body>
</html>