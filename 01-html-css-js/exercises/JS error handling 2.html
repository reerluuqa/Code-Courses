<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Error Handling Mastery - Interactive Dojo</title>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --accent-primary: #06b6d4;
            --accent-secondary: #8b5cf6;
            --accent-danger: #ef4444;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #475569;
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1a1f2e 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Background Animation */
        .bg-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--accent-primary);
            border-radius: 50%;
            opacity: 0.3;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from { transform: translateY(100vh) translateX(0); }
            to { transform: translateY(-10vh) translateX(100px); }
        }

        /* Layout */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        /* Sidebar */
        .sidebar {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--border-color);
            padding: 2rem 1.5rem;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tagline {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .progress-container {
            background: var(--bg-tertiary);
            height: 8px;
            border-radius: 4px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            text-align: right;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transform: translateX(5px);
        }

        .nav-link.active {
            background: rgba(6, 182, 212, 0.1);
            color: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .nav-link.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            margin-right: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Main Content */
        .main-content {
            padding: 2rem;
            overflow-y: auto;
            height: 100vh;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-subtitle {
            color: var(--text-secondary);
            font-size: 1.125rem;
        }

        /* Cards */
        .card {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .card-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Code Blocks */
        .code-container {
            background: #0d1117;
            border-radius: 8px;
            border: 1px solid #30363d;
            margin: 1rem 0;
            overflow: hidden;
        }

        .code-header {
            background: #161b22;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #30363d;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .code-block {
            padding: 1.5rem;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre;
            color: #e6edf3;
        }

        .keyword { color: #ff7b72; }
        .function { color: #d2a8ff; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; }
        .number { color: #79c0ff; }
        .operator { color: #ff7b72; }

        /* Interactive Elements */
        .interactive-demo {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px solid var(--accent-primary);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(6, 182, 212, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-danger);
            border: 1px solid var(--accent-danger);
        }

        .btn-success {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-success);
            border: 1px solid var(--accent-success);
        }

        /* Visual Flow Diagram */
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .flow-box {
            padding: 1rem 2rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            position: relative;
            transition: all 0.3s;
        }

        .flow-try { background: rgba(6, 182, 212, 0.2); border: 2px solid var(--accent-primary); }
        .flow-catch { background: rgba(239, 68, 68, 0.2); border: 2px solid var(--accent-danger); }
        .flow-finally { background: rgba(139, 92, 246, 0.2); border: 2px solid var(--accent-secondary); }
        .flow-success { background: rgba(16, 185, 129, 0.2); border: 2px solid var(--accent-success); }

        .flow-arrow {
            font-size: 1.5rem;
            color: var(--text-secondary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; transform: translateX(0); }
            50% { opacity: 1; transform: translateX(5px); }
        }

        .flow-box.active {
            transform: scale(1.1);
            box-shadow: 0 0 20px currentColor;
        }

        /* Error Type Cards */
        .error-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .error-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .error-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--accent-danger);
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .error-card:hover::before {
            transform: scaleX(1);
        }

        .error-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-danger);
        }

        .error-name {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--accent-danger);
            margin-bottom: 0.5rem;
            font-family: monospace;
        }

        .error-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .error-example {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.85rem;
            color: #ff7b72;
        }

        /* Quiz Styles */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-question {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .quiz-option {
            padding: 1rem;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quiz-option:hover {
            border-color: var(--accent-primary);
            background: rgba(6, 182, 212, 0.1);
        }

        .quiz-option.selected {
            border-color: var(--accent-primary);
            background: rgba(6, 182, 212, 0.2);
        }

        .quiz-option.correct {
            border-color: var(--accent-success);
            background: rgba(16, 185, 129, 0.2);
        }

        .quiz-option.wrong {
            border-color: var(--accent-danger);
            background: rgba(239, 68, 68, 0.2);
        }

        .quiz-option input {
            display: none;
        }

        /* Exercise Area */
        .exercise-area {
            background: var(--bg-primary);
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .code-editor {
            width: 100%;
            min-height: 200px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 1rem;
            color: #e6edf3;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            resize: vertical;
        }

        .output-console {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            min-height: 100px;
            font-family: monospace;
            color: #0f0;
            overflow-y: auto;
            max-height: 300px;
        }

        .output-console.error {
            color: #f44;
        }

        /* Badge System */
        .badge-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }

        .badge {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(139, 92, 246, 0.2));
            border: 2px solid var(--accent-primary);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .badge.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 2px dotted var(--accent-primary);
            cursor: help;
        }

        .tooltip-text {
            visibility: hidden;
            background: var(--bg-secondary);
            color: var(--text-primary);
            text-align: center;
            padding: 0.5rem;
            border-radius: 6px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            border: 1px solid var(--border-color);
            font-size: 0.875rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Pitfall Warning */
        .pitfall {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(245, 158, 11, 0.1));
            border-left: 4px solid var(--accent-danger);
            padding: 1.5rem;
            border-radius: 0 8px 8px 0;
            margin: 1.5rem 0;
            position: relative;
        }

        .pitfall-title {
            color: var(--accent-danger);
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            .sidebar {
                height: auto;
                position: relative;
            }
            .main-content {
                height: auto;
            }
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--accent-primary);
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            z-index: 1000;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Syntax Highlighting for editable areas */
        .highlight-container {
            position: relative;
        }

        .highlight-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 1rem;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            pointer-events: none;
            white-space: pre-wrap;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div class="bg-particles" id="particles"></div>

    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo">
                <span>üõ°Ô∏è</span>
                <span>ErrorMaster</span>
            </div>
            <div class="tagline">Master JS Error Handling</div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">0% Complete</div>

            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link active" onclick="showSection('intro')">
                            <span class="nav-icon">üéØ</span>
                            <span>Start Here</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('trycatch')">
                            <span class="nav-icon">1</span>
                            <span>Try-Catch Deep Dive</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('finally')">
                            <span class="nav-icon">2</span>
                            <span>The Finally Block</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('error-types')">
                            <span class="nav-icon">3</span>
                            <span>Error Type Encyclopedia</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('throwing')">
                            <span class="nav-icon">4</span>
                            <span>Throwing & Custom Errors</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('debugging')">
                            <span class="nav-icon">5</span>
                            <span>Debugging Arsenal</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('pitfalls')">
                            <span class="nav-icon">‚ö†Ô∏è</span>
                            <span>Common Pitfalls</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('playground')">
                            <span class="nav-icon">üéÆ</span>
                            <span>Interactive Playground</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('quiz')">
                            <span class="nav-icon">üèÜ</span>
                            <span>Final Boss Quiz</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="badge-container" style="margin-top: 2rem;">
                <div class="badge locked" id="badge-starter">üå± Starter</div>
                <div class="badge locked" id="badge-catcher">ü•∑ Catcher</div>
                <div class="badge locked" id="badge-expert">üßô Expert</div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Intro Section -->
            <section id="intro" class="section active">
                <div class="section-header">
                    <h1 class="section-title">Welcome to Error Handling Mastery</h1>
                    <p class="section-subtitle">Your journey from fragile code to bulletproof applications starts here.</p>
                </div>

                <div class="card">
                    <div class="card-title">üöÄ Why This Matters for Your Career</div>
                    <p style="margin-bottom: 1rem;">Junior developers write code that works when everything goes right. <strong>Senior developers write code that handles everything going wrong.</strong></p>
                    <p>Mastering error handling demonstrates:</p>
                    <ul style="margin-left: 2rem; margin-top: 0.5rem; color: var(--text-secondary);">
                        <li>Production-ready thinking</li>
                        <li>User experience awareness</li>
                        <li>Debugging efficiency</li>
                        <li>System reliability engineering</li>
                    </ul>
                </div>

                <div class="interactive-demo">
                    <h3 style="margin-bottom: 1rem;">The Error Handling Promise</h3>
                    <p>Watch how proper error handling transforms user experience:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1.5rem;">
                        <div style="background: rgba(239, 68, 68, 0.1); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--accent-danger);">
                            <div style="font-weight: bold; color: var(--accent-danger); margin-bottom: 0.5rem;">‚ùå Without Error Handling</div>
                            <div style="font-family: monospace; font-size: 0.9rem; color: var(--text-secondary);">
                                App crashes<br>
                                White screen of death<br>
                                User loses data<br>
                                "Undefined is not a function"
                            </div>
                        </div>
                        <div style="background: rgba(16, 185, 129, 0.1); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--accent-success);">
                            <div style="font-weight: bold; color: var(--accent-success); margin-bottom: 0.5rem;">‚úÖ With Error Handling</div>
                            <div style="font-family: monospace; font-size: 0.9rem; color: var(--text-secondary);">
                                Graceful degradation<br>
                                Meaningful error messages<br>
                                Data integrity preserved<br>
                                Retry mechanisms
                            </div>
                        </div>
                    </div>

                    <div class="demo-controls">
                        <button class="btn btn-primary" onclick="showSection('trycatch')">Begin Training ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- Try-Catch Section -->
            <section id="trycatch" class="section">
                <div class="section-header">
                    <h1 class="section-title">Try-Catch: Your Safety Net</h1>
                    <p class="section-subtitle">The fundamental pattern for graceful error recovery.</p>
                </div>

                <div class="card">
                    <div class="card-title">üìä Execution Flow Visualization</div>
                    <div class="flow-diagram" id="flowDiagram">
                        <div class="flow-box flow-try" id="box-try">Try Block</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-success" id="box-success">Success!</div>
                        <div style="width: 100%; text-align: center; margin: 1rem 0; color: var(--text-secondary);">OR</div>
                        <div class="flow-box flow-try" id="box-try2">Try Block</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-catch" id="box-catch">Catch Block</div>
                    </div>
                    
                    <div class="demo-controls" style="justify-content: center;">
                        <button class="btn btn-secondary" onclick="simulateFlow('success')">Simulate Success</button>
                        <button class="btn btn-danger" onclick="simulateFlow('error')">Simulate Error</button>
                    </div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <span>The Anatomy</span>
                        <span class="tooltip">Why this works?
                            <span class="tooltip-text">JavaScript hoists the error object into the catch block when an exception occurs in try.</span>
                        </span>
                    </div>
                    <div class="code-block"><span class="keyword">try</span> {
    <span class="comment">// Code that might explode üí•</span>
    <span class="function">riskyOperation</span>();
    <span class="function">console</span>.<span class="function">log</span>(<span class="string">"This won't run if error occurs"</span>);
} <span class="keyword">catch</span> (error) {
    <span class="comment">// Graceful recovery üõ°Ô∏è</span>
    <span class="function">console</span>.<span class="function">error</span>(<span class="string">"Operation failed:"</span>, error.<span class="property">message</span>);
    <span class="function">showUserFriendlyMessage</span>();
} <span class="keyword">finally</span> {
    <span class="comment">// Always executes (we'll cover this next)</span>
    <span class="function">cleanup</span>();
}</div>
                </div>

                <div class="card">
                    <div class="card-title">üéØ The Error Object Deep Dive</div>
                    <p style="margin-bottom: 1rem;">When an error is caught, you get an object with these properties:</p>
                    
                    <div class="code-container">
                        <div class="code-block"><span class="keyword">try</span> {
    <span class="function">undefinedFunction</span>();
} <span class="keyword">catch</span> (err) {
    <span class="function">console</span>.<span class="function">log</span>(err.<span class="property">name</span>);        <span class="comment">// "ReferenceError"</span>
    <span class="function">console</span>.<span class="function">log</span>(err.<span class="property">message</span>);     <span class="comment">// "undefinedFunction is not defined"</span>
    <span class="function">console</span>.<span class="function">log</span>(err.<span class="property">stack</span>);       <span class="comment">// Stack trace for debugging</span>
    <span class="function">console</span>.<span class="function">log</span>(err <span class="keyword">instanceof</span> <span class="function">Error</span>); <span class="comment">// true</span>
}</div>
                    </div>
                </div>

                <div class="exercise-area">
                    <h3 style="margin-bottom: 1rem;">üí™ Practice: Fix This Code</h3>
                    <p style="margin-bottom: 1rem;">The function below crashes when the user is not found. Wrap it in try-catch to handle the error gracefully.</p>
                    
                    <textarea class="code-editor" id="exercise1">function getUserData(userId) {
    const user = database.find(userId);
    return user.name; // Crashes if user is undefined!
}

// Your code here:
console.log(getUserData(999));</textarea>
                    
                    <div class="demo-controls">
                        <button class="btn btn-primary" onclick="checkExercise1()">Check Solution</button>
                        <button class="btn btn-secondary" onclick="showHint(1)">Need a Hint?</button>
                    </div>
                    <div id="hint1" style="display: none; margin-top: 1rem; color: var(--accent-warning);">
                        Hint: Wrap the function body in try-catch. Return null or a default message in the catch block.
                    </div>
                </div>
            </section>

            <!-- Finally Section -->
            <section id="finally" class="section">
                <div class="section-header">
                    <h1 class="section-title">The Finally Block</h1>
                    <p class="section-subtitle">Guaranteed execution, no matter what happens.</p>
                </div>

                <div class="card">
                    <div class="card-title">‚ö° The Guarantee</div>
                    <p style="margin-bottom: 1.5rem;">Finally executes whether your code succeeds, fails, or even returns early. This makes it perfect for cleanup operations.</p>
                    
                    <div class="flow-diagram">
                        <div class="flow-box flow-try">Try (Success)</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-finally">Finally</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-success">Return</div>
                    </div>
                    
                    <div class="flow-diagram" style="margin-top: 1rem;">
                        <div class="flow-box flow-try">Try (Error)</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-catch">Catch</div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-box flow-finally">Finally</div>
                    </div>
                </div>

                <div class="pitfall">
                    <div class="pitfall-title">‚ö†Ô∏è The Return Value Trap</div>
                    <p>If <code>finally</code> contains a return statement, it will override any return from try or catch!</p>
                    
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block"><span class="keyword">function</span> <span class="function">tricky</span>() {
    <span class="keyword">try</span> {
        <span class="keyword">return</span> <span class="string">"try"</span>;
    } <span class="keyword">finally</span> {
        <span class="keyword">return</span> <span class="string">"finally"</span>; <span class="comment">// This wins!</span>
    }
}

<span class="function">console</span>.<span class="function">log</span>(<span class="function">tricky</span>()); <span class="comment">// "finally" (not "try"!)</span></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üéØ Real-World Pattern: Resource Cleanup</div>
                    <div class="code-container">
                        <div class="code-block"><span class="keyword">async function</span> <span class="function">fetchWithLoading</span>() {
    <span class="keyword">const</span> loader = <span class="function">showLoadingSpinner</span>();
    
    <span class="keyword">try</span> {
        <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'/api/data'</span>);
        <span class="keyword">return</span> <span class="keyword">await</span> data.<span class="function">json</span>();
    } <span class="keyword">catch</span> (error) {
        <span class="function">showError</span>(error);
        <span class="keyword">throw</span> error; <span class="comment">// Re-throw after logging</span>
    } <span class="keyword">finally</span> {
        loader.<span class="function">hide</span>(); <span class="comment">// Always hide, success or fail!</span>
    }
}</div>
                    </div>
                </div>
            </section>

            <!-- Error Types Section -->
            <section id="error-types" class="section">
                <div class="section-header">
                    <h1 class="section-title">The Error Family Tree</h1>
                    <p class="section-subtitle">Know your enemies. Each error type reveals a specific kind of bug.</p>
                </div>

                <div class="error-grid">
                    <div class="error-card" onclick="showErrorDetail('syntax')">
                        <div class="error-name">SyntaxError</div>
                        <div class="error-desc">You broke the grammar rules. Code won't even run.</div>
                        <div class="error-example">JSON.parse("{bad json}")</div>
                    </div>

                    <div class="error-card" onclick="showErrorDetail('reference')">
                        <div class="error-name">ReferenceError</div>
                        <div class="error-desc">Variable doesn't exist or not yet defined (TDZ).</div>
                        <div class="error-example">console.log(undefinedVar)</div>
                    </div>

                    <div class="error-card" onclick="showErrorDetail('type')">
                        <div class="error-name">TypeError</div>
                        <div class="error-desc">Wrong type operation. null.property or undefined.method</div>
                        <div class="error-example">null.toString()</div>
                    </div>

                    <div class="error-card" onclick="showErrorDetail('range')">
                        <div class="error-name">RangeError</div>
                        <div class="error-desc">Value not in allowed range. Stack overflow or invalid length.</div>
                        <div class="error-example">(123).toFixed(101)</div>
                    </div>

                    <div class="error-card" onclick="showErrorDetail('uri')">
                        <div class="error-name">URIError</div>
                        <div class="error-desc">Invalid encode/decode URI operations.</div>
                        <div class="error-example">decodeURI('%')</div>
                    </div>

                    <div class="error-card" onclick="showErrorDetail('aggregate')">
                        <div class="error-name">AggregateError</div>
                        <div class="error-desc">Multiple errors wrapped into one (Promise.any).</div>
                        <div class="error-example">Promise.any([Promise.reject()])</div>
                    </div>
                </div>

                <div id="error-detail" class="card" style="display: none; margin-top: 2rem;">
                    <div class="card-title" id="detail-title">Select an error above</div>
                    <div id="detail-content"></div>
                </div>

                <div class="exercise-area">
                    <h3>üïµÔ∏è Detective Challenge</h3>
                    <p>Match the error type to the code:</p>
                    <div id="matching-game" style="margin-top: 1rem;">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </section>

            <!-- Throwing Section -->
            <section id="throwing" class="section">
                <div class="section-header">
                    <h1 class="section-title">Throwing & Custom Errors</h1>
                    <p class="section-subtitle">Fail fast, fail loud, fail informatively.</p>
                </div>

                <div class="card">
                    <div class="card-title">üé® Custom Error Classes</div>
                    <p>Always throw Error objects, not strings. Better yet, create custom error types for your domain.</p>
                    
                    <div class="code-container">
                        <div class="code-block"><span class="keyword">class</span> <span class="function">ValidationError</span> <span class="keyword">extends</span> <span class="function">Error</span> {
    <span class="function">constructor</span>(field, value) {
        <span class="keyword">super</span>(<span class="string">`Invalid value "</span>${value}<span class="string">" for field "</span>${field}<span class="string">"`</span>);
        <span class="keyword">this</span>.<span class="property">name</span> = <span class="string">"ValidationError"</span>;
        <span class="keyword">this</span>.<span class="property">field</span> = field;
        <span class="keyword">this</span>.<span class="property">value</span> = value;
        <span class="comment">// Maintain proper stack trace</span>
        <span class="keyword">if</span> (<span class="function">Error</span>.<span class="property">captureStackTrace</span>) {
            <span class="function">Error</span>.<span class="property">captureStackTrace</span>(<span class="keyword">this</span>, <span class="function">ValidationError</span>);
        }
    }
}

<span class="comment">// Usage</span>
<span class="keyword">function</span> <span class="function">createUser</span>(data) {
    <span class="keyword">if</span> (!data.<span class="property">email</span>?.<span class="function">includes</span>(<span class="string">'@'</span>)) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">ValidationError</span>(<span class="string">'email'</span>, data.<span class="property">email</span>);
    }
}</div>
                    </div>
                </div>

                <div class="pitfall">
                    <div class="pitfall-title">‚ö†Ô∏è Never Throw Strings</div>
                    <p>Throwing primitives (strings, numbers) loses the stack trace and breaks instanceof checks.</p>
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block"><span class="comment">// ‚ùå Bad - loses stack trace</span>
<span class="keyword">throw</span> <span class="string">"Something went wrong"</span>;

<span class="comment">// ‚úÖ Good - full error capabilities</span>
<span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">Error</span>(<span class="string">"Something went wrong"</span>);

<span class="comment">// üåü Better - contextual information</span>
<span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">DatabaseError</span>(<span class="string">"Connection timeout"</span>, { 
    <span class="property">host</span>: <span class="string">'localhost'</span>, 
    <span class="property">port</span>: <span class="number">5432</span> 
});</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Error.cause (ES2022)</div>
                    <p>Chain errors to preserve context when wrapping low-level errors:</p>
                    <div class="code-container">
                        <div class="code-block"><span class="keyword">try</span> {
    <span class="keyword">await</span> <span class="function">fetchUser</span>(id);
} <span class="keyword">catch</span> (err) {
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">AppError</span>(<span class="string">"Failed to load dashboard"</span>, { 
        <span class="property">cause</span>: err 
    });
}</div>
                    </div>
                </div>
            </section>

            <!-- Debugging Section -->
            <section id="debugging" class="section">
                <div class="section-header">
                    <h1 class="section-title">Debugging Arsenal</h1>
                    <p class="section-subtitle">Tools and techniques for hunting bugs.</p>
                </div>

                <div class="card">
                    <div class="card-title">üõ†Ô∏è Console Methods Beyond log()</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px;">
                            <code style="color: var(--accent-primary);">console.error()</code>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-secondary);">Red styling, includes stack trace</p>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px;">
                            <code style="color: var(--accent-warning);">console.warn()</code>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-secondary);">Yellow warning styling</p>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px;">
                            <code style="color: var(--accent-success);">console.table()</code>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-secondary);">Display arrays/objects as table</p>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px;">
                            <code style="color: var(--accent-secondary);">console.trace()</code>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-secondary);">Print current call stack</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">‚èπÔ∏è The debugger Statement</div>
                    <p>Place <code>debugger;</code> in your code to create a breakpoint that pauses execution only when DevTools is open.</p>
                    
                    <div class="code-container">
                        <div class="code-block"><span class="keyword">function</span> <span class="function">calculateTotal</span>(items) {
    <span class="keyword">let</span> total = <span class="number">0</span>;
    
    items.<span class="function">forEach</span>(item => {
        <span class="function">debugger</span>; <span class="comment">// Execution pauses here!</span>
        total += item.<span class="property">price</span> * item.<span class="property">quantity</span>;
    });
    
    <span class="keyword">return</span> total;
}</div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <h3>Stack Trace Reading Challenge</h3>
                    <p>Can you identify where the error originates?</p>
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block" style="color: #ff7b72;">
Error: Cannot read property 'name' of undefined
    at getUserName (app.js:45:15)
    at formatUser (utils.js:12:20)
    at displayProfile (profile.js:8:5)
    at HTMLButtonElement.&lt;anonymous&gt; (main.js:23:3)</div>
                    </div>
                    <div class="demo-controls">
                        <button class="btn btn-secondary" onclick="alert('Correct! Look at the top of the stack - line 45 in app.js is where undefined.name was accessed.')">Reveal Answer</button>
                    </div>
                </div>
            </section>

            <!-- Pitfalls Section -->
            <section id="pitfalls" class="section">
                <div class="section-header">
                    <h1 class="section-title">Common Pitfalls & Anti-Patterns</h1>
                    <p class="section-subtitle">Mistakes that cost developers hours of debugging.</p>
                </div>

                <div class="pitfall">
                    <div class="pitfall-title">‚ö†Ô∏è The Silent Killer: Empty Catch</div>
                    <p>Worst mistake ever. You swallow the error and never know something broke.</p>
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block"><span class="comment">// ‚ùå Never do this</span>
<span class="keyword">try</span> {
    <span class="function">criticalFunction</span>();
} <span class="keyword">catch</span> (e) {
    <span class="comment">// Nothing here... error is lost forever</span>
}

<span class="comment">// ‚úÖ At minimum, log it</span>
<span class="keyword">try</span> {
    <span class="function">criticalFunction</span>();
} <span class="keyword">catch</span> (e) {
    <span class="function">console</span>.<span class="function">error</span>(<span class="string">"Critical function failed:"</span>, e);
    <span class="comment">// Re-throw if you can't handle it</span>
    <span class="keyword">throw</span> e;
}</div>
                    </div>
                </div>

                <div class="pitfall">
                    <div class="pitfall-title">‚ö†Ô∏è Pokemon Exception Handling</div>
                    <p>Catching 'em all (catching generic errors without type checking) masks different bugs.</p>
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block"><span class="comment">// ‚ùå Catches everything including SyntaxErrors, OOM, etc</span>
<span class="keyword">try</span> {
    <span class="keyword">await</span> <span class="function">fetchData</span>();
} <span class="keyword">catch</span> (err) {
    <span class="function">showToast</span>(<span class="string">"Network error"</span>); 
    <span class="comment">// But what if it's a TypeError in your code?</span>
}

<span class="comment">// ‚úÖ Check error types</span>
<span class="keyword">try</span> {
    <span class="keyword">await</span> <span class="function">fetchData</span>();
} <span class="keyword">catch</span> (err) {
    <span class="keyword">if</span> (err <span class="keyword">instanceof</span> <span class="function">NetworkError</span>) {
        <span class="function">showToast</span>(<span class="string">"Network error"</span>);
    } <span class="keyword">else</span> {
        <span class="keyword">throw</span> err; <span class="comment">// Don't handle what you don't understand</span>
    }
}</div>
                    </div>
                </div>

                <div class="pitfall">
                    <div class="pitfall-title">‚ö†Ô∏è Async/Await Confusion</div>
                    <p>Try-catch doesn't catch errors in async functions unless you await them.</p>
                    <div class="code-container" style="margin-top: 1rem;">
                        <div class="code-block"><span class="comment">// ‚ùå Error will be uncaught</span>
<span class="keyword">try</span> {
    <span class="function">fetchData</span>(); <span class="comment">// Returns promise, not awaiting</span>
} <span class="keyword">catch</span> (e) {
    <span class="comment">// Never reaches here</span>
}

<span class="comment">// ‚úÖ Must await the promise</span>
<span class="keyword">try</span> {
    <span class="keyword">await</span> <span class="function">fetchData</span>();
} <span class="keyword">catch</span> (e) {
    <span class="comment">// Now it works!</span>
}</div>
                    </div>
                </div>
            </section>

            <!-- Playground Section -->
            <section id="playground" class="section">
                <div class="section-header">
                    <h1 class="section-title">Interactive Playground</h1>
                    <p class="section-subtitle">Experiment safely. Break things on purpose.</p>
                </div>

                <div class="card">
                    <div class="card-title">üß™ Safe Error Laboratory</div>
                    <p>Edit the code below and run it. Errors are caught and displayed without crashing the app.</p>
                    
                    <textarea class="code-editor" id="playground-code" style="min-height: 250px;"><span class="comment">// Experiment with error handling!</span>
<span class="keyword">try</span> {
    <span class="comment">// Try uncommenting different lines:</span>
    <span class="comment">// throw new Error("Boom!");</span>
    <span class="comment">// JSON.parse("invalid");</span>
    <span class="comment">// undefined();</span>
    
    <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Everything worked!"</span>);
} <span class="keyword">catch</span> (err) {
    <span class="function">console</span>.<span class="function">error</span>(<span class="string">"Caught:"</span>, err.<span class="property">name</span>);
    <span class="function">console</span>.<span class="function">error</span>(<span class="string">"Message:"</span>, err.<span class="property">message</span>);
} <span class="keyword">finally</span> {
    <span class="function">console</span>.<span class="function">log</span>(<span class="string">"Cleanup code runs always"</span>);
}</textarea>
                    
                    <div class="demo-controls">
                        <button class="btn btn-primary" onclick="runPlayground()">‚ñ∂ Run Code</button>
                        <button class="btn btn-secondary" onclick="resetPlayground()">‚Ü∫ Reset</button>
                    </div>
                    
                    <div class="output-console" id="playground-output">
                        // Output will appear here...
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">üéÆ Challenges</div>
                    <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 1rem;">
                        <div style="background: rgba(6, 182, 212, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--accent-primary);">
                            <strong>Challenge 1:</strong> Write a try-catch that catches a TypeError but re-throws ReferenceErrors.
                        </div>
                        <div style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--accent-secondary);">
                            <strong>Challenge 2:</strong> Create a function that always executes cleanup code using finally, even when returning early.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quiz Section -->
            <section id="quiz" class="section">
                <div class="section-header">
                    <h1 class="section-title">Final Boss: Mastery Quiz</h1>
                    <p class="section-subtitle">Prove your skills. 80% to earn the Expert badge.</p>
                </div>

                <div class="quiz-container" id="quiz-container">
                    <!-- Quiz generated by JS -->
                </div>

                <div id="quiz-results" style="display: none; text-align: center; margin-top: 2rem;">
                    <h2 id="quiz-score"></h2>
                    <p id="quiz-message"></p>
                    <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top: 1rem;">Retake Quiz</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // State Management
        const state = {
            currentSection: 'intro',
            progress: 0,
            completedSections: [],
            quizScore: 0,
            badges: []
        };

        // Initialize particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(sec => {
                sec.classList.remove('active');
            });
            
            // Show target section
            document.getElementById(sectionId).classList.add('active');
            
            // Update nav
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            state.currentSection = sectionId;
            
            // Update progress
            if (!state.completedSections.includes(sectionId)) {
                state.completedSections.push(sectionId);
                updateProgress();
            }

            // Special initializations
            if (sectionId === 'error-types') initMatchingGame();
            if (sectionId === 'quiz') initQuiz();
            
            window.scrollTo(0, 0);
        }

        function updateProgress() {
            const totalSections = 7; // Excluding intro and quiz
            const progress = Math.min(100, (state.completedSections.length / totalSections) * 100);
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '% Complete';
            
            // Unlock badges
            if (progress >= 25) unlockBadge('badge-starter');
            if (progress >= 60) unlockBadge('badge-catcher');
            if (progress >= 100 && state.quizScore >= 80) unlockBadge('badge-expert');
        }

        function unlockBadge(badgeId) {
            const badge = document.getElementById(badgeId);
            if (badge && badge.classList.contains('locked')) {
                badge.classList.remove('locked');
                // Confetti effect
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => createConfetti(), i * 50);
                }
            }
        }

        function createConfetti() {
            const colors = ['#06b6d4', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.top = '-10px';
            confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
            document.body.appendChild(confetti);
            setTimeout(() => confetti.remove(), 3000);
        }

        // Try-Catch Flow Simulation
        function simulateFlow(type) {
            const boxes = document.querySelectorAll('.flow-box');
            boxes.forEach(box => box.classList.remove('active'));
            
            if (type === 'success') {
                setTimeout(() => document.getElementById('box-try').classList.add('active'), 0);
                setTimeout(() => document.getElementById('box-success').classList.add('active'), 1000);
            } else {
                setTimeout(() => document.getElementById('box-try2').classList.add('active'), 0);
                setTimeout(() => document.getElementById('box-catch').classList.add('active'), 1000);
            }
        }

        // Exercise Validation
        function checkExercise1() {
            const code = document.getElementById('exercise1').value;
            const hasTry = code.includes('try');
            const hasCatch = code.includes('catch');
            const hasReturn = code.includes('return');
            
            if (hasTry && hasCatch && hasReturn) {
                alert('‚úÖ Excellent! You protected the function from crashing.');
                unlockBadge('badge-starter');
            } else {
                alert('‚ùå Not quite. Make sure you wrap the risky code in try-catch and return a safe value in catch.');
            }
        }

        function showHint(num) {
            document.getElementById('hint' + num).style.display = 'block';
        }

        // Error Type Details
        function showErrorDetail(type) {
            const details = {
                syntax: {
                    title: 'SyntaxError',
                    content: 'Occurs when the code violates the language syntax rules. Common causes:<br><ul><li>Missing brackets or parentheses</li><li>Invalid JSON parsing</li><li>Reserved words as variable names</li></ul>'
                },
                reference: {
                    title: 'ReferenceError',
                    content: 'Variable is not declared or not yet in scope. Common causes:<br><ul><li>Typos in variable names</li><li>Temporal Dead Zone (TDZ) with let/const</li><li>Accessing scope that no longer exists</li></ul>'
                },
                type: {
                    title: 'TypeError',
                    content: 'Operation cannot be performed on the given type. Common causes:<br><ul><li>Calling null/undefined as function</li><li>Accessing property on null/undefined</li><li>Wrong argument types</li></ul>'
                },
                range: {
                    title: 'RangeError',
                    content: 'Value not in acceptable range. Common causes:<br><ul><li>Recursion too deep (stack overflow)</li><li>Invalid array length</li><li>Number precision out of range</li></ul>'
                },
                uri: {
                    title: 'URIError',
                    content: 'Global URI handling functions used incorrectly. Rare in modern code.'
                },
                aggregate: {
                    title: 'AggregateError',
                    content: 'Multiple errors combined into one. New in ES2021, used by Promise.any() when all promises reject.'
                }
            };
            
            const detail = details[type];
            document.getElementById('detail-title').textContent = detail.title;
            document.getElementById('detail-content').innerHTML = detail.content;
            document.getElementById('error-detail').style.display = 'block';
        }

        // Matching Game
        function initMatchingGame() {
            const container = document.getElementById('matching-game');
            if (container.children.length > 0) return; // Already initialized
            
            const pairs = [
                { code: 'undefinedVariable', type: 'ReferenceError' },
                { code: 'null.toString()', type: 'TypeError' },
                { code: 'JSON.parse("{")', type: 'SyntaxError' },
                { code: '(1).toFixed(1000)', type: 'RangeError' }
            ];
            
            pairs.forEach((pair, idx) => {
                const div = document.createElement('div');
                div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem;';
                div.innerHTML = `
                    <code>${pair.code}</code>
                    <select id="match-${idx}" style="background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 0.5rem; border-radius: 4px;">
                        <option value="">Select error type...</option>
                        <option value="ReferenceError">ReferenceError</option>
                        <option value="TypeError">TypeError</option>
                        <option value="SyntaxError">SyntaxError</option>
                        <option value="RangeError">RangeError</option>
                    </select>
                `;
                container.appendChild(div);
            });
            
            const btn = document.createElement('button');
            btn.className = 'btn btn-primary';
            btn.textContent = 'Check Answers';
            btn.onclick = () => checkMatching(pairs);
            container.appendChild(btn);
        }

        function checkMatching(pairs) {
            let correct = 0;
            pairs.forEach((pair, idx) => {
                const select = document.getElementById(`match-${idx}`);
                if (select.value === pair.type) {
                    select.style.borderColor = 'var(--accent-success)';
                    correct++;
                } else {
                    select.style.borderColor = 'var(--accent-danger)';
                }
            });
            
            if (correct === pairs.length) {
                alert('üéâ Perfect! You know your error types!');
            } else {
                alert(`${correct}/${pairs.length} correct. Keep studying!`);
            }
        }

        // Playground
        function runPlayground() {
            const code = document.getElementById('playground-code').value;
            const output = document.getElementById('playground-output');
            output.innerHTML = '';
            output.classList.remove('error');
            
            // Capture console methods
            const logs = [];
            const mockConsole = {
                log: (...args) => logs.push({type: 'log', content: args.join(' ')}),
                error: (...args) => logs.push({type: 'error', content: args.join(' ')}),
                warn: (...args) => logs.push({type: 'warn', content: args.join(' ')})
            };
            
            try {
                // Safe execution using Function constructor with limited scope
                const func = new Function('console', code);
                func(mockConsole);
                
                logs.forEach(log => {
                    const div = document.createElement('div');
                    div.style.color = log.type === 'error' ? '#f44' : log.type === 'warn' ? '#fa0' : '#0f0';
                    div.textContent = '> ' + log.content;
                    output.appendChild(div);
                });
                
                if (logs.length === 0) {
                    output.textContent = '// No output';
                }
            } catch (err) {
                output.classList.add('error');
                output.innerHTML = `Uncaught ${err.name}: ${err.message}`;
            }
        }

        function resetPlayground() {
            document.getElementById('playground-code').value = `// Experiment with error handling!\ntry {\n    // Try uncommenting different lines:\n    // throw new Error("Boom!");\n    // JSON.parse("invalid");\n    // undefined();\n    \n    console.log("Everything worked!");\n} catch (err) {\n    console.error("Caught:", err.name);\n    console.error("Message:", err.message);\n} finally {\n    console.log("Cleanup code runs always");\n}`;
            document.getElementById('playground-output').textContent = '// Output will appear here...';
        }

        // Quiz System
        const quizQuestions = [
            {
                question: "What happens if you don't use 'await' inside try-catch with an async function?",
                options: [
                    "The catch block catches the error when the promise rejects",
                    "The error becomes an unhandled promise rejection",
                    "The code throws a SyntaxError",
                    "The function automatically awaits"
                ],
                correct: 1,
                explanation: "Without await, the function returns a Promise immediately. The try-catch finishes before the promise rejects, so you need .catch() on the promise or await it."
            },
            {
                question: "Which error type is thrown when accessing a property on null?",
                options: ["ReferenceError", "TypeError", "NullError", "SyntaxError"],
                correct: 1,
                explanation: "TypeError is thrown when a value is not of the expected type. null and undefined have no properties, so accessing them throws TypeError."
            },
            {
                question: "What is the output of: try { return 1; } finally { return 2; }",
                options: ["1", "2", "undefined", "Error"],
                correct: 1,
                explanation: "Finally block's return overrides the try block's return. This is a common pitfall!"
            },
            {
                question: "What is wrong with: try { risky(); } catch (e) { }",
                options: [
                    "Nothing, this is valid code",
                    "e is undefined",
                    "It's swallowing errors silently",
                    "Missing finally block"
                ],
                correct: 2,
                explanation: "Empty catch blocks swallow errors, making debugging impossible. At minimum, log the error."
            },
            {
                question: "How do you check if an error is a specific type?",
                options: [
                    "error.name === 'TypeError'",
                    "error instanceof TypeError",
                    "typeof error === 'TypeError'",
                    "Both A and B"
                ],
                correct: 3,
                explanation: "Both checking error.name and using instanceof work, but instanceof is more robust for custom error classes."
            }
        ];

        function initQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';
            
            quizQuestions.forEach((q, idx) => {
                const div = document.createElement('div');
                div.className = 'quiz-question';
                div.innerHTML = `
                    <h3>Question ${idx + 1}: ${q.question}</h3>
                    <div class="quiz-options">
                        ${q.options.map((opt, i) => `
                            <label class="quiz-option" onclick="selectOption(${idx}, ${i}, this)">
                                <input type="radio" name="q${idx}" value="${i}">
                                <span>${opt}</span>
                            </label>
                        `).join('')}
                    </div>
                    <div class="explanation" id="exp-${idx}" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(6, 182, 212, 0.1); border-radius: 8px; border-left: 4px solid var(--accent-primary);"></div>
                `;
                container.appendChild(div);
            });
            
            const btn = document.createElement('button');
            btn.className = 'btn btn-primary';
            btn.textContent = 'Submit Quiz';
            btn.onclick = submitQuiz;
            btn.id = 'submit-quiz-btn';
            container.appendChild(btn);
        }

        function selectOption(qIdx, optIdx, element) {
            // Remove selected from siblings
            const parent = element.parentElement;
            parent.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function submitQuiz() {
            let score = 0;
            quizQuestions.forEach((q, idx) => {
                const selected = document.querySelector(`input[name="q${idx}"]:checked`);
                const explanation = document.getElementById(`exp-${idx}`);
                const options = document.querySelectorAll(`input[name="q${idx}"]`).forEach((input, i) => {
                    const label = input.parentElement;
                    if (i === q.correct) {
                        label.classList.add('correct');
                    } else if (input.checked && i !== q.correct) {
                        label.classList.add('wrong');
                    }
                });
                
                if (selected && parseInt(selected.value) === q.correct) {
                    score++;
                }
                
                explanation.textContent = q.explanation;
                explanation.style.display = 'block';
            });
            
            state.quizScore = (score / quizQuestions.length) * 100;
            
            document.getElementById('quiz-results').style.display = 'block';
            document.getElementById('quiz-score').textContent = `Score: ${score}/${quizQuestions.length} (${state.quizScore}%)`;
            
            if (state.quizScore >= 80) {
                document.getElementById('quiz-message').textContent = 'üèÜ Congratulations! You earned the Expert badge!';
                unlockBadge('badge-expert');
            } else {
                document.getElementById('quiz-message').textContent = 'Review the material and try again. You need 80% to pass.';
            }
            
            document.getElementById('submit-quiz-btn').style.display = 'none';
            updateProgress();
        }

        function resetQuiz() {
            initQuiz();
            document.getElementById('quiz-results').style.display = 'none';
        }

        // Initialize
        window.onload = function() {
            createParticles();
            
            // Override navigation clicks to use showSection properly
            document.querySelectorAll('.nav-link').forEach(link => {
                link.onclick = function(e) {
                    const section = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                    showSection.call(this, section);
                };
            });
        };
    </script>
</body>
</html>