<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Design Patterns Masterclass - Interactive Learning</title>
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #ec4899;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --code-bg: #282c34;
            --text: #374151;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text);
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        h1 {
            color: var(--dark);
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .progress-container {
            background: var(--light);
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.5s ease;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px;
            height: fit-content;
            position: sticky;
            top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .nav-item {
            padding: 12px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-item:hover {
            background: var(--light);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #e0e7ff 0%, #fce7f3 100%);
            border-left-color: var(--primary);
            font-weight: bold;
        }

        .nav-item.completed::after {
            content: 'âœ“';
            margin-left: auto;
            color: var(--success);
            font-weight: bold;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 600px;
        }

        .pattern-section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .pattern-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .visual-diagram {
            background: var(--dark);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow: hidden;
        }

        .code-block {
            background: var(--code-bg);
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            position: relative;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .keyword { color: #c678dd; }
        .function { color: #61afef; }
        .string { color: #98c379; }
        .comment { color: #5c6370; font-style: italic; }
        .number { color: #d19a66; }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid var(--warning);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .error-box {
            background: #fee2e2;
            border-left: 4px solid var(--danger);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .success-box {
            background: #d1fae5;
            border-left: 4px solid var(--success);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: var(--dark);
        }

        .quiz-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .quiz-option {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            background: white;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background: #f5f3ff;
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: #d1fae5;
        }

        .quiz-option.wrong {
            border-color: var(--danger);
            background: #fee2e2;
        }

        .exercise-area {
            background: #f8fafc;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .sandbox {
            width: 100%;
            min-height: 200px;
            font-family: 'Fira Code', monospace;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            resize: vertical;
        }

        .output-console {
            background: var(--dark);
            color: #4ade80;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: monospace;
            min-height: 100px;
            white-space: pre-wrap;
        }

        .pattern-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 5px solid var(--primary);
            transition: transform 0.2s;
        }

        .pattern-card:hover {
            transform: translateX(5px);
        }

        .tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 5px;
        }

        .tag.creational { background: #dbeafe; color: #1e40af; }
        .tag.structural { background: #dcfce7; color: #166534; }
        .tag.behavioral { background: #fce7f3; color: #9d174d; }

        .decision-tree {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
            margin: 20px 0;
        }

        .tree-node {
            background: white;
            border: 2px solid var(--primary);
            padding: 15px 25px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            max-width: 300px;
        }

        .tree-node:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        .tree-connector {
            width: 2px;
            height: 30px;
            background: var(--primary);
        }

        @media (max-width: 968px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            .sidebar {
                position: relative;
                display: flex;
                overflow-x: auto;
                gap: 10px;
            }
            .nav-item {
                white-space: nowrap;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>ğŸ“ JavaScript Design Patterns Masterclass</h1>
            <p>Master the patterns that top-tier companies expect you to know</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                <span>Progress: <span id="progressText">0%</span></span>
                <span id="patternsCompleted">0/12 Patterns Mastered</span>
            </div>
        </header>

        <div class="main-layout">
            <nav class="sidebar">
                <div class="nav-item active" onclick="showSection('intro')">
                    <span>ğŸš€</span> Start Here
                </div>
                <div class="nav-item" onclick="showSection('creational')">
                    <span>ğŸ­</span> Creational Patterns
                </div>
                <div class="nav-item" onclick="showSection('structural')">
                    <span>ğŸ§±</span> Structural Patterns
                </div>
                <div class="nav-section" onclick="showSection('behavioral')">
                    <span>ğŸ­</span> Behavioral Patterns
                </div>
                <div class="nav-item" onclick="showSection('when-to-use')">
                    <span>ğŸ¯</span> When to Use What
                </div>
                <div class="nav-item" onclick="showSection('playground')">
                    <span>ğŸ›</span> Pattern Playground
                </div>
                <div class="nav-item" onclick="showSection('interview')">
                    <span>ğŸ’¼</span> Interview Prep
                </div>
            </nav>

            <main class="content-area">
                <!-- Introduction -->
                <section id="intro" class="pattern-section active">
                    <h2>Welcome to the Pattern Dojo ğŸ¥‹</h2>
                    <p style="font-size: 18px; margin: 20px 0; line-height: 1.8;">
                        Design patterns are battle-tested solutions to common problems. 
                        Top companies don't just want you to know <em>how</em> to codeâ€”they want you to know 
                        <em>how to architect</em> scalable, maintainable applications.
                    </p>
                    
                    <div class="success-box">
                        <strong>Why patterns matter for jobs:</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>React/Vue/Angular internally use Observer, Composite, and Proxy patterns</li>
                            <li>Redux uses Observer and Singleton concepts</li>
                            <li>Module bundlers (Webpack, Vite) rely on Module pattern</li>
                            <li>Testing frameworks use Strategy and Template Method</li>
                        </ul>
                    </div>

                    <h3>How to use this app:</h3>
                    <div class="pattern-card">
                        <strong>1. Learn</strong> - Visual explanations and real-world analogies
                    </div>
                    <div class="pattern-card">
                        <strong>2. Code</strong> - Interactive examples with common pitfalls highlighted
                    </div>
                    <div class="pattern-card">
                        <strong>3. Practice</strong> - Exercises and quizzes to cement knowledge
                    </div>
                    <div class="pattern-card">
                        <strong>4. Apply</strong> - Use the playground to experiment
                    </div>

                    <button class="btn" onclick="showSection('creational')" style="margin-top: 20px;">
                        Start Learning Creational Patterns â†’
                    </button>
                </section>

                <!-- Creational Patterns -->
                <section id="creational" class="pattern-section">
                    <h2>ğŸ­ Creational Patterns</h2>
                    <p>These patterns deal with object creation mechanisms, trying to create objects in a manner suitable to the situation.</p>

                    <!-- Singleton -->
                    <div class="pattern-card" style="border-left-color: #3b82f6;">
                        <span class="tag creational">Creational</span>
                        <h3>Singleton Pattern</h3>
                        <p><strong>Real-world analogy:</strong> A country's presidentâ€”there can only be one at a time.</p>
                        
                        <div class="visual-diagram">
                            <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Singleton Class   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  instance     â”‚â—„â”€â”¼â”€â”€ Only one instance
â”‚  â”‚  (static)     â”‚  â”‚    exists
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  getInstance()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ App A â”‚     â”‚ App B â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜
Both get same instance!</pre>
                        </div>

                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre><span class="comment">// âŒ BAD: Global variable approach</span>
<span class="keyword">let</span> <span class="function">dbConnection</span> = { ... };

<span class="comment">// âœ… GOOD: Singleton Pattern</span>
<span class="keyword">class</span> <span class="function">Database</span> {
  <span class="keyword">constructor</span>() {
    <span class="keyword">if</span> (!<span class="function">Database</span>.instance) {
      <span class="keyword">this</span>.connection = <span class="keyword">null</span>;
      <span class="function">Database</span>.instance = <span class="keyword">this</span>;
    }
    <span class="keyword">return</span> <span class="function">Database</span>.instance;
  }

  <span class="function">connect</span>() {
    <span class="keyword">if</span> (!<span class="keyword">this</span>.connection) {
      <span class="keyword">this</span>.connection = <span class="string">"Connected!"</span>;
      console.<span class="function">log</span>(<span class="string">"New connection established"</span>);
    } <span class="keyword">else</span> {
      console.<span class="function">log</span>(<span class="string">"Reusing existing connection"</span>);
    }
    <span class="keyword">return</span> <span class="keyword">this</span>.connection;
  }
}

<span class="comment">// Usage</span>
<span class="keyword">const</span> db1 = <span class="keyword">new</span> <span class="function">Database</span>();
<span class="keyword">const</span> db2 = <span class="keyword">new</span> <span class="function">Database</span>();
console.<span class="function">log</span>(db1 === db2); <span class="comment">// true</span></pre>
                        </div>

                        <div class="error-box">
                            <strong>âš ï¸ Common Pitfall: Thread Safety & Testing</strong>
                            <ul>
                                <li>S singletons make unit testing hard (global state pollution)</li>
                                <li>In Node.js, module.exports is already singleton-like</li>
                                <li>Memory leaks if singleton holds references to DOM elements</li>
                            </ul>
                        </div>

                        <div class="interactive-demo">
                            <h4>ğŸ® Interactive Demo</h4>
                            <p>Click multiple times. Notice how only one connection is created:</p>
                            <button class="btn" onclick="singletonDemo()">Get Database Instance</button>
                            <button class="btn btn-secondary" onclick="resetSingleton()">Reset</button>
                            <div id="singletonOutput" class="output-console">Output will appear here...</div>
                        </div>

                        <div class="quiz-container">
                            <h4>Quick Quiz</h4>
                            <p>When is Singleton NOT appropriate?</p>
                            <button class="quiz-option" onclick="checkAnswer(this, false)">
                                Managing a database connection pool
                            </button>
                            <button class="quiz-option" onclick="checkAnswer(this, true)">
                                Storing temporary user form data
                            </button>
                            <button class="quiz-option" onclick="checkAnswer(this, false)">
                                Configuration settings for the app
                            </button>
                        </div>
                    </div>

                    <!-- Factory -->
                    <div class="pattern-card" style="border-left-color: #8b5cf6;">
                        <span class="tag creational">Creational</span>
                        <h3>Factory Pattern</h3>
                        <p><strong>Real-world analogy:</strong> A restaurant. You order (type), the kitchen creates it (implementation hidden).</p>

                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre><span class="comment">// Without Factory (messy if-else)</span>
<span class="keyword">function</span> <span class="function">createUser</span>(type) {
  <span class="keyword">if</span> (type === <span class="string">'admin'</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="function">Admin</span>();
  <span class="keyword">if</span> (type === <span class="string">'customer'</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="function">Customer</span>();
  <span class="comment">// ... 10 more types</span>
}

<span class="comment">// âœ… With Factory Pattern</span>
<span class="keyword">class</span> <span class="function">UserFactory</span> {
  <span class="keyword">static</span> <span class="function">create</span>(type) {
    <span class="keyword">switch</span>(type) {
      <span class="keyword">case</span> <span class="string">'admin'</span>:
        <span class="keyword">return</span> { role: <span class="string">'admin'</span>, permissions: [<span class="string">'all'</span>] };
      <span class="keyword">case</span> <span class="string">'editor'</span>:
        <span class="keyword">return</span> { role: <span class="string">'editor'</span>, permissions: [<span class="string">'read'</span>, <span class="string">'write'</span>] };
      <span class="keyword">case</span> <span class="string">'viewer'</span>:
        <span class="keyword">return</span> { role: <span class="string">'viewer'</span>, permissions: [<span class="string">'read'</span>] };
      <span class="keyword">default</span>:
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">Error</span>(<span class="string">`User type ${type} not supported`</span>);
    }
  }
}

<span class="comment">// Usage - Clean and scalable!</span>
<span class="keyword">const</span> admin = <span class="function">UserFactory</span>.<span class="function">create</span>(<span class="string">'admin'</span>);
<span class="keyword">const</span> editor = <span class="function">UserFactory</span>.<span class="function">create</span>(<span class="string">'editor'</span>);</pre>
                        </div>

                        <div class="warning-box">
                            <strong>âš ï¸ Don't Over-Engineer!</strong>
                            <p>If you only have 2-3 simple object types, a factory might be overkill. Use it when:</p>
                            <ul>
                                <li>Object creation logic is complex</li>
                                <li>You need to support many subtypes</li>
                                <li>Creation logic might change frequently</li>
                            </ul>
                        </div>

                        <div class="exercise-area">
                            <h4>ğŸ’ª Exercise: Payment Processor Factory</h4>
                            <p>Create a factory that returns different payment processors (Stripe, PayPal, Crypto) based on the method parameter.</p>
                            <textarea class="sandbox" id="factoryExercise" placeholder="// Write your factory here
class PaymentFactory {
  static create(method) {
    // Your code
  }
}

// Test it
const payment = PaymentFactory.create('stripe');
payment.pay(100);"></textarea>
                            <button class="btn" onclick="runFactoryExercise()">Run Code</button>
                            <div id="factoryOutput" class="output-console"></div>
                        </div>
                    </div>

                    <!-- Builder -->
                    <div class="pattern-card" style="border-left-color: #06b6d4;">
                        <span class="tag creational">Creational</span>
                        <h3>Builder Pattern</h3>
                        <p><strong>Use case:</strong> Constructing complex objects step-by-step (like making a custom pizza).</p>

                        <div class="code-block">
<pre><span class="keyword">class</span> <span class="function">HttpRequestBuilder</span> {
  <span class="function">constructor</span>() {
    <span class="keyword">this</span>.url = <span class="string">''</span>;
    <span class="keyword">this</span>.method = <span class="string">'GET'</span>;
    <span class="keyword">this</span>.headers = {};
    <span class="keyword">this</span>.body = <span class="keyword">null</span>;
  }

  <span class="function">setUrl</span>(url) {
    <span class="keyword">this</span>.url = url;
    <span class="keyword">return</span> <span class="keyword">this</span>; <span class="comment">// For chaining</span>
  }

  <span class="function">setMethod</span>(method) {
    <span class="keyword">this</span>.method = method;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="function">addHeader</span>(key, value) {
    <span class="keyword">this</span>.headers[key] = value;
    <span class="keyword">return</span> <span class="keyword">this</span>;
  }

  <span class="function">build</span>() {
    <span class="keyword">return</span> {
      url: <span class="keyword">this</span>.url,
      method: <span class="keyword">this</span>.method,
      headers: <span class="keyword">this</span>.headers,
      body: <span class="keyword">this</span>.body,
      <span class="function">execute</span>: () => <span class="function">fetch</span>(<span class="keyword">this</span>.url, {
        method: <span class="keyword">this</span>.method,
        headers: <span class="keyword">this</span>.headers
      })
    };
  }
}

<span class="comment">// Beautiful, readable code:</span>
<span class="keyword">const</span> request = <span class="keyword">new</span> <span class="function">HttpRequestBuilder</span>()
  .<span class="function">setUrl</span>(<span class="string">'/api/users'</span>)
  .<span class="function">setMethod</span>(<span class="string">'POST'</span>)
  .<span class="function">addHeader</span>(<span class="string">'Content-Type'</span>, <span class="string">'application/json'</span>)
  .<span class="function">addHeader</span>(<span class="string">'Authorization'</span>, <span class="string">'Bearer token123'</span>)
  .<span class="function">build</span>();</pre>
                        </div>
                    </div>

                    <button class="btn" onclick="completeSection('creational'); showSection('structural')">
                        Continue to Structural Patterns â†’
                    </button>
                </section>

                <!-- Structural Patterns -->
                <section id="structural" class="pattern-section">
                    <h2>ğŸ§± Structural Patterns</h2>
                    <p>These concern class and object composition. They help ensure that when one part of a system changes, the entire structure doesn't need to change.</p>

                    <!-- Module Pattern -->
                    <div class="pattern-card" style="border-left-color: #10b981;">
                        <span class="tag structural">Structural</span>
                        <h3>Module Pattern (The Essential)</h3>
                        <p><strong>Why it matters:</strong> Keeps your code out of the global scopeâ€”critical for large apps.</p>

                        <div class="code-block">
<pre><span class="comment">// Before ES6 modules (still relevant in legacy code)</span>
<span class="keyword">const</span> ShoppingCart = (<span class="keyword">function</span>() {
  <span class="comment">// Private variables (closure)</span>
  <span class="keyword">let</span> items = [];
  <span class="keyword">let</span> total = <span class="number">0</span>;

  <span class="comment">// Private method</span>
  <span class="keyword">function</span> <span class="function">calculateTotal</span>() {
    total = items.<span class="function">reduce</span>((sum, item) => sum + item.price, <span class="number">0</span>);
  }

  <span class="comment">// Public API</span>
  <span class="keyword">return</span> {
    <span class="function">addItem</span>: <span class="keyword">function</span>(item) {
      items.<span class="function">push</span>(item);
      <span class="function">calculateTotal</span>();
    },
    <span class="function">getTotal</span>: <span class="keyword">function</span>() {
      <span class="keyword">return</span> total;
    },
    <span class="function">getItemCount</span>: <span class="keyword">function</span>() {
      <span class="keyword">return</span> items.length;
    }
  };
})();

<span class="comment">// ES6 Module version (Modern approach)</span>
<span class="comment">// cart.js</span>
<span class="keyword">let</span> items = []; <span class="comment">// Module-scoped (private)</span>

<span class="keyword">export</span> <span class="keyword">const</span> <span class="function">addItem</span> = (item) => items.<span class="function">push</span>(item);
<span class="keyword">export</span> <span class="keyword">const</span> <span class="function">getItems</span> = () => [...items]; <span class="comment">// Return copy, not reference!</span></pre>
                        </div>

                        <div class="error-box">
                            <strong>ğŸ”¥ Critical Mistake: Exposing Internal State</strong>
                            <pre style="background: #fee2e2; padding: 10px; margin-top: 10px;">
// WRONG: Returns reference to internal array
export const getItems = () => items; 

// User can now do: cart.getItems().length = 0; (Destroys your data!)

// RIGHT: Return copy
export const getItems = () => [...items];</pre>
                        </div>
                    </div>

                    <!-- Observer -->
                    <div class="pattern-card" style="border-left-color: #f59e0b;">
                        <span class="tag behavioral">Behavioral</span> <span class="tag structural">(Also Structural)</span>
                        <h3>Observer Pattern (Pub/Sub)</h3>
                        <p><strong>Real-world:</strong> YouTube subscriptions. You subscribe, you get notified when new content drops.</p>
                        
                        <div class="visual-diagram" style="text-align: center;">
<pre>
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Subject    â”‚
    â”‚ (YouTube    â”‚
    â”‚  Channel)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚ notify()
    â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â–¼      â–¼      â–¼
â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”
â”‚Sub 1â”‚â”‚Sub 2â”‚â”‚Sub 3â”‚
â”‚ğŸ‘¤   â”‚â”‚ğŸ‘¤   â”‚â”‚ğŸ‘¤   â”‚
â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜</pre>
                        </div>

                        <div class="code-block">
<pre><span class="keyword">class</span> <span class="function">Observable</span> {
  <span class="function">constructor</span>() {
    <span class="keyword">this</span>.observers = [];
  }

  <span class="function">subscribe</span>(fn) {
    <span class="keyword">this</span>.observers.<span class="function">push</span>(fn);
    <span class="comment">// Return unsubscribe function (clean!)</span>
    <span class="keyword">return</span> () => {
      <span class="keyword">this</span>.observers = <span class="keyword">this</span>.observers.<span class="function">filter</span>(sub => sub !== fn);
    };
  }

  <span class="function">notify</span>(data) {
    <span class="keyword">this</span>.observers.<span class="function">forEach</span>(fn => <span class="function">fn</span>(data));
  }
}

<span class="comment">// Usage - Event Bus pattern</span>
<span class="keyword">const</span> eventBus = <span class="keyword">new</span> <span class="function">Observable</span>();

<span class="keyword">const</span> unsubscribe = eventBus.<span class="function">subscribe</span>((data) => {
  console.<span class="function">log</span>(<span class="string">"Received:"</span>, data);
});

<span class="comment">// Later...</span>
eventBus.<span class="function">notify</span>({ type: <span class="string">'USER_LOGIN'</span>, userId: <span class="number">123</span> });

<span class="comment">// Cleanup (prevent memory leaks!)</span>
<span class="function">unsubscribe</span>();</pre>
                        </div>

                        <div class="interactive-demo">
                            <h4>ğŸ® Interactive: Stock Price Alert System</h4>
                            <div style="display: flex; gap: 10px; margin: 10px 0;">
                                <button class="btn" onclick="subscribeStock('Investor A')">Subscribe Investor A</button>
                                <button class="btn" onclick="subscribeStock('Investor B')">Subscribe Investor B</button>
                                <button class="btn btn-secondary" onclick="updateStockPrice()">Update Price ($)</button>
                            </div>
                            <div id="stockOutput" class="output-console"></div>
                        </div>

                        <div class="warning-box">
                            <strong>âš ï¸ Memory Leak Alert!</strong>
                            <p>Always unsubscribe when components destroy. In React, useEffect cleanup:</p>
                            <pre>useEffect(() => {
  const unsub = eventBus.subscribe(handler);
  return () => unsub(); // Cleanup!
}, []);</pre>
                        </div>
                    </div>

                    <!-- Decorator -->
                    <div class="pattern-card" style="border-left-color: #ec4899;">
                        <span class="tag structural">Structural</span>
                        <h3>Decorator Pattern</h3>
                        <p>Add behavior dynamically without subclassing. Like adding toppings to a pizza.</p>

                        <div class="code-block">
<pre><span class="comment">// Base component</span>
<span class="keyword">class</span> <span class="function">Coffee</span> {
  <span class="function">cost</span>() { <span class="keyword">return</span> <span class="number">5</span>; }
  <span class="function">description</span>() { <span class="keyword">return</span> <span class="string">'Simple coffee'</span>; }
}

<span class="comment">// Decorators</span>
<span class="keyword">class</span> <span class="function">MilkDecorator</span> {
  <span class="function">constructor</span>(coffee) {
    <span class="keyword">this</span>.coffee = coffee;
  }
  <span class="function">cost</span>() { <span class="keyword">return</span> <span class="keyword">this</span>.coffee.<span class="function">cost</span>() + <span class="number">1</span>; }
  <span class="function">description</span>() { 
    <span class="keyword">return</span> <span class="keyword">this</span>.coffee.<span class="function">description</span>() + <span class="string">', milk'</span>; 
  }
}

<span class="comment">// Usage</span>
<span class="keyword">let</span> coffee = <span class="keyword">new</span> <span class="function">Coffee</span>();
coffee = <span class="keyword">new</span> <span class="function">MilkDecorator</span>(coffee);
coffee = <span class="keyword">new</span> <span class="function">SugarDecorator</span>(coffee);

console.<span class="function">log</span>(coffee.<span class="function">cost</span>()); <span class="comment">// 6.5</span></pre>
                        </div>
                    </div>

                    <button class="btn" onclick="completeSection('structural'); showSection('behavioral')">
                        Continue to Behavioral Patterns â†’
                    </button>
                </section>

                <!-- Behavioral Patterns -->
                <section id="behavioral" class="pattern-section">
                    <h2>ğŸ­ Behavioral Patterns</h2>
                    <p>These identify common communication patterns between objects and increase flexibility in carrying out this communication.</p>

                    <!-- Strategy -->
                    <div class="pattern-card" style="border-left-color: #f97316;">
                        <span class="tag behavioral">Behavioral</span>
                        <h3>Strategy Pattern</h3>
                        <p><strong>Kills:</strong> Giant if-else/switch statements. Defines a family of algorithms, encapsulates each one.</p>

                        <div class="code-block">
<pre><span class="comment">// Without Strategy (Spaghetti code)</span>
<span class="keyword">function</span> <span class="function">calculateShipping</span>(method, weight) {
  <span class="keyword">if</span> (method === <span class="string">'fedex'</span>) <span class="keyword">return</span> weight * <span class="number">3</span>;
  <span class="keyword">if</span> (method === <span class="string">'ups'</span>) <span class="keyword">return</span> weight * <span class="number">2.5</span>;
  <span class="keyword">if</span> (method === <span class="string">'usps'</span>) <span class="keyword">return</span> weight * <span class="number">2</span>;
  <span class="comment">// Adding new carrier = modifying this function (Open/Closed violation)</span>
}

<span class="comment">// âœ… With Strategy Pattern</span>
<span class="keyword">const</span> shippingStrategies = {
  <span class="function">fedex</span>: (weight) => weight * <span class="number">3</span>,
  <span class="function">ups</span>: (weight) => weight * <span class="number">2.5</span>,
  <span class="function">usps</span>: (weight) => weight * <span class="number">2</span>,
  <span class="function">drone</span>: (weight) => weight * <span class="number">5</span> + <span class="number">10</span> <span class="comment">// Easy to add!</span>
};

<span class="keyword">function</span> <span class="function">calculateShipping</span>(strategy, weight) {
  <span class="keyword">return</span> shippingStrategies[strategy](weight);
}

<span class="comment">// Validation strategies example</span>
<span class="keyword">const</span> validators = {
  <span class="function">email</span>: (val) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.<span class="function">test</span>(val),
  <span class="function">phone</span>: (val) => /^\d{10}$/.<span class="function">test</span>(val),
  <span class="function">required</span>: (val) => val && val.length > <span class="number">0</span>
};</pre>
                        </div>

                        <div class="success-box">
                            <strong>ğŸ’¡ Interview Tip:</strong> When asked "How do you avoid long switch statements?", mention Strategy pattern with a Map/Object lookup. Shows architectural thinking!
                        </div>
                    </div>

                    <!-- Command -->
                    <div class="pattern-card" style="border-left-color: #ef4444;">
                        <span class="tag behavioral">Behavioral</span>
                        <h3>Command Pattern</h3>
                        <p>Encapsulates a request as an object. Key for: Undo/Redo functionality, job queues, macro recording.</p>

                        <div class="code-block">
<pre><span class="keyword">class</span> <span class="function">CommandManager</span> {
  <span class="function">constructor</span>() {
    <span class="keyword">this</span>.commands = [];
    <span class="keyword">this</span>.index = -<span class="number">1</span>;
  }

  <span class="function">execute</span>(command) {
    command.<span class="function">execute</span>();
    <span class="keyword">this</span>.commands = <span class="keyword">this</span>.commands.<span class="function">slice</span>(<span class="number">0</span>, <span class="keyword">this</span>.index + <span class="number">1</span>);
    <span class="keyword">this</span>.commands.<span class="function">push</span>(command);
    <span class="keyword">this</span>.index++;
  }

  <span class="function">undo</span>() {
    <span class="keyword">if</span> (<span class="keyword">this</span>.index >= <span class="number">0</span>) {
      <span class="keyword">this</span>.commands[<span class="keyword">this</span>.index].<span class="function">undo</span>();
      <span class="keyword">this</span>.index--;
    }
  }

  <span class="function">redo</span>() {
    <span class="keyword">if</span> (<span class="keyword">this</span>.index < <span class="keyword">this</span>.commands.length - <span class="number">1</span>) {
      <span class="keyword">this</span>.index++;
      <span class="keyword">this</span>.commands[<span class="keyword">this</span>.index].<span class="function">execute</span>();
    }
  }
}</pre>
                        </div>

                        <div class="interactive-demo">
                            <h4>ğŸ® Try the Undo/Redo System</h4>
                            <input type="text" id="textEditor" placeholder="Type here..." style="width: 100%; padding: 10px; margin: 10px 0;">
                            <div>
                                <button class="btn" onclick="textCommand('type')">Type Text</button>
                                <button class="btn btn-secondary" onclick="textCommand('undo')">â†©ï¸ Undo</button>
                                <button class="btn btn-secondary" onclick="textCommand('redo')">â†ªï¸ Redo</button>
                            </div>
                            <div id="commandOutput" style="margin-top: 10px; padding: 10px; background: white; border-radius: 4px; min-height: 40px;"></div>
                        </div>
                    </div>

                    <button class="btn" onclick="completeSection('behavioral'); showSection('when-to-use')">
                        Learn When to Use What â†’
                    </button>
                </section>

                <!-- When to Use -->
                <section id="when-to-use" class="pattern-section">
                    <h2>ğŸ¯ Pattern Decision Guide</h2>
                    <p>Don't just know patternsâ€”know when to apply them. Use this interactive guide:</p>

                    <div class="decision-tree">
                        <div class="tree-node" onclick="showDecision('creation')">
                            I need to create objects flexibly
                        </div>
                        <div class="tree-connector"></div>
                        <div style="display: flex; gap: 20px; justify-content: center;">
                            <div class="tree-node" onclick="showDecision('structure')">
                                I need to organize/classify objects
                            </div>
                            <div class="tree-node" onclick="showDecision('behavior')">
                                I need to manage communication
                            </div>
                        </div>
                    </div>

                    <div id="decision-creation" class="decision-content hidden">
                        <h3>Creational Decision Matrix</h3>
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr style="background: var(--primary); color: white;">
                                <th style="padding: 10px;">If you need...</th>
                                <th style="padding: 10px;">Use...</th>
                                <th style="padding: 10px;">Example</th>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Exactly one instance</td>
                                <td style="padding: 10px; border: 1px solid #ddd;"><strong>Singleton</strong></td>
                                <td style="padding: 10px; border: 1px solid #ddd;">Config, Logger, DB Connection</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Different types based on input</td>
                                <td style="padding: 10px; border: 1px solid #ddd;"><strong>Factory</strong></td>
                                <td style="padding: 10px; border: 1px solid #ddd;">UI Components, Payment methods</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Step-by-step construction</td>
                                <td style="padding: 10px; border: 1px solid #ddd;"><strong>Builder</strong></td>
                                <td style="padding: 10px; border: 1px solid #ddd;">SQL Queries, HTTP Requests</td>
                            </tr>
                        </table>
                    </div>

                    <div id="decision-behavior" class="decision-content hidden">
                        <h3>Common Scenarios & Solutions</h3>
                        <div class="pattern-card">
                            <strong>Scenario:</strong> "My component needs to react to data changes from multiple sources"<br>
                            <strong>Solution:</strong> <span class="tag behavioral">Observer</span> or Event Bus
                        </div>
                        <div class="pattern-card">
                            <strong>Scenario:</strong> "I have a massive switch statement for validation/processing"<br>
                            <strong>Solution:</strong> <span class="tag behavioral">Strategy</span> Pattern
                        </div>
                        <div class="pattern-card">
                            <strong>Scenario:</strong> "I need undo/redo functionality"<br>
                            <strong>Solution:</strong> <span class="tag behavioral">Command</span> Pattern
                        </div>
                        <div class="pattern-card">
                            <strong>Scenario:</strong> "Different algorithms need to be interchangeable at runtime"<br>
                            <strong>Solution:</strong> <span class="tag behavioral">Strategy</span> Pattern
                        </div>
                    </div>

                    <div class="warning-box">
                        <strong>ğŸš« Anti-Pattern Alert: Pattern Obsession</strong>
                        <p>Don't force patterns where simple code suffices. A quote from the GoF book:</p>
                        <em>"Design patterns should not be applied indiscriminately. Often the easiest solution is the best."</em>
                    </div>
                </section>

                <!-- Playground -->
                <section id="playground" class="pattern-section">
                    <h2>ğŸ› Pattern Playground</h2>
                    <p>Experiment with patterns in a safe environment. Write code below and see it execute:</p>
                    
                    <div style="margin: 20px 0;">
                        <label>Select Template:</label>
                        <select id="templateSelect" onchange="loadTemplate()" style="padding: 8px; margin-left: 10px;">
                            <option value="">-- Blank --</option>
                            <option value="singleton">Singleton Template</option>
                            <option value="observer">Observer Template</option>
                            <option value="factory">Factory Template</option>
                            <option value="strategy">Strategy Template</option>
                        </select>
                    </div>

                    <textarea class="sandbox" id="playgroundCode" style="min-height: 300px;">// Write your pattern implementation here
// console.log() will output below

class Example {
  constructor() {
    console.log('Hello Pattern Master!');
  }
}

const test = new Example();</textarea>
                    
                    <button class="btn" onclick="runPlayground()">â–¶ï¸ Run Code</button>
                    <button class="btn btn-secondary" onclick="document.getElementById('playgroundCode').value=''">Clear</button>
                    
                    <div class="output-console" id="playgroundOutput" style="margin-top: 20px;">Output will appear here...</div>
                </section>

                <!-- Interview Prep -->
                <section id="interview" class="pattern-section">
                    <h2>ğŸ’¼ Interview Prep</h2>
                    <p>Common questions from FAANG and top-tier companies:</p>

                    <div class="quiz-container">
                        <h4>Question 1: React & Patterns</h4>
                        <p>React's useEffect hook cleanup function uses which pattern?</p>
                        <button class="quiz-option" onclick="checkAnswer(this, false)">Factory Pattern</button>
                        <button class="quiz-option" onclick="checkAnswer(this, true)">Observer Pattern (Unsubscription)</button>
                        <button class="quiz-option" onclick="checkAnswer(this, false)">Singleton Pattern</button>
                    </div>

                    <div class="quiz-container">
                        <h4>Question 2: Module Scope</h4>
                        <p>What's the output of this code?</p>
                        <pre style="background: #f3f4f6; padding: 10px; margin: 10px 0;">
// module.js
export const count = 0;
export function increment() { count++; }

// main.js
import { count, increment } from './module.js';
increment();
console.log(count);</pre>
                        <button class="quiz-option" onclick="checkAnswer(this, false)">1</button>
                        <button class="quiz-option" onclick="checkAnswer(this, true)">Error (cannot reassign imported binding)</button>
                        <button class="quiz-option" onclick="checkAnswer(this, false)">0</button>
                    </div>

                    <div class="pattern-card">
                        <h4>ğŸ” System Design Scenario</h4>
                        <p><strong>"Design a notification system that supports Email, SMS, and Push notifications. Users can choose multiple channels. How do you structure this?"</strong></p>
                        <br>
                        <p><strong>Expected Answer:</strong></p>
                        <ul>
                            <li>Use <strong>Strategy Pattern</strong> for different notification channels (EmailStrategy, SMSStrategy)</li>
                            <li>Use <strong>Observer Pattern</strong> to notify all subscribed channels when event occurs</li>
                            <li>Use <strong>Factory Pattern</strong> to create appropriate channel instances based on user preferences</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h4>âœ… Checklist for Job Readiness</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li><input type="checkbox"> Can implement Singleton, Factory, Observer from scratch</li>
                            <li><input type="checkbox"> Know when NOT to use Singleton (testing issues)</li>
                            <li><input type="checkbox"> Understand Module pattern for encapsulation</li>
                            <li><input type="checkbox"> Can explain Strategy vs Factory difference</li>
                            <li><input type="checkbox"> Know memory leak risks in Observer pattern</li>
                            <li><input type="checkbox"> Can refactor spaghetti code using patterns</li>
                        </ul>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // State Management (using Module pattern!)
        const AppState = (function() {
            let progress = {
                creational: false,
                structural: false,
                behavioral: false
            };
            
            return {
                complete: function(section) {
                    progress[section] = true;
                    updateProgressUI();
                },
                getProgress: function() {
                    const completed = Object.values(progress).filter(v => v).length;
                    return Math.round((completed / 3) * 100);
                }
            };
        })();

        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.pattern-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            event.target.closest('.nav-item')?.classList.add('active');
            
            window.scrollTo(0, 0);
        }

        function completeSection(section) {
            AppState.complete(section);
            event.target.textContent = "âœ“ Completed";
            event.target.disabled = true;
        }

        function updateProgressUI() {
            const percent = AppState.getProgress();
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressText').textContent = percent + '%';
            
            const completed = Math.floor(percent / 33.33);
            document.getElementById('patternsCompleted').textContent = `${completed}/12 Patterns Viewed`;
        }

        // Singleton Demo
        let databaseInstance = null;
        let connectionCount = 0;

        class DatabaseDemo {
            constructor() {
                if (DatabaseDemo.instance) {
                    return DatabaseDemo.instance;
                }
                connectionCount++;
                this.id = Math.random().toString(36).substr(2, 9);
                DatabaseDemo.instance = this;
            }
        }

        function singletonDemo() {
            const db = new DatabaseDemo();
            const output = document.getElementById('singletonOutput');
            output.innerHTML += `Instance ID: ${db.id} | Total connections created: ${connectionCount}\n`;
            output.scrollTop = output.scrollHeight;
        }

        function resetSingleton() {
            DatabaseDemo.instance = null;
            connectionCount = 0;
            document.getElementById('singletonOutput').textContent = 'Reset! Try creating instances again.\n';
        }

        // Observer Demo (Stock Market)
        const stockObservable = {
            observers: [],
            price: 100,
            subscribe: function(fn) {
                this.observers.push(fn);
                return () => {
                    this.observers = this.observers.filter(obs => obs !== fn);
                };
            },
            notify: function() {
                this.observers.forEach(fn => fn(this.price));
            },
            setPrice: function(newPrice) {
                this.price = newPrice;
                this.notify();
            }
        };

        function subscribeStock(name) {
            stockObservable.subscribe((price) => {
                const output = document.getElementById('stockOutput');
                output.innerHTML += `[${new Date().toLocaleTimeString()}] ${name} notified: Price is now $${price}\n`;
                output.scrollTop = output.scrollHeight;
            });
            document.getElementById('stockOutput').innerHTML += `>> ${name} subscribed to stock alerts\n`;
        }

        function updateStockPrice() {
            const newPrice = Math.floor(Math.random() * 50) + 80;
            stockObservable.setPrice(newPrice);
        }

        // Command Pattern Demo (Undo/Redo)
        const textEditorState = {
            content: '',
            history: [],
            historyIndex: -1,
            
            execute: function(command) {
                this.history = this.history.slice(0, this.historyIndex + 1);
                this.history.push(command);
                this.historyIndex++;
                command.execute();
                this.updateDisplay();
            },
            
            undo: function() {
                if (this.historyIndex >= 0) {
                    this.history[this.historyIndex].undo();
                    this.historyIndex--;
                    this.updateDisplay();
                }
            },
            
            redo: function() {
                if (this.historyIndex < this.history.length - 1) {
                    this.historyIndex++;
                    this.history[this.historyIndex].execute();
                    this.updateDisplay();
                }
            },
            
            updateDisplay: function() {
                document.getElementById('commandOutput').innerHTML = 
                    `<strong>Current:</strong> "${this.content}"<br>
                     <small>History position: ${this.historyIndex + 1}/${this.history.length}</small>`;
            }
        };

        class TypeCommand {
            constructor(char, editor) {
                this.char = char;
                this.editor = editor;
                this.prevContent = editor.content;
            }
            execute() {
                this.editor.content += this.char;
            }
            undo() {
                this.editor.content = this.prevContent;
            }
        }

        function textCommand(action) {
            const input = document.getElementById('textEditor');
            if (action === 'type' && input.value) {
                const cmd = new TypeCommand(input.value, textEditorState);
                textEditorState.execute(cmd);
                input.value = '';
            } else if (action === 'undo') {
                textEditorState.undo();
            } else if (action === 'redo') {
                textEditorState.redo();
            }
        }

        // Quiz System
        function checkAnswer(btn, isCorrect) {
            const options = btn.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.disabled = true;
                opt.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                btn.classList.add('correct');
                btn.innerHTML += ' âœ“ Correct!';
            } else {
                btn.classList.add('wrong');
                btn.innerHTML += ' âœ— Wrong';
                // Highlight correct answer
                options.forEach(opt => {
                    if (opt.onclick.toString().includes('true')) {
                        opt.classList.add('correct');
                    }
                });
            }
        }

        // Exercise Runner
        function runFactoryExercise() {
            const code = document.getElementById('factoryExercise').value;
            const output = document.getElementById('factoryOutput');
            
            try {
                // Sandbox execution (simplified)
                output.innerHTML = '';
                const console = {
                    log: (...args) => {
                        output.innerHTML += args.join(' ') + '\n';
                    }
                };
                
                eval(code);
                output.style.color = '#4ade80';
            } catch (e) {
                output.innerHTML = 'Error: ' + e.message;
                output.style.color = '#ef4444';
            }
        }

        // Playground
        const templates = {
            singleton: `class Singleton {
  constructor() {
    if (!Singleton.instance) {
      Singleton.instance = this;
      this.data = [];
    }
    return Singleton.instance;
  }
  
  add(item) {
    this.data.push(item);
    console.log('Added:', item);
    console.log('All items:', this.data);
  }
}

const s1 = new Singleton();
const s2 = new Singleton();
console.log('Same instance?', s1 === s2);
s1.add('First item');
s2.add('Second item');`,
            
            observer: `class Subject {
  constructor() {
    this.observers = [];
  }
  
  subscribe(fn) {
    this.observers.push(fn);
    console.log('New subscriber added');
  }
  
  notify(data) {
    console.log('Notifying', this.observers.length, 'observers');
    this.observers.forEach(fn => fn(data));
  }
}

const subject = new Subject();
subject.subscribe(data => console.log('Subscriber 1 received:', data));
subject.subscribe(data => console.log('Subscriber 2 received:', data));

subject.notify('Hello Observers!');`,

            factory: `class ButtonFactory {
  static create(type) {
    if (type === 'primary') {
      return { style: 'bg-blue-500', text: 'Submit' };
    }
    if (type === 'danger') {
      return { style: 'bg-red-500', text: 'Delete' };
    }
    return { style: 'bg-gray-500', text: 'Default' };
  }
}

const btn1 = ButtonFactory.create('primary');
const btn2 = ButtonFactory.create('danger');
console.log('Created buttons:', btn1, btn2);`,

            strategy: `const strategies = {
  add: (a, b) => a + b,
  subtract: (a, b) => a - b,
  multiply: (a, b) => a * b
};

function execute(strategy, a, b) {
  console.log(\`Executing \${strategy} on \${a} and \${b}\`);
  return strategies[strategy](a, b);
}

console.log('Result:', execute('add', 5, 3));
console.log('Result:', execute('multiply', 4, 2));`
        };

        function loadTemplate() {
            const select = document.getElementById('templateSelect');
            const code = templates[select.value] || '';
            document.getElementById('playgroundCode').value = code;
        }

        function runPlayground() {
            const code = document.getElementById('playgroundCode').value;
            const output = document.getElementById('playgroundOutput');
            
            output.innerHTML = '';
            const originalLog = console.log;
            
            try {
                const sandboxConsole = {
                    log: (...args) => {
                        output.innerHTML += args.map(arg => 
                            typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                        ).join(' ') + '\n';
                    }
                };
                
                // Create a safe-ish eval context
                const func = new Function('console', code);
                func(sandboxConsole);
                
                output.style.borderLeft = '4px solid #10b981';
            } catch (e) {
                output.innerHTML = 'âŒ Error: ' + e.message;
                output.style.borderLeft = '4px solid #ef4444';
            }
        }

        // Copy code functionality
        function copyCode(btn) {
            const codeBlock = btn.nextElementSibling;
            const text = codeBlock.innerText;
            navigator.clipboard.writeText(text).then(() => {
                const original = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = original, 2000);
            });
        }

        // Decision tree
        function showDecision(type) {
            document.querySelectorAll('.decision-content').forEach(el => el.classList.add('hidden'));
            const target = document.getElementById('decision-' + type);
            if (target) {
                target.classList.remove('hidden');
                target.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ“ Design Patterns Masterclass Loaded');
            console.log('ğŸ’¡ Tip: Check the console for pattern examples as you navigate');
        });
    </script>
</body>
</html>