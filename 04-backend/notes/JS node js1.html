<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Node.js Mastery - Interactive Learning</title>
<style>
:root {
  --bg-dark: #0d1117;
  --bg-card: #161b22;
  --bg-code: #1a1e26;
  --bg-sidebar: #010409;
  --accent: #58a6ff;
  --accent2: #3fb950;
  --accent3: #f0883e;
  --accent4: #bc8cff;
  --accent5: #ff7b72;
  --text: #e6edf3;
  --text-dim: #8b949e;
  --border: #30363d;
  --success: #3fb950;
  --error: #f85149;
  --warning: #d29922;
  --node-green: #68a063;
  --node-dark: #333;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: var(--bg-dark);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg-dark); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

/* Layout */
.app-container {
  display: flex;
  min-height: 100vh;
}

/* Sidebar */
.sidebar {
  width: 280px;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border);
  padding: 0;
  position: fixed;
  top: 0;
  left: 0;
  height: 100vh;
  overflow-y: auto;
  z-index: 100;
  transition: transform 0.3s ease;
}

.sidebar-header {
  padding: 20px;
  border-bottom: 1px solid var(--border);
  text-align: center;
}

.sidebar-logo {
  width: 60px;
  height: 60px;
  margin: 0 auto 10px;
  background: var(--node-green);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: 900;
  color: #fff;
  box-shadow: 0 0 20px rgba(104,160,99,0.4);
  animation: pulse-logo 3s ease-in-out infinite;
}

@keyframes pulse-logo {
  0%, 100% { box-shadow: 0 0 20px rgba(104,160,99,0.4); }
  50% { box-shadow: 0 0 35px rgba(104,160,99,0.7); }
}

.sidebar-header h2 {
  color: var(--node-green);
  font-size: 18px;
}

.sidebar-header p {
  color: var(--text-dim);
  font-size: 12px;
  margin-top: 4px;
}

.progress-container {
  padding: 15px 20px;
  border-bottom: 1px solid var(--border);
}

.progress-label {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--text-dim);
  margin-bottom: 6px;
}

.progress-bar {
  width: 100%;
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--node-green), var(--accent));
  border-radius: 3px;
  transition: width 0.5s ease;
  width: 0%;
}

.nav-section {
  padding: 10px 0;
}

.nav-section-title {
  padding: 8px 20px;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--text-dim);
  font-weight: 600;
}

.nav-item {
  display: flex;
  align-items: center;
  padding: 10px 20px;
  cursor: pointer;
  transition: all 0.2s;
  border-left: 3px solid transparent;
  gap: 10px;
  font-size: 14px;
  color: var(--text-dim);
}

.nav-item:hover {
  background: rgba(88,166,255,0.05);
  color: var(--text);
}

.nav-item.active {
  background: rgba(88,166,255,0.1);
  border-left-color: var(--accent);
  color: var(--accent);
}

.nav-item.completed .nav-icon {
  background: var(--success);
  color: #fff;
}

.nav-icon {
  width: 26px;
  height: 26px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  background: var(--border);
  flex-shrink: 0;
}

/* Main Content */
.main-content {
  margin-left: 280px;
  flex: 1;
  padding: 30px 40px;
  max-width: 1000px;
}

.section {
  display: none;
}

.section.active {
  display: block;
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Hero Section */
.hero {
  text-align: center;
  padding: 40px 0 50px;
}

.hero-badge {
  display: inline-block;
  padding: 6px 16px;
  background: rgba(104,160,99,0.15);
  border: 1px solid rgba(104,160,99,0.3);
  border-radius: 20px;
  font-size: 13px;
  color: var(--node-green);
  margin-bottom: 20px;
}

.hero h1 {
  font-size: 42px;
  background: linear-gradient(135deg, var(--node-green), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 15px;
  line-height: 1.2;
}

.hero p {
  font-size: 18px;
  color: var(--text-dim);
  max-width: 600px;
  margin: 0 auto 30px;
  line-height: 1.6;
}

.hero-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 30px;
}

.hero-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s;
  cursor: pointer;
}

.hero-card:hover {
  border-color: var(--accent);
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.hero-card .card-icon {
  font-size: 32px;
  margin-bottom: 10px;
}

.hero-card h3 {
  font-size: 14px;
  margin-bottom: 6px;
}

.hero-card p {
  font-size: 12px;
  margin: 0;
  color: var(--text-dim);
}

.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 28px;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: all 0.2s;
}

.btn-primary {
  background: var(--node-green);
  color: #fff;
}

.btn-primary:hover {
  background: #7ab870;
  box-shadow: 0 4px 15px rgba(104,160,99,0.4);
}

.btn-secondary {
  background: var(--bg-card);
  color: var(--text);
  border: 1px solid var(--border);
}

.btn-secondary:hover {
  border-color: var(--accent);
}

.btn-small {
  padding: 8px 16px;
  font-size: 13px;
}

/* Content Styling */
.content-header {
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid var(--border);
}

.content-header .chapter-label {
  color: var(--accent);
  font-size: 13px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}

.content-header h1 {
  font-size: 32px;
  margin-bottom: 10px;
}

.content-header p {
  color: var(--text-dim);
  font-size: 16px;
  line-height: 1.6;
}

h2 {
  font-size: 24px;
  margin: 35px 0 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

h3 {
  font-size: 18px;
  margin: 25px 0 12px;
  color: var(--accent);
}

p, li {
  line-height: 1.8;
  color: var(--text-dim);
  margin-bottom: 10px;
}

ul, ol {
  padding-left: 20px;
  margin-bottom: 15px;
}

strong { color: var(--text); }

/* Visual Diagram */
.diagram-container {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 30px;
  margin: 25px 0;
  overflow-x: auto;
}

.diagram-title {
  text-align: center;
  font-weight: 700;
  font-size: 16px;
  margin-bottom: 25px;
  color: var(--text);
}

/* Event Loop Diagram */
.event-loop-visual {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
  padding: 20px;
}

.el-box {
  padding: 15px 20px;
  border-radius: 10px;
  text-align: center;
  font-size: 13px;
  font-weight: 600;
  min-width: 120px;
  position: relative;
  transition: all 0.3s;
  cursor: pointer;
}

.el-box:hover {
  transform: scale(1.08);
}

.el-box.v8 {
  background: linear-gradient(135deg, #4285f4, #356ac3);
  color: #fff;
  box-shadow: 0 4px 15px rgba(66,133,244,0.3);
}

.el-box.libuv {
  background: linear-gradient(135deg, var(--accent3), #c76e2e);
  color: #fff;
  box-shadow: 0 4px 15px rgba(240,136,62,0.3);
}

.el-box.event-loop {
  background: linear-gradient(135deg, var(--node-green), #4a8a44);
  color: #fff;
  box-shadow: 0 4px 15px rgba(104,160,99,0.3);
  animation: rotate-border 4s linear infinite;
}

.el-box.callback-q {
  background: linear-gradient(135deg, var(--accent4), #9060d0);
  color: #fff;
  box-shadow: 0 4px 15px rgba(188,140,255,0.3);
}

.el-box.thread-pool {
  background: linear-gradient(135deg, var(--accent5), #d04040);
  color: #fff;
  box-shadow: 0 4px 15px rgba(248,81,73,0.3);
}

.el-arrow {
  font-size: 24px;
  color: var(--text-dim);
  animation: arrow-bounce 1.5s ease-in-out infinite;
}

@keyframes arrow-bounce {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(5px); }
}

@keyframes rotate-border {
  0% { box-shadow: 0 4px 15px rgba(104,160,99,0.3), 0 0 0 2px transparent; }
  50% { box-shadow: 0 4px 15px rgba(104,160,99,0.6), 0 0 0 2px rgba(104,160,99,0.3); }
  100% { box-shadow: 0 4px 15px rgba(104,160,99,0.3), 0 0 0 2px transparent; }
}

.el-box-sub {
  font-size: 10px;
  font-weight: 400;
  opacity: 0.85;
  margin-top: 4px;
}

/* Architecture layers */
.arch-layers {
  display: flex;
  flex-direction: column;
  gap: 4px;
  max-width: 600px;
  margin: 0 auto;
}

.arch-layer {
  padding: 18px 20px;
  border-radius: 10px;
  text-align: center;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
}

.arch-layer:hover {
  transform: scaleX(1.02);
}

.arch-layer .layer-detail {
  font-size: 11px;
  font-weight: 400;
  opacity: 0;
  max-height: 0;
  overflow: hidden;
  transition: all 0.3s;
  margin-top: 0;
  color: rgba(255,255,255,0.85);
}

.arch-layer.expanded .layer-detail {
  opacity: 1;
  max-height: 100px;
  margin-top: 8px;
}

.arch-layer:nth-child(1) { background: linear-gradient(90deg, #4285f4, #5a9cf5); color: #fff; }
.arch-layer:nth-child(2) { background: linear-gradient(90deg, var(--node-green), #7ab870); color: #fff; }
.arch-layer:nth-child(3) { background: linear-gradient(90deg, var(--accent3), #f5a050); color: #fff; }
.arch-layer:nth-child(4) { background: linear-gradient(90deg, var(--accent4), #c9a0ff); color: #fff; }
.arch-layer:nth-child(5) { background: linear-gradient(90deg, var(--accent5), #ff9590); color: #fff; }

/* Code Block */
.code-block {
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 10px;
  margin: 15px 0;
  overflow: hidden;
}

.code-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 15px;
  background: rgba(255,255,255,0.03);
  border-bottom: 1px solid var(--border);
}

.code-dots {
  display: flex;
  gap: 6px;
}

.code-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

.code-dot:nth-child(1) { background: #ff5f56; }
.code-dot:nth-child(2) { background: #ffbd2e; }
.code-dot:nth-child(3) { background: #27c93f; }

.code-filename {
  font-size: 12px;
  color: var(--text-dim);
  font-family: 'Courier New', monospace;
}

.code-copy {
  background: none;
  border: 1px solid var(--border);
  color: var(--text-dim);
  padding: 4px 10px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 11px;
  transition: all 0.2s;
}

.code-copy:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.code-body {
  padding: 15px;
  overflow-x: auto;
}

.code-body pre {
  font-family: 'Courier New', 'Fira Code', monospace;
  font-size: 13.5px;
  line-height: 1.7;
  white-space: pre;
  color: var(--text);
}

/* Syntax highlighting */
.kw { color: #ff7b72; }
.str { color: #a5d6ff; }
.fn { color: #d2a8ff; }
.cm { color: #8b949e; font-style: italic; }
.num { color: #79c0ff; }
.op { color: #ff7b72; }
.obj { color: #ffa657; }
.prop { color: #79c0ff; }
.param { color: #ffa657; }

/* Info Box */
.info-box {
  border-radius: 10px;
  padding: 18px 20px;
  margin: 20px 0;
  border-left: 4px solid;
  display: flex;
  gap: 12px;
  align-items: flex-start;
}

.info-box.tip {
  background: rgba(63,185,80,0.08);
  border-color: var(--success);
}

.info-box.warning {
  background: rgba(210,153,34,0.08);
  border-color: var(--warning);
}

.info-box.danger {
  background: rgba(248,81,73,0.08);
  border-color: var(--error);
}

.info-box.info {
  background: rgba(88,166,255,0.08);
  border-color: var(--accent);
}

.info-box-icon {
  font-size: 20px;
  flex-shrink: 0;
  margin-top: 2px;
}

.info-box-content h4 {
  font-size: 14px;
  margin-bottom: 5px;
}

.info-box-content p {
  font-size: 13px;
  margin: 0;
  line-height: 1.6;
}

/* Interactive Exercise */
.exercise-container {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 25px;
  margin: 25px 0;
}

.exercise-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.exercise-badge {
  padding: 4px 12px;
  border-radius: 15px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}

.exercise-badge.practice { background: rgba(88,166,255,0.15); color: var(--accent); }
.exercise-badge.challenge { background: rgba(240,136,62,0.15); color: var(--accent3); }

.exercise-container h3 {
  margin: 0 0 10px;
  color: var(--text);
}

.exercise-container p {
  font-size: 14px;
}

.code-editor {
  width: 100%;
  min-height: 120px;
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 15px;
  color: var(--text);
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.6;
  resize: vertical;
  outline: none;
  margin: 10px 0;
  tab-size: 2;
}

.code-editor:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(88,166,255,0.15);
}

.exercise-actions {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

.exercise-result {
  margin-top: 12px;
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 14px;
  display: none;
}

.exercise-result.success {
  display: block;
  background: rgba(63,185,80,0.1);
  border: 1px solid rgba(63,185,80,0.3);
  color: var(--success);
}

.exercise-result.error {
  display: block;
  background: rgba(248,81,73,0.1);
  border: 1px solid rgba(248,81,73,0.3);
  color: var(--error);
}

.exercise-result.info {
  display: block;
  background: rgba(88,166,255,0.1);
  border: 1px solid rgba(88,166,255,0.3);
  color: var(--accent);
}

/* Quiz */
.quiz-container {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 25px;
  margin: 20px 0;
}

.quiz-question {
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 15px;
  display: flex;
  gap: 10px;
}

.quiz-number {
  background: var(--accent);
  color: #fff;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  flex-shrink: 0;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.quiz-option {
  padding: 12px 16px;
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.quiz-option:hover:not(.disabled) {
  border-color: var(--accent);
  background: rgba(88,166,255,0.05);
}

.quiz-option.selected {
  border-color: var(--accent);
  background: rgba(88,166,255,0.1);
}

.quiz-option.correct {
  border-color: var(--success);
  background: rgba(63,185,80,0.1);
}

.quiz-option.wrong {
  border-color: var(--error);
  background: rgba(248,81,73,0.1);
}

.quiz-option.disabled {
  cursor: default;
  opacity: 0.7;
}

.quiz-option-marker {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  flex-shrink: 0;
  transition: all 0.2s;
}

.quiz-option.correct .quiz-option-marker {
  background: var(--success);
  border-color: var(--success);
  color: #fff;
}

.quiz-option.wrong .quiz-option-marker {
  background: var(--error);
  border-color: var(--error);
  color: #fff;
}

.quiz-explanation {
  margin-top: 12px;
  padding: 12px 16px;
  background: rgba(88,166,255,0.06);
  border-radius: 8px;
  font-size: 13px;
  color: var(--text-dim);
  display: none;
  line-height: 1.6;
  border-left: 3px solid var(--accent);
}

.quiz-explanation.visible {
  display: block;
  animation: fadeIn 0.3s ease;
}

/* Pitfall Card */
.pitfall-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin: 20px 0;
  overflow: hidden;
}

.pitfall-header {
  padding: 15px 20px;
  background: rgba(248,81,73,0.08);
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}

.pitfall-header h4 {
  font-size: 15px;
  color: var(--accent5);
}

.pitfall-body {
  padding: 20px;
}

.pitfall-compare {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 10px;
}

.pitfall-wrong, .pitfall-right {
  border-radius: 8px;
  overflow: hidden;
}

.pitfall-label {
  padding: 8px 12px;
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pitfall-wrong .pitfall-label {
  background: rgba(248,81,73,0.15);
  color: var(--error);
}

.pitfall-right .pitfall-label {
  background: rgba(63,185,80,0.15);
  color: var(--success);
}

/* Comparison Table */
.compare-table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
  font-size: 14px;
}

.compare-table th {
  background: var(--bg-code);
  padding: 12px 16px;
  text-align: left;
  border: 1px solid var(--border);
  font-weight: 600;
}

.compare-table td {
  padding: 10px 16px;
  border: 1px solid var(--border);
  color: var(--text-dim);
}

.compare-table tr:hover td {
  background: rgba(88,166,255,0.03);
}

/* Interactive Tabs */
.tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
  margin-bottom: 20px;
  gap: 0;
}

.tab {
  padding: 10px 20px;
  cursor: pointer;
  font-size: 14px;
  color: var(--text-dim);
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
}

.tab:hover { color: var(--text); }

.tab.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
  animation: fadeIn 0.3s ease;
}

/* Module Card */
.module-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 12px;
  margin: 20px 0;
}

.module-card {
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  transition: all 0.3s;
  cursor: pointer;
}

.module-card:hover {
  border-color: var(--accent);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.module-card .mod-icon {
  font-size: 28px;
  margin-bottom: 8px;
}

.module-card .mod-name {
  font-weight: 700;
  font-size: 14px;
  color: var(--text);
  font-family: monospace;
}

.module-card .mod-desc {
  font-size: 11px;
  color: var(--text-dim);
  margin-top: 4px;
}

/* Interactive Terminal */
.terminal {
  background: #000;
  border-radius: 10px;
  margin: 20px 0;
  overflow: hidden;
  border: 1px solid var(--border);
}

.terminal-header {
  background: #1a1a1a;
  padding: 8px 15px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.terminal-header span {
  font-size: 12px;
  color: #aaa;
  margin-left: auto;
}

.terminal-body {
  padding: 15px;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  min-height: 80px;
}

.terminal-line {
  margin-bottom: 4px;
  line-height: 1.6;
}

.terminal-prompt { color: var(--node-green); }
.terminal-output { color: #ccc; }
.terminal-error { color: var(--error); }

/* Animated Steps */
.step-list {
  margin: 20px 0;
}

.step-item {
  display: flex;
  gap: 15px;
  padding: 15px 0;
  border-bottom: 1px solid var(--border);
  align-items: flex-start;
  opacity: 0;
  transform: translateX(-20px);
  animation: slideInStep 0.5s ease forwards;
}

.step-item:nth-child(1) { animation-delay: 0.1s; }
.step-item:nth-child(2) { animation-delay: 0.2s; }
.step-item:nth-child(3) { animation-delay: 0.3s; }
.step-item:nth-child(4) { animation-delay: 0.4s; }
.step-item:nth-child(5) { animation-delay: 0.5s; }
.step-item:nth-child(6) { animation-delay: 0.6s; }

@keyframes slideInStep {
  to { opacity: 1; transform: translateX(0); }
}

.step-num {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: var(--accent);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 700;
  flex-shrink: 0;
}

.step-content h4 {
  font-size: 15px;
  margin-bottom: 4px;
  color: var(--text);
}

.step-content p {
  font-size: 13px;
  margin: 0;
}

/* Event Loop Animation */
.event-loop-animation {
  position: relative;
  width: 100%;
  max-width: 500px;
  height: 300px;
  margin: 20px auto;
}

.ela-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: var(--node-green);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 12px;
  color: #fff;
  text-align: center;
  z-index: 2;
}

.ela-orbit {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 260px;
  height: 260px;
  border-radius: 50%;
  border: 2px dashed var(--border);
  animation: spin 15s linear infinite;
}

.ela-item {
  position: absolute;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 600;
  color: #fff;
  text-align: center;
  animation: counter-spin 15s linear infinite;
}

.ela-item:nth-child(1) { top: -30px; left: calc(50% - 30px); background: #4285f4; }
.ela-item:nth-child(2) { top: calc(50% - 30px); right: -30px; background: var(--accent3); }
.ela-item:nth-child(3) { bottom: -30px; left: calc(50% - 30px); background: var(--accent4); }
.ela-item:nth-child(4) { top: calc(50% - 30px); left: -30px; background: var(--accent5); }

@keyframes spin { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }
@keyframes counter-spin { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } }

/* Score Display */
.score-display {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 30px;
  text-align: center;
  margin: 20px 0;
}

.score-circle {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  margin: 0 auto 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px;
  font-weight: 700;
  position: relative;
}

.score-circle::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  padding: 4px;
  background: conic-gradient(var(--success) var(--score-pct, 0%), var(--border) 0%);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
}

/* Navigation buttons */
.nav-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 40px;
  padding-top: 20px;
  border-top: 1px solid var(--border);
}

/* Floating Action */
.fab-menu {
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 1000;
}

.fab-btn {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: var(--node-green);
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(104,160,99,0.4);
  transition: all 0.2s;
  display: none;
}

.fab-btn:hover {
  transform: scale(1.1);
}

/* Mobile hamburger */
.mobile-toggle {
  display: none;
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 200;
  width: 40px;
  height: 40px;
  border-radius: 8px;
  background: var(--bg-card);
  border: 1px solid var(--border);
  color: var(--text);
  font-size: 20px;
  cursor: pointer;
  align-items: center;
  justify-content: center;
}

/* Tooltip */
.tooltip {
  position: relative;
  display: inline;
  border-bottom: 1px dashed var(--accent);
  cursor: help;
  color: var(--accent);
}

.tooltip .tooltip-text {
  visibility: hidden;
  background: var(--bg-code);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 12px;
  position: absolute;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  white-space: nowrap;
  z-index: 10;
  opacity: 0;
  transition: all 0.2s;
}

.tooltip:hover .tooltip-text {
  visibility: visible;
  opacity: 1;
}

/* Highlight */
.highlight {
  background: rgba(88,166,255,0.15);
  padding: 1px 6px;
  border-radius: 4px;
  font-family: monospace;
  font-size: 0.9em;
  color: var(--accent);
}

/* Comparison Visual */
.vs-container {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 15px;
  align-items: center;
  margin: 20px 0;
}

.vs-box {
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 20px;
  text-align: center;
}

.vs-divider {
  font-size: 24px;
  font-weight: 700;
  color: var(--text-dim);
}

/* XP Bar */
.xp-bar-container {
  margin: 15px 0;
}

.xp-bar-label {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--text-dim);
  margin-bottom: 4px;
}

.xp-bar {
  height: 8px;
  background: var(--border);
  border-radius: 4px;
  overflow: hidden;
}

.xp-bar-fill {
  height: 100%;
  border-radius: 4px;
  background: linear-gradient(90deg, var(--accent), var(--accent4));
  transition: width 0.5s ease;
}

/* Confetti */
.confetti-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
}

.confetti {
  position: absolute;
  width: 10px;
  height: 10px;
  top: -10px;
  animation: confetti-fall 3s linear forwards;
}

@keyframes confetti-fall {
  to { top: 110vh; transform: rotate(720deg); }
}

/* Responsive */
@media (max-width: 768px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }
  .main-content { margin-left: 0; padding: 20px 15px; padding-top: 60px; }
  .mobile-toggle { display: flex; }
  .hero h1 { font-size: 28px; }
  .hero-cards { grid-template-columns: 1fr 1fr; }
  .pitfall-compare { grid-template-columns: 1fr; }
  .vs-container { grid-template-columns: 1fr; }
  .vs-divider { transform: rotate(90deg); }
  .event-loop-visual { flex-direction: column; }
  .el-arrow { transform: rotate(90deg); }
}

/* Keyboard shortcut hints */
.kbd {
  display: inline-block;
  padding: 2px 6px;
  font-size: 11px;
  font-family: monospace;
  background: var(--bg-code);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-dim);
}

/* Animated counter */
.stat-counter {
  display: flex;
  gap: 30px;
  justify-content: center;
  flex-wrap: wrap;
  margin: 20px 0;
}

.stat-item {
  text-align: center;
}

.stat-value {
  font-size: 36px;
  font-weight: 800;
  color: var(--accent);
}

.stat-label {
  font-size: 12px;
  color: var(--text-dim);
  margin-top: 4px;
}

/* Sandbox Output */
.sandbox-output {
  background: #000;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px 15px;
  margin-top: 10px;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  color: var(--node-green);
  min-height: 40px;
  max-height: 200px;
  overflow-y: auto;
}

.output-line {
  margin-bottom: 2px;
}

/* Flow diagram */
.flow-diagram {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  margin: 20px 0;
}

.flow-box {
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  text-align: center;
  min-width: 200px;
}

.flow-arrow {
  font-size: 18px;
  color: var(--text-dim);
}

.flow-box.req { background: rgba(88,166,255,0.15); color: var(--accent); border: 1px solid rgba(88,166,255,0.3); }
.flow-box.process { background: rgba(104,160,99,0.15); color: var(--node-green); border: 1px solid rgba(104,160,99,0.3); }
.flow-box.res { background: rgba(188,140,255,0.15); color: var(--accent4); border: 1px solid rgba(188,140,255,0.3); }

/* Accordion */
.accordion {
  margin: 15px 0;
}

.accordion-item {
  border: 1px solid var(--border);
  border-radius: 8px;
  margin-bottom: 8px;
  overflow: hidden;
}

.accordion-header {
  padding: 14px 18px;
  background: var(--bg-code);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.2s;
}

.accordion-header:hover {
  background: rgba(88,166,255,0.05);
}

.accordion-arrow {
  transition: transform 0.3s;
  font-size: 12px;
}

.accordion-item.open .accordion-arrow {
  transform: rotate(180deg);
}

.accordion-body {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

.accordion-body-inner {
  padding: 15px 18px;
}
</style>
</head>
<body>

<button class="mobile-toggle" onclick="toggleSidebar()">‚ò∞</button>

<div class="app-container">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">N</div>
      <h2>Node.js Mastery</h2>
      <p>Interactive Learning Path</p>
    </div>

    <div class="progress-container">
      <div class="progress-label">
        <span>Progress</span>
        <span id="progress-text">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="xp-bar-container">
        <div class="xp-bar-label">
          <span>‚ö° XP</span>
          <span id="xp-text">0 / 500</span>
        </div>
        <div class="xp-bar">
          <div class="xp-bar-fill" id="xp-fill" style="width:0%"></div>
        </div>
      </div>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">Getting Started</div>
      <div class="nav-item active" data-section="welcome" onclick="navigateTo('welcome')">
        <div class="nav-icon">üè†</div>
        <span>Welcome</span>
      </div>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">Chapters</div>
      <div class="nav-item" data-section="architecture" onclick="navigateTo('architecture')">
        <div class="nav-icon">üèóÔ∏è</div>
        <span>Node.js Architecture</span>
      </div>
      <div class="nav-item" data-section="modules" onclick="navigateTo('modules')">
        <div class="nav-icon">üì¶</div>
        <span>Modules System</span>
      </div>
      <div class="nav-item" data-section="filesystem" onclick="navigateTo('filesystem')">
        <div class="nav-icon">üìÅ</div>
        <span>File System</span>
      </div>
      <div class="nav-item" data-section="http" onclick="navigateTo('http')">
        <div class="nav-icon">üåê</div>
        <span>HTTP Server</span>
      </div>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">Practice</div>
      <div class="nav-item" data-section="exercises" onclick="navigateTo('exercises')">
        <div class="nav-icon">üí™</div>
        <span>Exercises</span>
      </div>
      <div class="nav-item" data-section="quiz" onclick="navigateTo('quiz')">
        <div class="nav-icon">üß†</div>
        <span>Final Quiz</span>
      </div>
      <div class="nav-item" data-section="pitfalls" onclick="navigateTo('pitfalls')">
        <div class="nav-icon">‚ö†Ô∏è</div>
        <span>Mistakes & Pitfalls</span>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">

    <!-- WELCOME SECTION -->
    <div class="section active" id="section-welcome">
      <div class="hero">
        <div class="hero-badge">üöÄ Interactive Course</div>
        <h1>Master Node.js Basics</h1>
        <p>Your complete guide to server-side JavaScript. Learn the architecture, modules, file system, and HTTP ‚Äî the foundational skills every competitive company looks for.</p>
        <button class="btn btn-primary" onclick="navigateTo('architecture')">Start Learning ‚Üí</button>

        <div class="stat-counter" style="margin-top:35px">
          <div class="stat-item">
            <div class="stat-value" data-count="5">0</div>
            <div class="stat-label">Chapters</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" data-count="12">0</div>
            <div class="stat-label">Examples</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" data-count="8">0</div>
            <div class="stat-label">Exercises</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" data-count="10">0</div>
            <div class="stat-label">Quiz Questions</div>
          </div>
        </div>

        <div class="hero-cards">
          <div class="hero-card" onclick="navigateTo('architecture')">
            <div class="card-icon">üèóÔ∏è</div>
            <h3>Architecture</h3>
            <p>V8 Engine, Event Loop, libuv</p>
          </div>
          <div class="hero-card" onclick="navigateTo('modules')">
            <div class="card-icon">üì¶</div>
            <h3>Modules</h3>
            <p>require, exports, npm</p>
          </div>
          <div class="hero-card" onclick="navigateTo('filesystem')">
            <div class="card-icon">üìÅ</div>
            <h3>File System</h3>
            <p>Read, Write, Delete files</p>
          </div>
          <div class="hero-card" onclick="navigateTo('http')">
            <div class="card-icon">üåê</div>
            <h3>HTTP Server</h3>
            <p>Create web servers</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ARCHITECTURE SECTION -->
    <div class="section" id="section-architecture">
      <div class="content-header">
        <div class="chapter-label">Chapter 1</div>
        <h1>üèóÔ∏è Node.js Architecture</h1>
        <p>Understand how Node.js works under the hood ‚Äî the secret sauce that makes it incredibly fast for I/O-heavy applications.</p>
      </div>

      <h2>ü§î What is Node.js?</h2>
      <p>Node.js is <strong>NOT</strong> a programming language. It's a <strong>runtime environment</strong> that lets you run JavaScript outside the browser ‚Äî on servers, your computer, even IoT devices.</p>

      <div class="vs-container">
        <div class="vs-box">
          <h3 style="margin-top:0">üåê Browser JS</h3>
          <p style="font-size:13px">Runs in Chrome, Firefox, etc.<br>Has <span class="highlight">window</span>, <span class="highlight">document</span><br>Limited by browser sandbox</p>
        </div>
        <div class="vs-divider">VS</div>
        <div class="vs-box">
          <h3 style="margin-top:0;color:var(--node-green)">‚öôÔ∏è Node.js</h3>
          <p style="font-size:13px">Runs on your machine<br>Has <span class="highlight">global</span>, <span class="highlight">process</span><br>Access to file system, network</p>
        </div>
      </div>

      <h2>üß¨ Architecture Layers</h2>
      <p>Click each layer to learn more:</p>

      <div class="diagram-container">
        <div class="diagram-title">Node.js Architecture Stack</div>
        <div class="arch-layers">
          <div class="arch-layer" onclick="toggleLayer(this)">
            üìù Your JavaScript Code
            <div class="layer-detail">The code YOU write ‚Äî your server logic, API routes, business logic. This is the top layer that you control.</div>
          </div>
          <div class="arch-layer" onclick="toggleLayer(this)">
            üì¶ Node.js APIs (Core Modules)
            <div class="layer-detail">Built-in modules like fs, http, path, crypto. JavaScript wrappers around C++ functionality. These are your tools.</div>
          </div>
          <div class="arch-layer" onclick="toggleLayer(this)">
            üîÑ Node.js Bindings (C++ bridge)
            <div class="layer-detail">Connects JavaScript to C++ code. When you call fs.readFile(), the binding translates it to a C++ operation.</div>
          </div>
          <div class="arch-layer" onclick="toggleLayer(this)">
            ‚ö° V8 Engine + libuv
            <div class="layer-detail">V8 compiles JS to machine code. libuv provides the event loop, async I/O, thread pool. This is where the magic happens!</div>
          </div>
          <div class="arch-layer" onclick="toggleLayer(this)">
            üñ•Ô∏è Operating System (Linux, macOS, Windows)
            <div class="layer-detail">The actual hardware and OS. File operations, network sockets, processes ‚Äî all handled at this lowest level.</div>
          </div>
        </div>
      </div>

      <h2>üîÑ The Event Loop ‚Äî Node's Superpower</h2>
      <p>The event loop is what makes Node.js <strong>non-blocking</strong>. Instead of waiting for slow operations (like reading files or making network calls), Node.js says <em>"I'll come back to you when you're ready"</em> and moves on to the next task.</p>

      <div class="diagram-container">
        <div class="diagram-title">How the Event Loop Works</div>
        <div class="event-loop-visual">
          <div class="el-box v8">
            V8 Engine
            <div class="el-box-sub">Executes your JS</div>
          </div>
          <div class="el-arrow">‚Üí</div>
          <div class="el-box event-loop">
            üîÑ Event Loop
            <div class="el-box-sub">Orchestrator</div>
          </div>
          <div class="el-arrow">‚Üí</div>
          <div class="el-box callback-q">
            Callback Queue
            <div class="el-box-sub">Waiting callbacks</div>
          </div>
        </div>
        <div class="event-loop-visual" style="margin-top:15px">
          <div class="el-box libuv">
            libuv
            <div class="el-box-sub">Async I/O engine</div>
          </div>
          <div class="el-arrow">‚Üí</div>
          <div class="el-box thread-pool">
            Thread Pool
            <div class="el-box-sub">4 threads (default)</div>
          </div>
        </div>
      </div>

      <h3>Event Loop in Action ‚Äî Step by Step</h3>
      <div class="step-list">
        <div class="step-item">
          <div class="step-num">1</div>
          <div class="step-content">
            <h4>Your code runs on the Call Stack</h4>
            <p>V8 picks up your synchronous code and executes it line by line.</p>
          </div>
        </div>
        <div class="step-item">
          <div class="step-num">2</div>
          <div class="step-content">
            <h4>Async operation detected!</h4>
            <p>When Node hits something like <span class="highlight">fs.readFile()</span>, it hands it off to libuv.</p>
          </div>
        </div>
        <div class="step-item">
          <div class="step-num">3</div>
          <div class="step-content">
            <h4>libuv handles it in the background</h4>
            <p>The thread pool works on the file read. Meanwhile, your code KEEPS RUNNING.</p>
          </div>
        </div>
        <div class="step-item">
          <div class="step-num">4</div>
          <div class="step-content">
            <h4>Operation complete ‚Üí Callback queued</h4>
            <p>When the file is read, the callback function goes into the callback queue.</p>
          </div>
        </div>
        <div class="step-item">
          <div class="step-num">5</div>
          <div class="step-content">
            <h4>Event Loop picks it up</h4>
            <p>When the call stack is empty, the event loop moves the callback to the stack for execution.</p>
          </div>
        </div>
      </div>

      <h3>See It In Code</h3>
      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">event-loop-demo.js</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'1Ô∏è‚É£ Start'</span>);

<span class="fn">setTimeout</span>(() <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'2Ô∏è‚É£ Timeout callback (async)'</span>);
}, <span class="num">0</span>);

<span class="obj">Promise</span>.<span class="fn">resolve</span>().<span class="fn">then</span>(() <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'3Ô∏è‚É£ Promise callback (microtask)'</span>);
});

<span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'4Ô∏è‚É£ End'</span>);

<span class="cm">// Output order:</span>
<span class="cm">// 1Ô∏è‚É£ Start</span>
<span class="cm">// 4Ô∏è‚É£ End</span>
<span class="cm">// 3Ô∏è‚É£ Promise callback (microtask)</span>
<span class="cm">// 2Ô∏è‚É£ Timeout callback (async)</span></pre></div>
      </div>

      <div class="info-box tip">
        <div class="info-box-icon">üí°</div>
        <div class="info-box-content">
          <h4>Why this order?</h4>
          <p>Synchronous code runs first (1 & 4). Microtasks (Promises) have higher priority than macrotasks (setTimeout). So 3 runs before 2, even though setTimeout has 0ms delay!</p>
        </div>
      </div>

      <h2>üÜö Blocking vs Non-Blocking</h2>

      <div class="pitfall-compare">
        <div class="pitfall-wrong">
          <div class="pitfall-label">‚ùå Blocking (Synchronous)</div>
          <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
            <div class="code-body"><pre><span class="cm">// Each line WAITS for the previous</span>
<span class="kw">const</span> data1 = <span class="obj">fs</span>.<span class="fn">readFileSync</span>(<span class="str">'big.txt'</span>);
<span class="cm">// ‚è≥ Waiting... 2 seconds</span>
<span class="kw">const</span> data2 = <span class="obj">fs</span>.<span class="fn">readFileSync</span>(<span class="str">'huge.txt'</span>);
<span class="cm">// ‚è≥ Waiting... 3 seconds</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Done'</span>);
<span class="cm">// Total: 5 seconds! üò∞</span></pre></div>
          </div>
        </div>
        <div class="pitfall-right">
          <div class="pitfall-label">‚úÖ Non-Blocking (Asynchronous)</div>
          <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
            <div class="code-body"><pre><span class="cm">// Both run AT THE SAME TIME!</span>
<span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'big.txt'</span>, (err, d1) <span class="op">=></span> {
  <span class="cm">// Ready after 2 seconds</span>
});
<span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'huge.txt'</span>, (err, d2) <span class="op">=></span> {
  <span class="cm">// Ready after 3 seconds</span>
});
<span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Moving on!'</span>);
<span class="cm">// Total: 3 seconds! üöÄ</span></pre></div>
          </div>
        </div>
      </div>

      <div class="info-box info">
        <div class="info-box-icon">üéØ</div>
        <div class="info-box-content">
          <h4>Interview Tip</h4>
          <p>When asked "Is Node.js single-threaded?", answer: "Node.js uses a <strong>single thread for the event loop and JavaScript execution</strong>, but libuv uses a <strong>thread pool (default 4 threads)</strong> for heavy operations like file I/O and crypto."</p>
        </div>
      </div>

      <!-- Quick Quiz for this section -->
      <div class="quiz-container" id="arch-quiz-1">
        <div class="quiz-question">
          <div class="quiz-number">?</div>
          <span>Quick Check: What engine does Node.js use to execute JavaScript?</span>
        </div>
        <div class="quiz-options">
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'arch-quiz-1')">
            <div class="quiz-option-marker">A</div>
            <span>SpiderMonkey</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, true, 'arch-quiz-1')">
            <div class="quiz-option-marker">B</div>
            <span>V8 (created by Google)</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'arch-quiz-1')">
            <div class="quiz-option-marker">C</div>
            <span>Chakra</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'arch-quiz-1')">
            <div class="quiz-option-marker">D</div>
            <span>JavaScriptCore</span>
          </div>
        </div>
        <div class="quiz-explanation" id="arch-quiz-1-exp">
          ‚úÖ <strong>V8</strong> is Google's open-source JavaScript engine, written in C++. It's used in Chrome and Node.js. It compiles JS directly to machine code for blazing-fast performance.
        </div>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('welcome')">‚Üê Welcome</button>
        <button class="btn btn-primary" onclick="navigateTo('modules')">Modules System ‚Üí</button>
      </div>
    </div>

    <!-- MODULES SECTION -->
    <div class="section" id="section-modules">
      <div class="content-header">
        <div class="chapter-label">Chapter 2</div>
        <h1>üì¶ Modules System</h1>
        <p>Modules are the building blocks of Node.js applications. Learn how to organize code, use built-in modules, and create your own.</p>
      </div>

      <h2>üìê What Are Modules?</h2>
      <p>In Node.js, <strong>every file is a module</strong>. Modules let you split your code into separate files, each with its own scope. No more global variable pollution!</p>

      <div class="info-box tip">
        <div class="info-box-icon">üí°</div>
        <div class="info-box-content">
          <h4>Module = File</h4>
          <p>In Node.js, each .js file is automatically wrapped in a function, giving it its own scope. Variables you define in one file are NOT visible in others unless you explicitly export them.</p>
        </div>
      </div>

      <h2>üìã Three Types of Modules</h2>

      <div class="tabs" id="module-types-tabs">
        <div class="tab active" onclick="switchTab('module-types', 'core')">Core Modules</div>
        <div class="tab" onclick="switchTab('module-types', 'local')">Local Modules</div>
        <div class="tab" onclick="switchTab('module-types', 'npm')">npm Modules</div>
      </div>

      <div id="module-types-core" class="tab-content active">
        <p>Built into Node.js ‚Äî no installation needed. Just <span class="highlight">require()</span> them:</p>
        <div class="module-grid">
          <div class="module-card" onclick="this.classList.toggle('active')">
            <div class="mod-icon">üìÅ</div>
            <div class="mod-name">fs</div>
            <div class="mod-desc">File system operations</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üåê</div>
            <div class="mod-name">http</div>
            <div class="mod-desc">HTTP server & client</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üìÇ</div>
            <div class="mod-name">path</div>
            <div class="mod-desc">File path utilities</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üîó</div>
            <div class="mod-name">url</div>
            <div class="mod-desc">URL parsing</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üì°</div>
            <div class="mod-name">events</div>
            <div class="mod-desc">Event emitter pattern</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üíæ</div>
            <div class="mod-name">buffer</div>
            <div class="mod-desc">Binary data handling</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üîí</div>
            <div class="mod-name">crypto</div>
            <div class="mod-desc">Cryptography functions</div>
          </div>
          <div class="module-card">
            <div class="mod-icon">üñ•Ô∏è</div>
            <div class="mod-name">os</div>
            <div class="mod-desc">Operating system info</div>
          </div>
        </div>
        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">core-modules.js</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="cm">// Import core modules using require()</span>
<span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);
<span class="kw">const</span> path = <span class="fn">require</span>(<span class="str">'path'</span>);
<span class="kw">const</span> http = <span class="fn">require</span>(<span class="str">'http'</span>);
<span class="kw">const</span> os = <span class="fn">require</span>(<span class="str">'os'</span>);
<span class="kw">const</span> crypto = <span class="fn">require</span>(<span class="str">'crypto'</span>);

<span class="cm">// Use them!</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">os</span>.<span class="fn">platform</span>());  <span class="cm">// 'linux', 'darwin', 'win32'</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">os</span>.<span class="fn">cpus</span>().<span class="prop">length</span>); <span class="cm">// Number of CPU cores</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">os</span>.<span class="fn">freemem</span>());  <span class="cm">// Available memory in bytes</span></pre></div>
        </div>
      </div>

      <div id="module-types-local" class="tab-content">
        <p>Files YOU create. Export functionality with <span class="highlight">module.exports</span> and import with <span class="highlight">require()</span>:</p>

        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">math.js (your custom module)</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="cm">// ‚úÖ Export functions from your module</span>

<span class="kw">function</span> <span class="fn">add</span>(<span class="param">a</span>, <span class="param">b</span>) {
  <span class="kw">return</span> a + b;
}

<span class="kw">function</span> <span class="fn">multiply</span>(<span class="param">a</span>, <span class="param">b</span>) {
  <span class="kw">return</span> a * b;
}

<span class="kw">const</span> PI = <span class="num">3.14159</span>;

<span class="cm">// Method 1: Export an object</span>
<span class="obj">module</span>.<span class="prop">exports</span> = { add, multiply, PI };

<span class="cm">// Method 2: Export individually</span>
<span class="cm">// exports.add = add;</span>
<span class="cm">// exports.multiply = multiply;</span>
<span class="cm">// exports.PI = PI;</span></pre></div>
        </div>

        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">app.js (imports your module)</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="cm">// ‚úÖ Import with RELATIVE path (./ or ../)</span>
<span class="kw">const</span> math = <span class="fn">require</span>(<span class="str">'./math'</span>);  <span class="cm">// .js extension optional</span>

<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">math</span>.<span class="fn">add</span>(<span class="num">5</span>, <span class="num">3</span>));       <span class="cm">// 8</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">math</span>.<span class="fn">multiply</span>(<span class="num">4</span>, <span class="num">7</span>)); <span class="cm">// 28</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">math</span>.<span class="prop">PI</span>);            <span class="cm">// 3.14159</span>

<span class="cm">// ‚úÖ Destructuring import</span>
<span class="kw">const</span> { add, PI } = <span class="fn">require</span>(<span class="str">'./math'</span>);
<span class="fn">console</span>.<span class="fn">log</span>(<span class="fn">add</span>(<span class="num">10</span>, <span class="num">20</span>));  <span class="cm">// 30</span></pre></div>
        </div>
      </div>

      <div id="module-types-npm" class="tab-content">
        <p>Third-party packages from the npm registry. Install with <span class="highlight">npm install</span>:</p>
        <div class="terminal">
          <div class="terminal-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span>Terminal</span>
          </div>
          <div class="terminal-body">
            <div class="terminal-line"><span class="terminal-prompt">$ </span><span class="terminal-output">npm init -y</span></div>
            <div class="terminal-line"><span class="terminal-prompt">$ </span><span class="terminal-output">npm install express</span></div>
            <div class="terminal-line"><span class="terminal-prompt">$ </span><span class="terminal-output">npm install lodash axios</span></div>
            <div class="terminal-line"><span class="terminal-output">added 57 packages in 3s</span></div>
          </div>
        </div>
        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">using-npm-modules.js</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="cm">// npm modules ‚Äî no ./ prefix!</span>
<span class="kw">const</span> express = <span class="fn">require</span>(<span class="str">'express'</span>);
<span class="kw">const</span> _ = <span class="fn">require</span>(<span class="str">'lodash'</span>);
<span class="kw">const</span> axios = <span class="fn">require</span>(<span class="str">'axios'</span>);

<span class="cm">// Node looks in node_modules/ folder</span></pre></div>
        </div>
      </div>

      <h2>üî¨ The Module Wrapper</h2>
      <p>Behind the scenes, Node.js wraps every file in a function. This is why each module has its own scope:</p>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">What Node.js actually does</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="cm">// Node.js secretly wraps your code in this:</span>
(<span class="kw">function</span>(<span class="param">exports</span>, <span class="param">require</span>, <span class="param">module</span>, <span class="param">__filename</span>, <span class="param">__dirname</span>) {

  <span class="cm">// YOUR CODE GOES HERE</span>
  <span class="kw">const</span> greeting = <span class="str">'Hello'</span>;  <span class="cm">// NOT global!</span>
  <span class="obj">module</span>.<span class="prop">exports</span> = greeting;

});

<span class="cm">// This gives you access to:</span>
<span class="cm">// exports    ‚Üí shorthand for module.exports</span>
<span class="cm">// require    ‚Üí function to import other modules</span>
<span class="cm">// module     ‚Üí reference to current module</span>
<span class="cm">// __filename ‚Üí absolute path of this file</span>
<span class="cm">// __dirname  ‚Üí directory path of this file</span></pre></div>
      </div>

      <div class="info-box warning">
        <div class="info-box-icon">‚ö†Ô∏è</div>
        <div class="info-box-content">
          <h4>Common Mistake: exports vs module.exports</h4>
          <p><span class="highlight">exports</span> is just a reference to <span class="highlight">module.exports</span>. If you reassign <span class="highlight">exports = something</span>, you break the reference! Always use <span class="highlight">module.exports</span> for safety.</p>
        </div>
      </div>

      <h2>üÜö CommonJS vs ES Modules</h2>
      <table class="compare-table">
        <thead>
          <tr><th>Feature</th><th>CommonJS (CJS)</th><th>ES Modules (ESM)</th></tr>
        </thead>
        <tbody>
          <tr><td>Syntax</td><td><span class="highlight">require() / module.exports</span></td><td><span class="highlight">import / export</span></td></tr>
          <tr><td>Loading</td><td>Synchronous</td><td>Asynchronous</td></tr>
          <tr><td>File extension</td><td>.js (default)</td><td>.mjs or "type":"module"</td></tr>
          <tr><td>Node.js support</td><td>Since the beginning</td><td>v12+ (stable v14+)</td></tr>
          <tr><td>Used in</td><td>Most Node.js projects</td><td>Modern projects, Deno</td></tr>
        </tbody>
      </table>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">ES Modules syntax (modern)</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="cm">// package.json: { "type": "module" }</span>

<span class="cm">// Named exports</span>
<span class="kw">export</span> <span class="kw">function</span> <span class="fn">add</span>(<span class="param">a</span>, <span class="param">b</span>) { <span class="kw">return</span> a + b; }
<span class="kw">export</span> <span class="kw">const</span> PI = <span class="num">3.14</span>;

<span class="cm">// Default export</span>
<span class="kw">export default</span> <span class="kw">class</span> <span class="fn">Calculator</span> { ... }

<span class="cm">// Importing</span>
<span class="kw">import</span> Calculator, { add, PI } <span class="kw">from</span> <span class="str">'./math.js'</span>;
<span class="kw">import</span> express <span class="kw">from</span> <span class="str">'express'</span>;</pre></div>
      </div>

      <div class="quiz-container" id="mod-quiz-1">
        <div class="quiz-question">
          <div class="quiz-number">?</div>
          <span>How do you import a local module called "utils.js" in the same directory?</span>
        </div>
        <div class="quiz-options">
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'mod-quiz-1')">
            <div class="quiz-option-marker">A</div>
            <span><code>const utils = require('utils');</code></span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, true, 'mod-quiz-1')">
            <div class="quiz-option-marker">B</div>
            <span><code>const utils = require('./utils');</code></span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'mod-quiz-1')">
            <div class="quiz-option-marker">C</div>
            <span><code>import utils from 'utils';</code></span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'mod-quiz-1')">
            <div class="quiz-option-marker">D</div>
            <span><code>const utils = include('./utils');</code></span>
          </div>
        </div>
        <div class="quiz-explanation" id="mod-quiz-1-exp">
          ‚úÖ Local modules MUST start with <strong>./</strong> or <strong>../</strong>. Without the dot, Node thinks it's a core module or npm package and will look in node_modules/ folder.
        </div>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('architecture')">‚Üê Architecture</button>
        <button class="btn btn-primary" onclick="navigateTo('filesystem')">File System ‚Üí</button>
      </div>
    </div>

    <!-- FILE SYSTEM SECTION -->
    <div class="section" id="section-filesystem">
      <div class="content-header">
        <div class="chapter-label">Chapter 3</div>
        <h1>üìÅ File System Operations</h1>
        <p>The <span class="highlight">fs</span> module lets you create, read, update, delete, and watch files. This is something you can NEVER do in browser JavaScript!</p>
      </div>

      <h2>üìñ Reading Files</h2>

      <div class="tabs" id="fs-read-tabs">
        <div class="tab active" onclick="switchTab('fs-read', 'async')">Async (Callback)</div>
        <div class="tab" onclick="switchTab('fs-read', 'sync')">Sync</div>
        <div class="tab" onclick="switchTab('fs-read', 'promise')">Promise/Async-Await</div>
      </div>

      <div id="fs-read-async" class="tab-content active">
        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">read-async.js</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);

<span class="cm">// ‚úÖ Asynchronous ‚Äî NON-BLOCKING (preferred!)</span>
<span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'hello.txt'</span>, <span class="str">'utf8'</span>, (<span class="param">err</span>, <span class="param">data</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) {
    <span class="fn">console</span>.<span class="fn">error</span>(<span class="str">'Error reading file:'</span>, err.<span class="prop">message</span>);
    <span class="kw">return</span>;
  }
  <span class="fn">console</span>.<span class="fn">log</span>(data);  <span class="cm">// File contents!</span>
});

<span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'This runs BEFORE the file is read!'</span>);</pre></div>
        </div>
        <div class="info-box tip">
          <div class="info-box-icon">üí°</div>
          <div class="info-box-content">
            <h4>Always include 'utf8'!</h4>
            <p>Without the encoding argument, <span class="highlight">readFile</span> returns a Buffer (raw binary data). Add <span class="highlight">'utf8'</span> to get a readable string.</p>
          </div>
        </div>
      </div>

      <div id="fs-read-sync" class="tab-content">
        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">read-sync.js</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);

<span class="cm">// ‚ö†Ô∏è Synchronous ‚Äî BLOCKS the event loop!</span>
<span class="kw">try</span> {
  <span class="kw">const</span> data = <span class="obj">fs</span>.<span class="fn">readFileSync</span>(<span class="str">'hello.txt'</span>, <span class="str">'utf8'</span>);
  <span class="fn">console</span>.<span class="fn">log</span>(data);
} <span class="kw">catch</span> (err) {
  <span class="fn">console</span>.<span class="fn">error</span>(<span class="str">'Error:'</span>, err.<span class="prop">message</span>);
}

<span class="cm">// Use ONLY for: startup config, CLI tools</span>
<span class="cm">// NEVER use in: HTTP request handlers!</span></pre></div>
        </div>
        <div class="info-box danger">
          <div class="info-box-icon">üö´</div>
          <div class="info-box-content">
            <h4>Don't use Sync in servers!</h4>
            <p>Sync methods block ALL other requests. If 1000 users hit your server and you use readFileSync, they wait in line one by one. üò±</p>
          </div>
        </div>
      </div>

      <div id="fs-read-promise" class="tab-content">
        <div class="code-block">
          <div class="code-header">
            <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
            <span class="code-filename">read-promise.js</span>
            <button class="code-copy" onclick="copyCode(this)">Copy</button>
          </div>
          <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>).<span class="prop">promises</span>;
<span class="cm">// OR: const { readFile } = require('fs/promises');</span>

<span class="cm">// ‚úÖ Modern async/await ‚Äî cleanest syntax!</span>
<span class="kw">async function</span> <span class="fn">readMyFile</span>() {
  <span class="kw">try</span> {
    <span class="kw">const</span> data = <span class="kw">await</span> <span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'hello.txt'</span>, <span class="str">'utf8'</span>);
    <span class="fn">console</span>.<span class="fn">log</span>(data);
  } <span class="kw">catch</span> (err) {
    <span class="fn">console</span>.<span class="fn">error</span>(<span class="str">'Error:'</span>, err.<span class="prop">message</span>);
  }
}

<span class="fn">readMyFile</span>();

<span class="cm">// üèÜ Best practice for modern Node.js!</span></pre></div>
        </div>
        <div class="info-box tip">
          <div class="info-box-icon">üèÜ</div>
          <div class="info-box-content">
            <h4>This is the recommended approach!</h4>
            <p>fs/promises + async/await gives you clean, readable code that's non-blocking. Use this in new projects.</p>
          </div>
        </div>
      </div>

      <h2>‚úçÔ∏è Writing Files</h2>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">write-files.js</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);

<span class="cm">// ‚úÖ writeFile ‚Äî OVERWRITES existing content</span>
<span class="obj">fs</span>.<span class="fn">writeFile</span>(<span class="str">'output.txt'</span>, <span class="str">'Hello Node.js!'</span>, (<span class="param">err</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) <span class="kw">throw</span> err;
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'File written! ‚úÖ'</span>);
});

<span class="cm">// ‚úÖ appendFile ‚Äî ADDS to existing content</span>
<span class="obj">fs</span>.<span class="fn">appendFile</span>(<span class="str">'log.txt'</span>, <span class="str">'New log entry\n'</span>, (<span class="param">err</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) <span class="kw">throw</span> err;
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Appended! ‚úÖ'</span>);
});

<span class="cm">// ‚úÖ Write JSON data</span>
<span class="kw">const</span> users = [
  { <span class="prop">name</span>: <span class="str">'Alice'</span>, <span class="prop">age</span>: <span class="num">25</span> },
  { <span class="prop">name</span>: <span class="str">'Bob'</span>, <span class="prop">age</span>: <span class="num">30</span> }
];
<span class="kw">const</span> json = <span class="obj">JSON</span>.<span class="fn">stringify</span>(users, <span class="kw">null</span>, <span class="num">2</span>);
<span class="obj">fs</span>.<span class="fn">writeFile</span>(<span class="str">'users.json'</span>, json, (<span class="param">err</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) <span class="kw">throw</span> err;
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'JSON saved! ‚úÖ'</span>);
});</pre></div>
      </div>

      <h2>üóÇÔ∏è Directory & Other Operations</h2>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">directory-ops.js</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);
<span class="kw">const</span> path = <span class="fn">require</span>(<span class="str">'path'</span>);

<span class="cm">// üìÅ Create directory</span>
<span class="obj">fs</span>.<span class="fn">mkdir</span>(<span class="str">'myFolder'</span>, { <span class="prop">recursive</span>: <span class="kw">true</span> }, (<span class="param">err</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) <span class="kw">throw</span> err;
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Directory created!'</span>);
});

<span class="cm">// üìã List directory contents</span>
<span class="obj">fs</span>.<span class="fn">readdir</span>(<span class="str">'./'</span>, (<span class="param">err</span>, <span class="param">files</span>) <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Files:'</span>, files);
});

<span class="cm">// üóëÔ∏è Delete a file</span>
<span class="obj">fs</span>.<span class="fn">unlink</span>(<span class="str">'temp.txt'</span>, (<span class="param">err</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) <span class="kw">throw</span> err;
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'File deleted!'</span>);
});

<span class="cm">// üìä Get file info</span>
<span class="obj">fs</span>.<span class="fn">stat</span>(<span class="str">'hello.txt'</span>, (<span class="param">err</span>, <span class="param">stats</span>) <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Size:'</span>, <span class="obj">stats</span>.<span class="prop">size</span>, <span class="str">'bytes'</span>);
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Is file?'</span>, <span class="obj">stats</span>.<span class="fn">isFile</span>());
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Is dir?'</span>, <span class="obj">stats</span>.<span class="fn">isDirectory</span>());
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Modified:'</span>, <span class="obj">stats</span>.<span class="prop">mtime</span>);
});

<span class="cm">// üìÇ Path module helpers</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">path</span>.<span class="fn">join</span>(<span class="str">'/users'</span>, <span class="str">'john'</span>, <span class="str">'docs'</span>));
<span class="cm">// ‚Üí '/users/john/docs'</span>

<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">path</span>.<span class="fn">extname</span>(<span class="str">'photo.jpg'</span>));
<span class="cm">// ‚Üí '.jpg'</span>

<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">path</span>.<span class="fn">basename</span>(<span class="str">'/home/user/file.txt'</span>));
<span class="cm">// ‚Üí 'file.txt'</span></pre></div>
      </div>

      <h2>üîç Complete fs Cheat Sheet</h2>

      <table class="compare-table">
        <thead>
          <tr><th>Operation</th><th>Async</th><th>Sync</th></tr>
        </thead>
        <tbody>
          <tr><td>Read file</td><td><span class="highlight">fs.readFile()</span></td><td><span class="highlight">fs.readFileSync()</span></td></tr>
          <tr><td>Write file</td><td><span class="highlight">fs.writeFile()</span></td><td><span class="highlight">fs.writeFileSync()</span></td></tr>
          <tr><td>Append to file</td><td><span class="highlight">fs.appendFile()</span></td><td><span class="highlight">fs.appendFileSync()</span></td></tr>
          <tr><td>Delete file</td><td><span class="highlight">fs.unlink()</span></td><td><span class="highlight">fs.unlinkSync()</span></td></tr>
          <tr><td>Rename/Move</td><td><span class="highlight">fs.rename()</span></td><td><span class="highlight">fs.renameSync()</span></td></tr>
          <tr><td>Check exists</td><td><span class="highlight">fs.access()</span></td><td><span class="highlight">fs.existsSync()</span></td></tr>
          <tr><td>Create dir</td><td><span class="highlight">fs.mkdir()</span></td><td><span class="highlight">fs.mkdirSync()</span></td></tr>
          <tr><td>Read dir</td><td><span class="highlight">fs.readdir()</span></td><td><span class="highlight">fs.readdirSync()</span></td></tr>
          <tr><td>File info</td><td><span class="highlight">fs.stat()</span></td><td><span class="highlight">fs.statSync()</span></td></tr>
          <tr><td>Watch file</td><td colspan="2"><span class="highlight">fs.watch() / fs.watchFile()</span></td></tr>
        </tbody>
      </table>

      <div class="quiz-container" id="fs-quiz-1">
        <div class="quiz-question">
          <div class="quiz-number">?</div>
          <span>What happens if you use fs.writeFile() on a file that already exists?</span>
        </div>
        <div class="quiz-options">
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'fs-quiz-1')">
            <div class="quiz-option-marker">A</div>
            <span>It throws an error</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'fs-quiz-1')">
            <div class="quiz-option-marker">B</div>
            <span>It appends to the file</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, true, 'fs-quiz-1')">
            <div class="quiz-option-marker">C</div>
            <span>It overwrites the entire file</span>
          </div>
          <div class="quiz-option" onclick="checkQuickQuiz(this, false, 'fs-quiz-1')">
            <div class="quiz-option-marker">D</div>
            <span>It creates a new file with (1) suffix</span>
          </div>
        </div>
        <div class="quiz-explanation" id="fs-quiz-1-exp">
          ‚úÖ <strong>writeFile()</strong> completely overwrites the existing file content. If you want to add to a file, use <strong>appendFile()</strong> instead!
        </div>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('modules')">‚Üê Modules</button>
        <button class="btn btn-primary" onclick="navigateTo('http')">HTTP Server ‚Üí</button>
      </div>
    </div>

    <!-- HTTP SERVER SECTION -->
    <div class="section" id="section-http">
      <div class="content-header">
        <div class="chapter-label">Chapter 4</div>
        <h1>üåê HTTP Server Creation</h1>
        <p>Build web servers from scratch with Node.js! This is where it all comes together ‚Äî the reason Node.js was created.</p>
      </div>

      <h2>üöÄ Your First Server</h2>
      <p>With just a few lines of code, you can create a web server that handles thousands of requests:</p>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">server.js ‚Äî Your first server!</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> http = <span class="fn">require</span>(<span class="str">'http'</span>);

<span class="cm">// Create a server</span>
<span class="kw">const</span> server = <span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="cm">// req = incoming request info</span>
  <span class="cm">// res = your response back to the client</span>

  <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, { <span class="str">'Content-Type'</span>: <span class="str">'text/plain'</span> });
  <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'Hello, World! üåç'</span>);
});

<span class="cm">// Start listening on port 3000</span>
<span class="obj">server</span>.<span class="fn">listen</span>(<span class="num">3000</span>, () <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Server running at http://localhost:3000'</span>);
});</pre></div>
      </div>

      <div class="terminal">
        <div class="terminal-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span>Terminal</span>
        </div>
        <div class="terminal-body">
          <div class="terminal-line"><span class="terminal-prompt">$ </span><span class="terminal-output">node server.js</span></div>
          <div class="terminal-line"><span class="terminal-output" style="color:var(--node-green)">Server running at http://localhost:3000</span></div>
        </div>
      </div>

      <h2>üìä Request & Response Flow</h2>

      <div class="diagram-container">
        <div class="diagram-title">HTTP Request Lifecycle in Node.js</div>
        <div class="flow-diagram">
          <div class="flow-box req">üåê Client sends HTTP Request (browser, Postman, etc.)</div>
          <div class="flow-arrow">‚¨áÔ∏è</div>
          <div class="flow-box process">‚öôÔ∏è Node.js receives request (req object)</div>
          <div class="flow-arrow">‚¨áÔ∏è</div>
          <div class="flow-box process">üîÄ Your code inspects req.url, req.method</div>
          <div class="flow-arrow">‚¨áÔ∏è</div>
          <div class="flow-box process">üìù You build a response (status, headers, body)</div>
          <div class="flow-arrow">‚¨áÔ∏è</div>
          <div class="flow-box res">üì§ res.end() sends response back to client</div>
        </div>
      </div>

      <h2>üîÄ Routing ‚Äî Handling Different URLs</h2>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">router-server.js</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> http = <span class="fn">require</span>(<span class="str">'http'</span>);

<span class="kw">const</span> server = <span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="cm">// üîç Inspect the request</span>
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">`${req.method} ${req.url}`</span>);

  <span class="cm">// üîÄ Simple router</span>
  <span class="kw">if</span> (<span class="obj">req</span>.<span class="prop">url</span> === <span class="str">'/'</span> && <span class="obj">req</span>.<span class="prop">method</span> === <span class="str">'GET'</span>) {
    <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, { <span class="str">'Content-Type'</span>: <span class="str">'text/html'</span> });
    <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'&lt;h1&gt;üè† Home Page&lt;/h1&gt;&lt;a href="/about"&gt;About&lt;/a&gt;'</span>);
  }
  <span class="kw">else if</span> (<span class="obj">req</span>.<span class="prop">url</span> === <span class="str">'/about'</span>) {
    <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, { <span class="str">'Content-Type'</span>: <span class="str">'text/html'</span> });
    <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'&lt;h1&gt;‚ÑπÔ∏è About Page&lt;/h1&gt;'</span>);
  }
  <span class="kw">else if</span> (<span class="obj">req</span>.<span class="prop">url</span> === <span class="str">'/api/users'</span>) {
    <span class="kw">const</span> users = [
      { <span class="prop">id</span>: <span class="num">1</span>, <span class="prop">name</span>: <span class="str">'Alice'</span> },
      { <span class="prop">id</span>: <span class="num">2</span>, <span class="prop">name</span>: <span class="str">'Bob'</span> }
    ];
    <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, { <span class="str">'Content-Type'</span>: <span class="str">'application/json'</span> });
    <span class="obj">res</span>.<span class="fn">end</span>(<span class="obj">JSON</span>.<span class="fn">stringify</span>(users));
  }
  <span class="kw">else</span> {
    <span class="cm">// 404 Not Found</span>
    <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">404</span>, { <span class="str">'Content-Type'</span>: <span class="str">'text/html'</span> });
    <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'&lt;h1&gt;404 ‚Äî Page Not Found üò¢&lt;/h1&gt;'</span>);
  }
});

<span class="obj">server</span>.<span class="fn">listen</span>(<span class="num">3000</span>, () <span class="op">=></span> {
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'üöÄ Server running on port 3000'</span>);
});</pre></div>
      </div>

      <h2>üì© Handling POST Data</h2>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">post-server.js</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> http = <span class="fn">require</span>(<span class="str">'http'</span>);

<span class="kw">const</span> server = <span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="kw">if</span> (<span class="obj">req</span>.<span class="prop">method</span> === <span class="str">'POST'</span> && <span class="obj">req</span>.<span class="prop">url</span> === <span class="str">'/api/data'</span>) {
    <span class="kw">let</span> body = <span class="str">''</span>;

    <span class="cm">// Data comes in chunks!</span>
    <span class="obj">req</span>.<span class="fn">on</span>(<span class="str">'data'</span>, (<span class="param">chunk</span>) <span class="op">=></span> {
      body += chunk.<span class="fn">toString</span>();
    });

    <span class="cm">// All data received</span>
    <span class="obj">req</span>.<span class="fn">on</span>(<span class="str">'end'</span>, () <span class="op">=></span> {
      <span class="kw">try</span> {
        <span class="kw">const</span> parsed = <span class="obj">JSON</span>.<span class="fn">parse</span>(body);
        <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'Received:'</span>, parsed);

        <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">201</span>, { <span class="str">'Content-Type'</span>: <span class="str">'application/json'</span> });
        <span class="obj">res</span>.<span class="fn">end</span>(<span class="obj">JSON</span>.<span class="fn">stringify</span>({
          <span class="prop">success</span>: <span class="kw">true</span>,
          <span class="prop">data</span>: parsed
        }));
      } <span class="kw">catch</span> (e) {
        <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">400</span>);
        <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'Invalid JSON'</span>);
      }
    });
  }
});

<span class="obj">server</span>.<span class="fn">listen</span>(<span class="num">3000</span>);</pre></div>
      </div>

      <div class="info-box info">
        <div class="info-box-icon">üì°</div>
        <div class="info-box-content">
          <h4>Why chunks?</h4>
          <p>HTTP request bodies arrive as a <strong>stream</strong> of data chunks. This is efficient for large payloads ‚Äî you don't need to load everything into memory at once. Listen for <span class="highlight">'data'</span> events and collect chunks, then process on <span class="highlight">'end'</span>.</p>
        </div>
      </div>

      <h2>üìÅ Serving Static Files</h2>

      <div class="code-block">
        <div class="code-header">
          <div class="code-dots"><div class="code-dot"></div><div class="code-dot"></div><div class="code-dot"></div></div>
          <span class="code-filename">static-server.js ‚Äî A real file server!</span>
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
        </div>
        <div class="code-body"><pre><span class="kw">const</span> http = <span class="fn">require</span>(<span class="str">'http'</span>);
<span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs'</span>);
<span class="kw">const</span> path = <span class="fn">require</span>(<span class="str">'path'</span>);

<span class="cm">// MIME types for different file extensions</span>
<span class="kw">const</span> mimeTypes = {
  <span class="str">'.html'</span>: <span class="str">'text/html'</span>,
  <span class="str">'.css'</span>:  <span class="str">'text/css'</span>,
  <span class="str">'.js'</span>:   <span class="str">'text/javascript'</span>,
  <span class="str">'.json'</span>: <span class="str">'application/json'</span>,
  <span class="str">'.png'</span>:  <span class="str">'image/png'</span>,
  <span class="str">'.jpg'</span>:  <span class="str">'image/jpeg'</span>,
};

<span class="kw">const</span> server = <span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="cm">// Build file path</span>
  <span class="kw">let</span> filePath = <span class="str">'./public'</span> + (<span class="obj">req</span>.<span class="prop">url</span> === <span class="str">'/'</span> ? <span class="str">'/index.html'</span> : <span class="obj">req</span>.<span class="prop">url</span>);
  <span class="kw">const</span> ext = <span class="obj">path</span>.<span class="fn">extname</span>(filePath);
  <span class="kw">const</span> contentType = mimeTypes[ext] || <span class="str">'application/octet-stream'</span>;

  <span class="obj">fs</span>.<span class="fn">readFile</span>(filePath, (<span class="param">err</span>, <span class="param">content</span>) <span class="op">=></span> {
    <span class="kw">if</span> (err) {
      <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">404</span>);
      <span class="obj">res</span>.<span class="fn">end</span>(<span class="str">'File not found'</span>);
    } <span class="kw">else</span> {
      <span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, { <span class="str">'Content-Type'</span>: contentType });
      <span class="obj">res</span>.<span class="fn">end</span>(content);
    }
  });
});

<span class="obj">server</span>.<span class="fn">listen</span>(<span class="num">3000</span>);</pre></div>
      </div>

      <h2>üìä HTTP Status Codes Cheat Sheet</h2>
      <table class="compare-table">
        <thead><tr><th>Code</th><th>Meaning</th><th>When to Use</th></tr></thead>
        <tbody>
          <tr><td><strong>200</strong></td><td>OK</td><td>Successful GET request</td></tr>
          <tr><td><strong>201</strong></td><td>Created</td><td>Successful POST (resource created)</td></tr>
          <tr><td><strong>204</strong></td><td>No Content</td><td>Successful DELETE (nothing to return)</td></tr>
          <tr><td><strong>301</strong></td><td>Moved Permanently</td><td>URL has changed permanently</td></tr>
          <tr><td><strong>400</strong></td><td>Bad Request</td><td>Invalid input from client</td></tr>
          <tr><td><strong>401</strong></td><td>Unauthorized</td><td>Authentication required</td></tr>
          <tr><td><strong>403</strong></td><td>Forbidden</td><td>No permission</td></tr>
          <tr><td><strong>404</strong></td><td>Not Found</td><td>Resource doesn't exist</td></tr>
          <tr><td><strong>500</strong></td><td>Server Error</td><td>Something broke on the server</td></tr>
        </tbody>
      </table>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('filesystem')">‚Üê File System</button>
        <button class="btn btn-primary" onclick="navigateTo('exercises')">Exercises ‚Üí</button>
      </div>
    </div>

    <!-- EXERCISES SECTION -->
    <div class="section" id="section-exercises">
      <div class="content-header">
        <div class="chapter-label">Practice</div>
        <h1>üí™ Exercises & Challenges</h1>
        <p>Time to put your knowledge to the test! Complete these exercises to cement your understanding. Your code will be checked for correctness.</p>
      </div>

      <!-- Exercise 1 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge practice">Exercise 1</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Import the fs module</h3>
        <p>Write the code to import (require) Node's file system module and store it in a constant called <span class="highlight">fs</span>.</p>
        <textarea class="code-editor" id="ex1-editor" placeholder="// Write your code here..."></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(1)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(1)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(1)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex1-result"></div>
      </div>

      <!-- Exercise 2 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge practice">Exercise 2</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Create a local module</h3>
        <p>Write code that exports an object with two functions: <span class="highlight">greet(name)</span> that returns "Hello, {name}!" and <span class="highlight">farewell(name)</span> that returns "Goodbye, {name}!"</p>
        <textarea class="code-editor" id="ex2-editor" placeholder="// Create and export your module here..."></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(2)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(2)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(2)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex2-result"></div>
      </div>

      <!-- Exercise 3 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge practice">Exercise 3</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Read a file asynchronously</h3>
        <p>Write code using <span class="highlight">fs.readFile()</span> to read a file called <span class="highlight">'data.txt'</span> as UTF-8, log the content on success, and log the error message on failure.</p>
        <textarea class="code-editor" id="ex3-editor" placeholder="// Write your async file reading code here..."></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(3)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(3)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(3)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex3-result"></div>
      </div>

      <!-- Exercise 4 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge challenge">Exercise 4</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Create an HTTP server</h3>
        <p>Write code to create an HTTP server that responds with "Hello Node!" (plain text, status 200) and listens on port <span class="highlight">3000</span>.</p>
        <textarea class="code-editor" id="ex4-editor" placeholder="// Create your HTTP server here..." style="min-height:150px"></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(4)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(4)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(4)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex4-result"></div>
      </div>

      <!-- Exercise 5 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge challenge">Exercise 5</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">JSON API endpoint</h3>
        <p>Create a server that returns a JSON response on <span class="highlight">/api/status</span> with the body: <span class="highlight">{"status": "ok", "uptime": process.uptime()}</span>. Use the correct Content-Type header.</p>
        <textarea class="code-editor" id="ex5-editor" placeholder="// Build your JSON API server here..." style="min-height:180px"></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(5)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(5)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(5)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex5-result"></div>
      </div>

      <!-- Exercise 6 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge challenge">Exercise 6</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Write JSON to a file</h3>
        <p>Write code that creates an array of 3 user objects (each with name and email), converts it to a formatted JSON string, and writes it to <span class="highlight">'users.json'</span>.</p>
        <textarea class="code-editor" id="ex6-editor" placeholder="// Write your file saving code here..." style="min-height:160px"></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(6)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(6)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(6)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex6-result"></div>
      </div>

      <!-- Exercise 7 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge challenge">Exercise 7</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Read file with async/await</h3>
        <p>Rewrite file reading using <span class="highlight">fs/promises</span> and <span class="highlight">async/await</span>. Read <span class="highlight">'config.json'</span>, parse it, and log the result. Handle errors with try/catch.</p>
        <textarea class="code-editor" id="ex7-editor" placeholder="// Use modern async/await style..." style="min-height:160px"></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(7)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(7)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(7)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex7-result"></div>
      </div>

      <!-- Exercise 8 -->
      <div class="exercise-container">
        <div class="exercise-header">
          <span class="exercise-badge challenge">Exercise 8</span>
        </div>
        <h3 style="color:var(--text);margin-top:0">Multi-route server with 404</h3>
        <p>Create a server with routes for <span class="highlight">/</span> (returns "Home"), <span class="highlight">/about</span> (returns "About"), and a 404 response for everything else. Use status code 404.</p>
        <textarea class="code-editor" id="ex8-editor" placeholder="// Build your router..." style="min-height:200px"></textarea>
        <div class="exercise-actions">
          <button class="btn btn-primary btn-small" onclick="checkExercise(8)">‚ñ∂ Check Answer</button>
          <button class="btn btn-secondary btn-small" onclick="showHint(8)">üí° Hint</button>
          <button class="btn btn-secondary btn-small" onclick="showSolution(8)">üëÅ Solution</button>
        </div>
        <div class="exercise-result" id="ex8-result"></div>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('http')">‚Üê HTTP Server</button>
        <button class="btn btn-primary" onclick="navigateTo('quiz')">Take the Quiz ‚Üí</button>
      </div>
    </div>

    <!-- QUIZ SECTION -->
    <div class="section" id="section-quiz">
      <div class="content-header">
        <div class="chapter-label">Assessment</div>
        <h1>üß† Final Knowledge Quiz</h1>
        <p>Test everything you've learned! 10 questions covering all topics. Get 80%+ to earn your completion badge!</p>
      </div>

      <div class="score-display" id="quiz-score" style="display:none">
        <div class="score-circle" id="score-circle">
          <span id="score-value">0</span>/10
        </div>
        <h3 id="score-message" style="margin-top:10px"></h3>
        <p id="score-detail" style="margin-top:8px"></p>
        <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top:15px">üîÑ Retake Quiz</button>
      </div>

      <div id="quiz-questions">
        <!-- Q1 -->
        <div class="quiz-container" id="quiz-q1">
          <div class="quiz-question">
            <div class="quiz-number">1</div>
            <span>Node.js is best described as:</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(1, this, 'a')"><div class="quiz-option-marker">A</div><span>A programming language</span></div>
            <div class="quiz-option" onclick="answerQuiz(1, this, 'b')"><div class="quiz-option-marker">B</div><span>A JavaScript runtime environment built on V8</span></div>
            <div class="quiz-option" onclick="answerQuiz(1, this, 'c')"><div class="quiz-option-marker">C</div><span>A web framework like Express</span></div>
            <div class="quiz-option" onclick="answerQuiz(1, this, 'd')"><div class="quiz-option-marker">D</div><span>A database management system</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q1-exp">Node.js is a <strong>runtime environment</strong> ‚Äî it provides the platform (V8 engine + libuv) to run JavaScript outside the browser.</div>
        </div>

        <!-- Q2 -->
        <div class="quiz-container" id="quiz-q2">
          <div class="quiz-question">
            <div class="quiz-number">2</div>
            <span>What does the event loop do?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(2, this, 'a')"><div class="quiz-option-marker">A</div><span>Creates new threads for each request</span></div>
            <div class="quiz-option" onclick="answerQuiz(2, this, 'b')"><div class="quiz-option-marker">B</div><span>Compiles JavaScript to machine code</span></div>
            <div class="quiz-option" onclick="answerQuiz(2, this, 'c')"><div class="quiz-option-marker">C</div><span>Manages async operations by moving callbacks to the call stack when ready</span></div>
            <div class="quiz-option" onclick="answerQuiz(2, this, 'd')"><div class="quiz-option-marker">D</div><span>Manages memory allocation</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q2-exp">The event loop continuously checks if the call stack is empty, then moves pending callbacks from the queue to the stack for execution. This is how Node handles concurrency on a single thread.</div>
        </div>

        <!-- Q3 -->
        <div class="quiz-container" id="quiz-q3">
          <div class="quiz-question">
            <div class="quiz-number">3</div>
            <span>Which is NOT a core Node.js module?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(3, this, 'a')"><div class="quiz-option-marker">A</div><span>fs</span></div>
            <div class="quiz-option" onclick="answerQuiz(3, this, 'b')"><div class="quiz-option-marker">B</div><span>http</span></div>
            <div class="quiz-option" onclick="answerQuiz(3, this, 'c')"><div class="quiz-option-marker">C</div><span>express</span></div>
            <div class="quiz-option" onclick="answerQuiz(3, this, 'd')"><div class="quiz-option-marker">D</div><span>path</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q3-exp"><strong>Express</strong> is a third-party npm package, not a core module. You need to install it with <code>npm install express</code>. fs, http, and path are all built-in.</div>
        </div>

        <!-- Q4 -->
        <div class="quiz-container" id="quiz-q4">
          <div class="quiz-question">
            <div class="quiz-number">4</div>
            <span>What's the output?<br><code>console.log('A'); setTimeout(() => console.log('B'), 0); console.log('C');</code></span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(4, this, 'a')"><div class="quiz-option-marker">A</div><span>A, B, C</span></div>
            <div class="quiz-option" onclick="answerQuiz(4, this, 'b')"><div class="quiz-option-marker">B</div><span>A, C, B</span></div>
            <div class="quiz-option" onclick="answerQuiz(4, this, 'c')"><div class="quiz-option-marker">C</div><span>B, A, C</span></div>
            <div class="quiz-option" onclick="answerQuiz(4, this, 'd')"><div class="quiz-option-marker">D</div><span>C, B, A</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q4-exp">Synchronous code (A, C) runs first. Even with 0ms delay, setTimeout is async ‚Äî its callback goes to the queue and runs after the call stack is empty.</div>
        </div>

        <!-- Q5 -->
        <div class="quiz-container" id="quiz-q5">
          <div class="quiz-question">
            <div class="quiz-number">5</div>
            <span>To import a local module "./helpers.js", you use:</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(5, this, 'a')"><div class="quiz-option-marker">A</div><span><code>require('helpers')</code></span></div>
            <div class="quiz-option" onclick="answerQuiz(5, this, 'b')"><div class="quiz-option-marker">B</div><span><code>require('./helpers')</code></span></div>
            <div class="quiz-option" onclick="answerQuiz(5, this, 'c')"><div class="quiz-option-marker">C</div><span><code>import 'helpers'</code></span></div>
            <div class="quiz-option" onclick="answerQuiz(5, this, 'd')"><div class="quiz-option-marker">D</div><span><code>include('./helpers')</code></span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q5-exp">Local modules MUST have <code>./</code> or <code>../</code> prefix. Without it, Node looks for core modules or in node_modules/.</div>
        </div>

        <!-- Q6 -->
        <div class="quiz-container" id="quiz-q6">
          <div class="quiz-question">
            <div class="quiz-number">6</div>
            <span>Which method adds content to an existing file WITHOUT overwriting?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(6, this, 'a')"><div class="quiz-option-marker">A</div><span>fs.writeFile()</span></div>
            <div class="quiz-option" onclick="answerQuiz(6, this, 'b')"><div class="quiz-option-marker">B</div><span>fs.appendFile()</span></div>
            <div class="quiz-option" onclick="answerQuiz(6, this, 'c')"><div class="quiz-option-marker">C</div><span>fs.addFile()</span></div>
            <div class="quiz-option" onclick="answerQuiz(6, this, 'd')"><div class="quiz-option-marker">D</div><span>fs.updateFile()</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q6-exp"><code>fs.appendFile()</code> adds data to the end of a file. <code>fs.writeFile()</code> overwrites everything. addFile and updateFile don't exist.</div>
        </div>

        <!-- Q7 -->
        <div class="quiz-container" id="quiz-q7">
          <div class="quiz-question">
            <div class="quiz-number">7</div>
            <span>In <code>http.createServer((req, res) => { ... })</code>, what does <code>res.end()</code> do?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(7, this, 'a')"><div class="quiz-option-marker">A</div><span>Terminates the server</span></div>
            <div class="quiz-option" onclick="answerQuiz(7, this, 'b')"><div class="quiz-option-marker">B</div><span>Signals the response is complete and sends it to the client</span></div>
            <div class="quiz-option" onclick="answerQuiz(7, this, 'c')"><div class="quiz-option-marker">C</div><span>Closes the database connection</span></div>
            <div class="quiz-option" onclick="answerQuiz(7, this, 'd')"><div class="quiz-option-marker">D</div><span>Ends the event loop</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q7-exp"><code>res.end()</code> tells the server the response is complete. You can optionally pass data as an argument. Without calling it, the client will hang waiting forever!</div>
        </div>

        <!-- Q8 -->
        <div class="quiz-container" id="quiz-q8">
          <div class="quiz-question">
            <div class="quiz-number">8</div>
            <span>What Content-Type header should you set for a JSON API response?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(8, this, 'a')"><div class="quiz-option-marker">A</div><span>text/plain</span></div>
            <div class="quiz-option" onclick="answerQuiz(8, this, 'b')"><div class="quiz-option-marker">B</div><span>text/html</span></div>
            <div class="quiz-option" onclick="answerQuiz(8, this, 'c')"><div class="quiz-option-marker">C</div><span>application/json</span></div>
            <div class="quiz-option" onclick="answerQuiz(8, this, 'd')"><div class="quiz-option-marker">D</div><span>text/json</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q8-exp"><code>application/json</code> is the correct MIME type for JSON. This tells the browser/client to parse the response as JSON.</div>
        </div>

        <!-- Q9 -->
        <div class="quiz-container" id="quiz-q9">
          <div class="quiz-question">
            <div class="quiz-number">9</div>
            <span>Why should you avoid <code>fs.readFileSync()</code> in HTTP request handlers?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(9, this, 'a')"><div class="quiz-option-marker">A</div><span>It doesn't work in servers</span></div>
            <div class="quiz-option" onclick="answerQuiz(9, this, 'b')"><div class="quiz-option-marker">B</div><span>It blocks the event loop, preventing other requests from being handled</span></div>
            <div class="quiz-option" onclick="answerQuiz(9, this, 'c')"><div class="quiz-option-marker">C</div><span>It uses too much memory</span></div>
            <div class="quiz-option" onclick="answerQuiz(9, this, 'd')"><div class="quiz-option-marker">D</div><span>It's deprecated</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q9-exp">Sync operations <strong>block the entire event loop</strong>. While reading one file, NO other requests can be processed. This destroys server performance under load.</div>
        </div>

        <!-- Q10 -->
        <div class="quiz-container" id="quiz-q10">
          <div class="quiz-question">
            <div class="quiz-number">10</div>
            <span>Which variable gives you the directory path of the current file in Node.js?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option" onclick="answerQuiz(10, this, 'a')"><div class="quiz-option-marker">A</div><span>__dirname</span></div>
            <div class="quiz-option" onclick="answerQuiz(10, this, 'b')"><div class="quiz-option-marker">B</div><span>__filename</span></div>
            <div class="quiz-option" onclick="answerQuiz(10, this, 'c')"><div class="quiz-option-marker">C</div><span>process.cwd()</span></div>
            <div class="quiz-option" onclick="answerQuiz(10, this, 'd')"><div class="quiz-option-marker">D</div><span>path.current()</span></div>
          </div>
          <div class="quiz-explanation" id="quiz-q10-exp"><code>__dirname</code> = directory of the current file. <code>__filename</code> = full path including filename. <code>process.cwd()</code> = where you ran the node command (can be different!).</div>
        </div>
      </div>

      <div style="text-align:center; margin-top:25px">
        <button class="btn btn-primary" id="submit-quiz-btn" onclick="submitQuiz()">üìä Submit Quiz & See Score</button>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('exercises')">‚Üê Exercises</button>
        <button class="btn btn-primary" onclick="navigateTo('pitfalls')">Pitfalls ‚Üí</button>
      </div>
    </div>

    <!-- PITFALLS SECTION -->
    <div class="section" id="section-pitfalls">
      <div class="content-header">
        <div class="chapter-label">Important</div>
        <h1>‚ö†Ô∏è Common Mistakes & Pitfalls</h1>
        <p>These are the traps that catch beginners (and sometimes experienced devs too). Learn them now to avoid hours of debugging later!</p>
      </div>

      <!-- Pitfall 1 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #1: Forgetting to handle errors in callbacks</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>In Node.js, callbacks follow the <strong>"error-first"</strong> pattern. The first argument is ALWAYS the error. If you ignore it, your app will crash silently or behave unpredictably.</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî No error handling</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'data.txt'</span>, (<span class="param">err</span>, <span class="param">data</span>) <span class="op">=></span> {
  <span class="cm">// üíÄ If file doesn't exist,</span>
  <span class="cm">// data is undefined and</span>
  <span class="cm">// this will crash!</span>
  <span class="fn">console</span>.<span class="fn">log</span>(data.<span class="fn">toString</span>());
});</pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Always check err first</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'data.txt'</span>, (<span class="param">err</span>, <span class="param">data</span>) <span class="op">=></span> {
  <span class="kw">if</span> (err) {
    <span class="fn">console</span>.<span class="fn">error</span>(<span class="str">'Error:'</span>, err.<span class="prop">message</span>);
    <span class="kw">return</span>;
  }
  <span class="fn">console</span>.<span class="fn">log</span>(data.<span class="fn">toString</span>());
});</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 2 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #2: Using require() without ./ for local files</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>Without the <span class="highlight">./</span> prefix, Node thinks you want a core module or npm package!</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="cm">// Looks for 'utils' in node_modules</span>
<span class="kw">const</span> utils = <span class="fn">require</span>(<span class="str">'utils'</span>);
<span class="cm">// Error: Cannot find module 'utils'</span></pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="cm">// ./ means "current directory"</span>
<span class="kw">const</span> utils = <span class="fn">require</span>(<span class="str">'./utils'</span>);
<span class="cm">// ‚úÖ Found!</span></pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 3 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #3: Forgetting res.end() in HTTP servers</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>If you forget to call <span class="highlight">res.end()</span>, the client will hang forever waiting for a response!</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî Client hangs forever</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="obj">res</span>.<span class="fn">write</span>(<span class="str">'Hello'</span>);
  <span class="cm">// üíÄ No res.end()!</span>
  <span class="cm">// Client spins forever...</span>
});</pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Always end the response</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="obj">res</span>.<span class="fn">write</span>(<span class="str">'Hello'</span>);
  <span class="obj">res</span>.<span class="fn">end</span>();
  <span class="cm">// ‚úÖ Or just: res.end('Hello')</span>
});</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 4 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #4: Sync methods in request handlers</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>Using synchronous methods inside HTTP handlers blocks ALL other requests. Under load, this destroys performance.</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî Blocks everything</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="cm">// üíÄ All users wait in line!</span>
  <span class="kw">const</span> data = <span class="obj">fs</span>.<span class="fn">readFileSync</span>(<span class="str">'big.txt'</span>);
  <span class="obj">res</span>.<span class="fn">end</span>(data);
});</pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Non-blocking</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">http</span>.<span class="fn">createServer</span>((<span class="param">req</span>, <span class="param">res</span>) <span class="op">=></span> {
  <span class="cm">// ‚úÖ Other requests keep flowing!</span>
  <span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'big.txt'</span>, (<span class="param">err</span>, <span class="param">data</span>) <span class="op">=></span> {
    <span class="obj">res</span>.<span class="fn">end</span>(data);
  });
});</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 5 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #5: Overwriting exports reference</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p><span class="highlight">exports</span> is just a shorthand reference to <span class="highlight">module.exports</span>. If you reassign it, you break the connection!</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî Broken reference</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="cm">// ‚ùå This does NOTHING!</span>
<span class="obj">exports</span> = { <span class="prop">add</span>: <span class="fn">add</span> };
<span class="cm">// You reassigned the variable,</span>
<span class="cm">// not module.exports</span></pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Use module.exports</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="cm">// ‚úÖ Option 1: module.exports</span>
<span class="obj">module</span>.<span class="prop">exports</span> = { <span class="prop">add</span>: <span class="fn">add</span> };

<span class="cm">// ‚úÖ Option 2: Add to exports</span>
<span class="obj">exports</span>.<span class="prop">add</span> = <span class="fn">add</span>;</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 6 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #6: Not setting Content-Type headers</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>Browsers need to know what type of content you're sending. Without proper headers, JSON might be displayed as plain text, HTML might not render, etc.</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî No Content-Type</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">res</span>.<span class="fn">end</span>(<span class="obj">JSON</span>.<span class="fn">stringify</span>({ <span class="prop">ok</span>: <span class="kw">true</span> }));
<span class="cm">// Client may not parse as JSON!</span></pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Set correct headers</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">res</span>.<span class="fn">writeHead</span>(<span class="num">200</span>, {
  <span class="str">'Content-Type'</span>: <span class="str">'application/json'</span>
});
<span class="obj">res</span>.<span class="fn">end</span>(<span class="obj">JSON</span>.<span class="fn">stringify</span>({ <span class="prop">ok</span>: <span class="kw">true</span> }));</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 7 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #7: Callback Hell ‚Äî deeply nested callbacks</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>When you nest callbacks inside callbacks, your code becomes unreadable. Use Promises or async/await instead!</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî Callback Hell</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'a.txt'</span>, (<span class="param">e</span>,<span class="param">a</span>) <span class="op">=></span> {
 <span class="obj">fs</span>.<span class="fn">readFile</span>(<span class="str">'b.txt'</span>, (<span class="param">e</span>,<span class="param">b</span>) <span class="op">=></span> {
  <span class="obj">fs</span>.<span class="fn">writeFile</span>(<span class="str">'c.txt'</span>,a+b, (<span class="param">e</span>) <span class="op">=></span> {
   <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'done'</span>);<span class="cm"> // üòµ</span>
  });
 });
});</pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Async/Await</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="kw">const</span> fs = <span class="fn">require</span>(<span class="str">'fs/promises'</span>);

<span class="kw">async function</span> <span class="fn">merge</span>() {
  <span class="kw">const</span> a = <span class="kw">await</span> fs.<span class="fn">readFile</span>(<span class="str">'a.txt'</span>);
  <span class="kw">const</span> b = <span class="kw">await</span> fs.<span class="fn">readFile</span>(<span class="str">'b.txt'</span>);
  <span class="kw">await</span> fs.<span class="fn">writeFile</span>(<span class="str">'c.txt'</span>, a+b);
  <span class="fn">console</span>.<span class="fn">log</span>(<span class="str">'done'</span>); <span class="cm">// üòä</span>
}</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pitfall 8 -->
      <div class="pitfall-card">
        <div class="pitfall-header" onclick="this.parentElement.classList.toggle('open')">
          <span>üî¥</span>
          <h4>Pitfall #8: Not parsing POST body before using it</h4>
          <span style="margin-left:auto;font-size:12px">Click to expand</span>
        </div>
        <div class="pitfall-body" style="display:none">
          <p>Request body data comes as chunks of strings. You must collect ALL chunks and THEN parse the complete data.</p>
          <div class="pitfall-compare">
            <div class="pitfall-wrong">
              <div class="pitfall-label">‚ùå BAD ‚Äî Using req.body directly</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="cm">// ‚ùå req.body doesn't exist in raw Node!</span>
<span class="cm">// (Only Express adds it with middleware)</span>
<span class="fn">console</span>.<span class="fn">log</span>(<span class="obj">req</span>.<span class="prop">body</span>); <span class="cm">// undefined!</span></pre></div>
              </div>
            </div>
            <div class="pitfall-right">
              <div class="pitfall-label">‚úÖ GOOD ‚Äî Collect chunks</div>
              <div class="code-block" style="margin:0;border-radius:0 0 8px 8px">
                <div class="code-body"><pre><span class="kw">let</span> body = <span class="str">''</span>;
<span class="obj">req</span>.<span class="fn">on</span>(<span class="str">'data'</span>, <span class="param">chunk</span> <span class="op">=></span> body += chunk);
<span class="obj">req</span>.<span class="fn">on</span>(<span class="str">'end'</span>, () <span class="op">=></span> {
  <span class="kw">const</span> data = <span class="obj">JSON</span>.<span class="fn">parse</span>(body);
  <span class="fn">console</span>.<span class="fn">log</span>(data); <span class="cm">// ‚úÖ</span>
});</pre></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="info-box tip" style="margin-top:30px">
        <div class="info-box-icon">üèÜ</div>
        <div class="info-box-content">
          <h4>Golden Rules for Node.js Development</h4>
          <p>
            1. <strong>Always handle errors</strong> ‚Äî err-first in callbacks, try/catch with async/await<br>
            2. <strong>Never use sync methods in servers</strong> ‚Äî they block all requests<br>
            3. <strong>Always call res.end()</strong> ‚Äî or the client hangs<br>
            4. <strong>Set proper Content-Type headers</strong> ‚Äî text/html, application/json, etc.<br>
            5. <strong>Use ./ for local requires</strong> ‚Äî bare names look in node_modules<br>
            6. <strong>Use async/await over callbacks</strong> ‚Äî cleaner, more readable
          </p>
        </div>
      </div>

      <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="navigateTo('quiz')">‚Üê Quiz</button>
        <button class="btn btn-primary" onclick="navigateTo('welcome')">üè† Home</button>
      </div>
    </div>

  </main>
</div>

<div class="confetti-container" id="confetti-container"></div>

<script>
// ============ APP STATE ============
const state = {
  currentSection: 'welcome',
  completedSections: new Set(),
  xp: 0,
  maxXp: 500,
  quizAnswers: {},
  quizCorrect: { 1:'b',2:'c',3:'c',4:'b',5:'b',6:'b',7:'b',8:'c',9:'b',10:'a' },
  quizSubmitted: false,
  exercisesCompleted: new Set()
};

// ============ NAVIGATION ============
function navigateTo(sectionId) {
  // Hide all sections
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  // Show target
  const target = document.getElementById('section-' + sectionId);
  if (target) {
    target.classList.add('active');
    state.currentSection = sectionId;
    // Mark as visited
    if (sectionId !== 'welcome') {
      state.completedSections.add(sectionId);
    }
    updateProgress();
  }
  // Update nav
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
    if (item.dataset.section === sectionId) {
      item.classList.add('active');
    }
    if (state.completedSections.has(item.dataset.section)) {
      item.classList.add('completed');
    }
  });
  // Close mobile sidebar
  document.getElementById('sidebar').classList.remove('open');
  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
  // Animate stats on welcome
  if (sectionId === 'welcome') animateCounters();
  // Re-trigger step animations
  if (sectionId === 'architecture') {
    document.querySelectorAll('.step-item').forEach(s => {
      s.style.animation = 'none';
      s.offsetHeight; // trigger reflow
      s.style.animation = '';
    });
  }
}

function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
}

// ============ PROGRESS ============
function updateProgress() {
  const total = 7; // total sections excluding welcome
  const completed = state.completedSections.size;
  const pct = Math.round((completed / total) * 100);
  document.getElementById('progress-fill').style.width = pct + '%';
  document.getElementById('progress-text').textContent = pct + '%';
  // XP
  const xpPct = Math.min((state.xp / state.maxXp) * 100, 100);
  document.getElementById('xp-fill').style.width = xpPct + '%';
  document.getElementById('xp-text').textContent = state.xp + ' / ' + state.maxXp;
}

function addXP(amount) {
  state.xp = Math.min(state.xp + amount, state.maxXp);
  updateProgress();
}

// ============ ARCHITECTURE LAYER TOGGLE ============
function toggleLayer(el) {
  el.classList.toggle('expanded');
}

// ============ TABS ============
function switchTab(group, tabName) {
  const tabContainer = document.getElementById(group + '-tabs') || document.querySelector(`[id^="${group}"]`).parentElement;
  // Find the tabs container
  const parentSection = document.getElementById('section-' + state.currentSection);
  const allTabs = parentSection.querySelectorAll(`#${group}-tabs .tab, .tabs .tab`);

  // Find tabs that belong to this group
  const tabsContainer = document.getElementById(group + '-tabs');
  if (tabsContainer) {
    tabsContainer.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    // Set active tab
    const tabs = tabsContainer.querySelectorAll('.tab');
    tabs.forEach(t => {
      if (t.textContent.toLowerCase().includes(tabName.substring(0,4))) {
        t.classList.add('active');
      }
    });
  }
  // Hide/show content
  const allIds = ['core','local','npm','async','sync','promise'];
  allIds.forEach(id => {
    const el = document.getElementById(group + '-' + id);
    if (el) {
      el.classList.remove('active');
    }
  });
  const target = document.getElementById(group + '-' + tabName);
  if (target) target.classList.add('active');
}

// ============ QUICK QUIZ (in-section) ============
function checkQuickQuiz(el, isCorrect, quizId) {
  const container = document.getElementById(quizId);
  const options = container.querySelectorAll('.quiz-option');
  if (options[0].classList.contains('disabled')) return; // already answered

  options.forEach(o => {
    o.classList.add('disabled');
    if (o === el) {
      o.classList.add(isCorrect ? 'correct' : 'wrong');
      o.querySelector('.quiz-option-marker').textContent = isCorrect ? '‚úì' : '‚úó';
    }
  });
  // Show correct if wrong
  if (!isCorrect) {
    options.forEach(o => {
      // Find the correct one by trying all
      // We need a different approach ‚Äî mark correct answers
    });
  }
  // Show explanation
  const exp = document.getElementById(quizId + '-exp');
  if (exp) exp.classList.add('visible');
  if (isCorrect) addXP(15);
}

// ============ EXERCISES ============
const exercises = {
  1: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('require') && c.includes("'fs'") && c.includes('const') && c.includes('fs');
    },
    hint: "Use const fs = require('...');  ‚Äî what's the module name for file system?",
    solution: "const fs = require('fs');"
  },
  2: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim().toLowerCase();
      return c.includes('module.exports') && c.includes('greet') && c.includes('farewell') && (c.includes('hello') || c.includes('`hello'));
    },
    hint: "Define two functions, then use module.exports = { greet, farewell }; Each function takes 'name' and returns a template string.",
    solution: `function greet(name) {
  return \`Hello, \${name}!\`;
}

function farewell(name) {
  return \`Goodbye, \${name}!\`;
}

module.exports = { greet, farewell };`
  },
  3: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('readFile') && !c.includes('readFileSync') && c.includes('utf8') && c.includes('err') && (c.includes('console.log') || c.includes('console.error'));
    },
    hint: "fs.readFile('filename', 'utf8', (err, data) => { ... }); ‚Äî Check err first, then log data.",
    solution: `const fs = require('fs');

fs.readFile('data.txt', 'utf8', (err, data) => {
  if (err) {
    console.error('Error:', err.message);
    return;
  }
  console.log(data);
});`
  },
  4: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('createServer') && c.includes('3000') && c.includes('listen') && (c.includes('end') || c.includes('.end'));
    },
    hint: "1. require('http')\n2. http.createServer((req, res) => { ... })\n3. res.writeHead(200, {'Content-Type': 'text/plain'})\n4. res.end('Hello Node!')\n5. server.listen(3000)",
    solution: `const http = require('http');

const server = http.createServer((req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('Hello Node!');
});

server.listen(3000, () => {
  console.log('Server running on port 3000');
});`
  },
  5: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('createServer') && c.includes('/api/status') && c.includes('application/json') && c.includes('uptime') && c.includes('JSON.stringify');
    },
    hint: "Check req.url === '/api/status', set Content-Type to 'application/json', and use JSON.stringify({ status: 'ok', uptime: process.uptime() })",
    solution: `const http = require('http');

const server = http.createServer((req, res) => {
  if (req.url === '/api/status') {
    res.writeHead(200, { 'Content-Type': 'application/json' });
    res.end(JSON.stringify({
      status: 'ok',
      uptime: process.uptime()
    }));
  } else {
    res.writeHead(404);
    res.end('Not found');
  }
});

server.listen(3000);`
  },
  6: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('writeFile') && c.includes('users.json') && c.includes('JSON.stringify') && (c.includes('name') && c.includes('email'));
    },
    hint: "1. Create an array of objects with name & email\n2. JSON.stringify(array, null, 2) for formatted output\n3. fs.writeFile('users.json', jsonString, callback)",
    solution: `const fs = require('fs');

const users = [
  { name: 'Alice', email: 'alice@mail.com' },
  { name: 'Bob', email: 'bob@mail.com' },
  { name: 'Charlie', email: 'charlie@mail.com' }
];

const json = JSON.stringify(users, null, 2);

fs.writeFile('users.json', json, (err) => {
  if (err) throw err;
  console.log('Users saved to users.json!');
});`
  },
  7: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('async') && c.includes('await') && c.includes('readFile') && c.includes('config.json') && c.includes('try') && c.includes('catch') && c.includes('JSON.parse');
    },
    hint: "1. const fs = require('fs/promises');\n2. async function loadConfig() { try { const data = await fs.readFile(...); const config = JSON.parse(data); } catch(err) { ... } }",
    solution: `const fs = require('fs/promises');

async function loadConfig() {
  try {
    const data = await fs.readFile('config.json', 'utf8');
    const config = JSON.parse(data);
    console.log('Config loaded:', config);
  } catch (err) {
    console.error('Failed to load config:', err.message);
  }
}

loadConfig();`
  },
  8: {
    check: (code) => {
      const c = code.replace(/\s+/g, ' ').trim();
      return c.includes('createServer') && c.includes("'/'") && c.includes('/about') && c.includes('404') && c.includes('listen');
    },
    hint: "Use if/else if/else to check req.url. For '/' return 'Home', for '/about' return 'About', else writeHead(404) and return 'Not Found'.",
    solution: `const http = require('http');

const server = http.createServer((req, res) => {
  if (req.url === '/') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('Home');
  } else if (req.url === '/about') {
    res.writeHead(200, { 'Content-Type': 'text/plain' });
    res.end('About');
  } else {
    res.writeHead(404, { 'Content-Type': 'text/plain' });
    res.end('Not Found');
  }
});

server.listen(3000);`
  }
};

function checkExercise(num) {
  const editor = document.getElementById('ex' + num + '-editor');
  const result = document.getElementById('ex' + num + '-result');
  const code = editor.value.trim();

  if (!code) {
    result.className = 'exercise-result error';
    result.textContent = '‚ùå Please write some code first!';
    result.style.display = 'block';
    return;
  }

  if (exercises[num].check(code)) {
    result.className = 'exercise-result success';
    result.innerHTML = '‚úÖ Correct! Great job! +25 XP';
    result.style.display = 'block';
    if (!state.exercisesCompleted.has(num)) {
      state.exercisesCompleted.add(num);
      addXP(25);
    }
  } else {
    result.className = 'exercise-result error';
    result.innerHTML = '‚ùå Not quite right. Check for missing parts. Click "Hint" for guidance!';
    result.style.display = 'block';
  }
}

function showHint(num) {
  const result = document.getElementById('ex' + num + '-result');
  result.className = 'exercise-result info';
  result.innerHTML = 'üí° <strong>Hint:</strong><br>' + exercises[num].hint.replace(/\n/g, '<br>');
  result.style.display = 'block';
}

function showSolution(num) {
  const editor = document.getElementById('ex' + num + '-editor');
  editor.value = exercises[num].solution;
  const result = document.getElementById('ex' + num + '-result');
  result.className = 'exercise-result info';
  result.textContent = 'üëÅ Solution revealed. Try to understand each line before moving on!';
  result.style.display = 'block';
}

// ============ FINAL QUIZ ============
function answerQuiz(qNum, el, answer) {
  if (state.quizSubmitted) return;
  const container = document.getElementById('quiz-q' + qNum);
  const options = container.querySelectorAll('.quiz-option');

  // Remove previous selection
  options.forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
  state.quizAnswers[qNum] = answer;
}

function submitQuiz() {
  if (Object.keys(state.quizAnswers).length < 10) {
    alert('Please answer all 10 questions before submitting!');
    return;
  }

  state.quizSubmitted = true;
  let score = 0;

  for (let i = 1; i <= 10; i++) {
    const container = document.getElementById('quiz-q' + i);
    const options = container.querySelectorAll('.quiz-option');
    const correct = state.quizCorrect[i];
    const userAnswer = state.quizAnswers[i];

    options.forEach(o => {
      o.classList.add('disabled');
      const optLetter = o.querySelector('.quiz-option-marker').textContent.trim().toLowerCase();
      if (optLetter === correct) {
        o.classList.add('correct');
        o.querySelector('.quiz-option-marker').textContent = '‚úì';
      }
      if (o.classList.contains('selected') && optLetter !== correct) {
        o.classList.add('wrong');
        o.querySelector('.quiz-option-marker').textContent = '‚úó';
      }
    });

    if (userAnswer === correct) score++;

    // Show explanation
    const exp = document.getElementById('quiz-q' + i + '-exp');
    if (exp) exp.classList.add('visible');
  }

  // Show score
  const scoreDisplay = document.getElementById('quiz-score');
  scoreDisplay.style.display = 'block';
  document.getElementById('score-value').textContent = score;
  const circle = document.getElementById('score-circle');
  circle.style.setProperty('--score-pct', (score * 10) + '%');

  const pct = score * 10;
  const msgEl = document.getElementById('score-message');
  const detEl = document.getElementById('score-detail');

  if (pct >= 90) {
    msgEl.textContent = 'üèÜ Outstanding! You\'re Node.js Ready!';
    msgEl.style.color = 'var(--success)';
    detEl.textContent = 'You have a strong grasp of Node.js fundamentals. Time to build projects!';
    addXP(100);
    launchConfetti();
  } else if (pct >= 70) {
    msgEl.textContent = 'üëè Great Job! Almost there!';
    msgEl.style.color = 'var(--accent)';
    detEl.textContent = 'Solid understanding! Review the topics you missed and retake.';
    addXP(60);
  } else if (pct >= 50) {
    msgEl.textContent = 'üìö Good Start! Keep Studying!';
    msgEl.style.color = 'var(--warning)';
    detEl.textContent = 'You know the basics but need more practice. Re-read the chapters above.';
    addXP(30);
  } else {
    msgEl.textContent = 'üí™ Don\'t Give Up! Review & Retry!';
    msgEl.style.color = 'var(--error)';
    detEl.textContent = 'Go through each chapter again. Focus on the code examples and try the exercises.';
    addXP(10);
  }

  document.getElementById('submit-quiz-btn').style.display = 'none';
  scoreDisplay.scrollIntoView({ behavior: 'smooth' });
}

function resetQuiz() {
  state.quizSubmitted = false;
  state.quizAnswers = {};

  for (let i = 1; i <= 10; i++) {
    const container = document.getElementById('quiz-q' + i);
    const options = container.querySelectorAll('.quiz-option');
    options.forEach(o => {
      o.classList.remove('selected', 'correct', 'wrong', 'disabled');
      const markers = ['A','B','C','D'];
      const idx = Array.from(options).indexOf(o);
      o.querySelector('.quiz-option-marker').textContent = markers[idx];
    });
    const exp = document.getElementById('quiz-q' + i + '-exp');
    if (exp) exp.classList.remove('visible');
  }

  document.getElementById('quiz-score').style.display = 'none';
  document.getElementById('submit-quiz-btn').style.display = '';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ============ COPY CODE ============
function copyCode(btn) {
  const codeBody = btn.closest('.code-block').querySelector('pre');
  const text = codeBody.textContent;
  navigator.clipboard.writeText(text).then(() => {
    const original = btn.textContent;
    btn.textContent = 'Copied!';
    btn.style.color = 'var(--success)';
    btn.style.borderColor = 'var(--success)';
    setTimeout(() => {
      btn.textContent = original;
      btn.style.color = '';
      btn.style.borderColor = '';
    }, 1500);
  });
}

// ============ CONFETTI ============
function launchConfetti() {
  const container = document.getElementById('confetti-container');
  const colors = ['#ff6b6b','#ffd93d','#6bcb77','#4d96ff','#ff6fcf','#845ec2'];
  for (let i = 0; i < 80; i++) {
    const conf = document.createElement('div');
    conf.className = 'confetti';
    conf.style.left = Math.random() * 100 + '%';
    conf.style.background = colors[Math.floor(Math.random() * colors.length)];
    conf.style.animationDuration = (2 + Math.random() * 2) + 's';
    conf.style.animationDelay = Math.random() * 1 + 's';
    conf.style.width = (5 + Math.random() * 10) + 'px';
    conf.style.height = (5 + Math.random() * 10) + 'px';
    conf.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    container.appendChild(conf);
  }
  setTimeout(() => { container.innerHTML = ''; }, 4000);
}

// ============ ANIMATE COUNTERS ============
function animateCounters() {
  document.querySelectorAll('.stat-value[data-count]').forEach(el => {
    const target = parseInt(el.dataset.count);
    let current = 0;
    const step = Math.ceil(target / 30);
    const timer = setInterval(() => {
      current += step;
      if (current >= target) {
        current = target;
        clearInterval(timer);
      }
      el.textContent = current;
    }, 40);
  });
}

// ============ PITFALL TOGGLE ============
document.querySelectorAll('.pitfall-header').forEach(header => {
  header.addEventListener('click', function() {
    const body = this.nextElementSibling;
    const isOpen = body.style.display === 'block';
    body.style.display = isOpen ? 'none' : 'block';
  });
});

// ============ KEYBOARD SHORTCUTS ============
document.addEventListener('keydown', (e) => {
  if (e.target.tagName === 'TEXTAREA') return;
  const sections = ['welcome','architecture','modules','filesystem','http','exercises','quiz','pitfalls'];
  const currentIdx = sections.indexOf(state.currentSection);

  if (e.key === 'ArrowRight' && currentIdx < sections.length - 1) {
    navigateTo(sections[currentIdx + 1]);
  } else if (e.key === 'ArrowLeft' && currentIdx > 0) {
    navigateTo(sections[currentIdx - 1]);
  }
});

// ============ TAB KEY IN EDITORS ============
document.querySelectorAll('.code-editor').forEach(editor => {
  editor.addEventListener('keydown', (e) => {
    if (e.key === 'Tab') {
      e.preventDefault();
      const start = editor.selectionStart;
      const end = editor.selectionEnd;
      editor.value = editor.value.substring(0, start) + '  ' + editor.value.substring(end);
      editor.selectionStart = editor.selectionEnd = start + 2;
    }
  });
});

// ============ INIT ============
animateCounters();
updateProgress();
</script>

</body>
</html>