<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GraphQL Mastery - Interactive Learning Hub</title>
<style>
/* ============ CSS RESET & VARIABLES ============ */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

:root {
  --gql-pink: #E10098;
  --gql-pink-light: #ff2bb8;
  --gql-pink-dark: #b3007a;
  --gql-blue: #1a1a2e;
  --gql-dark: #0f0f1a;
  --gql-card: #1e1e35;
  --gql-card-hover: #2a2a45;
  --gql-success: #00e676;
  --gql-error: #ff5252;
  --gql-warning: #ffc107;
  --gql-info: #448aff;
  --gql-text: #e8e8f0;
  --gql-text-dim: #9898b0;
  --gql-border: #333355;
  --gql-code-bg: #0d0d1a;
  --gql-gradient: linear-gradient(135deg, #E10098, #6f42c1, #448aff);
  --font-main: 'Segoe UI', system-ui, -apple-system, sans-serif;
  --font-code: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
  --radius: 12px;
  --radius-sm: 8px;
  --shadow: 0 8px 32px rgba(0,0,0,0.3);
  --shadow-pink: 0 4px 20px rgba(225,0,152,0.3);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-main);
  background: var(--gql-dark);
  color: var(--gql-text);
  line-height: 1.7;
  min-height: 100vh;
  overflow-x: hidden;
}

/* ============ SCROLLBAR ============ */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: var(--gql-dark); }
::-webkit-scrollbar-thumb { background: var(--gql-pink); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--gql-pink-light); }

/* ============ HEADER ============ */
.app-header {
  background: linear-gradient(180deg, rgba(225,0,152,0.15) 0%, transparent 100%);
  border-bottom: 1px solid var(--gql-border);
  padding: 20px 0;
  position: sticky;
  top: 0;
  z-index: 1000;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}

.header-content {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 30px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 15px;
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo-icon {
  width: 48px;
  height: 48px;
  background: var(--gql-gradient);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  font-weight: 900;
  color: white;
  box-shadow: var(--shadow-pink);
}

.logo-text h1 {
  font-size: 1.4rem;
  font-weight: 800;
  background: var(--gql-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.logo-text span {
  font-size: 0.75rem;
  color: var(--gql-text-dim);
  text-transform: uppercase;
  letter-spacing: 2px;
}

.progress-bar-container {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  max-width: 400px;
}

.progress-bar-container label {
  font-size: 0.8rem;
  color: var(--gql-text-dim);
  white-space: nowrap;
}

.progress-bar {
  flex: 1;
  height: 8px;
  background: var(--gql-card);
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  width: 0%;
  background: var(--gql-gradient);
  border-radius: 4px;
  transition: width 0.5s ease;
}

.progress-text {
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--gql-pink);
  min-width: 36px;
}

.xp-display {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--gql-card);
  padding: 8px 16px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--gql-border);
}

.xp-display .xp-icon { font-size: 1.2rem; }
.xp-display .xp-value {
  font-weight: 800;
  color: var(--gql-warning);
  font-size: 1rem;
}
.xp-display .xp-label {
  font-size: 0.75rem;
  color: var(--gql-text-dim);
}

/* ============ NAVIGATION ============ */
.nav-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px 30px 0;
}

.nav-tabs {
  display: flex;
  gap: 6px;
  overflow-x: auto;
  padding-bottom: 4px;
  scrollbar-width: none;
}

.nav-tabs::-webkit-scrollbar { display: none; }

.nav-tab {
  padding: 12px 24px;
  background: var(--gql-card);
  border: 1px solid var(--gql-border);
  border-bottom: none;
  border-radius: var(--radius-sm) var(--radius-sm) 0 0;
  color: var(--gql-text-dim);
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  white-space: nowrap;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
}

.nav-tab:hover {
  background: var(--gql-card-hover);
  color: var(--gql-text);
}

.nav-tab.active {
  background: var(--gql-blue);
  color: var(--gql-pink);
  border-color: var(--gql-pink);
  border-bottom: 2px solid var(--gql-blue);
}

.nav-tab .tab-emoji { font-size: 1.1rem; }

.nav-tab .tab-check {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--gql-success);
  color: var(--gql-dark);
  font-size: 10px;
  display: none;
  align-items: center;
  justify-content: center;
  font-weight: 900;
}

.nav-tab.completed .tab-check { display: flex; }

/* ============ MAIN CONTENT ============ */
.main-content {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 30px 60px;
}

.section-panel {
  display: none;
  background: var(--gql-blue);
  border: 1px solid var(--gql-border);
  border-top: 2px solid var(--gql-pink);
  border-radius: 0 var(--radius) var(--radius) var(--radius);
  padding: 40px;
  animation: fadeSlideIn 0.4s ease;
}

.section-panel.active { display: block; }

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.section-title {
  font-size: 2rem;
  font-weight: 800;
  margin-bottom: 8px;
  background: var(--gql-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.section-subtitle {
  color: var(--gql-text-dim);
  font-size: 1.05rem;
  margin-bottom: 30px;
}

/* ============ CONTENT BLOCKS ============ */
.concept-block {
  background: var(--gql-card);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius);
  padding: 30px;
  margin-bottom: 25px;
  transition: var(--transition);
}

.concept-block:hover {
  border-color: rgba(225,0,152,0.3);
  box-shadow: 0 0 20px rgba(225,0,152,0.05);
}

.concept-block h3 {
  color: var(--gql-pink);
  font-size: 1.3rem;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.concept-block h4 {
  color: var(--gql-info);
  font-size: 1.05rem;
  margin: 20px 0 10px;
}

.concept-block p {
  margin-bottom: 12px;
  color: var(--gql-text);
}

.concept-block ul, .concept-block ol {
  padding-left: 24px;
  margin-bottom: 15px;
}

.concept-block li {
  margin-bottom: 6px;
  color: var(--gql-text);
}

.concept-block li::marker {
  color: var(--gql-pink);
}

/* ============ CODE BLOCKS ============ */
.code-container {
  position: relative;
  margin: 18px 0;
  border-radius: var(--radius-sm);
  overflow: hidden;
  border: 1px solid var(--gql-border);
}

.code-header {
  background: rgba(0,0,0,0.4);
  padding: 8px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--gql-border);
}

.code-lang {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--gql-pink);
  font-weight: 700;
}

.code-dots {
  display: flex;
  gap: 6px;
}

.code-dots span {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

.code-dots span:nth-child(1) { background: #ff5f57; }
.code-dots span:nth-child(2) { background: #febc2e; }
.code-dots span:nth-child(3) { background: #28c840; }

.copy-btn {
  background: transparent;
  border: 1px solid var(--gql-border);
  color: var(--gql-text-dim);
  padding: 4px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.75rem;
  transition: var(--transition);
}

.copy-btn:hover {
  border-color: var(--gql-pink);
  color: var(--gql-pink);
}

pre {
  background: var(--gql-code-bg);
  padding: 20px;
  overflow-x: auto;
  font-family: var(--font-code);
  font-size: 0.88rem;
  line-height: 1.6;
  tab-size: 2;
}

code {
  font-family: var(--font-code);
}

.inline-code {
  background: rgba(225,0,152,0.15);
  color: var(--gql-pink-light);
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 0.88rem;
  font-family: var(--font-code);
}

/* Syntax highlighting */
.kw { color: #c792ea; } /* keyword */
.fn { color: #82aaff; } /* function */
.st { color: #c3e88d; } /* string */
.cm { color: #546e7a; font-style: italic; } /* comment */
.nm { color: #f78c6c; } /* number */
.tp { color: #ffcb6b; } /* type */
.op { color: #89ddff; } /* operator */
.pr { color: #f07178; } /* property */
.at { color: #bb80b3; } /* attribute/decorator */
.tx { color: #e8e8f0; } /* regular text */
.pn { color: #89ddff; } /* punctuation */

/* ============ CALLOUT BOXES ============ */
.callout {
  padding: 18px 22px;
  border-radius: var(--radius-sm);
  margin: 18px 0;
  border-left: 4px solid;
  font-size: 0.95rem;
}

.callout-tip {
  background: rgba(0,230,118,0.08);
  border-color: var(--gql-success);
}

.callout-tip .callout-title { color: var(--gql-success); }

.callout-warning {
  background: rgba(255,193,7,0.08);
  border-color: var(--gql-warning);
}

.callout-warning .callout-title { color: var(--gql-warning); }

.callout-danger {
  background: rgba(255,82,82,0.08);
  border-color: var(--gql-error);
}

.callout-danger .callout-title { color: var(--gql-error); }

.callout-info {
  background: rgba(68,138,255,0.08);
  border-color: var(--gql-info);
}

.callout-info .callout-title { color: var(--gql-info); }

.callout-title {
  font-weight: 700;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* ============ COMPARISON TABLE ============ */
.comparison-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin: 20px 0;
  border-radius: var(--radius-sm);
  overflow: hidden;
  border: 1px solid var(--gql-border);
}

.comparison-table th {
  background: rgba(225,0,152,0.15);
  color: var(--gql-pink);
  padding: 14px 18px;
  text-align: left;
  font-weight: 700;
  font-size: 0.9rem;
  border-bottom: 2px solid var(--gql-pink);
}

.comparison-table td {
  padding: 12px 18px;
  border-bottom: 1px solid var(--gql-border);
  font-size: 0.9rem;
  vertical-align: top;
}

.comparison-table tr:nth-child(even) td {
  background: rgba(0,0,0,0.15);
}

.comparison-table tr:last-child td { border-bottom: none; }

.comparison-table td:first-child {
  font-weight: 600;
  color: var(--gql-info);
}

/* ============ INTERACTIVE PLAYGROUND ============ */
.playground {
  background: var(--gql-card);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius);
  overflow: hidden;
  margin: 20px 0;
}

.playground-header {
  background: rgba(0,0,0,0.3);
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--gql-border);
}

.playground-title {
  font-weight: 700;
  color: var(--gql-pink);
  display: flex;
  align-items: center;
  gap: 8px;
}

.playground-body {
  display: grid;
  grid-template-columns: 1fr 1fr;
  min-height: 200px;
}

@media (max-width: 768px) {
  .playground-body { grid-template-columns: 1fr; }
}

.playground-input, .playground-output {
  padding: 0;
}

.playground-input {
  border-right: 1px solid var(--gql-border);
}

.playground-input textarea {
  width: 100%;
  height: 100%;
  min-height: 200px;
  background: var(--gql-code-bg);
  color: var(--gql-text);
  border: none;
  padding: 16px;
  font-family: var(--font-code);
  font-size: 0.88rem;
  line-height: 1.6;
  resize: vertical;
  outline: none;
}

.playground-output pre {
  margin: 0;
  min-height: 200px;
  border: none;
  border-radius: 0;
}

.playground-label {
  padding: 6px 16px;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--gql-text-dim);
  background: rgba(0,0,0,0.2);
  border-bottom: 1px solid var(--gql-border);
  font-weight: 600;
}

.run-btn {
  background: var(--gql-pink);
  color: white;
  border: none;
  padding: 8px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 700;
  font-size: 0.85rem;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 6px;
}

.run-btn:hover {
  background: var(--gql-pink-light);
  box-shadow: var(--shadow-pink);
}

/* ============ QUIZ SYSTEM ============ */
.quiz-container {
  background: var(--gql-card);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius);
  padding: 30px;
  margin: 25px 0;
}

.quiz-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}

.quiz-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--gql-pink);
  display: flex;
  align-items: center;
  gap: 8px;
}

.quiz-score {
  background: var(--gql-code-bg);
  padding: 6px 14px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.9rem;
}

.quiz-question {
  background: var(--gql-code-bg);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius-sm);
  padding: 24px;
  margin-bottom: 16px;
}

.quiz-question p {
  font-weight: 600;
  margin-bottom: 16px;
  font-size: 1rem;
}

.quiz-question .q-number {
  color: var(--gql-pink);
  font-weight: 800;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.quiz-option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--gql-card);
  border: 2px solid var(--gql-border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: var(--transition);
  font-size: 0.95rem;
}

.quiz-option:hover {
  border-color: var(--gql-pink);
  background: rgba(225,0,152,0.05);
}

.quiz-option.selected {
  border-color: var(--gql-info);
  background: rgba(68,138,255,0.1);
}

.quiz-option.correct {
  border-color: var(--gql-success) !important;
  background: rgba(0,230,118,0.1) !important;
}

.quiz-option.incorrect {
  border-color: var(--gql-error) !important;
  background: rgba(255,82,82,0.1) !important;
}

.quiz-option .option-letter {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: var(--gql-code-bg);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.85rem;
  color: var(--gql-text-dim);
  flex-shrink: 0;
}

.quiz-option.correct .option-letter {
  background: var(--gql-success);
  color: var(--gql-dark);
}

.quiz-option.incorrect .option-letter {
  background: var(--gql-error);
  color: white;
}

.quiz-explanation {
  margin-top: 12px;
  padding: 14px;
  border-radius: var(--radius-sm);
  font-size: 0.9rem;
  display: none;
}

.quiz-explanation.show { display: block; }

.quiz-explanation.correct-exp {
  background: rgba(0,230,118,0.08);
  border: 1px solid rgba(0,230,118,0.3);
  color: var(--gql-success);
}

.quiz-explanation.incorrect-exp {
  background: rgba(255,82,82,0.08);
  border: 1px solid rgba(255,82,82,0.3);
  color: var(--gql-error);
}

.quiz-actions {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.btn {
  padding: 10px 24px;
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-weight: 700;
  font-size: 0.9rem;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 6px;
}

.btn-primary {
  background: var(--gql-pink);
  color: white;
}
.btn-primary:hover {
  background: var(--gql-pink-light);
  box-shadow: var(--shadow-pink);
}

.btn-secondary {
  background: var(--gql-card);
  color: var(--gql-text);
  border: 1px solid var(--gql-border);
}
.btn-secondary:hover {
  border-color: var(--gql-pink);
  color: var(--gql-pink);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ============ EXERCISE SYSTEM ============ */
.exercise-container {
  background: var(--gql-card);
  border: 2px solid var(--gql-info);
  border-radius: var(--radius);
  padding: 30px;
  margin: 25px 0;
}

.exercise-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.exercise-badge {
  background: var(--gql-info);
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.exercise-title {
  font-size: 1.15rem;
  font-weight: 700;
}

.exercise-desc {
  margin-bottom: 20px;
  color: var(--gql-text-dim);
}

.exercise-editor {
  position: relative;
}

.exercise-editor textarea {
  width: 100%;
  min-height: 180px;
  background: var(--gql-code-bg);
  color: var(--gql-text);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius-sm);
  padding: 16px;
  font-family: var(--font-code);
  font-size: 0.88rem;
  line-height: 1.6;
  resize: vertical;
  outline: none;
  transition: var(--transition);
}

.exercise-editor textarea:focus {
  border-color: var(--gql-pink);
  box-shadow: 0 0 0 3px rgba(225,0,152,0.1);
}

.exercise-result {
  margin-top: 12px;
  padding: 14px;
  border-radius: var(--radius-sm);
  display: none;
  font-size: 0.9rem;
}

.exercise-result.show { display: block; }
.exercise-result.pass {
  background: rgba(0,230,118,0.08);
  border: 1px solid rgba(0,230,118,0.3);
  color: var(--gql-success);
}
.exercise-result.fail {
  background: rgba(255,82,82,0.08);
  border: 1px solid rgba(255,82,82,0.3);
  color: var(--gql-error);
}

.hint-btn {
  background: transparent;
  border: 1px dashed var(--gql-warning);
  color: var(--gql-warning);
  padding: 6px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.8rem;
  transition: var(--transition);
}

.hint-btn:hover {
  background: rgba(255,193,7,0.1);
}

.hint-text {
  display: none;
  margin-top: 10px;
  padding: 12px;
  background: rgba(255,193,7,0.08);
  border: 1px solid rgba(255,193,7,0.2);
  border-radius: var(--radius-sm);
  color: var(--gql-warning);
  font-size: 0.9rem;
}

.hint-text.show { display: block; }

/* ============ PITFALL CARDS ============ */
.pitfall-card {
  background: var(--gql-card);
  border: 1px solid var(--gql-error);
  border-radius: var(--radius);
  padding: 24px;
  margin: 20px 0;
  position: relative;
  overflow: hidden;
}

.pitfall-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: linear-gradient(90deg, var(--gql-error), transparent);
}

.pitfall-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.pitfall-icon {
  font-size: 1.5rem;
}

.pitfall-title {
  font-weight: 700;
  color: var(--gql-error);
  font-size: 1.1rem;
}

.pitfall-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 15px;
}

@media (max-width: 768px) {
  .pitfall-grid { grid-template-columns: 1fr; }
}

.pitfall-wrong, .pitfall-right {
  border-radius: var(--radius-sm);
  padding: 15px;
}

.pitfall-wrong {
  background: rgba(255,82,82,0.05);
  border: 1px solid rgba(255,82,82,0.3);
}

.pitfall-right {
  background: rgba(0,230,118,0.05);
  border: 1px solid rgba(0,230,118,0.3);
}

.pitfall-label {
  font-size: 0.8rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}

.pitfall-wrong .pitfall-label { color: var(--gql-error); }
.pitfall-right .pitfall-label { color: var(--gql-success); }

/* ============ TABS WITHIN SECTIONS ============ */
.sub-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.sub-tab {
  padding: 8px 18px;
  background: var(--gql-code-bg);
  border: 1px solid var(--gql-border);
  border-radius: 20px;
  color: var(--gql-text-dim);
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  transition: var(--transition);
}

.sub-tab:hover {
  color: var(--gql-text);
  border-color: var(--gql-pink);
}

.sub-tab.active {
  background: var(--gql-pink);
  color: white;
  border-color: var(--gql-pink);
}

.sub-content { display: none; }
.sub-content.active { display: block; }

/* ============ DIAGRAM / VISUAL ============ */
.visual-box {
  background: var(--gql-code-bg);
  border: 1px solid var(--gql-border);
  border-radius: var(--radius);
  padding: 30px;
  margin: 20px 0;
  text-align: center;
}

.flow-diagram {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  flex-wrap: wrap;
  margin: 20px 0;
}

.flow-node {
  background: var(--gql-card);
  border: 2px solid var(--gql-pink);
  border-radius: var(--radius-sm);
  padding: 12px 20px;
  font-weight: 700;
  font-size: 0.9rem;
  min-width: 120px;
  text-align: center;
}

.flow-node.highlight {
  background: rgba(225,0,152,0.15);
  border-color: var(--gql-pink-light);
  box-shadow: var(--shadow-pink);
}

.flow-arrow {
  color: var(--gql-pink);
  font-size: 1.5rem;
  font-weight: 900;
}

/* ============ ACCORDION ============ */
.accordion {
  margin: 15px 0;
}

.accordion-item {
  border: 1px solid var(--gql-border);
  border-radius: var(--radius-sm);
  margin-bottom: 8px;
  overflow: hidden;
}

.accordion-header {
  padding: 14px 20px;
  background: var(--gql-code-bg);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 600;
  transition: var(--transition);
}

.accordion-header:hover {
  background: var(--gql-card);
}

.accordion-header .arrow {
  transition: var(--transition);
  color: var(--gql-pink);
}

.accordion-header.open .arrow { transform: rotate(180deg); }

.accordion-body {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  background: var(--gql-card);
}

.accordion-body-inner {
  padding: 20px;
}

/* ============ TOAST NOTIFICATION ============ */
.toast {
  position: fixed;
  bottom: 30px;
  right: 30px;
  padding: 14px 24px;
  border-radius: var(--radius-sm);
  color: white;
  font-weight: 600;
  font-size: 0.9rem;
  z-index: 10000;
  transform: translateY(100px);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  display: flex;
  align-items: center;
  gap: 10px;
  box-shadow: var(--shadow);
  max-width: 400px;
}

.toast.show {
  transform: translateY(0);
  opacity: 1;
}

.toast-success { background: var(--gql-success); color: var(--gql-dark); }
.toast-error { background: var(--gql-error); }
.toast-info { background: var(--gql-info); }
.toast-xp { background: var(--gql-warning); color: var(--gql-dark); }

/* ============ RESPONSIVE ============ */
@media (max-width: 900px) {
  .header-content { flex-direction: column; align-items: flex-start; }
  .progress-bar-container { max-width: 100%; }
  .section-panel { padding: 24px 18px; }
  .section-title { font-size: 1.5rem; }
  .concept-block { padding: 20px; }
  .playground-body { grid-template-columns: 1fr; }
}

/* ============ ACHIEVEMENT POPUP ============ */
.achievement-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.achievement-overlay.show {
  opacity: 1;
  pointer-events: all;
}

.achievement-card {
  background: var(--gql-card);
  border: 2px solid var(--gql-warning);
  border-radius: var(--radius);
  padding: 40px;
  text-align: center;
  max-width: 400px;
  transform: scale(0.8);
  transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  box-shadow: 0 0 60px rgba(255,193,7,0.3);
}

.achievement-overlay.show .achievement-card {
  transform: scale(1);
}

.achievement-emoji {
  font-size: 4rem;
  margin-bottom: 15px;
}

.achievement-title {
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--gql-warning);
  margin-bottom: 8px;
}

.achievement-desc {
  color: var(--gql-text-dim);
  margin-bottom: 20px;
}

/* ============ SECTION COMPLETE BANNER ============ */
.section-complete-banner {
  background: linear-gradient(135deg, rgba(0,230,118,0.1), rgba(68,138,255,0.1));
  border: 1px solid var(--gql-success);
  border-radius: var(--radius);
  padding: 24px;
  text-align: center;
  margin-top: 30px;
  display: none;
}

.section-complete-banner.show { display: block; }

.section-complete-banner h3 {
  color: var(--gql-success);
  font-size: 1.3rem;
  margin-bottom: 8px;
}

/* ============ FLASHCARD ============ */
.flashcard-container {
  perspective: 1000px;
  margin: 20px 0;
}

.flashcard {
  width: 100%;
  min-height: 180px;
  position: relative;
  cursor: pointer;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.flashcard.flipped { transform: rotateY(180deg); }

.flashcard-front, .flashcard-back {
  position: absolute;
  width: 100%;
  min-height: 180px;
  backface-visibility: hidden;
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 30px;
  text-align: center;
}

.flashcard-front {
  background: linear-gradient(135deg, var(--gql-card), var(--gql-card-hover));
  border: 2px solid var(--gql-pink);
}

.flashcard-back {
  background: linear-gradient(135deg, rgba(225,0,152,0.1), var(--gql-card));
  border: 2px solid var(--gql-success);
  transform: rotateY(180deg);
}

.flashcard-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 10px;
  color: var(--gql-text-dim);
}

.flashcard-text {
  font-size: 1.1rem;
  font-weight: 600;
}

/* ============ STEP INDICATOR ============ */
.step-list {
  counter-reset: step-counter;
  list-style: none;
  padding: 0;
}

.step-item {
  counter-increment: step-counter;
  display: flex;
  gap: 16px;
  margin-bottom: 24px;
  padding-left: 0;
}

.step-item::before {
  content: counter(step-counter);
  width: 36px;
  height: 36px;
  background: var(--gql-pink);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 800;
  font-size: 0.9rem;
  flex-shrink: 0;
  margin-top: 2px;
}

.step-content h4 {
  margin-bottom: 6px;
  color: var(--gql-text);
}

.step-content p {
  color: var(--gql-text-dim);
  font-size: 0.95rem;
}

/* ============ ANIMATIONS ============ */
@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 5px rgba(225,0,152,0.3); }
  50% { box-shadow: 0 0 20px rgba(225,0,152,0.6); }
}

.pulse { animation: pulse 2s infinite; }
.glow { animation: glow 2s infinite; }

/* Tag badges */
.tag {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.tag-beginner { background: rgba(0,230,118,0.15); color: var(--gql-success); }
.tag-intermediate { background: rgba(255,193,7,0.15); color: var(--gql-warning); }
.tag-advanced { background: rgba(255,82,82,0.15); color: var(--gql-error); }

/* Drag and drop matching */
.match-container {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 12px;
  align-items: start;
  margin: 20px 0;
}

.match-column {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.match-item {
  padding: 12px 16px;
  background: var(--gql-code-bg);
  border: 2px solid var(--gql-border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: 0.9rem;
  transition: var(--transition);
  text-align: center;
}

.match-item:hover { border-color: var(--gql-pink); }
.match-item.selected { border-color: var(--gql-info); background: rgba(68,138,255,0.1); }
.match-item.matched { border-color: var(--gql-success); background: rgba(0,230,118,0.1); opacity: 0.7; }

.match-divider {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--gql-text-dim);
  font-size: 1.5rem;
  padding-top: 40px;
}

/* Confetti canvas */
#confetti-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 99999;
}
</style>
</head>
<body>

<!-- Toast Notification -->
<div class="toast" id="toast"></div>

<!-- Achievement Overlay -->
<div class="achievement-overlay" id="achievementOverlay">
  <div class="achievement-card">
    <div class="achievement-emoji" id="achieveEmoji">üèÜ</div>
    <div class="achievement-title" id="achieveTitle">Achievement Unlocked!</div>
    <div class="achievement-desc" id="achieveDesc">You've completed a milestone!</div>
    <button class="btn btn-primary" onclick="closeAchievement()">Awesome! üéâ</button>
  </div>
</div>

<!-- Confetti Canvas -->
<canvas id="confetti-canvas"></canvas>

<!-- ============ HEADER ============ -->
<header class="app-header">
  <div class="header-content">
    <div class="logo">
      <div class="logo-icon">G</div>
      <div class="logo-text">
        <h1>GraphQL Mastery</h1>
        <span>Interactive Learning Hub</span>
      </div>
    </div>
    <div class="progress-bar-container">
      <label>Progress</label>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <span class="progress-text" id="progressText">0%</span>
    </div>
    <div class="xp-display">
      <span class="xp-icon">‚ö°</span>
      <span class="xp-value" id="xpValue">0</span>
      <span class="xp-label">XP</span>
    </div>
  </div>
</header>

<!-- ============ NAVIGATION ============ -->
<nav class="nav-container">
  <div class="nav-tabs" id="navTabs">
    <div class="nav-tab active" data-tab="intro" onclick="switchTab('intro')">
      <span class="tab-emoji">üöÄ</span> Intro
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="schema" onclick="switchTab('schema')">
      <span class="tab-emoji">üìê</span> Schema
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="queries" onclick="switchTab('queries')">
      <span class="tab-emoji">üîç</span> Queries
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="mutations" onclick="switchTab('mutations')">
      <span class="tab-emoji">‚úèÔ∏è</span> Mutations
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="apollo" onclick="switchTab('apollo')">
      <span class="tab-emoji">üöÄ</span> Apollo Client
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="vs-rest" onclick="switchTab('vs-rest')">
      <span class="tab-emoji">‚öîÔ∏è</span> GraphQL vs REST
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="pitfalls" onclick="switchTab('pitfalls')">
      <span class="tab-emoji">‚ö†Ô∏è</span> Pitfalls
      <span class="tab-check">‚úì</span>
    </div>
    <div class="nav-tab" data-tab="final-quiz" onclick="switchTab('final-quiz')">
      <span class="tab-emoji">üéØ</span> Final Quiz
      <span class="tab-check">‚úì</span>
    </div>
  </div>
</nav>

<!-- ============ MAIN CONTENT ============ -->
<main class="main-content">

<!-- ==================== SECTION: INTRO ==================== -->
<section class="section-panel active" id="section-intro">
  <h2 class="section-title">Welcome to GraphQL Mastery</h2>
  <p class="section-subtitle">Master the query language that's revolutionizing how we build APIs</p>

  <div class="concept-block">
    <h3>ü§î What is GraphQL?</h3>
    <p>GraphQL is a <strong>query language for APIs</strong> and a <strong>runtime for executing those queries</strong>. It was developed by Facebook in 2012 and open-sourced in 2015. Unlike REST, GraphQL gives clients the power to ask for exactly what they need ‚Äî nothing more, nothing less.</p>

    <div class="callout callout-info">
      <div class="callout-title">üí° Key Insight</div>
      Think of GraphQL as a "menu" at a restaurant. Instead of getting a fixed meal (REST), you tell the waiter exactly what dishes you want, how they should be prepared, and in what order ‚Äî and that's exactly what you get.
    </div>

    <h4>Core Concepts at a Glance</h4>
    <div class="flow-diagram">
      <div class="flow-node highlight">Schema</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node">Queries</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node">Mutations</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node">Resolvers</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node highlight">Response</div>
    </div>

    <ul>
      <li><strong>Schema:</strong> Defines the shape of your data (types, fields, relationships)</li>
      <li><strong>Queries:</strong> Read data (like GET in REST)</li>
      <li><strong>Mutations:</strong> Write/modify data (like POST/PUT/DELETE in REST)</li>
      <li><strong>Resolvers:</strong> Functions that fetch the actual data for each field</li>
      <li><strong>Subscriptions:</strong> Real-time data via WebSockets</li>
    </ul>
  </div>

  <div class="concept-block">
    <h3>‚ö° Your First GraphQL Query</h3>
    <p>Here's the simplest GraphQL query compared to what you'd get with REST:</p>

    <div class="pitfall-grid">
      <div class="pitfall-right">
        <div class="pitfall-label">GraphQL ‚Äî Ask for exactly what you need</div>
        <div class="code-container">
          <div class="code-header">
            <span class="code-lang">GraphQL</span>
            <div class="code-dots"><span></span><span></span><span></span></div>
          </div>
          <pre><code><span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
        <div class="code-container">
          <div class="code-header">
            <span class="code-lang">Response</span>
            <div class="code-dots"><span></span><span></span><span></span></div>
          </div>
          <pre><code><span class="pn">{</span>
  <span class="st">"data"</span><span class="pn">:</span> <span class="pn">{</span>
    <span class="st">"user"</span><span class="pn">:</span> <span class="pn">{</span>
      <span class="st">"name"</span><span class="pn">:</span> <span class="st">"Alice"</span><span class="pn">,</span>
      <span class="st">"email"</span><span class="pn">:</span> <span class="st">"alice@example.com"</span>
    <span class="pn">}</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
      <div class="pitfall-wrong">
        <div class="pitfall-label">REST ‚Äî Get everything whether you need it or not</div>
        <div class="code-container">
          <div class="code-header">
            <span class="code-lang">REST</span>
            <div class="code-dots"><span></span><span></span><span></span></div>
          </div>
          <pre><code><span class="fn">GET</span> <span class="st">/api/users/1</span></code></pre>
        </div>
        <div class="code-container">
          <div class="code-header">
            <span class="code-lang">Response (Over-fetching!)</span>
            <div class="code-dots"><span></span><span></span><span></span></div>
          </div>
          <pre><code><span class="pn">{</span>
  <span class="st">"id"</span><span class="pn">:</span> <span class="nm">1</span><span class="pn">,</span>
  <span class="st">"name"</span><span class="pn">:</span> <span class="st">"Alice"</span><span class="pn">,</span>
  <span class="st">"email"</span><span class="pn">:</span> <span class="st">"alice@example.com"</span><span class="pn">,</span>
  <span class="st">"phone"</span><span class="pn">:</span> <span class="st">"555-0100"</span><span class="pn">,</span>
  <span class="st">"address"</span><span class="pn">:</span> <span class="st">"..."</span><span class="pn">,</span>
  <span class="st">"avatar"</span><span class="pn">:</span> <span class="st">"..."</span><span class="pn">,</span>
  <span class="st">"createdAt"</span><span class="pn">:</span> <span class="st">"..."</span><span class="pn">,</span>
  <span class="cm">// 20 more fields you don't need!</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- INTRO MINI QUIZ -->
  <div class="quiz-container" id="intro-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Quick Check</div>
      <div class="quiz-score" id="intro-quiz-score">0/2</div>
    </div>
    <div class="quiz-question" id="intro-q1">
      <p><span class="q-number">Q1.</span> What problem does GraphQL primarily solve compared to REST?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('intro', 1, 0)">
          <span class="option-letter">A</span> GraphQL is faster than REST at the network level
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 1, 1)">
          <span class="option-letter">B</span> Clients can request exactly the data they need (no over/under-fetching)
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 1, 2)">
          <span class="option-letter">C</span> GraphQL doesn't need a server
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 1, 3)">
          <span class="option-letter">D</span> GraphQL replaces databases
        </div>
      </div>
      <div class="quiz-explanation" id="intro-q1-exp"></div>
    </div>
    <div class="quiz-question" id="intro-q2">
      <p><span class="q-number">Q2.</span> Which company originally developed GraphQL?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('intro', 2, 0)">
          <span class="option-letter">A</span> Google
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 2, 1)">
          <span class="option-letter">B</span> Netflix
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 2, 2)">
          <span class="option-letter">C</span> Facebook (Meta)
        </div>
        <div class="quiz-option" onclick="answerQuiz('intro', 2, 3)">
          <span class="option-letter">D</span> Twitter
        </div>
      </div>
      <div class="quiz-explanation" id="intro-q2-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="intro-complete">
    <h3>üéâ Introduction Complete!</h3>
    <p>You understand the basics! Move on to <strong>Schema</strong> to learn how GraphQL types work.</p>
    <button class="btn btn-primary" onclick="switchTab('schema')" style="margin-top:12px;">Next: Schema ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: SCHEMA ==================== -->
<section class="section-panel" id="section-schema">
  <h2 class="section-title">GraphQL Schema</h2>
  <p class="section-subtitle">The contract between your client and server ‚Äî the blueprint for your entire API</p>

  <div class="concept-block">
    <h3>üìê What is a Schema?</h3>
    <p>A GraphQL schema is the <strong>single source of truth</strong> that describes what data clients can query. It defines:</p>
    <ul>
      <li><strong>Types</strong> ‚Äî The shape of your data objects</li>
      <li><strong>Fields</strong> ‚Äî The properties on each type</li>
      <li><strong>Relationships</strong> ‚Äî How types connect to each other</li>
      <li><strong>Entry points</strong> ‚Äî Query, Mutation, and Subscription root types</li>
    </ul>

    <div class="callout callout-tip">
      <div class="callout-title">‚úÖ Pro Tip</div>
      The schema is written in <strong>SDL (Schema Definition Language)</strong>. It's like TypeScript types for your API. If you know TypeScript, you'll pick this up fast!
    </div>
  </div>

  <div class="concept-block">
    <h3>üî§ Scalar Types (Built-in Primitives)</h3>
    <p>GraphQL has 5 built-in scalar types:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL SDL</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
      </div>
      <pre><code><span class="cm"># The 5 built-in scalar types</span>
<span class="tp">Int</span>      <span class="cm"># Signed 32-bit integer</span>
<span class="tp">Float</span>    <span class="cm"># Signed double-precision floating-point</span>
<span class="tp">String</span>   <span class="cm"># UTF-8 character sequence</span>
<span class="tp">Boolean</span>  <span class="cm"># true or false</span>
<span class="tp">ID</span>       <span class="cm"># Unique identifier (serialized as String)</span>

<span class="cm"># You can also create custom scalars!</span>
<span class="kw">scalar</span> <span class="tp">Date</span>
<span class="kw">scalar</span> <span class="tp">JSON</span>
<span class="kw">scalar</span> <span class="tp">URL</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üèóÔ∏è Object Types</h3>
    <p>Object types are the most common types in a schema. They represent a "thing" in your domain:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL SDL</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Define an object type</span>
<span class="kw">type</span> <span class="tp">User</span> <span class="pn">{</span>
  <span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span>           <span class="cm"># ! means non-nullable (required)</span>
  <span class="pr">name</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">email</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">age</span><span class="pn">:</span> <span class="tp">Int</span>            <span class="cm"># nullable (can be null)</span>
  <span class="pr">isActive</span><span class="pn">:</span> <span class="tp">Boolean!</span>
  <span class="pr">posts</span><span class="pn">:</span> <span class="pn">[</span><span class="tp">Post!</span><span class="pn">]!</span>     <span class="cm"># Non-null list of non-null Posts</span>
  <span class="pr">friends</span><span class="pn">:</span> <span class="pn">[</span><span class="tp">User</span><span class="pn">]</span>     <span class="cm"># Nullable list of nullable Users</span>
<span class="pn">}</span>

<span class="kw">type</span> <span class="tp">Post</span> <span class="pn">{</span>
  <span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span>
  <span class="pr">title</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">content</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">author</span><span class="pn">:</span> <span class="tp">User!</span>       <span class="cm"># Relationship back to User</span>
  <span class="pr">tags</span><span class="pn">:</span> <span class="pn">[</span><span class="tp">String!</span><span class="pn">]</span>
  <span class="pr">createdAt</span><span class="pn">:</span> <span class="tp">String!</span>
<span class="pn">}</span></code></pre>
    </div>

    <div class="callout callout-warning">
      <div class="callout-title">‚ö†Ô∏è Nullability Cheat Sheet</div>
      <p>This trips up many beginners. Memorize these:</p>
      <ul style="margin-top:8px;">
        <li><span class="inline-code">String</span> ‚Üí Can be null</li>
        <li><span class="inline-code">String!</span> ‚Üí Never null (guaranteed to return a string)</li>
        <li><span class="inline-code">[String]</span> ‚Üí List can be null, items can be null</li>
        <li><span class="inline-code">[String!]</span> ‚Üí List can be null, but items can't</li>
        <li><span class="inline-code">[String!]!</span> ‚Üí Neither list nor items can be null</li>
      </ul>
    </div>
  </div>

  <div class="concept-block">
    <h3>üîå Enums, Input Types & Interfaces</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL SDL</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Enum ‚Äî A set of allowed values</span>
<span class="kw">enum</span> <span class="tp">Role</span> <span class="pn">{</span>
  <span class="pr">ADMIN</span>
  <span class="pr">USER</span>
  <span class="pr">MODERATOR</span>
<span class="pn">}</span>

<span class="cm"># Input type ‚Äî Used for mutation arguments</span>
<span class="kw">input</span> <span class="tp">CreateUserInput</span> <span class="pn">{</span>
  <span class="pr">name</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">email</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">role</span><span class="pn">:</span> <span class="tp">Role</span> <span class="op">=</span> <span class="pr">USER</span>   <span class="cm"># Default value!</span>
<span class="pn">}</span>

<span class="cm"># Interface ‚Äî Shared fields across types</span>
<span class="kw">interface</span> <span class="tp">Node</span> <span class="pn">{</span>
  <span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span>
<span class="pn">}</span>

<span class="kw">type</span> <span class="tp">User</span> <span class="kw">implements</span> <span class="tp">Node</span> <span class="pn">{</span>
  <span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span>
  <span class="pr">name</span><span class="pn">:</span> <span class="tp">String!</span>
<span class="pn">}</span>

<span class="cm"># Union ‚Äî One of several types</span>
<span class="kw">union</span> <span class="tp">SearchResult</span> <span class="op">=</span> <span class="tp">User</span> <span class="op">|</span> <span class="tp">Post</span> <span class="op">|</span> <span class="tp">Comment</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üéØ The Root Types ‚Äî Entry Points</h3>
    <p>Every schema must have a <span class="inline-code">Query</span> type. <span class="inline-code">Mutation</span> and <span class="inline-code">Subscription</span> are optional:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL SDL ‚Äî Complete Schema</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Root Query ‚Äî All read operations start here</span>
<span class="kw">type</span> <span class="tp">Query</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">):</span> <span class="tp">User</span>
  <span class="fn">users</span><span class="pn">(</span><span class="pr">limit</span><span class="pn">:</span> <span class="tp">Int</span><span class="pn">,</span> <span class="pr">offset</span><span class="pn">:</span> <span class="tp">Int</span><span class="pn">):</span> <span class="pn">[</span><span class="tp">User!</span><span class="pn">]!</span>
  <span class="fn">post</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">):</span> <span class="tp">Post</span>
  <span class="fn">search</span><span class="pn">(</span><span class="pr">term</span><span class="pn">:</span> <span class="tp">String!</span><span class="pn">):</span> <span class="pn">[</span><span class="tp">SearchResult!</span><span class="pn">]</span>
<span class="pn">}</span>

<span class="cm"># Root Mutation ‚Äî All write operations start here</span>
<span class="kw">type</span> <span class="tp">Mutation</span> <span class="pn">{</span>
  <span class="fn">createUser</span><span class="pn">(</span><span class="pr">input</span><span class="pn">:</span> <span class="tp">CreateUserInput!</span><span class="pn">):</span> <span class="tp">User!</span>
  <span class="fn">updateUser</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">,</span> <span class="pr">input</span><span class="pn">:</span> <span class="tp">UpdateUserInput!</span><span class="pn">):</span> <span class="tp">User!</span>
  <span class="fn">deleteUser</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">):</span> <span class="tp">Boolean!</span>
<span class="pn">}</span>

<span class="cm"># Schema declaration</span>
<span class="kw">schema</span> <span class="pn">{</span>
  <span class="pr">query</span><span class="pn">:</span> <span class="tp">Query</span>
  <span class="pr">mutation</span><span class="pn">:</span> <span class="tp">Mutation</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <!-- SCHEMA EXERCISE -->
  <div class="exercise-container" id="schema-exercise-1">
    <div class="exercise-header">
      <span class="exercise-badge">Exercise</span>
      <span class="exercise-title">Build a Schema</span>
      <span class="tag tag-beginner">Beginner</span>
    </div>
    <p class="exercise-desc">Write a GraphQL schema for a <strong>Book</strong> type with the following fields: <code>id</code> (required ID), <code>title</code> (required String), <code>author</code> (required String), <code>year</code> (optional Int), <code>genres</code> (required list of non-null Strings). Type it in GraphQL SDL.</p>
    <div class="exercise-editor">
      <textarea id="schema-ex1-input" placeholder="type Book {&#10;  // your fields here&#10;}"></textarea>
    </div>
    <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
      <button class="btn btn-primary" onclick="checkSchemaExercise1()">‚úì Check Answer</button>
      <button class="hint-btn" onclick="toggleHint('schema-hint-1')">üí° Show Hint</button>
    </div>
    <div class="hint-text" id="schema-hint-1">
      Remember: <code>!</code> means non-nullable, <code>[Type!]!</code> means required list of required items. The ID type is for unique identifiers.
    </div>
    <div class="exercise-result" id="schema-ex1-result"></div>
  </div>

  <!-- SCHEMA QUIZ -->
  <div class="quiz-container" id="schema-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Schema Quiz</div>
      <div class="quiz-score" id="schema-quiz-score">0/3</div>
    </div>
    <div class="quiz-question" id="schema-q1">
      <p><span class="q-number">Q1.</span> What does <span class="inline-code">[String!]!</span> mean?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('schema', 1, 0)">
          <span class="option-letter">A</span> A nullable list of nullable strings
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 1, 1)">
          <span class="option-letter">B</span> A non-null list of non-null strings
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 1, 2)">
          <span class="option-letter">C</span> A non-null list of nullable strings
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 1, 3)">
          <span class="option-letter">D</span> A nullable list of non-null strings
        </div>
      </div>
      <div class="quiz-explanation" id="schema-q1-exp"></div>
    </div>
    <div class="quiz-question" id="schema-q2">
      <p><span class="q-number">Q2.</span> What keyword is used to define a set of allowed values?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('schema', 2, 0)">
          <span class="option-letter">A</span> <span class="inline-code">type</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 2, 1)">
          <span class="option-letter">B</span> <span class="inline-code">interface</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 2, 2)">
          <span class="option-letter">C</span> <span class="inline-code">enum</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 2, 3)">
          <span class="option-letter">D</span> <span class="inline-code">union</span>
        </div>
      </div>
      <div class="quiz-explanation" id="schema-q2-exp"></div>
    </div>
    <div class="quiz-question" id="schema-q3">
      <p><span class="q-number">Q3.</span> Which root type is REQUIRED in every GraphQL schema?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('schema', 3, 0)">
          <span class="option-letter">A</span> Mutation
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 3, 1)">
          <span class="option-letter">B</span> Query
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 3, 2)">
          <span class="option-letter">C</span> Subscription
        </div>
        <div class="quiz-option" onclick="answerQuiz('schema', 3, 3)">
          <span class="option-letter">D</span> All of the above
        </div>
      </div>
      <div class="quiz-explanation" id="schema-q3-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="schema-complete">
    <h3>üéâ Schema Section Complete!</h3>
    <p>You now understand GraphQL type system! Move on to <strong>Queries</strong>.</p>
    <button class="btn btn-primary" onclick="switchTab('queries')" style="margin-top:12px;">Next: Queries ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: QUERIES ==================== -->
<section class="section-panel" id="section-queries">
  <h2 class="section-title">GraphQL Queries</h2>
  <p class="section-subtitle">Ask for data with precision ‚Äî the heart of GraphQL</p>

  <div class="concept-block">
    <h3>üîç Basic Query Structure</h3>
    <p>Queries in GraphQL mirror the shape of the response. You write what you want, and that's exactly what you get:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Query</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Named query (best practice for production)</span>
<span class="kw">query</span> <span class="fn">GetUser</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">id</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
    <span class="pr">posts</span> <span class="pn">{</span>       <span class="cm"># Nested query ‚Äî get related data!</span>
      <span class="pr">title</span>
      <span class="pr">createdAt</span>
    <span class="pn">}</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># Response mirrors the query shape:</span>
<span class="cm"># {</span>
<span class="cm">#   "data": {</span>
<span class="cm">#     "user": {</span>
<span class="cm">#       "id": "1",</span>
<span class="cm">#       "name": "Alice",</span>
<span class="cm">#       "email": "alice@dev.io",</span>
<span class="cm">#       "posts": [</span>
<span class="cm">#         { "title": "GraphQL 101", "createdAt": "2024-01-15" }</span>
<span class="cm">#       ]</span>
<span class="cm">#     }</span>
<span class="cm">#   }</span>
<span class="cm"># }</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üì¶ Variables ‚Äî Dynamic Queries</h3>
    <p>Never concatenate values into query strings! Use variables instead:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL with Variables</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Query with variables (the right way!)</span>
<span class="kw">query</span> <span class="fn">GetUser</span><span class="pn">(</span><span class="at">$userId</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="at">$userId</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># Variables (sent as separate JSON):</span>
<span class="cm"># {</span>
<span class="cm">#   "userId": "42"</span>
<span class="cm"># }</span>

<span class="cm"># Multiple variables with defaults</span>
<span class="kw">query</span> <span class="fn">SearchUsers</span><span class="pn">(</span>
  <span class="at">$term</span><span class="pn">:</span> <span class="tp">String!</span><span class="pn">,</span>
  <span class="at">$limit</span><span class="pn">:</span> <span class="tp">Int</span> <span class="op">=</span> <span class="nm">10</span><span class="pn">,</span>
  <span class="at">$includeInactive</span><span class="pn">:</span> <span class="tp">Boolean</span> <span class="op">=</span> <span class="kw">false</span>
<span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">users</span><span class="pn">(</span><span class="pr">search</span><span class="pn">:</span> <span class="at">$term</span><span class="pn">,</span> <span class="pr">limit</span><span class="pn">:</span> <span class="at">$limit</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üè∑Ô∏è Aliases & Fragments ‚Äî Power Features</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Aliases</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Aliases ‚Äî Query same field with different args</span>
<span class="kw">query</span> <span class="fn">CompareTwoUsers</span> <span class="pn">{</span>
  <span class="fn">alice</span><span class="pn">:</span> <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
  <span class="fn">bob</span><span class="pn">:</span> <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"2"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># Response:</span>
<span class="cm"># { "data": { "alice": { ... }, "bob": { ... } } }</span></code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Fragments</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Fragments ‚Äî Reusable sets of fields (DRY!)</span>
<span class="kw">fragment</span> <span class="fn">UserFields</span> <span class="kw">on</span> <span class="tp">User</span> <span class="pn">{</span>
  <span class="pr">id</span>
  <span class="pr">name</span>
  <span class="pr">email</span>
  <span class="pr">avatar</span>
<span class="pn">}</span>

<span class="kw">query</span> <span class="fn">GetDashboard</span> <span class="pn">{</span>
  <span class="fn">currentUser</span> <span class="pn">{</span>
    <span class="op">...</span><span class="fn">UserFields</span>   <span class="cm"># Spread the fragment</span>
  <span class="pn">}</span>
  <span class="fn">topUsers</span> <span class="pn">{</span>
    <span class="op">...</span><span class="fn">UserFields</span>   <span class="cm"># Reuse same fields!</span>
    <span class="pr">score</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># Inline fragments for union/interface types</span>
<span class="kw">query</span> <span class="fn">Search</span> <span class="pn">{</span>
  <span class="fn">search</span><span class="pn">(</span><span class="pr">term</span><span class="pn">:</span> <span class="st">"graphql"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="op">...</span> <span class="kw">on</span> <span class="tp">User</span> <span class="pn">{</span>
      <span class="pr">name</span>
      <span class="pr">email</span>
    <span class="pn">}</span>
    <span class="op">...</span> <span class="kw">on</span> <span class="tp">Post</span> <span class="pn">{</span>
      <span class="pr">title</span>
      <span class="pr">content</span>
    <span class="pn">}</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üì° Directives ‚Äî Conditional Fields</h3>
    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Directives</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
      </div>
      <pre><code><span class="cm"># @include ‚Äî Include field if condition is true</span>
<span class="cm"># @skip ‚Äî Skip field if condition is true</span>

<span class="kw">query</span> <span class="fn">GetUser</span><span class="pn">(</span><span class="at">$withPosts</span><span class="pn">:</span> <span class="tp">Boolean!</span><span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
    <span class="pr">posts</span> <span class="at">@include</span><span class="pn">(</span><span class="pr">if</span><span class="pn">:</span> <span class="at">$withPosts</span><span class="pn">)</span> <span class="pn">{</span>
      <span class="pr">title</span>
    <span class="pn">}</span>
    <span class="pr">phoneNumber</span> <span class="at">@skip</span><span class="pn">(</span><span class="pr">if</span><span class="pn">:</span> <span class="kw">true</span><span class="pn">)</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <!-- QUERY PLAYGROUND -->
  <div class="playground" id="query-playground">
    <div class="playground-header">
      <div class="playground-title">üéÆ Query Playground</div>
      <button class="run-btn" onclick="runQueryPlayground()">‚ñ∂ Execute</button>
    </div>
    <div class="playground-body">
      <div class="playground-input">
        <div class="playground-label">Query</div>
        <textarea id="query-pg-input">{
  user(id: "1") {
    name
    email
    posts {
      title
    }
  }
}</textarea>
      </div>
      <div class="playground-output">
        <div class="playground-label">Result</div>
        <pre id="query-pg-output"><code class="tx">Click "Execute" to see the result...</code></pre>
      </div>
    </div>
  </div>

  <!-- QUERIES QUIZ -->
  <div class="quiz-container" id="queries-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Queries Quiz</div>
      <div class="quiz-score" id="queries-quiz-score">0/3</div>
    </div>
    <div class="quiz-question" id="queries-q1">
      <p><span class="q-number">Q1.</span> How do you query the same field twice with different arguments?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('queries', 1, 0)">
          <span class="option-letter">A</span> Use aliases
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 1, 1)">
          <span class="option-letter">B</span> Use fragments
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 1, 2)">
          <span class="option-letter">C</span> Use directives
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 1, 3)">
          <span class="option-letter">D</span> It's not possible
        </div>
      </div>
      <div class="quiz-explanation" id="queries-q1-exp"></div>
    </div>
    <div class="quiz-question" id="queries-q2">
      <p><span class="q-number">Q2.</span> What character prefixes variable names in GraphQL?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('queries', 2, 0)">
          <span class="option-letter">A</span> <span class="inline-code">@</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 2, 1)">
          <span class="option-letter">B</span> <span class="inline-code">#</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 2, 2)">
          <span class="option-letter">C</span> <span class="inline-code">$</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 2, 3)">
          <span class="option-letter">D</span> <span class="inline-code">%</span>
        </div>
      </div>
      <div class="quiz-explanation" id="queries-q2-exp"></div>
    </div>
    <div class="quiz-question" id="queries-q3">
      <p><span class="q-number">Q3.</span> Which directive conditionally INCLUDES a field?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('queries', 3, 0)">
          <span class="option-letter">A</span> <span class="inline-code">@skip</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 3, 1)">
          <span class="option-letter">B</span> <span class="inline-code">@include</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 3, 2)">
          <span class="option-letter">C</span> <span class="inline-code">@show</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('queries', 3, 3)">
          <span class="option-letter">D</span> <span class="inline-code">@if</span>
        </div>
      </div>
      <div class="quiz-explanation" id="queries-q3-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="queries-complete">
    <h3>üéâ Queries Section Complete!</h3>
    <p>You know how to read data! Now learn how to <strong>write</strong> data with Mutations.</p>
    <button class="btn btn-primary" onclick="switchTab('mutations')" style="margin-top:12px;">Next: Mutations ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: MUTATIONS ==================== -->
<section class="section-panel" id="section-mutations">
  <h2 class="section-title">GraphQL Mutations</h2>
  <p class="section-subtitle">Create, update, and delete data ‚Äî the write side of GraphQL</p>

  <div class="concept-block">
    <h3>‚úèÔ∏è What Are Mutations?</h3>
    <p>Mutations are how you <strong>modify data</strong> in GraphQL. While queries are for reading, mutations handle creating, updating, and deleting. They're like POST, PUT, PATCH, and DELETE in REST ‚Äî but with a unified syntax.</p>

    <div class="callout callout-info">
      <div class="callout-title">üí° Key Difference from Queries</div>
      Queries can run in parallel, but <strong>mutations run sequentially</strong> ‚Äî each one completes before the next starts. This prevents race conditions.
    </div>
  </div>

  <div class="concept-block">
    <h3>üî® Mutation Syntax</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Mutations</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># CREATE ‚Äî Adding a new user</span>
<span class="kw">mutation</span> <span class="fn">CreateUser</span> <span class="pn">{</span>
  <span class="fn">createUser</span><span class="pn">(</span><span class="pr">input</span><span class="pn">:</span> <span class="pn">{</span>
    <span class="pr">name</span><span class="pn">:</span> <span class="st">"Alice"</span><span class="pn">,</span>
    <span class="pr">email</span><span class="pn">:</span> <span class="st">"alice@dev.io"</span><span class="pn">,</span>
    <span class="pr">role</span><span class="pn">:</span> <span class="pr">ADMIN</span>
  <span class="pn">})</span> <span class="pn">{</span>
    <span class="pr">id</span>         <span class="cm"># Return the created user's data!</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
    <span class="pr">role</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># UPDATE ‚Äî With variables (best practice!)</span>
<span class="kw">mutation</span> <span class="fn">UpdateUser</span><span class="pn">(</span><span class="at">$id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">,</span> <span class="at">$input</span><span class="pn">:</span> <span class="tp">UpdateUserInput!</span><span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">updateUser</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="at">$id</span><span class="pn">,</span> <span class="pr">input</span><span class="pn">:</span> <span class="at">$input</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">id</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span>

<span class="cm"># DELETE</span>
<span class="kw">mutation</span> <span class="fn">DeleteUser</span><span class="pn">(</span><span class="at">$id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">deleteUser</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="at">$id</span><span class="pn">)</span>  <span class="cm"># Returns Boolean</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üìã Input Types ‚Äî Clean Mutation Arguments</h3>
    <p>When mutations need many parameters, use <strong>input types</strong> instead of listing arguments one by one:</p>

    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå Messy ‚Äî Too many inline args</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">Avoid This</span></div>
          <pre><code><span class="kw">mutation</span> <span class="pn">{</span>
  <span class="fn">createUser</span><span class="pn">(</span>
    <span class="pr">name</span><span class="pn">:</span> <span class="st">"Alice"</span><span class="pn">,</span>
    <span class="pr">email</span><span class="pn">:</span> <span class="st">"a@b.c"</span><span class="pn">,</span>
    <span class="pr">age</span><span class="pn">:</span> <span class="nm">25</span><span class="pn">,</span>
    <span class="pr">role</span><span class="pn">:</span> <span class="pr">ADMIN</span><span class="pn">,</span>
    <span class="pr">bio</span><span class="pn">:</span> <span class="st">"..."</span>
  <span class="pn">)</span> <span class="pn">{</span> <span class="pr">id</span> <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ Clean ‚Äî Use input type + variables</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">Do This</span></div>
          <pre><code><span class="kw">mutation</span> <span class="fn">Create</span><span class="pn">(</span><span class="at">$input</span><span class="pn">:</span> <span class="tp">CreateUserInput!</span><span class="pn">)</span> <span class="pn">{</span>
  <span class="fn">createUser</span><span class="pn">(</span><span class="pr">input</span><span class="pn">:</span> <span class="at">$input</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">id</span>
    <span class="pr">name</span>
  <span class="pn">}</span>
<span class="pn">}</span>
<span class="cm">// Variables: { "input": {...} }</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="concept-block">
    <h3>üîÑ Mutation Response Patterns</h3>
    <p>Always return useful data from mutations! Common patterns:</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL SDL ‚Äî Mutation Response Types</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
      </div>
      <pre><code><span class="cm"># Pattern 1: Return the modified object</span>
<span class="kw">type</span> <span class="tp">Mutation</span> <span class="pn">{</span>
  <span class="fn">updateUser</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="tp">ID!</span><span class="pn">,</span> <span class="pr">input</span><span class="pn">:</span> <span class="tp">UpdateUserInput!</span><span class="pn">):</span> <span class="tp">User!</span>
<span class="pn">}</span>

<span class="cm"># Pattern 2: Return a payload with metadata</span>
<span class="kw">type</span> <span class="tp">CreateUserPayload</span> <span class="pn">{</span>
  <span class="pr">user</span><span class="pn">:</span> <span class="tp">User</span>
  <span class="pr">success</span><span class="pn">:</span> <span class="tp">Boolean!</span>
  <span class="pr">message</span><span class="pn">:</span> <span class="tp">String</span>
  <span class="pr">errors</span><span class="pn">:</span> <span class="pn">[</span><span class="tp">FieldError!</span><span class="pn">]</span>
<span class="pn">}</span>

<span class="kw">type</span> <span class="tp">FieldError</span> <span class="pn">{</span>
  <span class="pr">field</span><span class="pn">:</span> <span class="tp">String!</span>
  <span class="pr">message</span><span class="pn">:</span> <span class="tp">String!</span>
<span class="pn">}</span>

<span class="kw">type</span> <span class="tp">Mutation</span> <span class="pn">{</span>
  <span class="fn">createUser</span><span class="pn">(</span><span class="pr">input</span><span class="pn">:</span> <span class="tp">CreateUserInput!</span><span class="pn">):</span> <span class="tp">CreateUserPayload!</span>
<span class="pn">}</span></code></pre>
    </div>

    <div class="callout callout-tip">
      <div class="callout-title">‚úÖ Best Practice</div>
      Always return the mutated data so the client cache can update automatically. This prevents an extra query after each mutation!
    </div>
  </div>

  <!-- MUTATION EXERCISE -->
  <div class="exercise-container" id="mutation-exercise-1">
    <div class="exercise-header">
      <span class="exercise-badge">Exercise</span>
      <span class="exercise-title">Write a Mutation</span>
      <span class="tag tag-intermediate">Intermediate</span>
    </div>
    <p class="exercise-desc">Write a mutation that creates a new blog post. It should accept a variable <code>$input</code> of type <code>CreatePostInput!</code>. The mutation field is called <code>createPost</code>. Return the <code>id</code>, <code>title</code>, and <code>author { name }</code>.</p>
    <div class="exercise-editor">
      <textarea id="mutation-ex1-input" placeholder="mutation CreatePost(... ) {&#10;  ...&#10;}"></textarea>
    </div>
    <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
      <button class="btn btn-primary" onclick="checkMutationExercise1()">‚úì Check Answer</button>
      <button class="hint-btn" onclick="toggleHint('mutation-hint-1')">üí° Show Hint</button>
    </div>
    <div class="hint-text" id="mutation-hint-1">
      Structure: <code>mutation Name($input: CreatePostInput!) { createPost(input: $input) { fields... } }</code>. Don't forget nested selection for author!
    </div>
    <div class="exercise-result" id="mutation-ex1-result"></div>
  </div>

  <!-- MUTATIONS QUIZ -->
  <div class="quiz-container" id="mutations-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Mutations Quiz</div>
      <div class="quiz-score" id="mutations-quiz-score">0/2</div>
    </div>
    <div class="quiz-question" id="mutations-q1">
      <p><span class="q-number">Q1.</span> How do mutations execute when multiple are sent in one request?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('mutations', 1, 0)">
          <span class="option-letter">A</span> In parallel (like queries)
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 1, 1)">
          <span class="option-letter">B</span> Sequentially, one after another
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 1, 2)">
          <span class="option-letter">C</span> In random order
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 1, 3)">
          <span class="option-letter">D</span> Only the first one runs
        </div>
      </div>
      <div class="quiz-explanation" id="mutations-q1-exp"></div>
    </div>
    <div class="quiz-question" id="mutations-q2">
      <p><span class="q-number">Q2.</span> What keyword defines a type for mutation arguments?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('mutations', 2, 0)">
          <span class="option-letter">A</span> <span class="inline-code">type</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 2, 1)">
          <span class="option-letter">B</span> <span class="inline-code">input</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 2, 2)">
          <span class="option-letter">C</span> <span class="inline-code">args</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('mutations', 2, 3)">
          <span class="option-letter">D</span> <span class="inline-code">params</span>
        </div>
      </div>
      <div class="quiz-explanation" id="mutations-q2-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="mutations-complete">
    <h3>üéâ Mutations Section Complete!</h3>
    <p>You can now read AND write data! Time to learn <strong>Apollo Client</strong>.</p>
    <button class="btn btn-primary" onclick="switchTab('apollo')" style="margin-top:12px;">Next: Apollo Client ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: APOLLO CLIENT ==================== -->
<section class="section-panel" id="section-apollo">
  <h2 class="section-title">Apollo Client</h2>
  <p class="section-subtitle">The most popular GraphQL client for JavaScript ‚Äî state management meets data fetching</p>

  <div class="concept-block">
    <h3>üöÄ What is Apollo Client?</h3>
    <p>Apollo Client is a <strong>comprehensive state management library</strong> for JavaScript that handles fetching, caching, and modifying GraphQL data. It integrates beautifully with React, Vue, Angular, and vanilla JS.</p>

    <div class="flow-diagram">
      <div class="flow-node">Your React App</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node highlight">Apollo Client</div>
      <div class="flow-arrow">‚Üí</div>
      <div class="flow-node">GraphQL Server</div>
    </div>

    <h4>Key Features</h4>
    <ul>
      <li><strong>Declarative data fetching</strong> ‚Äî Just describe what data you need</li>
      <li><strong>Normalized cache</strong> ‚Äî Intelligent caching that deduplicates objects</li>
      <li><strong>Loading & error states</strong> ‚Äî Built-in UI state management</li>
      <li><strong>Optimistic UI</strong> ‚Äî Update UI before server responds</li>
      <li><strong>Real-time via subscriptions</strong> ‚Äî WebSocket support</li>
    </ul>
  </div>

  <div class="concept-block">
    <h3>‚öôÔ∏è Setup & Installation</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">Terminal</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="cm"># Install Apollo Client + GraphQL</span>
<span class="fn">npm install</span> <span class="st">@apollo/client graphql</span></code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">JavaScript ‚Äî Client Setup</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="kw">import</span> <span class="pn">{</span>
  <span class="fn">ApolloClient</span><span class="pn">,</span>
  <span class="fn">InMemoryCache</span><span class="pn">,</span>
  <span class="fn">ApolloProvider</span><span class="pn">,</span>
  <span class="fn">gql</span>
<span class="pn">}</span> <span class="kw">from</span> <span class="st">'@apollo/client'</span><span class="pn">;</span>

<span class="cm">// 1. Create the Apollo Client instance</span>
<span class="kw">const</span> <span class="tx">client</span> <span class="op">=</span> <span class="kw">new</span> <span class="fn">ApolloClient</span><span class="pn">({</span>
  <span class="pr">uri</span><span class="pn">:</span> <span class="st">'https://your-api.com/graphql'</span><span class="pn">,</span>
  <span class="pr">cache</span><span class="pn">:</span> <span class="kw">new</span> <span class="fn">InMemoryCache</span><span class="pn">(),</span>
  <span class="pr">headers</span><span class="pn">:</span> <span class="pn">{</span>
    <span class="pr">authorization</span><span class="pn">:</span> <span class="st">`Bearer </span><span class="op">${</span><span class="tx">token</span><span class="op">}</span><span class="st">`</span>
  <span class="pn">}</span>
<span class="pn">});</span>

<span class="cm">// 2. Wrap your app with ApolloProvider (React)</span>
<span class="kw">function</span> <span class="fn">App</span><span class="pn">()</span> <span class="pn">{</span>
  <span class="kw">return</span> <span class="pn">(</span>
    <span class="op">&lt;</span><span class="fn">ApolloProvider</span> <span class="pr">client</span><span class="op">=</span><span class="pn">{</span><span class="tx">client</span><span class="pn">}</span><span class="op">&gt;</span>
      <span class="op">&lt;</span><span class="fn">MyApp</span> <span class="op">/&gt;</span>
    <span class="op">&lt;/</span><span class="fn">ApolloProvider</span><span class="op">&gt;</span>
  <span class="pn">);</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üìñ useQuery ‚Äî Fetching Data</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">React + Apollo Client</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="kw">import</span> <span class="pn">{</span> <span class="fn">useQuery</span><span class="pn">,</span> <span class="fn">gql</span> <span class="pn">}</span> <span class="kw">from</span> <span class="st">'@apollo/client'</span><span class="pn">;</span>

<span class="cm">// Define the query</span>
<span class="kw">const</span> <span class="tx">GET_USERS</span> <span class="op">=</span> <span class="fn">gql</span><span class="st">`
  query GetUsers($limit: Int) {
    users(limit: $limit) {
      id
      name
      email
      avatar
    }
  }
`</span><span class="pn">;</span>

<span class="cm">// Use it in a component</span>
<span class="kw">function</span> <span class="fn">UserList</span><span class="pn">()</span> <span class="pn">{</span>
  <span class="kw">const</span> <span class="pn">{</span> <span class="tx">loading</span><span class="pn">,</span> <span class="tx">error</span><span class="pn">,</span> <span class="tx">data</span><span class="pn">,</span> <span class="tx">refetch</span> <span class="pn">}</span> <span class="op">=</span> <span class="fn">useQuery</span><span class="pn">(</span><span class="tx">GET_USERS</span><span class="pn">,</span> <span class="pn">{</span>
    <span class="pr">variables</span><span class="pn">:</span> <span class="pn">{</span> <span class="pr">limit</span><span class="pn">:</span> <span class="nm">10</span> <span class="pn">},</span>
    <span class="pr">pollInterval</span><span class="pn">:</span> <span class="nm">30000</span><span class="pn">,</span>  <span class="cm">// Refetch every 30s</span>
    <span class="pr">fetchPolicy</span><span class="pn">:</span> <span class="st">'cache-first'</span><span class="pn">,</span>  <span class="cm">// Default</span>
  <span class="pn">});</span>

  <span class="kw">if</span> <span class="pn">(</span><span class="tx">loading</span><span class="pn">)</span> <span class="kw">return</span> <span class="op">&lt;</span><span class="tx">p</span><span class="op">&gt;</span><span class="tx">Loading...</span><span class="op">&lt;/</span><span class="tx">p</span><span class="op">&gt;</span><span class="pn">;</span>
  <span class="kw">if</span> <span class="pn">(</span><span class="tx">error</span><span class="pn">)</span> <span class="kw">return</span> <span class="op">&lt;</span><span class="tx">p</span><span class="op">&gt;</span><span class="tx">Error: </span><span class="pn">{</span><span class="tx">error</span><span class="pn">.</span><span class="pr">message</span><span class="pn">}</span><span class="op">&lt;/</span><span class="tx">p</span><span class="op">&gt;</span><span class="pn">;</span>

  <span class="kw">return</span> <span class="pn">(</span>
    <span class="op">&lt;</span><span class="tx">ul</span><span class="op">&gt;</span>
      <span class="pn">{</span><span class="tx">data</span><span class="pn">.</span><span class="pr">users</span><span class="pn">.</span><span class="fn">map</span><span class="pn">(</span><span class="tx">user</span> <span class="op">=&gt;</span> <span class="pn">(</span>
        <span class="op">&lt;</span><span class="tx">li</span> <span class="pr">key</span><span class="op">=</span><span class="pn">{</span><span class="tx">user</span><span class="pn">.</span><span class="pr">id</span><span class="pn">}</span><span class="op">&gt;</span><span class="pn">{</span><span class="tx">user</span><span class="pn">.</span><span class="pr">name</span><span class="pn">}</span><span class="op">&lt;/</span><span class="tx">li</span><span class="op">&gt;</span>
      <span class="pn">))}</span>
    <span class="op">&lt;/</span><span class="tx">ul</span><span class="op">&gt;</span>
  <span class="pn">);</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>‚úèÔ∏è useMutation ‚Äî Modifying Data</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">React + Apollo Client</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="kw">import</span> <span class="pn">{</span> <span class="fn">useMutation</span><span class="pn">,</span> <span class="fn">gql</span> <span class="pn">}</span> <span class="kw">from</span> <span class="st">'@apollo/client'</span><span class="pn">;</span>

<span class="kw">const</span> <span class="tx">CREATE_USER</span> <span class="op">=</span> <span class="fn">gql</span><span class="st">`
  mutation CreateUser($input: CreateUserInput!) {
    createUser(input: $input) {
      id
      name
      email
    }
  }
`</span><span class="pn">;</span>

<span class="kw">function</span> <span class="fn">CreateUserForm</span><span class="pn">()</span> <span class="pn">{</span>
  <span class="kw">const</span> <span class="pn">[</span><span class="fn">createUser</span><span class="pn">,</span> <span class="pn">{</span> <span class="tx">loading</span><span class="pn">,</span> <span class="tx">error</span><span class="pn">,</span> <span class="tx">data</span> <span class="pn">}]</span> <span class="op">=</span> <span class="fn">useMutation</span><span class="pn">(</span>
    <span class="tx">CREATE_USER</span><span class="pn">,</span>
    <span class="pn">{</span>
      <span class="cm">// Update cache after mutation</span>
      <span class="fn">update</span><span class="pn">(</span><span class="tx">cache</span><span class="pn">,</span> <span class="pn">{</span> <span class="pr">data</span><span class="pn">:</span> <span class="pn">{</span> <span class="pr">createUser</span> <span class="pn">} })</span> <span class="pn">{</span>
        <span class="tx">cache</span><span class="pn">.</span><span class="fn">modify</span><span class="pn">({</span>
          <span class="pr">fields</span><span class="pn">:</span> <span class="pn">{</span>
            <span class="fn">users</span><span class="pn">(</span><span class="tx">existing</span> <span class="op">=</span> <span class="pn">[])</span> <span class="pn">{</span>
              <span class="kw">const</span> <span class="tx">newRef</span> <span class="op">=</span> <span class="tx">cache</span><span class="pn">.</span><span class="fn">writeFragment</span><span class="pn">({</span>
                <span class="pr">data</span><span class="pn">:</span> <span class="tx">createUser</span><span class="pn">,</span>
                <span class="pr">fragment</span><span class="pn">:</span> <span class="fn">gql</span><span class="st">`fragment NewUser on User { id name email }`</span>
              <span class="pn">});</span>
              <span class="kw">return</span> <span class="pn">[...</span><span class="tx">existing</span><span class="pn">,</span> <span class="tx">newRef</span><span class="pn">];</span>
            <span class="pn">}</span>
          <span class="pn">}</span>
        <span class="pn">});</span>
      <span class="pn">},</span>
      <span class="cm">// Optimistic response (instant UI update!)</span>
      <span class="pr">optimisticResponse</span><span class="pn">:</span> <span class="pn">{</span>
        <span class="pr">createUser</span><span class="pn">:</span> <span class="pn">{</span>
          <span class="pr">__typename</span><span class="pn">:</span> <span class="st">'User'</span><span class="pn">,</span>
          <span class="pr">id</span><span class="pn">:</span> <span class="st">'temp-id'</span><span class="pn">,</span>
          <span class="pr">name</span><span class="pn">:</span> <span class="tx">formData</span><span class="pn">.</span><span class="pr">name</span><span class="pn">,</span>
          <span class="pr">email</span><span class="pn">:</span> <span class="tx">formData</span><span class="pn">.</span><span class="pr">email</span>
        <span class="pn">}</span>
      <span class="pn">}</span>
    <span class="pn">}</span>
  <span class="pn">);</span>

  <span class="kw">const</span> <span class="fn">handleSubmit</span> <span class="op">=</span> <span class="pn">()</span> <span class="op">=&gt;</span> <span class="pn">{</span>
    <span class="fn">createUser</span><span class="pn">({</span>
      <span class="pr">variables</span><span class="pn">:</span> <span class="pn">{</span>
        <span class="pr">input</span><span class="pn">:</span> <span class="pn">{</span> <span class="pr">name</span><span class="pn">:</span> <span class="st">"Bob"</span><span class="pn">,</span> <span class="pr">email</span><span class="pn">:</span> <span class="st">"bob@dev.io"</span> <span class="pn">}</span>
      <span class="pn">}</span>
    <span class="pn">});</span>
  <span class="pn">};</span>
<span class="pn">}</span></code></pre>
    </div>
  </div>

  <div class="concept-block">
    <h3>üóÑÔ∏è Fetch Policies ‚Äî Cache Control</h3>
    <p>Apollo Client's cache is powerful, but you need to understand when it uses the cache vs. the network:</p>

    <table class="comparison-table">
      <thead>
        <tr>
          <th>Policy</th>
          <th>Behavior</th>
          <th>Use When</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="inline-code">cache-first</span></td>
          <td>Check cache first; only fetch if not cached</td>
          <td>Default ‚Äî good for most cases</td>
        </tr>
        <tr>
          <td><span class="inline-code">network-only</span></td>
          <td>Always fetch from network, update cache</td>
          <td>Data that must be fresh</td>
        </tr>
        <tr>
          <td><span class="inline-code">cache-and-network</span></td>
          <td>Return cache immediately, then update from network</td>
          <td>Show stale data while fetching fresh</td>
        </tr>
        <tr>
          <td><span class="inline-code">no-cache</span></td>
          <td>Always fetch, don't store in cache</td>
          <td>Sensitive data (auth tokens, etc.)</td>
        </tr>
        <tr>
          <td><span class="inline-code">cache-only</span></td>
          <td>Only read from cache, never fetch</td>
          <td>Offline mode</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="concept-block">
    <h3>üîß Vanilla JS (without React)</h3>
    <p>You don't need React to use Apollo Client!</p>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">Vanilla JavaScript</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code><span class="kw">import</span> <span class="pn">{</span> <span class="fn">ApolloClient</span><span class="pn">,</span> <span class="fn">InMemoryCache</span><span class="pn">,</span> <span class="fn">gql</span> <span class="pn">}</span> <span class="kw">from</span> <span class="st">'@apollo/client/core'</span><span class="pn">;</span>

<span class="kw">const</span> <span class="tx">client</span> <span class="op">=</span> <span class="kw">new</span> <span class="fn">ApolloClient</span><span class="pn">({</span>
  <span class="pr">uri</span><span class="pn">:</span> <span class="st">'https://api.example.com/graphql'</span><span class="pn">,</span>
  <span class="pr">cache</span><span class="pn">:</span> <span class="kw">new</span> <span class="fn">InMemoryCache</span><span class="pn">()</span>
<span class="pn">});</span>

<span class="cm">// Query</span>
<span class="kw">const</span> <span class="tx">result</span> <span class="op">=</span> <span class="kw">await</span> <span class="tx">client</span><span class="pn">.</span><span class="fn">query</span><span class="pn">({</span>
  <span class="pr">query</span><span class="pn">:</span> <span class="fn">gql</span><span class="st">`{ users { id name } }`</span>
<span class="pn">});</span>

<span class="tx">console</span><span class="pn">.</span><span class="fn">log</span><span class="pn">(</span><span class="tx">result</span><span class="pn">.</span><span class="pr">data</span><span class="pn">.</span><span class="pr">users</span><span class="pn">);</span>

<span class="cm">// Mutate</span>
<span class="kw">const</span> <span class="tx">mutResult</span> <span class="op">=</span> <span class="kw">await</span> <span class="tx">client</span><span class="pn">.</span><span class="fn">mutate</span><span class="pn">({</span>
  <span class="pr">mutation</span><span class="pn">:</span> <span class="fn">gql</span><span class="st">`
    mutation($input: CreateUserInput!) {
      createUser(input: $input) { id name }
    }
  `</span><span class="pn">,</span>
  <span class="pr">variables</span><span class="pn">:</span> <span class="pn">{</span>
    <span class="pr">input</span><span class="pn">:</span> <span class="pn">{</span> <span class="pr">name</span><span class="pn">:</span> <span class="st">"Eve"</span><span class="pn">,</span> <span class="pr">email</span><span class="pn">:</span> <span class="st">"eve@dev.io"</span> <span class="pn">}</span>
  <span class="pn">}</span>
<span class="pn">});</span></code></pre>
    </div>
  </div>

  <!-- APOLLO QUIZ -->
  <div class="quiz-container" id="apollo-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Apollo Client Quiz</div>
      <div class="quiz-score" id="apollo-quiz-score">0/3</div>
    </div>
    <div class="quiz-question" id="apollo-q1">
      <p><span class="q-number">Q1.</span> What hook is used to fetch data in Apollo Client (React)?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('apollo', 1, 0)">
          <span class="option-letter">A</span> <span class="inline-code">useFetch</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 1, 1)">
          <span class="option-letter">B</span> <span class="inline-code">useQuery</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 1, 2)">
          <span class="option-letter">C</span> <span class="inline-code">useData</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 1, 3)">
          <span class="option-letter">D</span> <span class="inline-code">useGraphQL</span>
        </div>
      </div>
      <div class="quiz-explanation" id="apollo-q1-exp"></div>
    </div>
    <div class="quiz-question" id="apollo-q2">
      <p><span class="q-number">Q2.</span> What fetch policy always goes to the network and updates the cache?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('apollo', 2, 0)">
          <span class="option-letter">A</span> <span class="inline-code">cache-first</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 2, 1)">
          <span class="option-letter">B</span> <span class="inline-code">no-cache</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 2, 2)">
          <span class="option-letter">C</span> <span class="inline-code">network-only</span>
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 2, 3)">
          <span class="option-letter">D</span> <span class="inline-code">cache-only</span>
        </div>
      </div>
      <div class="quiz-explanation" id="apollo-q2-exp"></div>
    </div>
    <div class="quiz-question" id="apollo-q3">
      <p><span class="q-number">Q3.</span> What does "optimistic response" do in Apollo mutations?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('apollo', 3, 0)">
          <span class="option-letter">A</span> Retries failed requests automatically
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 3, 1)">
          <span class="option-letter">B</span> Updates the UI immediately before the server responds
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 3, 2)">
          <span class="option-letter">C</span> Sends the mutation twice for safety
        </div>
        <div class="quiz-option" onclick="answerQuiz('apollo', 3, 3)">
          <span class="option-letter">D</span> Skips validation on the server
        </div>
      </div>
      <div class="quiz-explanation" id="apollo-q3-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="apollo-complete">
    <h3>üéâ Apollo Client Section Complete!</h3>
    <p>You're an Apollo wizard! Now let's compare <strong>GraphQL vs REST</strong>.</p>
    <button class="btn btn-primary" onclick="switchTab('vs-rest')" style="margin-top:12px;">Next: GraphQL vs REST ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: VS REST ==================== -->
<section class="section-panel" id="section-vs-rest">
  <h2 class="section-title">GraphQL vs REST</h2>
  <p class="section-subtitle">Understanding when and why to choose one over the other</p>

  <div class="concept-block">
    <h3>‚öîÔ∏è Head-to-Head Comparison</h3>

    <table class="comparison-table">
      <thead>
        <tr>
          <th>Feature</th>
          <th>REST</th>
          <th>GraphQL</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Endpoints</td>
          <td>Multiple (/users, /posts, /users/1/posts)</td>
          <td>Single endpoint (/graphql)</td>
        </tr>
        <tr>
          <td>Data Fetching</td>
          <td>Server decides what to return</td>
          <td>Client decides what to return</td>
        </tr>
        <tr>
          <td>Over-fetching</td>
          <td>Common problem ‚ùå</td>
          <td>Eliminated by design ‚úÖ</td>
        </tr>
        <tr>
          <td>Under-fetching</td>
          <td>Requires multiple requests ‚ùå</td>
          <td>Nested queries in one request ‚úÖ</td>
        </tr>
        <tr>
          <td>Versioning</td>
          <td>/api/v1/, /api/v2/ etc.</td>
          <td>No versioning needed ‚Äî evolve the schema</td>
        </tr>
        <tr>
          <td>Type System</td>
          <td>None built-in (need Swagger/OpenAPI)</td>
          <td>Strong type system built-in ‚úÖ</td>
        </tr>
        <tr>
          <td>Caching</td>
          <td>HTTP caching is easy (GET requests) ‚úÖ</td>
          <td>More complex (need Apollo cache) ‚ö†Ô∏è</td>
        </tr>
        <tr>
          <td>File Upload</td>
          <td>Native support ‚úÖ</td>
          <td>Requires extra setup ‚ö†Ô∏è</td>
        </tr>
        <tr>
          <td>Learning Curve</td>
          <td>Low ‚Äî everyone knows HTTP ‚úÖ</td>
          <td>Higher ‚Äî new concepts to learn ‚ö†Ô∏è</td>
        </tr>
        <tr>
          <td>Error Handling</td>
          <td>HTTP status codes (404, 500, etc.)</td>
          <td>Always 200 ‚Äî errors in response body</td>
        </tr>
        <tr>
          <td>Real-time</td>
          <td>Need WebSockets or SSE separately</td>
          <td>Subscriptions built into spec ‚úÖ</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="concept-block">
    <h3>üîÑ The Over-Fetching / Under-Fetching Problem</h3>
    <p>This is the #1 reason companies switch to GraphQL. Let's visualize it:</p>

    <h4>Scenario: Show a user's profile page with their recent posts</h4>

    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">REST ‚Äî 3 separate requests needed</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">REST Calls</span></div>
          <pre><code><span class="cm">// Request 1: Get user</span>
<span class="fn">GET</span> <span class="st">/api/users/1</span>
<span class="cm">// Returns 30 fields, you need 3 üò´</span>

<span class="cm">// Request 2: Get user's posts</span>
<span class="fn">GET</span> <span class="st">/api/users/1/posts</span>
<span class="cm">// Returns all post fields, you need 2 üò´</span>

<span class="cm">// Request 3: Get user's followers count</span>
<span class="fn">GET</span> <span class="st">/api/users/1/followers?count=true</span>

<span class="cm">// Total: 3 round-trips, tons of unused data</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">GraphQL ‚Äî 1 request, exact data</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">GraphQL</span></div>
          <pre><code><span class="kw">query</span> <span class="fn">ProfilePage</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
    <span class="pr">avatar</span>
    <span class="pr">bio</span>
    <span class="pr">posts</span><span class="pn">(</span><span class="pr">last</span><span class="pn">:</span> <span class="nm">5</span><span class="pn">)</span> <span class="pn">{</span>
      <span class="pr">title</span>
      <span class="pr">createdAt</span>
    <span class="pn">}</span>
    <span class="pr">followersCount</span>
  <span class="pn">}</span>
<span class="pn">}</span>
<span class="cm">// 1 request, exact data! üéØ</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="concept-block">
    <h3>ü§ù When to Use Each</h3>

    <div class="pitfall-grid">
      <div style="background:rgba(0,230,118,0.05);border:1px solid rgba(0,230,118,0.3);border-radius:var(--radius-sm);padding:20px;">
        <h4 style="color:var(--gql-success);margin-top:0;">‚úÖ Use GraphQL When:</h4>
        <ul>
          <li>Multiple clients need different data shapes (web, mobile, TV)</li>
          <li>Your UI is highly interactive with complex nested data</li>
          <li>You have bandwidth constraints (mobile apps)</li>
          <li>You want a strongly-typed API contract</li>
          <li>You need real-time features (subscriptions)</li>
          <li>Rapid frontend development is a priority</li>
        </ul>
      </div>
      <div style="background:rgba(68,138,255,0.05);border:1px solid rgba(68,138,255,0.3);border-radius:var(--radius-sm);padding:20px;">
        <h4 style="color:var(--gql-info);margin-top:0;">‚úÖ Use REST When:</h4>
        <ul>
          <li>Simple CRUD with predictable data shapes</li>
          <li>Heavy reliance on HTTP caching</li>
          <li>File uploads are a major feature</li>
          <li>Team isn't familiar with GraphQL</li>
          <li>Public API with many third-party consumers</li>
          <li>Microservices that don't need a unified graph</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="concept-block">
    <h3>‚ö†Ô∏è GraphQL Error Handling ‚Äî A Key Difference</h3>

    <div class="code-container">
      <div class="code-header">
        <span class="code-lang">GraphQL Error Response (HTTP 200!)</span>
        <div class="code-dots"><span></span><span></span><span></span></div>
      </div>
      <pre><code><span class="cm">// GraphQL ALWAYS returns HTTP 200</span>
<span class="cm">// Errors are in the response body</span>
<span class="pn">{</span>
  <span class="st">"data"</span><span class="pn">:</span> <span class="pn">{</span>
    <span class="st">"user"</span><span class="pn">:</span> <span class="kw">null</span>
  <span class="pn">},</span>
  <span class="st">"errors"</span><span class="pn">:</span> <span class="pn">[</span>
    <span class="pn">{</span>
      <span class="st">"message"</span><span class="pn">:</span> <span class="st">"User not found"</span><span class="pn">,</span>
      <span class="st">"locations"</span><span class="pn">:</span> <span class="pn">[{</span> <span class="st">"line"</span><span class="pn">:</span> <span class="nm">2</span><span class="pn">,</span> <span class="st">"column"</span><span class="pn">:</span> <span class="nm">3</span> <span class="pn">}],</span>
      <span class="st">"path"</span><span class="pn">:</span> <span class="pn">[</span><span class="st">"user"</span><span class="pn">],</span>
      <span class="st">"extensions"</span><span class="pn">:</span> <span class="pn">{</span>
        <span class="st">"code"</span><span class="pn">:</span> <span class="st">"NOT_FOUND"</span>
      <span class="pn">}</span>
    <span class="pn">}</span>
  <span class="pn">]</span>
<span class="pn">}</span></code></pre>
    </div>

    <div class="callout callout-warning">
      <div class="callout-title">‚ö†Ô∏è Gotcha</div>
      Don't check <code>response.ok</code> or HTTP status codes for GraphQL errors! You must check the <code>errors</code> array in the response body. A partial success (some fields resolved, some errored) will still be HTTP 200.
    </div>
  </div>

  <!-- VS REST QUIZ -->
  <div class="quiz-container" id="vs-rest-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† GraphQL vs REST Quiz</div>
      <div class="quiz-score" id="vs-rest-quiz-score">0/3</div>
    </div>
    <div class="quiz-question" id="vs-rest-q1">
      <p><span class="q-number">Q1.</span> What HTTP status code does GraphQL typically return, even for errors?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 1, 0)">
          <span class="option-letter">A</span> 404
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 1, 1)">
          <span class="option-letter">B</span> 200
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 1, 2)">
          <span class="option-letter">C</span> 500
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 1, 3)">
          <span class="option-letter">D</span> 400
        </div>
      </div>
      <div class="quiz-explanation" id="vs-rest-q1-exp"></div>
    </div>
    <div class="quiz-question" id="vs-rest-q2">
      <p><span class="q-number">Q2.</span> What does "under-fetching" mean?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 2, 0)">
          <span class="option-letter">A</span> Getting too much data from the server
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 2, 1)">
          <span class="option-letter">B</span> Not getting enough data, requiring additional requests
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 2, 2)">
          <span class="option-letter">C</span> The server crashing from too many requests
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 2, 3)">
          <span class="option-letter">D</span> Sending data too slowly
        </div>
      </div>
      <div class="quiz-explanation" id="vs-rest-q2-exp"></div>
    </div>
    <div class="quiz-question" id="vs-rest-q3">
      <p><span class="q-number">Q3.</span> How many endpoints does a typical GraphQL API have?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 3, 0)">
          <span class="option-letter">A</span> One per resource
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 3, 1)">
          <span class="option-letter">B</span> One single endpoint
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 3, 2)">
          <span class="option-letter">C</span> Two (one for queries, one for mutations)
        </div>
        <div class="quiz-option" onclick="answerQuiz('vs-rest', 3, 3)">
          <span class="option-letter">D</span> It depends on the framework
        </div>
      </div>
      <div class="quiz-explanation" id="vs-rest-q3-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="vs-rest-complete">
    <h3>üéâ Comparison Complete!</h3>
    <p>Now let's learn about common <strong>Pitfalls & Mistakes</strong> to avoid!</p>
    <button class="btn btn-primary" onclick="switchTab('pitfalls')" style="margin-top:12px;">Next: Pitfalls ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: PITFALLS ==================== -->
<section class="section-panel" id="section-pitfalls">
  <h2 class="section-title">Common Pitfalls & Mistakes</h2>
  <p class="section-subtitle">Learn from others' mistakes ‚Äî avoid these traps that catch even experienced developers</p>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üíÄ</span>
      <span class="pitfall-title">Pitfall #1: The N+1 Query Problem</span>
    </div>
    <p>The most infamous GraphQL performance issue. When resolving lists, each item triggers a separate database query.</p>
    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå The Problem</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">What Happens</span></div>
          <pre><code><span class="cm">// Query:</span>
<span class="pn">{</span> <span class="fn">users</span> <span class="pn">{</span> <span class="pr">name</span> <span class="pr">posts</span> <span class="pn">{</span> <span class="pr">title</span> <span class="pn">} } }</span>

<span class="cm">// Server executes:</span>
<span class="fn">SELECT</span> * <span class="kw">FROM</span> users  <span class="cm">// 1 query</span>
<span class="fn">SELECT</span> * <span class="kw">FROM</span> posts <span class="kw">WHERE</span> user_id=<span class="nm">1</span>
<span class="fn">SELECT</span> * <span class="kw">FROM</span> posts <span class="kw">WHERE</span> user_id=<span class="nm">2</span>
<span class="fn">SELECT</span> * <span class="kw">FROM</span> posts <span class="kw">WHERE</span> user_id=<span class="nm">3</span>
<span class="cm">// ... N more queries! üò±</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ The Solution: DataLoader</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">JavaScript</span></div>
          <pre><code><span class="kw">const</span> <span class="tx">DataLoader</span> <span class="op">=</span> <span class="fn">require</span><span class="pn">(</span><span class="st">'dataloader'</span><span class="pn">);</span>

<span class="kw">const</span> <span class="tx">postLoader</span> <span class="op">=</span> <span class="kw">new</span> <span class="fn">DataLoader</span><span class="pn">(</span>
  <span class="kw">async</span> <span class="pn">(</span><span class="tx">userIds</span><span class="pn">)</span> <span class="op">=></span> <span class="pn">{</span>
    <span class="cm">// ONE batched query!</span>
    <span class="kw">const</span> <span class="tx">posts</span> <span class="op">=</span> <span class="kw">await</span> <span class="fn">db</span><span class="pn">.</span><span class="fn">query</span><span class="pn">(</span>
      <span class="st">`SELECT * FROM posts
       WHERE user_id IN (?)`</span><span class="pn">,</span>
      <span class="pn">[</span><span class="tx">userIds</span><span class="pn">]</span>
    <span class="pn">);</span>
    <span class="kw">return</span> <span class="tx">userIds</span><span class="pn">.</span><span class="fn">map</span><span class="pn">(</span><span class="tx">id</span> <span class="op">=></span>
      <span class="tx">posts</span><span class="pn">.</span><span class="fn">filter</span><span class="pn">(</span><span class="tx">p</span> <span class="op">=></span> <span class="tx">p</span><span class="pn">.</span><span class="pr">userId</span> <span class="op">===</span> <span class="tx">id</span><span class="pn">)</span>
    <span class="pn">);</span>
  <span class="pn">}</span>
<span class="pn">);</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üîì</span>
      <span class="pitfall-title">Pitfall #2: No Query Depth Limiting</span>
    </div>
    <p>Malicious users can craft deeply nested queries to DoS your server:</p>
    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå Malicious Query</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">Attack</span></div>
          <pre><code><span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span><span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">friends</span> <span class="pn">{</span>
      <span class="pr">friends</span> <span class="pn">{</span>
        <span class="pr">friends</span> <span class="pn">{</span>
          <span class="pr">friends</span> <span class="pn">{</span>
            <span class="pr">friends</span> <span class="pn">{</span>
              <span class="cm">// infinite nesting! üí•</span>
            <span class="pn">}</span>
          <span class="pn">}</span>
        <span class="pn">}</span>
      <span class="pn">}</span>
    <span class="pn">}</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ Solution: Depth & Complexity Limits</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">JavaScript</span></div>
          <pre><code><span class="kw">const</span> <span class="tx">depthLimit</span> <span class="op">=</span>
  <span class="fn">require</span><span class="pn">(</span><span class="st">'graphql-depth-limit'</span><span class="pn">);</span>

<span class="kw">const</span> <span class="tx">server</span> <span class="op">=</span> <span class="kw">new</span> <span class="fn">ApolloServer</span><span class="pn">({</span>
  <span class="pr">typeDefs</span><span class="pn">,</span>
  <span class="pr">resolvers</span><span class="pn">,</span>
  <span class="pr">validationRules</span><span class="pn">:</span> <span class="pn">[</span>
    <span class="fn">depthLimit</span><span class="pn">(</span><span class="nm">5</span><span class="pn">)</span>  <span class="cm">// Max 5 levels deep</span>
  <span class="pn">]</span>
<span class="pn">});</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üèóÔ∏è</span>
      <span class="pitfall-title">Pitfall #3: Not Naming Your Operations</span>
    </div>
    <p>Anonymous queries work but are a nightmare for debugging, logging, and caching.</p>
    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå Anonymous (Bad for production)</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">GraphQL</span></div>
          <pre><code><span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ Named (Debuggable & Trackable)</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">GraphQL</span></div>
          <pre><code><span class="kw">query</span> <span class="fn">GetUserProfile</span> <span class="pn">{</span>
  <span class="fn">user</span><span class="pn">(</span><span class="pr">id</span><span class="pn">:</span> <span class="st">"1"</span><span class="pn">)</span> <span class="pn">{</span>
    <span class="pr">name</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üíæ</span>
      <span class="pitfall-title">Pitfall #4: Forgetting __typename in Apollo Cache</span>
    </div>
    <p>Apollo's normalized cache uses <span class="inline-code">__typename</span> + <span class="inline-code">id</span> to identify cached objects. Missing <span class="inline-code">id</span> fields means cache can't deduplicate!</p>
    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå No ID ‚Äî Cache can't normalize</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">GraphQL</span></div>
          <pre><code><span class="kw">query</span> <span class="pn">{</span>
  <span class="fn">users</span> <span class="pn">{</span>
    <span class="pr">name</span>     <span class="cm"># No id! üò±</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ Always include id</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">GraphQL</span></div>
          <pre><code><span class="kw">query</span> <span class="pn">{</span>
  <span class="fn">users</span> <span class="pn">{</span>
    <span class="pr">id</span>       <span class="cm"># Always! ‚úÖ</span>
    <span class="pr">name</span>
    <span class="pr">email</span>
  <span class="pn">}</span>
<span class="pn">}</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üî§</span>
      <span class="pitfall-title">Pitfall #5: String Interpolation in Queries</span>
    </div>
    <p>NEVER build queries by concatenating strings. This opens you up to injection attacks and breaks caching.</p>
    <div class="pitfall-grid">
      <div class="pitfall-wrong">
        <div class="pitfall-label">‚ùå SQL-injection-style vulnerability!</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">JavaScript</span></div>
          <pre><code><span class="cm">// NEVER DO THIS!</span>
<span class="kw">const</span> <span class="tx">query</span> <span class="op">=</span> <span class="st">`{
  user(id: "</span><span class="op">${</span><span class="tx">userId</span><span class="op">}</span><span class="st">") {
    name
  }
}`</span><span class="pn">;</span></code></pre>
        </div>
      </div>
      <div class="pitfall-right">
        <div class="pitfall-label">‚úÖ Use variables!</div>
        <div class="code-container">
          <div class="code-header"><span class="code-lang">JavaScript</span></div>
          <pre><code><span class="kw">const</span> <span class="tx">query</span> <span class="op">=</span> <span class="fn">gql</span><span class="st">`
  query GetUser($id: ID!) {
    user(id: $id) { name }
  }
`</span><span class="pn">;</span>
<span class="cm">// Pass variables separately</span>
<span class="pn">{</span> <span class="pr">variables</span><span class="pn">:</span> <span class="pn">{</span> <span class="pr">id</span><span class="pn">:</span> <span class="tx">userId</span> <span class="pn">} }</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="pitfall-card">
    <div class="pitfall-header">
      <span class="pitfall-icon">üìä</span>
      <span class="pitfall-title">Pitfall #6: Exposing Your Entire Schema</span>
    </div>
    <p>GraphQL introspection lets anyone explore your entire API. Disable it in production!</p>
    <div class="code-container">
      <div class="code-header"><span class="code-lang">JavaScript ‚Äî Apollo Server</span></div>
      <pre><code><span class="kw">const</span> <span class="tx">server</span> <span class="op">=</span> <span class="kw">new</span> <span class="fn">ApolloServer</span><span class="pn">({</span>
  <span class="pr">typeDefs</span><span class="pn">,</span>
  <span class="pr">resolvers</span><span class="pn">,</span>
  <span class="pr">introspection</span><span class="pn">:</span> <span class="tx">process</span><span class="pn">.</span><span class="pr">env</span><span class="pn">.</span><span class="pr">NODE_ENV</span> <span class="op">!==</span> <span class="st">'production'</span><span class="pn">,</span>
<span class="pn">});</span></code></pre>
    </div>
  </div>

  <!-- PITFALL QUIZ -->
  <div class="quiz-container" id="pitfalls-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üß† Pitfalls Quiz</div>
      <div class="quiz-score" id="pitfalls-quiz-score">0/2</div>
    </div>
    <div class="quiz-question" id="pitfalls-q1">
      <p><span class="q-number">Q1.</span> What tool solves the N+1 problem in GraphQL?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 1, 0)">
          <span class="option-letter">A</span> Apollo Client
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 1, 1)">
          <span class="option-letter">B</span> DataLoader
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 1, 2)">
          <span class="option-letter">C</span> GraphQL Shield
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 1, 3)">
          <span class="option-letter">D</span> Redis
        </div>
      </div>
      <div class="quiz-explanation" id="pitfalls-q1-exp"></div>
    </div>
    <div class="quiz-question" id="pitfalls-q2">
      <p><span class="q-number">Q2.</span> Why should you ALWAYS include <span class="inline-code">id</span> in your queries?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 2, 0)">
          <span class="option-letter">A</span> GraphQL requires it
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 2, 1)">
          <span class="option-letter">B</span> For Apollo's normalized cache to work properly
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 2, 2)">
          <span class="option-letter">C</span> To make queries faster
        </div>
        <div class="quiz-option" onclick="answerQuiz('pitfalls', 2, 3)">
          <span class="option-letter">D</span> It's just a convention
        </div>
      </div>
      <div class="quiz-explanation" id="pitfalls-q2-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="pitfalls-complete">
    <h3>üéâ Pitfalls Section Complete!</h3>
    <p>You know what to watch out for! Time for the <strong>Final Quiz</strong>!</p>
    <button class="btn btn-primary" onclick="switchTab('final-quiz')" style="margin-top:12px;">Final Quiz ‚Üí</button>
  </div>
</section>

<!-- ==================== SECTION: FINAL QUIZ ==================== -->
<section class="section-panel" id="section-final-quiz">
  <h2 class="section-title">üéØ Final Comprehensive Quiz</h2>
  <p class="section-subtitle">Test everything you've learned ‚Äî 10 questions covering all topics</p>

  <div class="quiz-container" id="final-quiz">
    <div class="quiz-header">
      <div class="quiz-title">üèÜ Final Challenge</div>
      <div class="quiz-score" id="final-quiz-score">0/10</div>
    </div>

    <div class="quiz-question" id="final-q1">
      <p><span class="q-number">Q1.</span> In GraphQL SDL, what does the <span class="inline-code">!</span> after a type mean?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 1, 0)"><span class="option-letter">A</span> The field is deprecated</div>
        <div class="quiz-option" onclick="answerQuiz('final', 1, 1)"><span class="option-letter">B</span> The field is non-nullable (required)</div>
        <div class="quiz-option" onclick="answerQuiz('final', 1, 2)"><span class="option-letter">C</span> The field is unique</div>
        <div class="quiz-option" onclick="answerQuiz('final', 1, 3)"><span class="option-letter">D</span> The field is private</div>
      </div>
      <div class="quiz-explanation" id="final-q1-exp"></div>
    </div>

    <div class="quiz-question" id="final-q2">
      <p><span class="q-number">Q2.</span> What is the difference between <span class="inline-code">type</span> and <span class="inline-code">input</span> in a schema?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 2, 0)"><span class="option-letter">A</span> They are the same thing</div>
        <div class="quiz-option" onclick="answerQuiz('final', 2, 1)"><span class="option-letter">B</span> <code>type</code> is for outputs, <code>input</code> is for mutation arguments</div>
        <div class="quiz-option" onclick="answerQuiz('final', 2, 2)"><span class="option-letter">C</span> <code>input</code> can have resolvers, <code>type</code> cannot</div>
        <div class="quiz-option" onclick="answerQuiz('final', 2, 3)"><span class="option-letter">D</span> <code>type</code> is only for queries</div>
      </div>
      <div class="quiz-explanation" id="final-q2-exp"></div>
    </div>

    <div class="quiz-question" id="final-q3">
      <p><span class="q-number">Q3.</span> What are GraphQL fragments used for?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 3, 0)"><span class="option-letter">A</span> Breaking queries into pages</div>
        <div class="quiz-option" onclick="answerQuiz('final', 3, 1)"><span class="option-letter">B</span> Reusable sets of fields to avoid repetition</div>
        <div class="quiz-option" onclick="answerQuiz('final', 3, 2)"><span class="option-letter">C</span> Partial server responses</div>
        <div class="quiz-option" onclick="answerQuiz('final', 3, 3)"><span class="option-letter">D</span> Encrypting parts of a query</div>
      </div>
      <div class="quiz-explanation" id="final-q3-exp"></div>
    </div>

    <div class="quiz-question" id="final-q4">
      <p><span class="q-number">Q4.</span> How do queries and mutations differ in execution?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 4, 0)"><span class="option-letter">A</span> Queries are faster</div>
        <div class="quiz-option" onclick="answerQuiz('final', 4, 1)"><span class="option-letter">B</span> Queries can run in parallel; mutations run sequentially</div>
        <div class="quiz-option" onclick="answerQuiz('final', 4, 2)"><span class="option-letter">C</span> They execute identically</div>
        <div class="quiz-option" onclick="answerQuiz('final', 4, 3)"><span class="option-letter">D</span> Mutations can run in parallel; queries are sequential</div>
      </div>
      <div class="quiz-explanation" id="final-q4-exp"></div>
    </div>

    <div class="quiz-question" id="final-q5">
      <p><span class="q-number">Q5.</span> What function wraps your React app to provide Apollo Client?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 5, 0)"><span class="option-letter">A</span> <span class="inline-code">ApolloWrapper</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 5, 1)"><span class="option-letter">B</span> <span class="inline-code">ApolloProvider</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 5, 2)"><span class="option-letter">C</span> <span class="inline-code">GraphQLProvider</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 5, 3)"><span class="option-letter">D</span> <span class="inline-code">QueryProvider</span></div>
      </div>
      <div class="quiz-explanation" id="final-q5-exp"></div>
    </div>

    <div class="quiz-question" id="final-q6">
      <p><span class="q-number">Q6.</span> REST API returns user with 30 fields, but you only need 3. This problem is called:</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 6, 0)"><span class="option-letter">A</span> Under-fetching</div>
        <div class="quiz-option" onclick="answerQuiz('final', 6, 1)"><span class="option-letter">B</span> Over-fetching</div>
        <div class="quiz-option" onclick="answerQuiz('final', 6, 2)"><span class="option-letter">C</span> Data bloating</div>
        <div class="quiz-option" onclick="answerQuiz('final', 6, 3)"><span class="option-letter">D</span> Cache overflow</div>
      </div>
      <div class="quiz-explanation" id="final-q6-exp"></div>
    </div>

    <div class="quiz-question" id="final-q7">
      <p><span class="q-number">Q7.</span> How should you disable introspection in production?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 7, 0)"><span class="option-letter">A</span> Delete the schema file</div>
        <div class="quiz-option" onclick="answerQuiz('final', 7, 1)"><span class="option-letter">B</span> Set <span class="inline-code">introspection: false</span> in server config</div>
        <div class="quiz-option" onclick="answerQuiz('final', 7, 2)"><span class="option-letter">C</span> Use HTTPS</div>
        <div class="quiz-option" onclick="answerQuiz('final', 7, 3)"><span class="option-letter">D</span> You can't disable it</div>
      </div>
      <div class="quiz-explanation" id="final-q7-exp"></div>
    </div>

    <div class="quiz-question" id="final-q8">
      <p><span class="q-number">Q8.</span> What does the <span class="inline-code">gql</span> template tag do?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 8, 0)"><span class="option-letter">A</span> Sends the query to the server</div>
        <div class="quiz-option" onclick="answerQuiz('final', 8, 1)"><span class="option-letter">B</span> Parses a GraphQL query string into an AST (document node)</div>
        <div class="quiz-option" onclick="answerQuiz('final', 8, 2)"><span class="option-letter">C</span> Validates the query against the schema</div>
        <div class="quiz-option" onclick="answerQuiz('final', 8, 3)"><span class="option-letter">D</span> Encrypts the query</div>
      </div>
      <div class="quiz-explanation" id="final-q8-exp"></div>
    </div>

    <div class="quiz-question" id="final-q9">
      <p><span class="q-number">Q9.</span> Which is NOT a built-in GraphQL scalar type?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 9, 0)"><span class="option-letter">A</span> <span class="inline-code">String</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 9, 1)"><span class="option-letter">B</span> <span class="inline-code">Date</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 9, 2)"><span class="option-letter">C</span> <span class="inline-code">ID</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 9, 3)"><span class="option-letter">D</span> <span class="inline-code">Boolean</span></div>
      </div>
      <div class="quiz-explanation" id="final-q9-exp"></div>
    </div>

    <div class="quiz-question" id="final-q10">
      <p><span class="q-number">Q10.</span> What fetch policy returns cached data immediately, then updates from network?</p>
      <div class="quiz-options">
        <div class="quiz-option" onclick="answerQuiz('final', 10, 0)"><span class="option-letter">A</span> <span class="inline-code">cache-first</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 10, 1)"><span class="option-letter">B</span> <span class="inline-code">cache-and-network</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 10, 2)"><span class="option-letter">C</span> <span class="inline-code">network-only</span></div>
        <div class="quiz-option" onclick="answerQuiz('final', 10, 3)"><span class="option-letter">D</span> <span class="inline-code">stale-while-revalidate</span></div>
      </div>
      <div class="quiz-explanation" id="final-q10-exp"></div>
    </div>
  </div>

  <div class="section-complete-banner" id="final-quiz-complete">
    <h3>üèÜ You've Completed the GraphQL Mastery Course!</h3>
    <p>Congratulations! Review any section to strengthen your knowledge.</p>
  </div>
</section>

</main>

<!-- ============ JAVASCRIPT ============ -->
<script>
// ==================== STATE MANAGEMENT ====================
const state = {
  xp: 0,
  currentTab: 'intro',
  completedSections: new Set(),
  quizAnswers: {},
  quizScores: {
    intro: { correct: 0, total: 2 },
    schema: { correct: 0, total: 3 },
    queries: { correct: 0, total: 3 },
    mutations: { correct: 0, total: 2 },
    apollo: { correct: 0, total: 3 },
    'vs-rest': { correct: 0, total: 3 },
    pitfalls: { correct: 0, total: 2 },
    final: { correct: 0, total: 10 }
  },
  exercisesCompleted: new Set(),
  totalActivities: 30, // quizzes + exercises
  completedActivities: 0
};

// ==================== QUIZ ANSWERS ====================
const quizCorrectAnswers = {
  'intro-1': 1,
  'intro-2': 2,
  'schema-1': 1,
  'schema-2': 2,
  'schema-3': 1,
  'queries-1': 0,
  'queries-2': 2,
  'queries-3': 1,
  'mutations-1': 1,
  'mutations-2': 1,
  'apollo-1': 1,
  'apollo-2': 2,
  'apollo-3': 1,
  'vs-rest-1': 1,
  'vs-rest-2': 1,
  'vs-rest-3': 1,
  'pitfalls-1': 1,
  'pitfalls-2': 1,
  'final-1': 1,
  'final-2': 1,
  'final-3': 1,
  'final-4': 1,
  'final-5': 1,
  'final-6': 1,
  'final-7': 1,
  'final-8': 1,
  'final-9': 1,
  'final-10': 1,
};

const quizExplanations = {
  'intro-1': {
    correct: '‚úÖ Correct! GraphQL eliminates over-fetching (getting too much data) and under-fetching (not getting enough, requiring multiple requests) by letting clients specify exactly what data they need.',
    incorrect: '‚ùå Not quite. The main advantage of GraphQL over REST is that clients can request exactly the data they need ‚Äî no more, no less. This solves over-fetching and under-fetching.'
  },
  'intro-2': {
    correct: '‚úÖ Correct! Facebook (now Meta) developed GraphQL internally in 2012 to solve mobile performance issues, and open-sourced it in 2015.',
    incorrect: '‚ùå GraphQL was developed by Facebook (now Meta) in 2012 and open-sourced in 2015. It was created to improve mobile app performance by reducing data transfer.'
  },
  'schema-1': {
    correct: '‚úÖ Correct! [String!]! means: the list itself cannot be null (outer !), and each item in the list cannot be null (inner !). You\'ll always get a list, and every item will be a string.',
    incorrect: '‚ùå [String!]! breaks down as: inner ! = items can\'t be null, outer ! = list itself can\'t be null. So it\'s a non-null list of non-null strings.'
  },
  'schema-2': {
    correct: '‚úÖ Correct! The `enum` keyword defines a type that\'s restricted to a specific set of values, like Role { ADMIN, USER, MODERATOR }.',
    incorrect: '‚ùå The `enum` keyword is used for a set of allowed values. Example: enum Status { ACTIVE, INACTIVE, SUSPENDED }'
  },
  'schema-3': {
    correct: '‚úÖ Correct! Every GraphQL schema MUST have a Query type. Mutation and Subscription are optional.',
    incorrect: '‚ùå The Query type is the only required root type. Every GraphQL schema must have it. Mutation and Subscription are optional.'
  },
  'queries-1': {
    correct: '‚úÖ Correct! Aliases let you query the same field with different arguments by giving each a unique name. Example: alice: user(id: "1") { name }',
    incorrect: '‚ùå Aliases are the answer! They let you rename fields in the response so you can query the same field twice. Example: alice: user(id: "1") { name }'
  },
  'queries-2': {
    correct: '‚úÖ Correct! Variables in GraphQL use the $ prefix. Example: query GetUser($id: ID!) { user(id: $id) { name } }',
    incorrect: '‚ùå GraphQL variables use the $ prefix. For example: $userId, $limit, $includeInactive'
  },
  'queries-3': {
    correct: '‚úÖ Correct! @include(if: Boolean!) includes the field when the condition is true. Its counterpart @skip does the opposite.',
    incorrect: '‚ùå The @include directive includes a field conditionally. Syntax: field @include(if: $booleanVar). The @skip directive does the opposite.'
  },
  'mutations-1': {
    correct: '‚úÖ Correct! Unlike queries that can execute in parallel, mutations execute sequentially (one after another) to prevent race conditions.',
    incorrect: '‚ùå Mutations run sequentially ‚Äî each one completes before the next starts. This is different from queries, which can run in parallel.'
  },
  'mutations-2': {
    correct: '‚úÖ Correct! The `input` keyword defines types specifically for mutation arguments. Regular `type` can\'t be used as an argument type.',
    incorrect: '‚ùå The `input` keyword is used. Input types are special types designed for mutation arguments. You can\'t use regular `type` as argument types in GraphQL.'
  },
  'apollo-1': {
    correct: '‚úÖ Correct! useQuery is the primary React hook for fetching data. It returns { loading, error, data } and handles refetching, polling, and caching automatically.',
    incorrect: '‚ùå The correct hook is useQuery from @apollo/client. It returns { loading, error, data, refetch } and manages the query lifecycle automatically.'
  },
  'apollo-2': {
    correct: '‚úÖ Correct! network-only always fetches from the network and stores the result in the cache. Use it when data must be fresh.',
    incorrect: '‚ùå network-only is the answer. It bypasses the cache for reading but still updates it. no-cache would fetch but NOT update the cache.'
  },
  'apollo-3': {
    correct: '‚úÖ Correct! Optimistic response predicts what the server will return and updates the UI instantly. If the real response differs, it automatically corrects the UI.',
    incorrect: '‚ùå Optimistic response immediately updates the UI with a predicted result before the server responds. This makes mutations feel instant!'
  },
  'vs-rest-1': {
    correct: '‚úÖ Correct! GraphQL typically returns HTTP 200 for all responses, including errors. Errors are communicated in the response body\'s "errors" array.',
    incorrect: '‚ùå GraphQL almost always returns HTTP 200! Errors are in the response body: { "data": null, "errors": [...] }. Don\'t rely on HTTP status codes!'
  },
  'vs-rest-2': {
    correct: '‚úÖ Correct! Under-fetching means a single API endpoint doesn\'t provide enough data, forcing you to make additional requests to get everything you need.',
    incorrect: '‚ùå Under-fetching = not getting enough data from one endpoint, requiring additional requests. Over-fetching = getting too much data. GraphQL solves both!'
  },
  'vs-rest-3': {
    correct: '‚úÖ Correct! GraphQL uses a single endpoint (usually /graphql). All queries and mutations go through this one URL. The query/mutation body determines what happens.',
    incorrect: '‚ùå GraphQL uses a single endpoint! Unlike REST where you have /users, /posts, /comments etc., GraphQL sends everything to one URL like /graphql.'
  },
  'pitfalls-1': {
    correct: '‚úÖ Correct! DataLoader by Facebook batches and deduplicates database calls. Instead of N separate queries, it combines them into one batched query.',
    incorrect: '‚ùå DataLoader is the standard solution. It batches individual loads within a single tick of the event loop into one query. Install: npm install dataloader'
  },
  'pitfalls-2': {
    correct: '‚úÖ Correct! Apollo\'s normalized cache uses __typename + id to identify unique objects. Without id, it can\'t deduplicate or update cached data properly.',
    incorrect: '‚ùå Apollo uses __typename + id to build its normalized cache. Without id fields, Apollo can\'t properly identify, deduplicate, or update cached objects.'
  },
  'final-1': {
    correct: '‚úÖ The ! means the field is non-nullable ‚Äî it will always return a value and never be null.',
    incorrect: '‚ùå The ! means non-nullable (required). A field marked with ! guarantees it will always return a value.'
  },
  'final-2': {
    correct: '‚úÖ `type` defines output shapes (what the server returns), while `input` defines argument shapes for mutations.',
    incorrect: '‚ùå `type` is for outputs (query results), `input` is specifically for mutation arguments. They can\'t be used interchangeably.'
  },
  'final-3': {
    correct: '‚úÖ Fragments are reusable sets of fields. They help keep queries DRY by defining common field selections once.',
    incorrect: '‚ùå Fragments are reusable field selections that prevent repetition. Define once with `fragment Name on Type { fields }`, use with `...Name`.'
  },
  'final-4': {
    correct: '‚úÖ Queries can run in parallel for performance, but mutations must run sequentially to prevent race conditions.',
    incorrect: '‚ùå Queries execute in parallel (safe since they\'re read-only). Mutations execute sequentially to avoid data conflicts.'
  },
  'final-5': {
    correct: '‚úÖ ApolloProvider wraps your React component tree and makes the client available via React context to all useQuery/useMutation hooks.',
    incorrect: '‚ùå ApolloProvider from @apollo/client wraps your app: <ApolloProvider client={client}><App /></ApolloProvider>'
  },
  'final-6': {
    correct: '‚úÖ Over-fetching = receiving more data than you need. GraphQL solves this by letting you specify exactly which fields to return.',
    incorrect: '‚ùå Over-fetching means receiving more data than needed. It wastes bandwidth and processing time. GraphQL eliminates this by design.'
  },
  'final-7': {
    correct: '‚úÖ Set introspection: false in your Apollo Server config for production. This prevents attackers from exploring your entire API schema.',
    incorrect: '‚ùå Set `introspection: false` in the server config. Best practice: `introspection: process.env.NODE_ENV !== \'production\'`'
  },
  'final-8': {
    correct: '‚úÖ The gql tag parses a GraphQL query string into an Abstract Syntax Tree (AST/DocumentNode) that Apollo Client can work with.',
    incorrect: '‚ùå gql is a template literal tag that parses GraphQL strings into AST (document nodes). Apollo Client needs this parsed format, not raw strings.'
  },
  'final-9': {
    correct: '‚úÖ Date is NOT built-in! The 5 built-in scalars are: Int, Float, String, Boolean, and ID. Date must be defined as a custom scalar.',
    incorrect: '‚ùå Date is not built-in. The 5 built-in scalar types are: Int, Float, String, Boolean, ID. You need `scalar Date` for custom date support.'
  },
  'final-10': {
    correct: '‚úÖ cache-and-network returns cached data instantly (fast UI) then fetches from network and updates if data changed.',
    incorrect: '‚ùå cache-and-network gives you the best of both worlds: immediate cache response + background network fetch to ensure freshness.'
  }
};

// ==================== TAB NAVIGATION ====================
function switchTab(tabId) {
  // Update nav tabs
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.classList.toggle('active', tab.dataset.tab === tabId);
  });

  // Update section panels
  document.querySelectorAll('.section-panel').forEach(panel => {
    panel.classList.toggle('active', panel.id === `section-${tabId}`);
  });

  state.currentTab = tabId;
  window.scrollTo({ top: 200, behavior: 'smooth' });
}

// ==================== QUIZ SYSTEM ====================
function answerQuiz(section, questionNum, selectedIndex) {
  const key = `${section}-${questionNum}`;

  // Prevent re-answering
  if (state.quizAnswers[key] !== undefined) return;

  const correct = quizCorrectAnswers[key];
  const isCorrect = selectedIndex === correct;
  state.quizAnswers[key] = selectedIndex;

  // Highlight options
  const questionEl = document.getElementById(`${section}-q${questionNum}`);
  const options = questionEl.querySelectorAll('.quiz-option');
  options.forEach((opt, i) => {
    if (i === correct) opt.classList.add('correct');
    if (i === selectedIndex && !isCorrect) opt.classList.add('incorrect');
    opt.style.pointerEvents = 'none';
  });

  // Show explanation
  const expEl = document.getElementById(`${section}-q${questionNum}-exp`);
  const explanation = quizExplanations[key];
  if (isCorrect) {
    expEl.className = 'quiz-explanation show correct-exp';
    expEl.textContent = explanation.correct;
    state.quizScores[section].correct++;
    addXP(15);
    showToast('success', `üéâ Correct! +15 XP`);
  } else {
    expEl.className = 'quiz-explanation show incorrect-exp';
    expEl.textContent = explanation.incorrect;
    addXP(3);
    showToast('error', `Not quite! +3 XP for trying`);
  }

  state.completedActivities++;
  updateProgress();

  // Update score display
  const scoreEl = document.getElementById(`${section}-quiz-score`);
  scoreEl.textContent = `${state.quizScores[section].correct}/${state.quizScores[section].total}`;

  // Check if section quiz is complete
  checkSectionComplete(section);
}

// ==================== SECTION COMPLETION ====================
function checkSectionComplete(section) {
  const quizScore = state.quizScores[section];
  let allQuizzesAnswered = true;

  for (let i = 1; i <= quizScore.total; i++) {
    if (state.quizAnswers[`${section}-${i}`] === undefined) {
      allQuizzesAnswered = false;
      break;
    }
  }

  // Check section-specific exercises too
  let exerciseDone = true;
  if (section === 'schema' && !state.exercisesCompleted.has('schema-ex1')) exerciseDone = false;
  if (section === 'mutations' && !state.exercisesCompleted.has('mutation-ex1')) exerciseDone = false;

  if (allQuizzesAnswered) {
    const bannerEl = document.getElementById(`${section}-complete`);
    if (bannerEl) {
      bannerEl.classList.add('show');
    }

    if (!state.completedSections.has(section)) {
      state.completedSections.add(section);
      const tab = document.querySelector(`.nav-tab[data-tab="${section}"]`);
      if (tab) tab.classList.add('completed');

      // Achievement check
      if (state.completedSections.size === 3) {
        showAchievement('üåü', 'Getting Serious!', 'You\'ve completed 3 sections! Keep going!');
      } else if (state.completedSections.size === 6) {
        showAchievement('üöÄ', 'GraphQL Ninja!', 'Almost there! Just the final quiz left!');
      } else if (state.completedSections.size === 8) {
        showAchievement('üèÜ', 'GraphQL Master!', 'You\'ve completed ALL sections! You\'re ready for interviews!');
        launchConfetti();
      }
    }
  }
}

// ==================== EXERCISE CHECKERS ====================
function checkSchemaExercise1() {
  const input = document.getElementById('schema-ex1-input').value.toLowerCase().replace(/\s+/g, ' ').trim();
  const resultEl = document.getElementById('schema-ex1-result');

  // Check for key elements
  const checks = [
    input.includes('type book') || input.includes('type book'),
    input.includes('id') && (input.includes('id!') || input.includes('id !')),
    input.includes('title') && input.includes('string!'),
    input.includes('author') && input.includes('string!'),
    input.includes('year') && input.includes('int'),
    input.includes('genres') && (input.includes('[string!]!') || input.includes('[string!] !') || input.includes('[ string! ]!'))
  ];

  const passed = checks.filter(Boolean).length;

  if (passed >= 5) {
    resultEl.className = 'exercise-result show pass';
    resultEl.innerHTML = '‚úÖ <strong>Excellent!</strong> Your Book schema looks correct! Key elements: type Book with proper field types and nullability. +25 XP!';
    if (!state.exercisesCompleted.has('schema-ex1')) {
      state.exercisesCompleted.add('schema-ex1');
      addXP(25);
      state.completedActivities++;
      updateProgress();
      showToast('success', 'üéØ Exercise completed! +25 XP');
    }
  } else if (passed >= 3) {
    resultEl.className = 'exercise-result show fail';
    resultEl.innerHTML = `‚ö†Ô∏è <strong>Almost!</strong> ${passed}/6 checks passed. Make sure you have: type Book { id: ID!, title: String!, author: String!, year: Int, genres: [String!]! }`;
  } else {
    resultEl.className = 'exercise-result show fail';
    resultEl.innerHTML = '‚ùå <strong>Keep trying!</strong> Start with <code>type Book {</code> and add each field with its type. Remember <code>!</code> for required fields!';
  }
  checkSectionComplete('schema');
}

function checkMutationExercise1() {
  const input = document.getElementById('mutation-ex1-input').value.toLowerCase().replace(/\s+/g, ' ').trim();
  const resultEl = document.getElementById('mutation-ex1-result');

  const checks = [
    input.includes('mutation'),
    input.includes('$input') && input.includes('createpostinput!'),
    input.includes('createpost') && input.includes('input:'),
    input.includes('id'),
    input.includes('title'),
    input.includes('author') && input.includes('name')
  ];

  const passed = checks.filter(Boolean).length;

  if (passed >= 5) {
    resultEl.className = 'exercise-result show pass';
    resultEl.innerHTML = '‚úÖ <strong>Perfect!</strong> Your mutation has the right structure: named operation, variable declaration, field with argument, and return selection with nested author! +25 XP!';
    if (!state.exercisesCompleted.has('mutation-ex1')) {
      state.exercisesCompleted.add('mutation-ex1');
      addXP(25);
      state.completedActivities++;
      updateProgress();
      showToast('success', 'üéØ Exercise completed! +25 XP');
    }
  } else if (passed >= 3) {
    resultEl.className = 'exercise-result show fail';
    resultEl.innerHTML = `‚ö†Ô∏è <strong>Getting close!</strong> ${passed}/6 checks passed. Structure: mutation CreatePost($input: CreatePostInput!) { createPost(input: $input) { id title author { name } } }`;
  } else {
    resultEl.className = 'exercise-result show fail';
    resultEl.innerHTML = '‚ùå <strong>Try again!</strong> Pattern: mutation Name($input: InputType!) { fieldName(input: $input) { returnFields } }';
  }
  checkSectionComplete('mutations');
}

// ==================== QUERY PLAYGROUND ====================
function runQueryPlayground() {
  const input = document.getElementById('query-pg-input').value;
  const outputEl = document.getElementById('query-pg-output');

  // Simulated responses
  const mockDB = {
    users: [
      { id: '1', name: 'Alice Chen', email: 'alice@dev.io', avatar: 'üë©‚Äçüíª', age: 28, isActive: true, posts: [
        { id: '101', title: 'Mastering GraphQL', createdAt: '2024-01-15', content: 'GraphQL is amazing...', tags: ['graphql', 'api'] },
        { id: '102', title: 'Apollo Client Tips', createdAt: '2024-02-20', content: 'Here are my tips...', tags: ['apollo', 'react'] }
      ]},
      { id: '2', name: 'Bob Smith', email: 'bob@dev.io', avatar: 'üë®‚Äçüíª', age: 32, isActive: true, posts: [
        { id: '201', title: 'REST vs GraphQL', createdAt: '2024-03-10', content: 'Let me compare...', tags: ['rest', 'graphql'] }
      ]},
      { id: '3', name: 'Carol Dev', email: 'carol@dev.io', avatar: 'üë©‚Äçüî¨', age: 25, isActive: false, posts: [] }
    ]
  };

  try {
    // Simple parser for demo
    let response = { data: {} };

    if (input.includes('user') && input.includes('id')) {
      const idMatch = input.match(/id:\s*"(\d+)"/);
      const userId = idMatch ? idMatch[1] : '1';
      const user = mockDB.users.find(u => u.id === userId) || mockDB.users[0];

      const result = {};
      if (input.includes('name')) result.name = user.name;
      if (input.includes('email')) result.email = user.email;
      if (input.includes('id') && !input.includes('id:')) result.id = user.id;
      if (input.includes('avatar')) result.avatar = user.avatar;
      if (input.includes('age')) result.age = user.age;
      if (input.includes('isActive')) result.isActive = user.isActive;
      if (input.includes('posts')) {
        result.posts = user.posts.map(p => {
          const post = {};
          if (input.includes('title')) post.title = p.title;
          if (input.includes('createdAt')) post.createdAt = p.createdAt;
          if (input.includes('content')) post.content = p.content;
          if (input.includes('tags')) post.tags = p.tags;
          return post;
        });
      }

      response.data.user = result;
    } else if (input.includes('users')) {
      response.data.users = mockDB.users.map(user => {
        const result = {};
        if (input.includes('name')) result.name = user.name;
        if (input.includes('email')) result.email = user.email;
        result.id = user.id;
        return result;
      });
    } else {
      response = { data: null, errors: [{ message: 'Unknown query. Try querying user(id: "1") or users!' }] };
    }

    outputEl.innerHTML = `<code class="tx">${syntaxHighlightJSON(JSON.stringify(response, null, 2))}</code>`;

    if (!state.exercisesCompleted.has('playground')) {
      state.exercisesCompleted.add('playground');
      addXP(10);
      state.completedActivities++;
      updateProgress();
      showToast('info', 'üéÆ Playground used! +10 XP');
    }
  } catch (e) {
    outputEl.innerHTML = `<code class="tx" style="color:var(--gql-error)">Error parsing query: ${e.message}</code>`;
  }
}

function syntaxHighlightJSON(json) {
  return json
    .replace(/(".*?")(\s*:)/g, '<span class="pr">$1</span>$2')
    .replace(/:\s*(".*?")/g, ': <span class="st">$1</span>')
    .replace(/:\s*(\d+)/g, ': <span class="nm">$1</span>')
    .replace(/:\s*(true|false|null)/g, ': <span class="kw">$1</span>');
}

// ==================== XP & PROGRESS ====================
function addXP(amount) {
  state.xp += amount;
  document.getElementById('xpValue').textContent = state.xp;

  // Animate XP
  const xpEl = document.getElementById('xpValue');
  xpEl.style.transform = 'scale(1.3)';
  xpEl.style.transition = 'transform 0.2s';
  setTimeout(() => { xpEl.style.transform = 'scale(1)'; }, 200);
}

function updateProgress() {
  const pct = Math.round((state.completedActivities / state.totalActivities) * 100);
  document.getElementById('progressFill').style.width = `${Math.min(pct, 100)}%`;
  document.getElementById('progressText').textContent = `${Math.min(pct, 100)}%`;
}

// ==================== TOAST NOTIFICATIONS ====================
function showToast(type, message) {
  const toast = document.getElementById('toast');
  toast.className = `toast toast-${type} show`;
  toast.textContent = message;

  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
}

// ==================== ACHIEVEMENTS ====================
function showAchievement(emoji, title, desc) {
  document.getElementById('achieveEmoji').textContent = emoji;
  document.getElementById('achieveTitle').textContent = title;
  document.getElementById('achieveDesc').textContent = desc;
  document.getElementById('achievementOverlay').classList.add('show');
  addXP(50);
}

function closeAchievement() {
  document.getElementById('achievementOverlay').classList.remove('show');
}

// ==================== CONFETTI ====================
function launchConfetti() {
  const canvas = document.getElementById('confetti-canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const pieces = [];
  const colors = ['#E10098', '#ff2bb8', '#6f42c1', '#448aff', '#00e676', '#ffc107', '#ff5252'];

  for (let i = 0; i < 150; i++) {
    pieces.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height - canvas.height,
      w: Math.random() * 10 + 5,
      h: Math.random() * 6 + 3,
      color: colors[Math.floor(Math.random() * colors.length)],
            vx: (Math.random() - 0.5) * 8,        // horizontal speed
      vy: Math.random() * 5 + 5,            // vertical speed (falling)
      gravity: 0.2,                         // gravity acceleration
      rotation: Math.random() * 360,         // initial rotation
      rotationSpeed: (Math.random() - 0.5) * 2 // rotation speed
    });
  }

  // Animation loop
  function drawConfetti() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    pieces.forEach(p => {
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rotation * Math.PI / 180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
      ctx.restore();

      // Update position
      p.x += p.vx;
      p.y += p.vy;
      p.vy += p.gravity;
      p.rotation += p.rotationSpeed;

      // Reset when off screen
      if (p.y > canvas.height + 100) {
        p.y = -100;
        p.x = Math.random() * canvas.width;
        p.vy = Math.random() * 5 + 5;
        p.vx = (Math.random() - 0.5) * 8;
        p.rotation = Math.random() * 360;
      }
    });
    requestAnimationFrame(drawConfetti);
  }

  drawConfetti();

  // Stop after 5 seconds
  setTimeout(() => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }, 5000);
}

// ==================== HELPER FUNCTIONS ====================
function copyCode(btn) {
  // Find the closest pre element and copy its text
  const pre = btn.closest('.code-container')?.querySelector('pre');
  if (!pre) return;

  const text = pre.innerText;
  navigator.clipboard.writeText(text).then(() => {
    showToast('success', '‚úÖ Code copied to clipboard!');
    btn.textContent = 'Copied!';
    setTimeout(() => { btn.textContent = 'Copy'; }, 2000);
  }).catch(() => {
    showToast('error', '‚ùå Failed to copy');
  });
}

function toggleHint(id) {
  const hint = document.getElementById(id);
  if (hint) hint.classList.toggle('show');
}

// ==================== INITIALIZATION ====================
function initApp() {
  // Set up window resize for confetti canvas
  window.addEventListener('resize', () => {
    const canvas = document.getElementById('confetti-canvas');
    if (canvas) {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
  });

  // Initial progress update
  updateProgress();

  // Load any saved state? (optional)
  console.log('GraphQL Mastery ready! üöÄ');
}

// Run init when DOM is loaded
document.addEventListener('DOMContentLoaded', initApp);

// ==================== CLOSING TAGS ====================
</script>
</body>
</html>