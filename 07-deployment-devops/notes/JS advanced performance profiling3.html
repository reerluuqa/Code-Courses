<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Testing Mastery</title>
<style>
  :root {
    --bg: #0f1117;
    --surface: #1a1d27;
    --surface2: #252836;
    --surface3: #2d3148;
    --accent: #6c63ff;
    --accent2: #ff6584;
    --accent3: #43e97b;
    --accent4: #f7971e;
    --text: #e8eaf0;
    --text2: #9ca3af;
    --border: #333650;
    --success: #43e97b;
    --error: #ff6584;
    --warn: #f7971e;
    --info: #38bdf8;
    --code-bg: #12141f;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }
  /* NAV */
  nav {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 20px;
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 8px;
    overflow-x: auto;
    scrollbar-width: none;
  }
  nav::-webkit-scrollbar { display: none; }
  .nav-logo {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--accent);
    white-space: nowrap;
    padding: 14px 12px 14px 0;
    border-right: 1px solid var(--border);
    margin-right: 4px;
  }
  nav button {
    background: none;
    border: none;
    color: var(--text2);
    padding: 14px 12px;
    cursor: pointer;
    font-size: 0.82rem;
    white-space: nowrap;
    transition: all 0.2s;
    border-bottom: 2px solid transparent;
    font-weight: 500;
  }
  nav button:hover { color: var(--text); }
  nav button.active { color: var(--accent); border-bottom-color: var(--accent); }
  /* MAIN */
  main { max-width: 960px; margin: 0 auto; padding: 32px 20px 80px; }
  .section { display: none; }
  .section.active { display: block; }
  h1 { font-size: 2rem; font-weight: 800; margin-bottom: 8px; }
  h2 { font-size: 1.4rem; font-weight: 700; margin: 32px 0 12px; color: var(--accent); }
  h3 { font-size: 1.1rem; font-weight: 600; margin: 20px 0 8px; color: var(--accent4); }
  p { color: var(--text2); line-height: 1.7; margin-bottom: 12px; }
  .subtitle { font-size: 1rem; color: var(--text2); margin-bottom: 32px; }
  /* CARDS */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 16px;
  }
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }
  .card.accent-left { border-left: 3px solid var(--accent); }
  .card.success-left { border-left: 3px solid var(--success); }
  .card.error-left { border-left: 3px solid var(--error); }
  .card.warn-left { border-left: 3px solid var(--warn); }
  .card.info-left { border-left: 3px solid var(--info); }
  /* CODE BLOCKS */
  .code-block {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin: 12px 0;
    overflow: hidden;
  }
  .code-header {
    background: var(--surface2);
    padding: 8px 16px;
    font-size: 0.75rem;
    color: var(--text2);
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border);
  }
  .code-header span { color: var(--accent); font-weight: 600; }
  pre {
    padding: 16px;
    overflow-x: auto;
    font-size: 0.82rem;
    line-height: 1.6;
    font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  }
  .kw { color: #c792ea; }
  .fn { color: #82aaff; }
  .str { color: #c3e88d; }
  .cm { color: #546e7a; font-style: italic; }
  .num { color: #f78c6c; }
  .cls { color: #ffcb6b; }
  .op { color: #89ddff; }
  /* PYRAMID */
  .pyramid {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    margin: 24px 0;
  }
  .pyramid-layer {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.85rem;
    color: #fff;
    transition: transform 0.2s;
    cursor: default;
  }
  .pyramid-layer:hover { transform: scale(1.02); }
  /* TAGS */
  .tag {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.72rem;
    font-weight: 600;
    margin: 2px;
  }
  .tag-purple { background: rgba(108,99,255,0.2); color: var(--accent); }
  .tag-green { background: rgba(67,233,123,0.2); color: var(--success); }
  .tag-red { background: rgba(255,101,132,0.2); color: var(--error); }
  .tag-yellow { background: rgba(247,151,30,0.2); color: var(--warn); }
  .tag-blue { background: rgba(56,189,248,0.2); color: var(--info); }
  /* QUIZ */
  .quiz-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 20px;
  }
  .quiz-q { font-weight: 600; font-size: 1rem; margin-bottom: 16px; line-height: 1.5; }
  .quiz-options { display: flex; flex-direction: column; gap: 10px; }
  .quiz-opt {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.88rem;
    text-align: left;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .quiz-opt:hover:not(:disabled) { border-color: var(--accent); background: var(--surface3); }
  .quiz-opt.correct { border-color: var(--success); background: rgba(67,233,123,0.1); }
  .quiz-opt.wrong { border-color: var(--error); background: rgba(255,101,132,0.1); }
  .quiz-opt .opt-letter {
    width: 26px; height: 26px;
    border-radius: 50%;
    background: var(--surface3);
    display: flex; align-items: center; justify-content: center;
    font-weight: 700; font-size: 0.75rem;
    flex-shrink: 0;
  }
  .quiz-feedback {
    margin-top: 12px;
    padding: 10px 14px;
    border-radius: 8px;
    font-size: 0.85rem;
    line-height: 1.5;
    display: none;
  }
  .quiz-feedback.show { display: block; }
  .quiz-feedback.correct { background: rgba(67,233,123,0.1); border: 1px solid var(--success); color: var(--success); }
  .quiz-feedback.wrong { background: rgba(255,101,132,0.1); border: 1px solid var(--error); color: var(--error); }
  .quiz-score {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    margin-top: 24px;
    display: none;
  }
  .quiz-score.show { display: block; }
  .score-num { font-size: 2.5rem; font-weight: 800; color: var(--accent); }
  /* EXERCISES */
  .exercise {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
  }
  .ex-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .ex-title { font-weight: 700; font-size: 1rem; }
  .diff-badge {
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.72rem;
    font-weight: 700;
  }
  .diff-easy { background: rgba(67,233,123,0.2); color: var(--success); }
  .diff-medium { background: rgba(247,151,30,0.2); color: var(--warn); }
  .diff-hard { background: rgba(255,101,132,0.2); color: var(--error); }
  .ex-desc { color: var(--text2); font-size: 0.88rem; margin-bottom: 14px; line-height: 1.6; }
  textarea {
    width: 100%;
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 14px;
    color: var(--text);
    font-family: 'Cascadia Code', 'Fira Code', monospace;
    font-size: 0.82rem;
    line-height: 1.6;
    resize: vertical;
    min-height: 160px;
    outline: none;
    transition: border-color 0.2s;
  }
  textarea:focus { border-color: var(--accent); }
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 9px 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.2s;
  }
  .btn-primary { background: var(--accent); color: #fff; }
  .btn-primary:hover { background: #5a52e0; transform: translateY(-1px); }
  .btn-success { background: var(--success); color: #000; }
  .btn-success:hover { opacity: 0.85; }
  .btn-outline {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text);
  }
  .btn-outline:hover { border-color: var(--accent); color: var(--accent); }
  .btn-sm { padding: 6px 12px; font-size: 0.78rem; }
  .btn-row { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
  .output-box {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    margin-top: 12px;
    font-size: 0.82rem;
    font-family: monospace;
    min-height: 40px;
    display: none;
    line-height: 1.6;
  }
  .output-box.show { display: block; }
  /* TIPS/PITFALLS */
  .pitfall {
    background: rgba(255,101,132,0.05);
    border: 1px solid rgba(255,101,132,0.3);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    gap: 12px;
  }
  .pitfall-icon { font-size: 1.3rem; flex-shrink: 0; }
  .pitfall-body h4 { font-size: 0.9rem; margin-bottom: 4px; color: var(--error); }
  .pitfall-body p { font-size: 0.83rem; margin: 0; }
  .tip {
    background: rgba(67,233,123,0.05);
    border: 1px solid rgba(67,233,123,0.3);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    gap: 12px;
  }
  .tip-icon { font-size: 1.3rem; flex-shrink: 0; }
  .tip-body h4 { font-size: 0.9rem; margin-bottom: 4px; color: var(--success); }
  .tip-body p { font-size: 0.83rem; margin: 0; }
  /* CHEATSHEET */
  .cheat-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.82rem;
    margin-bottom: 24px;
  }
  .cheat-table th {
    background: var(--surface2);
    padding: 10px 14px;
    text-align: left;
    color: var(--accent);
    font-weight: 700;
    border-bottom: 1px solid var(--border);
  }
  .cheat-table td {
    padding: 10px 14px;
    border-bottom: 1px solid var(--border);
    color: var(--text2);
    vertical-align: top;
  }
  .cheat-table tr:hover td { background: var(--surface2); }
  .cheat-table code {
    background: var(--surface3);
    padding: 2px 6px;
    border-radius: 4px;
    color: var(--accent);
    font-family: monospace;
    font-size: 0.8rem;
  }
  /* PROGRESS BAR */
  .progress-track {
    background: var(--surface2);
    border-radius: 20px;
    height: 6px;
    margin: 8px 0 4px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    border-radius: 20px;
    background: linear-gradient(90deg, var(--accent), var(--accent3));
    transition: width 0.5s;
  }
  /* COMPARE GRID */
  .compare-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin: 16px 0;
  }
  @media(max-width:600px) { .compare-grid { grid-template-columns: 1fr; } }
  /* TABS (inner) */
  .inner-tabs { display: flex; gap: 4px; margin-bottom: 16px; flex-wrap: wrap; }
  .inner-tab {
    padding: 8px 16px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text2);
    cursor: pointer;
    font-size: 0.82rem;
    font-weight: 500;
    transition: all 0.2s;
  }
  .inner-tab.active { background: var(--accent); color: #fff; border-color: var(--accent); }
  .inner-content { display: none; }
  .inner-content.active { display: block; }
  /* FLOW DIAGRAM */
  .flow {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    margin: 16px 0;
  }
  .flow-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 0.82rem;
    font-weight: 600;
    text-align: center;
  }
  .flow-arrow { color: var(--text2); font-size: 1.2rem; }
  /* HERO BADGE */
  .hero-badges { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 28px; }
  .hero-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 14px;
    font-size: 0.82rem;
    font-weight: 600;
  }
  .hero-badge .dot { width: 8px; height: 8px; border-radius: 50%; }
  /* ACCORDION */
  .accordion { margin-bottom: 8px; }
  .acc-header {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 18px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    color: var(--text);
    font-weight: 600;
    font-size: 0.9rem;
    transition: border-color 0.2s;
    text-align: left;
  }
  .acc-header:hover { border-color: var(--accent); }
  .acc-header.open { border-bottom-left-radius: 0; border-bottom-right-radius: 0; border-color: var(--accent); color: var(--accent); }
  .acc-body {
    display: none;
    background: var(--surface2);
    border: 1px solid var(--accent);
    border-top: none;
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px;
    padding: 16px 18px;
  }
  .acc-body.open { display: block; }
  .acc-arrow { transition: transform 0.2s; }
  .acc-header.open .acc-arrow { transform: rotate(180deg); }
  /* INTERACTIVE DEMO */
  .demo-box {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin: 16px 0;
  }
  .demo-box h4 { color: var(--accent4); margin-bottom: 12px; font-size: 0.95rem; }
  .test-runner {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .test-row {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px;
    background: var(--surface2);
    border-radius: 8px;
    font-size: 0.82rem;
    font-family: monospace;
    opacity: 0;
    transform: translateX(-10px);
    transition: all 0.3s;
  }
  .test-row.visible { opacity: 1; transform: translateX(0); }
  .test-icon { font-size: 1rem; }
  .test-name { flex: 1; color: var(--text); }
  .test-time { color: var(--text2); font-size: 0.75rem; }
  /* CHECKLIST */
  .checklist { list-style: none; }
  .checklist li {
    display: flex;
    gap: 10px;
    align-items: flex-start;
    padding: 8px 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.88rem;
    color: var(--text2);
  }
  .checklist li:last-child { border: none; }
  .checklist li::before { content: '‚úì'; color: var(--success); font-weight: 700; margin-top: 2px; }
  /* STRATEGY CARDS */
  .strategy-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 14px; margin: 16px 0; }
  .strategy-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
  }
  .strategy-card .s-icon { font-size: 2rem; margin-bottom: 8px; }
  .strategy-card .s-title { font-weight: 700; font-size: 0.9rem; margin-bottom: 6px; }
  .strategy-card .s-desc { font-size: 0.78rem; color: var(--text2); line-height: 1.5; }
  /* ALERT BOXES */
  .alert {
    border-radius: 8px;
    padding: 12px 16px;
    margin: 12px 0;
    font-size: 0.85rem;
    display: flex;
    gap: 10px;
    align-items: flex-start;
    line-height: 1.5;
  }
  .alert-info { background: rgba(56,189,248,0.1); border: 1px solid rgba(56,189,248,0.3); color: var(--info); }
  .alert-warn { background: rgba(247,151,30,0.1); border: 1px solid rgba(247,151,30,0.3); color: var(--warn); }
  .alert-success { background: rgba(67,233,123,0.1); border: 1px solid rgba(67,233,123,0.3); color: var(--success); }
  /* NUMBERS */
  .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 14px; margin: 16px 0; }
  .stat-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
  }
  .stat-num { font-size: 1.8rem; font-weight: 800; color: var(--accent); }
  .stat-label { font-size: 0.75rem; color: var(--text2); margin-top: 4px; }
</style>
</head>
<body>

<nav>
  <div class="nav-logo">üß™ Advanced Testing</div>
  <button class="active" onclick="showSection('intro')">üìñ Intro</button>
  <button onclick="showSection('integration')">üîó Integration</button>
  <button onclick="showSection('e2e')">üåê E2E</button>
  <button onclick="showSection('visual')">üëÅÔ∏è Visual</button>
  <button onclick="showSection('strategy')">üó∫Ô∏è Strategy</button>
  <button onclick="showSection('examples')">üíª Examples</button>
  <button onclick="showSection('exercises')">üèãÔ∏è Exercises</button>
  <button onclick="showSection('pitfalls')">‚ö†Ô∏è Pitfalls</button>
  <button onclick="showSection('quiz')">üß© Quiz</button>
  <button onclick="showSection('cheatsheet')">üìã Cheatsheet</button>
</nav>

<main>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INTRO ‚ïê‚ïê -->
<section class="section active" id="intro">
  <h1>üß™ Advanced Testing</h1>
  <p class="subtitle">Integration tests ¬∑ E2E ¬∑ Visual Regression ¬∑ Test Strategies ‚Äî Everything you need to ace interviews</p>

  <div class="hero-badges">
    <div class="hero-badge"><div class="dot" style="background:#6c63ff"></div>Integration Testing</div>
    <div class="hero-badge"><div class="dot" style="background:#43e97b"></div>E2E with Playwright/Cypress</div>
    <div class="hero-badge"><div class="dot" style="background:#f7971e"></div>Visual Regression</div>
    <div class="hero-badge"><div class="dot" style="background:#ff6584"></div>Test Strategies</div>
  </div>

  <h2>ü§î Why Advanced Testing?</h2>
  <div class="card-grid">
    <div class="card accent-left">
      <h3 style="margin-top:0">Unit Tests Alone Aren't Enough</h3>
      <p>Unit tests test individual pieces in isolation. But they can't catch bugs that appear when pieces are <strong>connected together</strong>. That's where integration and E2E tests come in.</p>
    </div>
    <div class="card success-left">
      <h3 style="margin-top:0">Catch Real-World Bugs</h3>
      <p>The most damaging bugs are often at the <strong>seams</strong> ‚Äî where your API meets your DB, where your frontend meets your API, where one service calls another.</p>
    </div>
    <div class="card warn-left">
      <h3 style="margin-top:0">Build Confidence to Ship</h3>
      <p>A strong test suite lets your team <strong>refactor fearlessly</strong>, merge frequently, and deploy on Fridays without panic.</p>
    </div>
  </div>

  <h2>üèõÔ∏è The Testing Pyramid</h2>
  <p>Think of testing as a pyramid. More tests at the base, fewer (but critical) at the top:</p>

  <div class="pyramid">
    <div class="pyramid-layer" style="width:160px;height:52px;background:linear-gradient(135deg,#ff6584,#c94b4b)">
      üåê E2E (few, slow, expensive)
    </div>
    <div class="pyramid-layer" style="width:280px;height:52px;background:linear-gradient(135deg,#f7971e,#c47c1a)">
      üîó Integration (moderate)
    </div>
    <div class="pyramid-layer" style="width:400px;height:52px;background:linear-gradient(135deg,#43e97b,#2f9b55)">
      ‚ö° Unit Tests (many, fast, cheap)
    </div>
  </div>

  <div class="stat-grid">
    <div class="stat-box"><div class="stat-num">70%</div><div class="stat-label">Unit Tests</div></div>
    <div class="stat-box"><div class="stat-num">20%</div><div class="stat-label">Integration Tests</div></div>
    <div class="stat-box"><div class="stat-num">10%</div><div class="stat-label">E2E Tests</div></div>
  </div>

  <h2>üìö Simple Mental Model</h2>
  <div class="card-grid">
    <div class="card">
      <h3 style="margin-top:0">üîß Unit Test</h3>
      <p style="font-size:0.85rem">Testing a <strong>single function</strong> with mocked dependencies. Fast, isolated, runs in ms.</p>
      <p style="font-size:0.82rem;color:var(--accent)">Example: "Does <code>calculateTotal()</code> return the right number?"</p>
    </div>
    <div class="card">
      <h3 style="margin-top:0">üîó Integration Test</h3>
      <p style="font-size:0.85rem">Testing <strong>multiple units working together</strong>, often with a real DB or real HTTP calls.</p>
      <p style="font-size:0.82rem;color:var(--accent)">Example: "Does POST /orders actually save to the database?"</p>
    </div>
    <div class="card">
      <h3 style="margin-top:0">üåê E2E Test</h3>
      <p style="font-size:0.85rem">Testing the <strong>entire application</strong> through a real browser, just like a real user would.</p>
      <p style="font-size:0.82rem;color:var(--accent)">Example: "Can a user sign up, add a product, and check out?"</p>
    </div>
  </div>

  <div class="alert alert-info">
    üí° <span><strong>Interview Tip:</strong> Interviewers at top companies love when you can articulate the trade-offs between test types and justify why you'd use each one.</span>
  </div>

  <h2>üîÑ The Testing Flow</h2>
  <div class="flow">
    <div class="flow-box">Write Code</div>
    <div class="flow-arrow">‚Üí</div>
    <div class="flow-box">Unit Tests</div>
    <div class="flow-arrow">‚Üí</div>
    <div class="flow-box">Integration Tests</div>
    <div class="flow-arrow">‚Üí</div>
    <div class="flow-box">E2E Tests</div>
    <div class="flow-arrow">‚Üí</div>
    <div class="flow-box">CI/CD Pipeline</div>
    <div class="flow-arrow">‚Üí</div>
    <div class="flow-box" style="border-color:var(--success);color:var(--success)">üöÄ Deploy</div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INTEGRATION ‚ïê‚ïê -->
<section class="section" id="integration">
  <h1>üîó Integration Testing</h1>
  <p class="subtitle">Testing multiple units working together ‚Äî APIs, databases, services</p>

  <h2>What is Integration Testing?</h2>
  <div class="card">
    <p>Integration tests verify that <strong>multiple components work correctly when combined</strong>. Unlike unit tests that mock everything, integration tests use real connections ‚Äî or as close to real as practical.</p>
    <ul style="color:var(--text2);font-size:0.88rem;line-height:2;padding-left:20px">
      <li>Tests API routes with a real (or in-memory) database</li>
      <li>Tests service-to-service communication</li>
      <li>Tests middleware chains and auth flows</li>
      <li>Tests database queries with actual data</li>
    </ul>
  </div>

  <h2>Integration Test Setup</h2>
  <div class="inner-tabs">
    <button class="inner-tab active" onclick="showInner('it','jest')">Jest + Supertest</button>
    <button class="inner-tab" onclick="showInner('it','vitest')">Vitest</button>
    <button class="inner-tab" onclick="showInner('it','db')">DB Testing</button>
  </div>

  <div class="inner-content active" id="it-jest">
    <div class="code-block">
      <div class="code-header"><span>üì¶ Installation</span></div>
      <pre>npm install --save-dev jest supertest @types/supertest
npm install --save-dev @testcontainers/postgresql</pre>
    </div>
    <div class="code-block">
      <div class="code-header"><span>api.test.js ‚Äî Basic Integration Test</span></div>
      <pre><span class="kw">const</span> request = <span class="fn">require</span>(<span class="str">'supertest'</span>);
<span class="kw">const</span> app = <span class="fn">require</span>(<span class="str">'./app'</span>);  <span class="cm">// Your Express app</span>
<span class="kw">const</span> db = <span class="fn">require</span>(<span class="str">'./db'</span>);   <span class="cm">// Real DB connection</span>

<span class="cm">// Run ONCE before all tests in this file</span>
<span class="fn">beforeAll</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">connect</span>();
  <span class="kw">await</span> db.<span class="fn">migrate</span>();   <span class="cm">// Run migrations</span>
});

<span class="cm">// Clean up after EACH test to avoid pollution</span>
<span class="fn">afterEach</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">truncate</span>([<span class="str">'users'</span>, <span class="str">'orders'</span>]);
});

<span class="fn">afterAll</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">disconnect</span>();
});

<span class="fn">describe</span>(<span class="str">'POST /api/users'</span>, () => {
  <span class="fn">it</span>(<span class="str">'creates a user and returns 201'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/users'</span>)
      .<span class="fn">send</span>({ name: <span class="str">'Alice'</span>, email: <span class="str">'alice@test.com'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">201</span>);
    <span class="fn">expect</span>(res.body.email).<span class="fn">toBe</span>(<span class="str">'alice@test.com'</span>);

    <span class="cm">// Verify it ACTUALLY persisted to DB</span>
    <span class="kw">const</span> user = <span class="kw">await</span> db.<span class="fn">query</span>(
      <span class="str">'SELECT * FROM users WHERE email = $1'</span>,
      [<span class="str">'alice@test.com'</span>]
    );
    <span class="fn">expect</span>(user.rows).toHaveLength(<span class="num">1</span>);
  });

  <span class="fn">it</span>(<span class="str">'returns 409 if email already exists'</span>, <span class="kw">async</span> () => {
    <span class="cm">// Seed existing user</span>
    <span class="kw">await</span> db.<span class="fn">query</span>(
      <span class="str">'INSERT INTO users (name, email) VALUES ($1, $2)'</span>,
      [<span class="str">'Bob'</span>, <span class="str">'bob@test.com'</span>]
    );

    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/users'</span>)
      .<span class="fn">send</span>({ name: <span class="str">'Bob2'</span>, email: <span class="str">'bob@test.com'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">409</span>);
  });
});</pre>
    </div>
  </div>

  <div class="inner-content" id="it-vitest">
    <div class="code-block">
      <div class="code-header"><span>vitest.config.js</span></div>
      <pre><span class="kw">import</span> { defineConfig } <span class="kw">from</span> <span class="str">'vitest/config'</span>;

<span class="kw">export default</span> <span class="fn">defineConfig</span>({
  test: {
    <span class="cm">// Run integration tests with real env vars</span>
    env: { NODE_ENV: <span class="str">'test'</span> },
    globalSetup: <span class="str">'./src/test/globalSetup.ts'</span>,
    setupFiles: [<span class="str">'./src/test/setup.ts'</span>],
    <span class="cm">// Don't run in parallel ‚Äî DB state could conflict</span>
    pool: <span class="str">'forks'</span>,
    poolOptions: { forks: { singleFork: <span class="kw">true</span> } },
  }
});</pre>
    </div>
    <div class="code-block">
      <div class="code-header"><span>integration.test.ts ‚Äî Vitest style</span></div>
      <pre><span class="kw">import</span> { describe, it, expect, beforeAll, afterEach } <span class="kw">from</span> <span class="str">'vitest'</span>;
<span class="kw">import</span> { testClient } <span class="kw">from</span> <span class="str">'hono/testing'</span>;
<span class="kw">import</span> { app } <span class="kw">from</span> <span class="str">'./app'</span>;

<span class="fn">describe</span>(<span class="str">'Orders API'</span>, () => {
  <span class="fn">it</span>(<span class="str">'GET /orders returns array'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">testClient</span>(app).<span class="fn">get</span>(<span class="str">'/orders'</span>);
    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(<span class="kw">await</span> res.<span class="fn">json</span>()).<span class="fn">toBeInstanceOf</span>(Array);
  });
});</pre>
    </div>
  </div>

  <div class="inner-content" id="it-db">
    <div class="code-block">
      <div class="code-header"><span>Testcontainers ‚Äî Real PostgreSQL in Docker for tests</span></div>
      <pre><span class="kw">import</span> { PostgreSqlContainer } <span class="kw">from</span> <span class="str">'@testcontainers/postgresql'</span>;

<span class="kw">let</span> container;
<span class="kw">let</span> db;

<span class="fn">beforeAll</span>(<span class="kw">async</span> () => {
  <span class="cm">// Spin up a REAL PostgreSQL in Docker!</span>
  container = <span class="kw">await new</span> <span class="cls">PostgreSqlContainer</span>().<span class="fn">start</span>();

  db = <span class="kw">await</span> <span class="fn">createConnection</span>({
    host: container.<span class="fn">getHost</span>(),
    port: container.<span class="fn">getMappedPort</span>(<span class="num">5432</span>),
    database: container.<span class="fn">getDatabase</span>(),
    username: container.<span class="fn">getUsername</span>(),
    password: container.<span class="fn">getPassword</span>(),
  });

  <span class="kw">await</span> db.<span class="fn">runMigrations</span>();
}, <span class="num">60000</span>); <span class="cm">// Longer timeout for Docker startup</span>

<span class="fn">afterAll</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">close</span>();
  <span class="kw">await</span> container.<span class="fn">stop</span>();
});</pre>
    </div>

    <div class="code-block">
      <div class="code-header"><span>In-Memory SQLite ‚Äî Lightweight alternative</span></div>
      <pre><span class="kw">const</span> Database = <span class="fn">require</span>(<span class="str">'better-sqlite3'</span>);

<span class="cm">// :memory: creates an in-RAM database ‚Äî super fast!</span>
<span class="kw">const</span> db = <span class="kw">new</span> <span class="cls">Database</span>(<span class="str">':memory:'</span>);

<span class="fn">beforeAll</span>(() => {
  db.<span class="fn">exec</span>(`
    CREATE TABLE users (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      name TEXT NOT NULL,
      email TEXT UNIQUE NOT NULL
    );
  `);
});

<span class="fn">afterEach</span>(() => {
  db.<span class="fn">exec</span>(<span class="str">'DELETE FROM users'</span>); <span class="cm">// Clean between tests</span>
});</pre>
    </div>
  </div>

  <h2>üîë Key Integration Test Patterns</h2>
  <div class="accordion">
    <button class="acc-header" onclick="toggleAcc(this)">
      1. Test Happy Path AND Edge Cases <span class="acc-arrow">‚ñº</span>
    </button>
    <div class="acc-body">
      <div class="code-block">
        <div class="code-header"><span>Complete route test</span></div>
        <pre><span class="fn">describe</span>(<span class="str">'PATCH /api/orders/:id'</span>, () => {
  <span class="cm">// ‚úÖ Happy path</span>
  <span class="fn">it</span>(<span class="str">'updates order status'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> order = <span class="kw">await</span> <span class="fn">createOrder</span>({ status: <span class="str">'pending'</span> });

    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">patch</span>(`/api/orders/${order.id}`)
      .<span class="fn">set</span>(<span class="str">'Authorization'</span>, <span class="str">'Bearer valid-token'</span>)
      .<span class="fn">send</span>({ status: <span class="str">'shipped'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(res.body.status).<span class="fn">toBe</span>(<span class="str">'shipped'</span>);
  });

  <span class="cm">// ‚ùå Auth failure</span>
  <span class="fn">it</span>(<span class="str">'returns 401 without auth'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">patch</span>(<span class="str">'/api/orders/1'</span>);
    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">401</span>);
  });

  <span class="cm">// ‚ùå Not found</span>
  <span class="fn">it</span>(<span class="str">'returns 404 for missing order'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">patch</span>(<span class="str">'/api/orders/99999'</span>)
      .<span class="fn">set</span>(<span class="str">'Authorization'</span>, <span class="str">'Bearer valid-token'</span>);
    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">404</span>);
  });
});</pre>
      </div>
    </div>
  </div>

  <div class="accordion">
    <button class="acc-header" onclick="toggleAcc(this)">
      2. Test Factory Helpers <span class="acc-arrow">‚ñº</span>
    </button>
    <div class="acc-body">
      <div class="code-block">
        <div class="code-header"><span>factories.js ‚Äî Avoid repetitive seed data</span></div>
        <pre><span class="cm">// üè≠ Factory functions make tests readable & DRY</span>
<span class="kw">const</span> <span class="fn">createUser</span> = <span class="kw">async</span> (overrides = {}) => {
  <span class="kw">const</span> defaults = {
    name: <span class="str">'Test User'</span>,
    email: `test-${Date.<span class="fn">now</span>()}@example.com`,
    role: <span class="str">'user'</span>,
  };
  <span class="kw">const</span> data = { ...defaults, ...overrides };
  <span class="kw">return</span> db.users.<span class="fn">create</span>(data);
};

<span class="kw">const</span> <span class="fn">createProduct</span> = <span class="kw">async</span> (overrides = {}) => ({
  name: <span class="str">'Test Product'</span>,
  price: <span class="num">9.99</span>,
  stock: <span class="num">100</span>,
  ...overrides,
});

<span class="cm">// Usage in tests:</span>
<span class="fn">it</span>(<span class="str">'admin can delete users'</span>, <span class="kw">async</span> () => {
  <span class="kw">const</span> admin = <span class="kw">await</span> <span class="fn">createUser</span>({ role: <span class="str">'admin'</span> });
  <span class="kw">const</span> target = <span class="kw">await</span> <span class="fn">createUser</span>({ email: <span class="str">'victim@test.com'</span> });
  <span class="cm">// ... test logic</span>
});</pre>
      </div>
    </div>
  </div>

  <div class="accordion">
    <button class="acc-header" onclick="toggleAcc(this)">
      3. Testing Authentication Flows <span class="acc-arrow">‚ñº</span>
    </button>
    <div class="acc-body">
      <div class="code-block">
        <div class="code-header"><span>auth.test.js</span></div>
        <pre><span class="fn">describe</span>(<span class="str">'Auth Integration'</span>, () => {
  <span class="fn">it</span>(<span class="str">'full login flow returns JWT'</span>, <span class="kw">async</span> () => {
    <span class="cm">// 1. Create user in DB</span>
    <span class="kw">await</span> <span class="fn">createUser</span>({ email: <span class="str">'user@test.com'</span>, password: <span class="str">'hashed'</span> });

    <span class="cm">// 2. Call login endpoint</span>
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/auth/login'</span>)
      .<span class="fn">send</span>({ email: <span class="str">'user@test.com'</span>, password: <span class="str">'secret'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(res.body).<span class="fn">toHaveProperty</span>(<span class="str">'token'</span>);
    <span class="fn">expect</span>(res.headers[<span class="str">'set-cookie'</span>]).<span class="fn">toBeDefined</span>();

    <span class="cm">// 3. Use token to access protected route</span>
    <span class="kw">const</span> { token } = res.body;
    <span class="kw">const</span> protectedRes = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">get</span>(<span class="str">'/api/profile'</span>)
      .<span class="fn">set</span>(<span class="str">'Authorization'</span>, `Bearer ${token}`);

    <span class="fn">expect</span>(protectedRes.status).<span class="fn">toBe</span>(<span class="num">200</span>);
  });
});</pre>
      </div>
    </div>
  </div>

  <div class="demo-box">
    <h4>üéÆ Interactive: Simulate Integration Test Run</h4>
    <div class="test-runner" id="integrationRunner"></div>
    <div class="btn-row">
      <button class="btn btn-primary" onclick="runIntegrationDemo()">‚ñ∂ Run Tests</button>
      <button class="btn btn-outline" onclick="resetIntegration()">‚Ü∫ Reset</button>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê E2E ‚ïê‚ïê -->
<section class="section" id="e2e">
  <h1>üåê E2E Testing</h1>
  <p class="subtitle">Playwright & Cypress ‚Äî Testing the full stack through a real browser</p>

  <h2>Playwright vs Cypress</h2>
  <div class="compare-grid">
    <div class="card accent-left">
      <h3 style="margin-top:0;color:var(--accent)">üé≠ Playwright</h3>
      <ul style="color:var(--text2);font-size:0.85rem;line-height:1.9;padding-left:18px">
        <li>Multi-browser: Chrome, Firefox, Safari, Edge</li>
        <li>Auto-waits built in</li>
        <li>Supports multiple tabs/windows</li>
        <li>Better for non-JS apps</li>
        <li>Faster parallel execution</li>
        <li>Code generation (record & playback)</li>
        <li><span class="tag tag-green">Best for</span> complex apps, multi-browser</li>
      </ul>
    </div>
    <div class="card info-left">
      <h3 style="margin-top:0;color:var(--info)">üå≤ Cypress</h3>
      <ul style="color:var(--text2);font-size:0.85rem;line-height:1.9;padding-left:18px">
        <li>Runs inside the browser</li>
        <li>Excellent DX & error messages</li>
        <li>Real-time reload while writing tests</li>
        <li>Great for React/Vue/Angular apps</li>
        <li>Component testing support</li>
        <li>Dashboard for CI recordings</li>
        <li><span class="tag tag-blue">Best for</span> JS-heavy SPAs</li>
      </ul>
    </div>
  </div>

  <h2>üé≠ Playwright Examples</h2>
  <div class="inner-tabs">
    <button class="inner-tab active" onclick="showInner('pw','basics')">Basics</button>
    <button class="inner-tab" onclick="showInner('pw','forms')">Forms & Nav</button>
    <button class="inner-tab" onclick="showInner('pw','api')">API Mocking</button>
    <button class="inner-tab" onclick="showInner('pw','advanced')">Advanced</button>
  </div>

  <div class="inner-content active" id="pw-basics">
    <div class="code-block">
      <div class="code-header"><span>playwright.config.ts</span></div>
      <pre><span class="kw">import</span> { defineConfig, devices } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

<span class="kw">export default</span> <span class="fn">defineConfig</span>({
  testDir: <span class="str">'./e2e'</span>,
  fullyParallel: <span class="kw">true</span>,
  retries: process.env.CI ? <span class="num">2</span> : <span class="num">0</span>, <span class="cm">// Retry on CI</span>
  workers: process.env.CI ? <span class="num">1</span> : undefined,
  reporter: [<span class="str">'html'</span>, [<span class="str">'junit'</span>, { outputFile: <span class="str">'results.xml'</span> }]],
  use: {
    baseURL: <span class="str">'http://localhost:3000'</span>,
    screenshot: <span class="str">'only-on-failure'</span>, <span class="cm">// Auto screenshots on fail</span>
    video: <span class="str">'retain-on-failure'</span>,   <span class="cm">// Video of failing tests</span>
    trace: <span class="str">'on-first-retry'</span>,       <span class="cm">// Detailed trace on retry</span>
  },
  projects: [
    { name: <span class="str">'chromium'</span>, use: { ...devices[<span class="str">'Desktop Chrome'</span>] } },
    { name: <span class="str">'firefox'</span>,  use: { ...devices[<span class="str">'Desktop Firefox'</span>] } },
    { name: <span class="str">'mobile'</span>,   use: { ...devices[<span class="str">'iPhone 13'</span>] } },
  ],
  webServer: {
    command: <span class="str">'npm run dev'</span>,
    url: <span class="str">'http://localhost:3000'</span>,
    reuseExistingServer: !process.env.CI,
  },
});</pre>
    </div>

    <div class="code-block">
      <div class="code-header"><span>e2e/home.spec.ts ‚Äî Basic navigation test</span></div>
      <pre><span class="kw">import</span> { test, expect } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

test.<span class="fn">describe</span>(<span class="str">'Homepage'</span>, () => {
  <span class="fn">test</span>(<span class="str">'loads and shows hero section'</span>, <span class="kw">async</span> ({ page }) => {
    <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/'</span>);

    <span class="cm">// Playwright auto-waits for elements!</span>
    <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByRole</span>(<span class="str">'heading'</span>, { name: <span class="str">'Welcome'</span> }))
      .<span class="fn">toBeVisible</span>();

    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveTitle</span>(<span class="str">/My App/</span>);
    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="str">'/'</span>);
  });

  <span class="fn">test</span>(<span class="str">'navigation works'</span>, <span class="kw">async</span> ({ page }) => {
    <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/'</span>);
    <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'link'</span>, { name: <span class="str">'Products'</span> }).<span class="fn">click</span>();
    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="str">'/products'</span>);
  });
});</pre>
    </div>
  </div>

  <div class="inner-content" id="pw-forms">
    <div class="code-block">
      <div class="code-header"><span>e2e/checkout.spec.ts ‚Äî Full user flow</span></div>
      <pre><span class="fn">test</span>(<span class="str">'user can complete checkout'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="cm">// Step 1: Login</span>
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/login'</span>);
  <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Email'</span>).<span class="fn">fill</span>(<span class="str">'user@test.com'</span>);
  <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Password'</span>).<span class="fn">fill</span>(<span class="str">'password123'</span>);
  <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Sign In'</span> }).<span class="fn">click</span>();

  <span class="cm">// Step 2: Add to cart</span>
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/products'</span>);
  <span class="kw">await</span> page.<span class="fn">getByTestId</span>(<span class="str">'product-card-1'</span>)
    .<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Add to Cart'</span> })
    .<span class="fn">click</span>();

  <span class="cm">// Step 3: Verify cart badge updated</span>
  <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByTestId</span>(<span class="str">'cart-count'</span>))
    .<span class="fn">toHaveText</span>(<span class="str">'1'</span>);

  <span class="cm">// Step 4: Checkout</span>
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/checkout'</span>);
  <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Card Number'</span>).<span class="fn">fill</span>(<span class="str">'4242 4242 4242 4242'</span>);
  <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Expiry'</span>).<span class="fn">fill</span>(<span class="str">'12/28'</span>);
  <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Place Order'</span> }).<span class="fn">click</span>();

  <span class="cm">// Step 5: Assert success page</span>
  <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByRole</span>(<span class="str">'heading'</span>, { name: <span class="str">'Order Confirmed'</span> }))
    .<span class="fn">toBeVisible</span>();
  <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByTestId</span>(<span class="str">'order-id'</span>)).<span class="fn">toBeVisible</span>();
});</pre>
    </div>

    <div class="code-block">
      <div class="code-header"><span>Page Object Model ‚Äî Keep tests maintainable</span></div>
      <pre><span class="cm">// pages/LoginPage.ts</span>
<span class="kw">export class</span> <span class="cls">LoginPage</span> {
  <span class="kw">constructor</span>(<span class="kw">private</span> page: Page) {}

  <span class="kw">async</span> <span class="fn">login</span>(email: <span class="kw">string</span>, password: <span class="kw">string</span>) {
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">goto</span>(<span class="str">'/login'</span>);
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByLabel</span>(<span class="str">'Email'</span>).<span class="fn">fill</span>(email);
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByLabel</span>(<span class="str">'Password'</span>).<span class="fn">fill</span>(password);
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Sign In'</span> }).<span class="fn">click</span>();
  }

  <span class="kw">async</span> <span class="fn">expectError</span>(message: <span class="kw">string</span>) {
    <span class="kw">await</span> <span class="fn">expect</span>(<span class="kw">this</span>.page.<span class="fn">getByRole</span>(<span class="str">'alert'</span>))
      .<span class="fn">toContainText</span>(message);
  }
}

<span class="cm">// In your test:</span>
<span class="fn">test</span>(<span class="str">'invalid login shows error'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">const</span> loginPage = <span class="kw">new</span> <span class="cls">LoginPage</span>(page);
  <span class="kw">await</span> loginPage.<span class="fn">login</span>(<span class="str">'bad@test.com'</span>, <span class="str">'wrong'</span>);
  <span class="kw">await</span> loginPage.<span class="fn">expectError</span>(<span class="str">'Invalid credentials'</span>);
});</pre>
      </div>
  </div>

  <div class="inner-content" id="pw-api">
    <div class="code-block">
      <div class="code-header"><span>API Mocking ‚Äî Control backend responses</span></div>
      <pre><span class="fn">test</span>(<span class="str">'shows error when API fails'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="cm">// Intercept and mock the API response</span>
  <span class="kw">await</span> page.<span class="fn">route</span>(<span class="str">'**/api/users'</span>, route =>
    route.<span class="fn">fulfill</span>({
      status: <span class="num">500</span>,
      json: { error: <span class="str">'Internal Server Error'</span> },
    })
  );

  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/dashboard'</span>);
  <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="str">'Something went wrong'</span>)).<span class="fn">toBeVisible</span>();
});

<span class="fn">test</span>(<span class="str">'shows loading skeleton'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="cm">// Delay the response to test loading state</span>
  <span class="kw">await</span> page.<span class="fn">route</span>(<span class="str">'**/api/products'</span>, <span class="kw">async</span> route => {
    <span class="kw">await</span> page.<span class="fn">waitForTimeout</span>(<span class="num">500</span>);
    <span class="kw">await</span> route.<span class="fn">continue</span>();
  });

  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/products'</span>);
  <span class="cm">// Should see skeleton immediately</span>
  <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByTestId</span>(<span class="str">'skeleton'</span>)).<span class="fn">toBeVisible</span>();
});

<span class="fn">test</span>(<span class="str">'uses real API but asserts request shape'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">let</span> requestBody;

  <span class="kw">await</span> page.<span class="fn">route</span>(<span class="str">'**/api/orders'</span>, <span class="kw">async</span> route => {
    requestBody = route.<span class="fn">request</span>().<span class="fn">postDataJSON</span>();
    <span class="kw">await</span> route.<span class="fn">continue</span>();
  });

  <span class="cm">// ... interact with UI ...</span>

  <span class="fn">expect</span>(requestBody.items).<span class="fn">toHaveLength</span>(<span class="num">2</span>);
  <span class="fn">expect</span>(requestBody.total).<span class="fn">toBe</span>(<span class="num">29.98</span>);
});</pre>
    </div>
  </div>

  <div class="inner-content" id="pw-advanced">
    <div class="code-block">
      <div class="code-header"><span>Fixtures ‚Äî Reusable authenticated state</span></div>
      <pre><span class="cm">// fixtures.ts</span>
<span class="kw">import</span> { test <span class="kw">as</span> base } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

<span class="kw">type</span> Fixtures = {
  authenticatedPage: Page;
  adminPage: Page;
};

<span class="kw">export const</span> test = base.<span class="fn">extend</span>&lt;Fixtures&gt;({
  authenticatedPage: <span class="kw">async</span> ({ browser }, use) => {
    <span class="kw">const</span> context = <span class="kw">await</span> browser.<span class="fn">newContext</span>({
      storageState: <span class="str">'./auth/user.json'</span>, <span class="cm">// Pre-saved login</span>
    });
    <span class="kw">const</span> page = <span class="kw">await</span> context.<span class="fn">newPage</span>();
    <span class="kw">await</span> <span class="fn">use</span>(page);
    <span class="kw">await</span> context.<span class="fn">close</span>();
  },

  adminPage: <span class="kw">async</span> ({ browser }, use) => {
    <span class="kw">const</span> context = <span class="kw">await</span> browser.<span class="fn">newContext</span>({
      storageState: <span class="str">'./auth/admin.json'</span>,
    });
    <span class="kw">const</span> page = <span class="kw">await</span> context.<span class="fn">newPage</span>();
    <span class="kw">await</span> <span class="fn">use</span>(page);
    <span class="kw">await</span> context.<span class="fn">close</span>();
  },
});

<span class="cm">// Usage ‚Äî no login boilerplate needed!</span>
test(<span class="str">'user sees their dashboard'</span>, <span class="kw">async</span> ({ authenticatedPage }) => {
  <span class="kw">await</span> authenticatedPage.<span class="fn">goto</span>(<span class="str">'/dashboard'</span>);
  <span class="cm">// Already logged in!</span>
});</pre>
    </div>

    <div class="code-block">
      <div class="code-header"><span>Global Setup ‚Äî Login once, save auth state</span></div>
      <pre><span class="cm">// global-setup.ts</span>
<span class="kw">import</span> { chromium } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

<span class="kw">export default async function</span> <span class="fn">globalSetup</span>() {
  <span class="kw">const</span> browser = <span class="kw">await</span> chromium.<span class="fn">launch</span>();
  <span class="kw">const</span> page = <span class="kw">await</span> browser.<span class="fn">newPage</span>();

  <span class="cm">// Login via API (faster than UI login)</span>
  <span class="kw">await</span> page.<span class="fn">request</span>.<span class="fn">post</span>(<span class="str">'/api/auth/login'</span>, {
    data: { email: <span class="str">'user@test.com'</span>, password: <span class="str">'test123'</span> }
  });

  <span class="cm">// Save the auth cookies/localStorage</span>
  <span class="kw">await</span> page.context().<span class="fn">storageState</span>({ path: <span class="str">'./auth/user.json'</span> });
  <span class="kw">await</span> browser.<span class="fn">close</span>();
}</pre>
    </div>
  </div>

  <h2>üå≤ Cypress Examples</h2>
  <div class="code-block">
    <div class="code-header"><span>cypress/e2e/login.cy.js</span></div>
    <pre><span class="fn">describe</span>(<span class="str">'Login'</span>, () => {
  <span class="fn">beforeEach</span>(() => {
    cy.<span class="fn">visit</span>(<span class="str">'/login'</span>);
  });

  <span class="fn">it</span>(<span class="str">'logs in successfully'</span>, () => {
    cy.<span class="fn">get</span>(<span class="str">'[data-testid=email]'</span>).<span class="fn">type</span>(<span class="str">'user@test.com'</span>);
    cy.<span class="fn">get</span>(<span class="str">'[data-testid=password]'</span>).<span class="fn">type</span>(<span class="str">'password123'</span>);
    cy.<span class="fn">get</span>(<span class="str">'[data-testid=submit]'</span>).<span class="fn">click</span>();

    cy.<span class="fn">url</span>().<span class="fn">should</span>(<span class="str">'include'</span>, <span class="str">'/dashboard'</span>);
    cy.<span class="fn">get</span>(<span class="str">'[data-testid=welcome]'</span>).<span class="fn">should</span>(<span class="str">'contain'</span>, <span class="str">'Welcome'</span>);
  });

  <span class="cm">// üöÄ Skip UI login ‚Äî use cy.session for speed</span>
  <span class="fn">it</span>(<span class="str">'uses session cache'</span>, () => {
    cy.<span class="fn">session</span>(<span class="str">'userSession'</span>, () => {
      cy.<span class="fn">request</span>(<span class="str">'POST'</span>, <span class="str">'/api/auth/login'</span>, {
        email: <span class="str">'user@test.com'</span>,
        password: <span class="str">'password123'</span>,
      });
    });

    cy.<span class="fn">visit</span>(<span class="str">'/dashboard'</span>);
    cy.<span class="fn">get</span>(<span class="str">'h1'</span>).<span class="fn">should</span>(<span class="str">'exist'</span>);
  });
});</pre>
  </div>

  <div class="code-block">
    <div class="code-header"><span>cypress/support/commands.js ‚Äî Custom commands</span></div>
    <pre><span class="cm">// Define once, use everywhere</span>
Cypress.Commands.<span class="fn">add</span>(<span class="str">'login'</span>, (email, password) => {
  cy.<span class="fn">session</span>([email, password], () => {
    cy.<span class="fn">request</span>({
      method: <span class="str">'POST'</span>,
      url: <span class="str">'/api/auth/login'</span>,
      body: { email, password },
    });
  });
});

Cypress.Commands.<span class="fn">add</span>(<span class="str">'loginAsAdmin'</span>, () => {
  cy.<span class="fn">login</span>(
    Cypress.env(<span class="str">'ADMIN_EMAIL'</span>),
    Cypress.env(<span class="str">'ADMIN_PASSWORD'</span>)
  );
});

<span class="cm">// Usage:</span>
<span class="fn">beforeEach</span>(() => {
  cy.<span class="fn">loginAsAdmin</span>();
});</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê VISUAL ‚ïê‚ïê -->
<section class="section" id="visual">
  <h1>üëÅÔ∏è Visual Regression Testing</h1>
  <p class="subtitle">Catch unintended UI changes automatically by comparing screenshots</p>

  <h2>What is Visual Regression Testing?</h2>
  <div class="card">
    <p>Visual regression tests <strong>take screenshots of your UI and compare them to "baseline" images</strong>. If pixels change unexpectedly, the test fails ‚Äî catching CSS bugs, layout breaks, and design regressions that functional tests miss.</p>
  </div>

  <div class="card-grid">
    <div class="card success-left">
      <h3 style="margin-top:0">‚úÖ Catches</h3>
      <ul style="color:var(--text2);font-size:0.85rem;line-height:1.9;padding-left:18px">
        <li>Accidental CSS changes</li>
        <li>Font rendering issues</li>
        <li>Layout shifts</li>
        <li>Color palette changes</li>
        <li>Component regressions</li>
      </ul>
    </div>
    <div class="card error-left">
      <h3 style="margin-top:0">‚ùå Limitations</h3>
      <ul style="color:var(--text2);font-size:0.85rem;line-height:1.9;padding-left:18px">
        <li>Flaky with dynamic content</li>
        <li>Can't test functionality</li>
        <li>Requires snapshot updates</li>
        <li>OS/font rendering differs</li>
        <li>Large image storage needs</li>
      </ul>
    </div>
  </div>

  <h2>üé≠ Playwright Visual Testing</h2>
  <div class="code-block">
    <div class="code-header"><span>visual.spec.ts ‚Äî Screenshot comparison</span></div>
    <pre><span class="kw">import</span> { test, expect } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

<span class="fn">test</span>(<span class="str">'homepage looks correct'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/'</span>);

  <span class="cm">// Full page screenshot comparison</span>
  <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="str">'homepage.png'</span>);
});

<span class="fn">test</span>(<span class="str">'button states look correct'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/components'</span>);

  <span class="cm">// Compare just a specific element!</span>
  <span class="kw">const</span> button = page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Submit'</span> });
  <span class="kw">await</span> <span class="fn">expect</span>(button).<span class="fn">toHaveScreenshot</span>(<span class="str">'submit-button.png'</span>);

  <span class="cm">// Test hover state</span>
  <span class="kw">await</span> button.<span class="fn">hover</span>();
  <span class="kw">await</span> <span class="fn">expect</span>(button).<span class="fn">toHaveScreenshot</span>(<span class="str">'submit-button-hover.png'</span>);
});

<span class="fn">test</span>(<span class="str">'allows small pixel differences'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/dashboard'</span>);

  <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="str">'dashboard.png'</span>, {
    maxDiffPixels: <span class="num">100</span>,          <span class="cm">// Allow 100 pixel diff</span>
    threshold: <span class="num">0.2</span>,              <span class="cm">// 20% color diff allowed</span>
    animations: <span class="str">'disabled'</span>,     <span class="cm">// Disable animations!</span>
    mask: [page.<span class="fn">getByTestId</span>(<span class="str">'timestamp'</span>)], <span class="cm">// Mask dynamic content</span>
  });
});</pre>
  </div>

  <div class="code-block">
    <div class="code-header"><span>Update snapshots when design changes intentionally</span></div>
    <pre><span class="cm"># First run ‚Äî creates baseline images</span>
npx playwright test --update-snapshots

<span class="cm"># Normal run ‚Äî compares against baseline</span>
npx playwright test

<span class="cm"># View the visual diff report</span>
npx playwright show-report</pre>
  </div>

  <h2>üé® Storybook + Chromatic</h2>
  <div class="card info-left">
    <p><strong>Chromatic</strong> is the industry-standard tool for visual testing of component libraries. It integrates with Storybook and provides a UI for reviewing visual diffs in PRs.</p>
  </div>
  <div class="code-block">
    <div class="code-header"><span>Chromatic CI integration</span></div>
    <pre><span class="cm"># Install</span>
npm install --save-dev chromatic

<span class="cm"># Run visual tests (also publishes Storybook)</span>
npx chromatic --project-token=YOUR_TOKEN

<span class="cm"># In CI (GitHub Actions):</span>
<span class="cm"># - Chromatic compares against your main branch</span>
<span class="cm"># - PRs get a visual diff review UI</span>
<span class="cm"># - Reviewers approve/deny visual changes</span></pre>
  </div>

  <h2>Percy / BackstopJS</h2>
  <div class="code-block">
    <div class="code-header"><span>backstop.json ‚Äî BackstopJS config</span></div>
    <pre>{
  <span class="str">"id"</span>: <span class="str">"my-app"</span>,
  <span class="str">"viewports"</span>: [
    { <span class="str">"label"</span>: <span class="str">"phone"</span>, <span class="str">"width"</span>: <span class="num">375</span>, <span class="str">"height"</span>: <span class="num">667</span> },
    { <span class="str">"label"</span>: <span class="str">"desktop"</span>, <span class="str">"width"</span>: <span class="num">1280</span>, <span class="str">"height"</span>: <span class="num">800</span> }
  ],
  <span class="str">"scenarios"</span>: [
    {
      <span class="str">"label"</span>: <span class="str">"Homepage"</span>,
      <span class="str">"url"</span>: <span class="str">"http://localhost:3000/"</span>,
      <span class="str">"delay"</span>: <span class="num">500</span>,
      <span class="str">"misMatchThreshold"</span>: <span class="num">0.1</span>  <span class="cm">// 0.1% pixel diff allowed</span>
    },
    {
      <span class="str">"label"</span>: <span class="str">"Login Page"</span>,
      <span class="str">"url"</span>: <span class="str">"http://localhost:3000/login"</span>
    }
  ]
}

<span class="cm"># Commands:</span>
<span class="cm">backstop reference  # Create baselines</span>
<span class="cm">backstop test       # Compare</span>
<span class="cm">backstop approve    # Accept new baselines</span></pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STRATEGY ‚ïê‚ïê -->
<section class="section" id="strategy">
  <h1>üó∫Ô∏è Test Strategies</h1>
  <p class="subtitle">How to think about testing ‚Äî what, when, and how much</p>

  <h2>Core Testing Philosophies</h2>
  <div class="strategy-cards">
    <div class="strategy-card">
      <div class="s-icon">üèõÔ∏è</div>
      <div class="s-title">Testing Pyramid</div>
      <div class="s-desc">Many unit, some integration, few E2E. Fast feedback, cheap to run.</div>
    </div>
    <div class="strategy-card">
      <div class="s-icon">üèÜ</div>
      <div class="s-title">Testing Trophy</div>
      <div class="s-desc">Kent C. Dodds approach. Heavy on integration, less on unit.</div>
    </div>
    <div class="strategy-card">
      <div class="s-icon">üçØ</div>
      <div class="s-title">Honeycomb</div>
      <div class="s-desc">Spotify model. Focus on service integration over unit or E2E.</div>
    </div>
    <div class="strategy-card">
      <div class="s-icon">üé≠</div>
      <div class="s-title">Test Ice Cream Cone</div>
      <div class="s-desc">Anti-pattern! Too many E2E, too few unit tests. Avoid this!</div>
    </div>
  </div>

  <h2>When to Use Each Test Type</h2>
  <table class="cheat-table">
    <tr>
      <th>Scenario</th>
      <th>Best Test Type</th>
      <th>Why</th>
    </tr>
    <tr>
      <td>Pure function logic</td>
      <td><span class="tag tag-green">Unit</span></td>
      <td>Fast, isolated, many edge cases</td>
    </tr>
    <tr>
      <td>API endpoint with DB</td>
      <td><span class="tag tag-purple">Integration</span></td>
      <td>Tests the real connection</td>
    </tr>
    <tr>
      <td>Critical user journeys</td>
      <td><span class="tag tag-red">E2E</span></td>
      <td>Simulates real user behavior</td>
    </tr>
    <tr>
      <td>UI component rendering</td>
      <td><span class="tag tag-yellow">Unit (RTL)</span></td>
      <td>Fast, component isolation</td>
    </tr>
    <tr>
      <td>Auth flows end-to-end</td>
      <td><span class="tag tag-red">E2E</span></td>
      <td>Too complex to mock completely</td>
    </tr>
    <tr>
      <td>External API integration</td>
      <td><span class="tag tag-purple">Integration</span></td>
      <td>With mocked external, real internal</td>
    </tr>
    <tr>
      <td>Design system components</td>
      <td><span class="tag tag-blue">Visual</span></td>
      <td>Catch visual regressions</td>
    </tr>
    <tr>
      <td>Microservice communication</td>
      <td><span class="tag tag-purple">Integration</span></td>
      <td>Contract testing</td>
    </tr>
  </table>

  <h2>üéØ Test Naming Strategy</h2>
  <div class="card success-left">
    <p>Good test names follow the <strong>"Given-When-Then"</strong> or <strong>"should [behavior] when [condition]"</strong> pattern:</p>
    <div class="code-block">
      <div class="code-header"><span>Good vs Bad test names</span></div>
      <pre><span class="cm">// ‚ùå BAD ‚Äî Vague, doesn't say what's expected</span>
<span class="fn">it</span>(<span class="str">'tests login'</span>, ...);
<span class="fn">it</span>(<span class="str">'works correctly'</span>, ...);
<span class="fn">it</span>(<span class="str">'user stuff'</span>, ...);

<span class="cm">// ‚úÖ GOOD ‚Äî Clear, behavior-driven</span>
<span class="fn">it</span>(<span class="str">'redirects to dashboard after successful login'</span>, ...);
<span class="fn">it</span>(<span class="str">'shows validation error when email is invalid'</span>, ...);
<span class="fn">it</span>(<span class="str">'returns 429 when rate limit is exceeded'</span>, ...);

<span class="cm">// ‚úÖ ALSO GOOD ‚Äî Given/When/Then style</span>
<span class="fn">it</span>(<span class="str">'given an expired token, when accessing /profile, returns 401'</span>, ...);

<span class="cm">// Organize with describe blocks</span>
<span class="fn">describe</span>(<span class="str">'POST /api/cart'</span>, () => {
  <span class="fn">describe</span>(<span class="str">'when user is authenticated'</span>, () => {
    <span class="fn">it</span>(<span class="str">'adds item to cart'</span>, ...);
    <span class="fn">it</span>(<span class="str">'returns updated cart total'</span>, ...);
  });
  <span class="fn">describe</span>(<span class="str">'when user is not authenticated'</span>, () => {
    <span class="fn">it</span>(<span class="str">'returns 401'</span>, ...);
  });
});</pre>
    </div>
  </div>

  <h2>üîÑ CI/CD Test Strategy</h2>
  <div class="code-block">
    <div class="code-header"><span>.github/workflows/test.yml</span></div>
    <pre>name: Test Suite
on: [push, pull_request]

jobs:
  unit-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Unit Tests (fast)
        run: npm run test:unit
        <span class="cm"># Runs in ~30 seconds</span>

  integration-tests:
    needs: unit-tests
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:16
        env:
          POSTGRES_PASSWORD: test
    steps:
      - name: Integration Tests
        run: npm run test:integration
        <span class="cm"># Runs in ~2 minutes</span>

  e2e-tests:
    needs: integration-tests
    runs-on: ubuntu-latest
    steps:
      - name: Build app
        run: npm run build
      - name: E2E Tests (Playwright)
        run: npx playwright test
        <span class="cm"># Runs in ~10 minutes (parallelized)</span>
      - uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: playwright-report
          path: playwright-report/</pre>
  </div>

  <h2>üìä Code Coverage Strategy</h2>
  <div class="card warn-left">
    <h3 style="margin-top:0">‚ö†Ô∏è Coverage Myths</h3>
    <p style="font-size:0.85rem">100% coverage doesn't mean zero bugs. Coverage shows which <em>lines</em> ran, not whether your logic is <em>correct</em>. Aim for coverage on <strong>critical paths</strong>, not arbitrary percentages.</p>
  </div>

  <div class="code-block">
    <div class="code-header"><span>jest.config.js ‚Äî Sensible coverage thresholds</span></div>
    <pre><span class="kw">module.exports</span> = {
  collectCoverageFrom: [
    <span class="str">'src/**/*.{js,ts}'</span>,
    <span class="str">'!src/**/*.d.ts'</span>,
    <span class="str">'!src/types/**'</span>,
    <span class="str">'!src/**/index.ts'</span>,    <span class="cm">// Re-exports don't need testing</span>
    <span class="str">'!src/migrations/**'</span>,  <span class="cm">// Migration files excluded</span>
  ],
  coverageThresholds: {
    global: {
      branches: <span class="num">70</span>,     <span class="cm">// 70% is reasonable</span>
      functions: <span class="num">80</span>,
      lines: <span class="num">80</span>,
      statements: <span class="num">80</span>,
    },
    <span class="cm">// Critical files get higher thresholds!</span>
    <span class="str">'./src/payment/**'</span>: { lines: <span class="num">95</span> },
    <span class="str">'./src/auth/**'</span>: { lines: <span class="num">90</span> },
  },
};</pre>
  </div>

  <h2>ü§ù Contract Testing (Advanced)</h2>
  <div class="card accent-left">
    <p>Contract testing verifies that <strong>services agree on API shapes</strong> ‚Äî the consumer defines what it expects, the provider verifies it can satisfy those expectations.</p>
    <p style="font-size:0.85rem">Tools: <strong>Pact</strong>, <strong>Spring Cloud Contract</strong></p>
    <div class="code-block">
      <div class="code-header"><span>Pact ‚Äî Consumer-driven contract testing</span></div>
      <pre><span class="cm">// Consumer (frontend) defines what it expects:</span>
<span class="kw">const</span> interaction = {
  state: <span class="str">'user 1 exists'</span>,
  uponReceiving: <span class="str">'a request for user 1'</span>,
  withRequest: { method: <span class="str">'GET'</span>, path: <span class="str">'/users/1'</span> },
  willRespondWith: {
    status: <span class="num">200</span>,
    body: {
      id: like(<span class="num">1</span>),
      name: like(<span class="str">'string'</span>),
      email: term({ matcher: <span class="str">'.+@.+\\..+'</span>, generate: <span class="str">'u@t.com'</span> }),
    },
  },
};

<span class="cm">// Provider (API) verifies it can satisfy the contract</span>
<span class="cm">// Run in CI ‚Äî ensures both sides always agree!</span></pre>
      </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXAMPLES ‚ïê‚ïê -->
<section class="section" id="examples">
  <h1>üíª Real-World Examples</h1>
  <p class="subtitle">Production-grade patterns used at top companies</p>

  <h2>Example 1: Testing an E-commerce Checkout</h2>
  <div class="code-block">
    <div class="code-header"><span>checkout.integration.test.js ‚Äî Full checkout flow</span></div>
    <pre><span class="fn">describe</span>(<span class="str">'Checkout Service Integration'</span>, () => {
  <span class="kw">let</span> user, product, cart;

  <span class="fn">beforeEach</span>(<span class="kw">async</span> () => {
    <span class="cm">// Seed test data using factories</span>
    user = <span class="kw">await</span> <span class="fn">userFactory</span>({ balance: <span class="num">100</span> });
    product = <span class="kw">await</span> <span class="fn">productFactory</span>({ price: <span class="num">29.99</span>, stock: <span class="num">10</span> });
    cart = <span class="kw">await</span> <span class="fn">cartFactory</span>({ userId: user.id, items: [product] });
  });

  <span class="fn">it</span>(<span class="str">'decrements stock on successful checkout'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/checkout'</span>)
      .<span class="fn">set</span>(<span class="str">'Authorization'</span>, <span class="fn">authToken</span>(user))
      .<span class="fn">send</span>({ cartId: cart.id });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">201</span>);

    <span class="cm">// Verify stock was actually decremented in DB</span>
    <span class="kw">const</span> updated = <span class="kw">await</span> Product.<span class="fn">findById</span>(product.id);
    <span class="fn">expect</span>(updated.stock).<span class="fn">toBe</span>(<span class="num">9</span>); <span class="cm">// Was 10, now 9</span>
  });

  <span class="fn">it</span>(<span class="str">'prevents double-checkout (idempotency)'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> idempotencyKey = <span class="str">'unique-key-123'</span>;

    <span class="cm">// First checkout succeeds</span>
    <span class="kw">const</span> res1 = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/checkout'</span>)
      .<span class="fn">set</span>(<span class="str">'Idempotency-Key'</span>, idempotencyKey)
      .<span class="fn">send</span>({ cartId: cart.id });

    <span class="cm">// Second with same key returns same order, no double charge</span>
    <span class="kw">const</span> res2 = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/checkout'</span>)
      .<span class="fn">set</span>(<span class="str">'Idempotency-Key'</span>, idempotencyKey)
      .<span class="fn">send</span>({ cartId: cart.id });

    <span class="fn">expect</span>(res2.body.orderId).<span class="fn">toBe</span>(res1.body.orderId);

    <span class="cm">// Stock only went down by 1, not 2</span>
    <span class="kw">const</span> updated = <span class="kw">await</span> Product.<span class="fn">findById</span>(product.id);
    <span class="fn">expect</span>(updated.stock).<span class="fn">toBe</span>(<span class="num">9</span>);
  });

  <span class="fn">it</span>(<span class="str">'rolls back on payment failure'</span>, <span class="kw">async</span> () => {
    <span class="cm">// Mock payment service to fail</span>
    jest.<span class="fn">spyOn</span>(paymentService, <span class="str">'charge'</span>).<span class="fn">mockRejectedValue</span>(
      <span class="kw">new</span> <span class="cls">PaymentError</span>(<span class="str">'Card declined'</span>)
    );

    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/checkout'</span>)
      .<span class="fn">send</span>({ cartId: cart.id });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">402</span>);

    <span class="cm">// Stock should NOT have changed (transaction rolled back)</span>
    <span class="kw">const</span> updated = <span class="kw">await</span> Product.<span class="fn">findById</span>(product.id);
    <span class="fn">expect</span>(updated.stock).<span class="fn">toBe</span>(<span class="num">10</span>); <span class="cm">// Still 10!</span>
  });
});</pre>
  </div>

  <h2>Example 2: Playwright E2E ‚Äî SaaS Onboarding</h2>
  <div class="code-block">
    <div class="code-header"><span>e2e/onboarding.spec.ts</span></div>
    <pre>test.<span class="fn">describe</span>(<span class="str">'New User Onboarding'</span>, () => {
  test(<span class="str">'complete onboarding creates workspace'</span>, <span class="kw">async</span> ({ page }) => {
    <span class="cm">// Use API to create user (faster than UI signup)</span>
    <span class="kw">const</span> { token } = <span class="kw">await</span> <span class="fn">createTestUser</span>();
    <span class="kw">await</span> page.context().<span class="fn">addCookies</span>([
      { name: <span class="str">'auth-token'</span>, value: token, domain: <span class="str">'localhost'</span> }
    ]);

    <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/onboarding'</span>);

    <span class="cm">// Step 1: Workspace name</span>
    <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Workspace Name'</span>).<span class="fn">fill</span>(<span class="str">'Acme Corp'</span>);
    <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Continue'</span> }).<span class="fn">click</span>();

    <span class="cm">// Step 2: Invite team members</span>
    <span class="kw">await</span> page.<span class="fn">getByLabel</span>(<span class="str">'Email'</span>).<span class="fn">fill</span>(<span class="str">'colleague@acme.com'</span>);
    <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Send Invite'</span> }).<span class="fn">click</span>();
    <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="str">'Invite sent'</span>)).<span class="fn">toBeVisible</span>();
    <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Skip for now'</span> }).<span class="fn">click</span>();

    <span class="cm">// Step 3: Choose plan</span>
    <span class="kw">await</span> page.<span class="fn">getByTestId</span>(<span class="str">'plan-pro'</span>).<span class="fn">click</span>();
    <span class="kw">await</span> page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Get Started'</span> }).<span class="fn">click</span>();

    <span class="cm">// Verify redirect to dashboard</span>
    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="str">'/dashboard'</span>);
    <span class="kw">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="str">'Welcome to Acme Corp'</span>)).<span class="fn">toBeVisible</span>();

    <span class="cm">// Visual regression ‚Äî ensure dashboard looks right</span>
    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="str">'new-dashboard.png'</span>, {
      mask: [page.<span class="fn">getByTestId</span>(<span class="str">'user-avatar'</span>)],
    });
  });
});</pre>
  </div>

  <h2>Example 3: Testing WebSockets</h2>
  <div class="code-block">
    <div class="code-header"><span>websocket.e2e.spec.ts ‚Äî Real-time features</span></div>
    <pre><span class="fn">test</span>(<span class="str">'real-time chat works between two users'</span>, <span class="kw">async</span> ({ browser }) => {
  <span class="cm">// Create TWO browser contexts (two users)</span>
  <span class="kw">const</span> userA = <span class="kw">await</span> browser.<span class="fn">newPage</span>();
  <span class="kw">const</span> userB = <span class="kw">await</span> browser.<span class="fn">newPage</span>();

  <span class="kw">await</span> userA.<span class="fn">goto</span>(<span class="str">'/chat/room-1'</span>);
  <span class="kw">await</span> userB.<span class="fn">goto</span>(<span class="str">'/chat/room-1'</span>);

  <span class="cm">// User A sends a message</span>
  <span class="kw">await</span> userA.<span class="fn">getByPlaceholder</span>(<span class="str">'Type a message'</span>).<span class="fn">fill</span>(<span class="str">'Hello!'</span>);
  <span class="kw">await</span> userA.<span class="fn">keyboard</span>.<span class="fn">press</span>(<span class="str">'Enter'</span>);

  <span class="cm">// User B receives it in real-time!</span>
  <span class="kw">await</span> <span class="fn">expect</span>(userB.<span class="fn">getByText</span>(<span class="str">'Hello!'</span>)).<span class="fn">toBeVisible</span>({ timeout: <span class="num">5000</span> });

  <span class="kw">await</span> userA.<span class="fn">close</span>();
  <span class="kw">await</span> userB.<span class="fn">close</span>();
});</pre>
  </div>

  <h2>Example 4: Database Transaction Testing</h2>
  <div class="code-block">
    <div class="code-header"><span>transaction.test.js ‚Äî Ensuring atomicity</span></div>
    <pre><span class="fn">describe</span>(<span class="str">'Money Transfer'</span>, () => {
  <span class="fn">it</span>(<span class="str">'transfers money atomically'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> alice = <span class="kw">await</span> <span class="fn">createAccount</span>({ balance: <span class="num">1000</span> });
    <span class="kw">const</span> bob = <span class="kw">await</span> <span class="fn">createAccount</span>({ balance: <span class="num">500</span> });

    <span class="kw">await</span> <span class="fn">transferService</span>(alice.id, bob.id, <span class="num">200</span>);

    <span class="kw">const</span> [updatedAlice, updatedBob] = <span class="kw">await</span> Promise.<span class="fn">all</span>([
      Account.<span class="fn">findById</span>(alice.id),
      Account.<span class="fn">findById</span>(bob.id),
    ]);

    <span class="fn">expect</span>(updatedAlice.balance).<span class="fn">toBe</span>(<span class="num">800</span>);
    <span class="fn">expect</span>(updatedBob.balance).<span class="fn">toBe</span>(<span class="num">700</span>);

    <span class="cm">// Total money in system is unchanged!</span>
    <span class="fn">expect</span>(updatedAlice.balance + updatedBob.balance).<span class="fn">toBe</span>(<span class="num">1500</span>);
  });

  <span class="fn">it</span>(<span class="str">'rolls back if recipient account is frozen'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> alice = <span class="kw">await</span> <span class="fn">createAccount</span>({ balance: <span class="num">1000</span> });
    <span class="kw">const</span> frozen = <span class="kw">await</span> <span class="fn">createAccount</span>({ balance: <span class="num">500</span>, frozen: <span class="kw">true</span> });

    <span class="kw">await</span> <span class="fn">expect</span>(<span class="fn">transferService</span>(alice.id, frozen.id, <span class="num">200</span>))
      .<span class="fn">rejects</span>.<span class="fn">toThrow</span>(<span class="str">'Account is frozen'</span>);

    <span class="cm">// Alice's balance should be unchanged!</span>
    <span class="kw">const</span> updatedAlice = <span class="kw">await</span> Account.<span class="fn">findById</span>(alice.id);
    <span class="fn">expect</span>(updatedAlice.balance).<span class="fn">toBe</span>(<span class="num">1000</span>);
  });
});</pre>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXERCISES ‚ïê‚ïê -->
<section class="section" id="exercises">
  <h1>üèãÔ∏è Practice Exercises</h1>
  <p class="subtitle">Write the code ‚Äî think before revealing the answer</p>

  <div class="exercise">
    <div class="ex-header">
      <div class="ex-title">Exercise 1: Integration Test for User Registration</div>
      <span class="diff-badge diff-easy">Easy</span>
    </div>
    <div class="ex-desc">
      Write an integration test for <code>POST /api/register</code> that:
      <br>1. Successfully creates a user and returns 201 with the user object (no password)
      <br>2. Returns 400 if email is missing
      <br>3. Returns 409 if email already exists
      <br>Use Supertest + Jest pattern.
    </div>
    <textarea id="ex1" placeholder="Write your integration test here..." rows="14"></textarea>
    <div class="btn-row">
      <button class="btn btn-primary" onclick="checkEx(1)">Check Answer</button>
      <button class="btn btn-outline" onclick="showSolution(1)">Show Solution</button>
    </div>
    <div class="output-box" id="ex1-out"></div>
    <div class="code-block" id="ex1-sol" style="display:none">
      <div class="code-header"><span>Solution</span></div>
      <pre><span class="fn">describe</span>(<span class="str">'POST /api/register'</span>, () => {
  <span class="fn">afterEach</span>(<span class="kw">async</span> () => {
    <span class="kw">await</span> db.<span class="fn">truncate</span>([<span class="str">'users'</span>]);
  });

  <span class="fn">it</span>(<span class="str">'creates user and returns 201 without password'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/register'</span>)
      .<span class="fn">send</span>({ name: <span class="str">'Alice'</span>, email: <span class="str">'alice@test.com'</span>, password: <span class="str">'secret'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">201</span>);
    <span class="fn">expect</span>(res.body.email).<span class="fn">toBe</span>(<span class="str">'alice@test.com'</span>);
    <span class="fn">expect</span>(res.body.password).<span class="fn">toBeUndefined</span>(); <span class="cm">// NEVER expose password!</span>
  });

  <span class="fn">it</span>(<span class="str">'returns 400 when email is missing'</span>, <span class="kw">async</span> () => {
    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/register'</span>)
      .<span class="fn">send</span>({ name: <span class="str">'Alice'</span>, password: <span class="str">'secret'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">400</span>);
    <span class="fn">expect</span>(res.body.error).<span class="fn">toMatch</span>(<span class="str">/email/i</span>);
  });

  <span class="fn">it</span>(<span class="str">'returns 409 when email already exists'</span>, <span class="kw">async</span> () => {
    <span class="kw">await</span> <span class="fn">userFactory</span>({ email: <span class="str">'alice@test.com'</span> });

    <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="str">'/api/register'</span>)
      .<span class="fn">send</span>({ name: <span class="str">'Alice2'</span>, email: <span class="str">'alice@test.com'</span>, password: <span class="str">'test'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">409</span>);
  });
});</pre>
    </div>
  </div>

  <div class="exercise">
    <div class="ex-header">
      <div class="ex-title">Exercise 2: Playwright E2E ‚Äî Search Feature</div>
      <span class="diff-badge diff-medium">Medium</span>
    </div>
    <div class="ex-desc">
      Write a Playwright test that:
      <br>1. Navigates to <code>/products</code>
      <br>2. Types "laptop" in the search bar (testid: "search-input")
      <br>3. Waits for results to load
      <br>4. Asserts at least one result contains "laptop" (case-insensitive)
      <br>5. Clears the search and asserts all products are shown
    </div>
    <textarea id="ex2" placeholder="Write your Playwright test here..." rows="14"></textarea>
    <div class="btn-row">
      <button class="btn btn-primary" onclick="checkEx(2)">Check Answer</button>
      <button class="btn btn-outline" onclick="showSolution(2)">Show Solution</button>
    </div>
    <div class="output-box" id="ex2-out"></div>
    <div class="code-block" id="ex2-sol" style="display:none">
      <div class="code-header"><span>Solution</span></div>
      <pre><span class="fn">test</span>(<span class="str">'search filters products correctly'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/products'</span>);

  <span class="cm">// Count all products initially</span>
  <span class="kw">const</span> allProducts = page.<span class="fn">getByTestId</span>(<span class="str">'product-card'</span>);
  <span class="kw">const</span> totalCount = <span class="kw">await</span> allProducts.<span class="fn">count</span>();

  <span class="cm">// Search for laptop</span>
  <span class="kw">const</span> searchInput = page.<span class="fn">getByTestId</span>(<span class="str">'search-input'</span>);
  <span class="kw">await</span> searchInput.<span class="fn">fill</span>(<span class="str">'laptop'</span>);

  <span class="cm">// Wait for results to update</span>
  <span class="kw">await</span> page.<span class="fn">waitForResponse</span>(res => res.url().<span class="fn">includes</span>(<span class="str">'/api/products'</span>));

  <span class="cm">// Assert at least one result with "laptop"</span>
  <span class="kw">const</span> results = page.<span class="fn">getByTestId</span>(<span class="str">'product-card'</span>);
  <span class="kw">await</span> <span class="fn">expect</span>(results.<span class="fn">first</span>()).<span class="fn">toContainText</span>(<span class="str">/laptop/i</span>);

  <span class="cm">// Clear search</span>
  <span class="kw">await</span> searchInput.<span class="fn">clear</span>();

  <span class="cm">// All products should be shown again</span>
  <span class="kw">await</span> <span class="fn">expect</span>(results).<span class="fn">toHaveCount</span>(totalCount);
});</pre>
    </div>
  </div>

  <div class="exercise">
    <div class="ex-header">
      <div class="ex-title">Exercise 3: Page Object Model</div>
      <span class="diff-badge diff-medium">Medium</span>
    </div>
    <div class="ex-desc">
      Create a <strong>CheckoutPage</strong> Page Object Model class for Playwright with methods:
      <br>‚Ä¢ <code>fillCardDetails(number, expiry, cvv)</code>
      <br>‚Ä¢ <code>placeOrder()</code>
      <br>‚Ä¢ <code>expectSuccess()</code>
      <br>‚Ä¢ <code>expectError(message)</code>
      <br>Then write a test using it.
    </div>
    <textarea id="ex3" placeholder="Write your Page Object Model here..." rows="18"></textarea>
    <div class="btn-row">
      <button class="btn btn-primary" onclick="checkEx(3)">Check Answer</button>
      <button class="btn btn-outline" onclick="showSolution(3)">Show Solution</button>
    </div>
    <div class="output-box" id="ex3-out"></div>
    <div class="code-block" id="ex3-sol" style="display:none">
      <div class="code-header"><span>Solution</span></div>
      <pre><span class="kw">import</span> { type Page, expect } <span class="kw">from</span> <span class="str">'@playwright/test'</span>;

<span class="kw">class</span> <span class="cls">CheckoutPage</span> {
  <span class="kw">private</span> page: Page;

  <span class="kw">constructor</span>(page: Page) {
    <span class="kw">this</span>.page = page;
  }

  <span class="kw">async</span> <span class="fn">fillCardDetails</span>(number: <span class="kw">string</span>, expiry: <span class="kw">string</span>, cvv: <span class="kw">string</span>) {
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByLabel</span>(<span class="str">'Card Number'</span>).<span class="fn">fill</span>(number);
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByLabel</span>(<span class="str">'Expiry Date'</span>).<span class="fn">fill</span>(expiry);
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByLabel</span>(<span class="str">'CVV'</span>).<span class="fn">fill</span>(cvv);
  }

  <span class="kw">async</span> <span class="fn">placeOrder</span>() {
    <span class="kw">await</span> <span class="kw">this</span>.page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Place Order'</span> }).<span class="fn">click</span>();
  }

  <span class="kw">async</span> <span class="fn">expectSuccess</span>() {
    <span class="kw">await</span> <span class="fn">expect</span>(<span class="kw">this</span>.page.<span class="fn">getByRole</span>(<span class="str">'heading'</span>, { name: <span class="str">'Order Confirmed'</span> }))
      .<span class="fn">toBeVisible</span>();
    <span class="kw">await</span> <span class="fn">expect</span>(<span class="kw">this</span>.page.<span class="fn">getByTestId</span>(<span class="str">'order-id'</span>)).<span class="fn">toBeVisible</span>();
  }

  <span class="kw">async</span> <span class="fn">expectError</span>(message: <span class="kw">string</span>) {
    <span class="kw">await</span> <span class="fn">expect</span>(<span class="kw">this</span>.page.<span class="fn">getByRole</span>(<span class="str">'alert'</span>))
      .<span class="fn">toContainText</span>(message);
  }
}

<span class="cm">// Test using the Page Object</span>
<span class="fn">test</span>(<span class="str">'successful payment'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/checkout'</span>);
  <span class="kw">const</span> checkout = <span class="kw">new</span> <span class="cls">CheckoutPage</span>(page);

  <span class="kw">await</span> checkout.<span class="fn">fillCardDetails</span>(<span class="str">'4242 4242 4242 4242'</span>, <span class="str">'12/28'</span>, <span class="str">'123'</span>);
  <span class="kw">await</span> checkout.<span class="fn">placeOrder</span>();
  <span class="kw">await</span> checkout.<span class="fn">expectSuccess</span>();
});

<span class="fn">test</span>(<span class="str">'declined card shows error'</span>, <span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/checkout'</span>);
  <span class="kw">const</span> checkout = <span class="kw">new</span> <span class="cls">CheckoutPage</span>(page);

  <span class="kw">await</span> checkout.<span class="fn">fillCardDetails</span>(<span class="str">'4000 0000 0000 0002'</span>, <span class="str">'12/28'</span>, <span class="str">'123'</span>);
  <span class="kw">await</span> checkout.<span class="fn">placeOrder</span>();
  <span class="kw">await</span> checkout.<span class="fn">expectError</span>(<span class="str">'Card declined'</span>);
});</pre>
    </div>
  </div>

  <div class="exercise">
    <div class="ex-header">
      <div class="ex-title">Exercise 4: Visual Regression ‚Äî Handle Dynamic Content</div>
      <span class="diff-badge diff-hard">Hard</span>
    </div>
    <div class="ex-desc">
      Write a Playwright visual regression test for a dashboard page that has:
      <br>‚Ä¢ Dynamic timestamps (must be masked)
      <br>‚Ä¢ User avatar (must be masked)
      <br>‚Ä¢ An animated counter (animations must be disabled)
      <br>‚Ä¢ Different viewports (desktop + mobile)
      <br>Use <code>toHaveScreenshot</code> with appropriate options.
    </div>
    <textarea id="ex4" placeholder="Write your visual regression test here..." rows="14"></textarea>
    <div class="btn-row">
      <button class="btn btn-primary" onclick="checkEx(4)">Check Answer</button>
      <button class="btn btn-outline" onclick="showSolution(4)">Show Solution</button>
    </div>
    <div class="output-box" id="ex4-out"></div>
    <div class="code-block" id="ex4-sol" style="display:none">
      <div class="code-header"><span>Solution</span></div>
      <pre>test.<span class="fn">describe</span>(<span class="str">'Dashboard Visual Regression'</span>, () => {
  <span class="fn">test</span>(<span class="str">'desktop view'</span>, <span class="kw">async</span> ({ page }) => {
    <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/dashboard'</span>);

    <span class="cm">// Wait for all data to load before screenshotting</span>
    <span class="kw">await</span> page.<span class="fn">waitForSelector</span>(<span class="str">'[data-testid="stats-loaded"]'</span>);

    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="str">'dashboard-desktop.png'</span>, {
      animations: <span class="str">'disabled'</span>,  <span class="cm">// Freeze animations</span>
      mask: [
        page.<span class="fn">getByTestId</span>(<span class="str">'timestamp'</span>),      <span class="cm">// Dynamic text</span>
        page.<span class="fn">getByTestId</span>(<span class="str">'user-avatar'</span>),    <span class="cm">// User-specific</span>
        page.<span class="fn">getByTestId</span>(<span class="str">'live-counter'</span>),   <span class="cm">// Animated counter</span>
      ],
      maxDiffPixels: <span class="num">50</span>,
    });
  });

  <span class="fn">test</span>(<span class="str">'mobile view'</span>, <span class="kw">async</span> ({ browser }) => {
    <span class="kw">const</span> context = <span class="kw">await</span> browser.<span class="fn">newContext</span>({
      viewport: { width: <span class="num">375</span>, height: <span class="num">812</span> },  <span class="cm">// iPhone</span>
      deviceScaleFactor: <span class="num">2</span>,                       <span class="cm">// Retina</span>
    });
    <span class="kw">const</span> page = <span class="kw">await</span> context.<span class="fn">newPage</span>();
    <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/dashboard'</span>);

    <span class="kw">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="str">'dashboard-mobile.png'</span>, {
      animations: <span class="str">'disabled'</span>,
      mask: [
        page.<span class="fn">getByTestId</span>(<span class="str">'timestamp'</span>),
        page.<span class="fn">getByTestId</span>(<span class="str">'user-avatar'</span>),
      ],
    });

    <span class="kw">await</span> context.<span class="fn">close</span>();
  });
});</pre>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PITFALLS ‚ïê‚ïê -->
<section class="section" id="pitfalls">
  <h1>‚ö†Ô∏è Pitfalls & Mistakes to Avoid</h1>
  <p class="subtitle">Learn from common mistakes before they cost you in production or interviews</p>

  <h2>üî• Critical Mistakes</h2>

  <div class="pitfall">
    <div class="pitfall-icon">üíÄ</div>
    <div class="pitfall-body">
      <h4>Test State Pollution ‚Äî Most Common Bug</h4>
      <p>Not cleaning up database state between tests causes tests to pass/fail based on execution order. Always truncate tables in <code>afterEach</code>, not <code>afterAll</code>.</p>
    </div>
  </div>
  <div class="code-block">
    <div class="code-header"><span>‚ùå Wrong vs ‚úÖ Right</span></div>
    <pre><span class="cm">// ‚ùå WRONG ‚Äî cleanup only at the end</span>
<span class="fn">afterAll</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">truncate</span>(); <span class="cm">// Too late! Tests already contaminated each other</span>
});

<span class="cm">// ‚úÖ RIGHT ‚Äî cleanup after EACH test</span>
<span class="fn">afterEach</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">truncate</span>([<span class="str">'users'</span>, <span class="str">'orders'</span>]);
});

<span class="cm">// ‚úÖ ALSO GOOD ‚Äî wrap each test in a transaction and rollback</span>
<span class="fn">beforeEach</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">query</span>(<span class="str">'BEGIN'</span>);
});
<span class="fn">afterEach</span>(<span class="kw">async</span> () => {
  <span class="kw">await</span> db.<span class="fn">query</span>(<span class="str">'ROLLBACK'</span>); <span class="cm">// Nothing persists!</span>
});</pre>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">‚è±Ô∏è</div>
    <div class="pitfall-body">
      <h4>Hardcoded Timeouts in E2E Tests</h4>
      <p>Using <code>page.waitForTimeout(2000)</code> creates flaky tests. They're too slow on fast machines and too short on slow CI servers. Always use auto-waits or wait for specific conditions.</p>
    </div>
  </div>
  <div class="code-block">
    <div class="code-header"><span>‚ùå Flaky timeouts vs ‚úÖ Smart waits</span></div>
    <pre><span class="cm">// ‚ùå WRONG ‚Äî arbitrary timeout</span>
<span class="kw">await</span> page.<span class="fn">waitForTimeout</span>(<span class="num">2000</span>); <span class="cm">// "sleep" ‚Äî NEVER do this</span>
<span class="kw">await</span> page.<span class="fn">click</span>(<span class="str">'#submit'</span>);

<span class="cm">// ‚úÖ RIGHT ‚Äî wait for specific conditions</span>
<span class="kw">await</span> page.<span class="fn">waitForURL</span>(<span class="str">'/dashboard'</span>);              <span class="cm">// URL changed</span>
<span class="kw">await</span> page.<span class="fn">waitForSelector</span>(<span class="str">'[data-loaded]'</span>);       <span class="cm">// Element appears</span>
<span class="kw">await</span> page.<span class="fn">waitForResponse</span>(<span class="str">'**/api/data'</span>);         <span class="cm">// API call completes</span>
<span class="kw">await</span> <span class="fn">expect</span>(element).<span class="fn">toBeVisible</span>();              <span class="cm">// Playwright auto-waits!</span>

<span class="cm">// ‚úÖ Cypress equivalent</span>
cy.<span class="fn">intercept</span>(<span class="str">'POST'</span>, <span class="str">'/api/submit'</span>).<span class="kw">as</span>(<span class="str">'submitCall'</span>);
cy.<span class="fn">get</span>(<span class="str">'#submit'</span>).<span class="fn">click</span>();
cy.<span class="fn">wait</span>(<span class="str">'@submitCall'</span>); <span class="cm">// Wait for SPECIFIC network call</span></pre>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">üîê</div>
    <div class="pitfall-body">
      <h4>Logging In Via UI in Every E2E Test</h4>
      <p>If every test navigates to /login and fills a form, your suite becomes 10x slower. Login via API or use saved auth state.</p>
    </div>
  </div>
  <div class="code-block">
    <div class="code-header"><span>‚ùå UI Login vs ‚úÖ API Login</span></div>
    <pre><span class="cm">// ‚ùå SLOW ‚Äî login UI in every test (takes ~3s per test)</span>
<span class="fn">beforeEach</span>(<span class="kw">async</span> ({ page }) => {
  <span class="kw">await</span> page.<span class="fn">goto</span>(<span class="str">'/login'</span>);
  <span class="kw">await</span> page.<span class="fn">fill</span>(<span class="str">'#email'</span>, <span class="str">'user@test.com'</span>);
  <span class="kw">await</span> page.<span class="fn">fill</span>(<span class="str">'#password'</span>, <span class="str">'secret'</span>);
  <span class="kw">await</span> page.<span class="fn">click</span>(<span class="str">'#submit'</span>);
});

<span class="cm">// ‚úÖ FAST ‚Äî login via API, reuse session</span>
<span class="fn">test</span>.<span class="fn">use</span>({ storageState: <span class="str">'auth/user.json'</span> });  <span class="cm">// Pre-saved login!</span>

<span class="cm">// Or with Cypress cy.session():</span>
<span class="fn">beforeEach</span>(() => {
  cy.<span class="fn">session</span>(<span class="str">'user'</span>, () => {       <span class="cm">// Cached across tests!</span>
    cy.<span class="fn">request</span>(<span class="str">'POST'</span>, <span class="str">'/api/login'</span>, { email: <span class="str">'u@t.com'</span>, password: <span class="str">'s'</span> });
  });
});</pre>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">üîç</div>
    <div class="pitfall-body">
      <h4>Using CSS Selectors / XPath in E2E Tests</h4>
      <p>CSS class selectors like <code>.btn-primary-v2</code> break when styles change. XPath is fragile. Use semantic selectors that reflect how users interact with your app.</p>
    </div>
  </div>
  <div class="code-block">
    <div class="code-header"><span>Selector priority guide</span></div>
    <pre><span class="cm">// ‚ùå FRAGILE ‚Äî breaks on refactor</span>
page.<span class="fn">locator</span>(<span class="str">'.sidebar > div:nth-child(2) > button'</span>)
page.<span class="fn">locator</span>(<span class="str">'#btn-submit-v3'</span>)
page.<span class="fn">locator</span>(<span class="str">'xpath=//div[@class="modal"]/button'</span>)

<span class="cm">// ‚úÖ BEST ‚Äî role-based (what users see)</span>
page.<span class="fn">getByRole</span>(<span class="str">'button'</span>, { name: <span class="str">'Submit Order'</span> })
page.<span class="fn">getByRole</span>(<span class="str">'link'</span>, { name: <span class="str">'Home'</span> })
page.<span class="fn">getByLabel</span>(<span class="str">'Email Address'</span>)

<span class="cm">// ‚úÖ GOOD ‚Äî explicit test IDs (stable but less semantic)</span>
page.<span class="fn">getByTestId</span>(<span class="str">'submit-button'</span>)  <span class="cm">// data-testid="submit-button"</span>

<span class="cm">// ‚úÖ GOOD ‚Äî text content</span>
page.<span class="fn">getByText</span>(<span class="str">'Order confirmed'</span>)
page.<span class="fn">getByPlaceholder</span>(<span class="str">'Enter your email'</span>)

<span class="cm">// Priority: role > testId > text > CSS</span></pre>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">üé≠</div>
    <div class="pitfall-body">
      <h4>Over-Mocking in Integration Tests</h4>
      <p>If you mock the database in an "integration" test, you're just writing a unit test. Integration tests should test the real connections you care about.</p>
    </div>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">üì∏</div>
    <div class="pitfall-body">
      <h4>Committing Visual Snapshots Without Review</h4>
      <p>If you blindly run <code>--update-snapshots</code> without reviewing diffs, you defeat the purpose of visual testing. Always look at snapshot diffs in PRs before approving.</p>
    </div>
  </div>

  <div class="pitfall">
    <div class="pitfall-icon">üîÑ</div>
    <div class="pitfall-body">
      <h4>Tests That Depend on Each Other</h4>
      <p>Test A should not rely on Test B running first. Each test must be fully independent and run in any order.</p>
    </div>
  </div>
  <div class="code-block">
    <div class="code-header"><span>‚ùå Order-dependent vs ‚úÖ Independent</span></div>
    <pre><span class="cm">// ‚ùå WRONG ‚Äî test 2 depends on test 1 creating data</span>
<span class="fn">it</span>(<span class="str">'creates user'</span>, () => { <span class="cm">/* creates user with id 1 */</span> });
<span class="fn">it</span>(<span class="str">'fetches user 1'</span>, () => { <span class="cm">/* assumes user 1 exists from above! */</span> });

<span class="cm">// ‚úÖ RIGHT ‚Äî each test seeds its own data</span>
<span class="fn">it</span>(<span class="str">'creates user'</span>, <span class="kw">async</span> () => {
  <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app).<span class="fn">post</span>(<span class="str">'/users'</span>).<span class="fn">send</span>({...});
  <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">201</span>);
});
<span class="fn">it</span>(<span class="str">'fetches a user'</span>, <span class="kw">async</span> () => {
  <span class="kw">const</span> user = <span class="kw">await</span> <span class="fn">createUser</span>(); <span class="cm">// Seeds its own user</span>
  <span class="kw">const</span> res = <span class="kw">await</span> <span class="fn">request</span>(app).<span class="fn">get</span>(`/users/${user.id}`);
  <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
});</pre>
  </div>

  <h2>üí° Pro Tips</h2>
  <div class="tip">
    <div class="tip-icon">üöÄ</div>
    <div class="tip-body">
      <h4>Test The Behavior, Not The Implementation</h4>
      <p>Tests should describe what your app does, not how it does it. If you refactor internals without changing behavior, tests should still pass.</p>
    </div>
  </div>
  <div class="tip">
    <div class="tip-icon">üéØ</div>
    <div class="tip-body">
      <h4>Use data-testid Sparingly</h4>
      <p>Prefer role-based selectors. Add <code>data-testid</code> only when semantic selectors aren't sufficient. Keep them in your code alongside your components.</p>
    </div>
  </div>
  <div class="tip">
    <div class="tip-icon">‚ö°</div>
    <div class="tip-body">
      <h4>Parallelize Tests Carefully</h4>
      <p>Unit tests can always run in parallel. Integration tests with a shared DB need isolation. Use separate DB schemas or transaction rollbacks for parallel integration tests.</p>
    </div>
  </div>
  <div class="tip">
    <div class="tip-icon">üîÑ</div>
    <div class="tip-body">
      <h4>Run E2E Tests Against Production-Like Environment</h4>
      <p>E2E tests should run against a staging environment with production data shape. "It works in dev" doesn't mean it works in prod.</p>
    </div>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUIZ ‚ïê‚ïê -->
<section class="section" id="quiz">
  <h1>üß© Quiz Time</h1>
  <p class="subtitle">Test your knowledge ‚Äî can you ace it all?</p>

  <div id="quiz-container"></div>
  <div class="quiz-score" id="quiz-score">
    <div class="score-num" id="score-display">0/0</div>
    <p style="color:var(--text2);margin-top:8px" id="score-msg">Complete the quiz!</p>
    <button class="btn btn-primary" style="margin-top:16px" onclick="resetQuiz()">‚Ü∫ Try Again</button>
  </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CHEATSHEET ‚ïê‚ïê -->
<section class="section" id="cheatsheet">
  <h1>üìã Ultimate Cheatsheet</h1>
  <p class="subtitle">Everything you need at a glance</p>

  <h2>üîó Integration Testing</h2>
  <table class="cheat-table">
    <tr><th>Concept</th><th>Code</th><th>Notes</th></tr>
    <tr><td>Supertest basic</td><td><code>request(app).get('/path')</code></td><td>No server needs to run</td></tr>
    <tr><td>Assert status</td><td><code>expect(res.status).toBe(200)</code></td><td>Always check status first</td></tr>
    <tr><td>Assert body</td><td><code>expect(res.body.name).toBe('Alice')</code></td><td>Check response shape</td></tr>
    <tr><td>Send JSON</td><td><code>.send({ key: value })</code></td><td>Auto sets Content-Type</td></tr>
    <tr><td>Set header</td><td><code>.set('Authorization', 'Bearer token')</code></td><td>For auth tests</td></tr>
    <tr><td>Cleanup</td><td><code>afterEach(() => db.truncate())</code></td><td>Always after each!</td></tr>
    <tr><td>Factory</td><td><code>const user = await userFactory()</code></td><td>DRY test data</td></tr>
    <tr><td>In-memory DB</td><td><code>new Database(':memory:')</code></td><td>SQLite for speed</td></tr>
    <tr><td>Real DB</td><td><code>new PostgreSqlContainer().start()</code></td><td>Testcontainers</td></tr>
  </table>

  <h2>üé≠ Playwright Cheatsheet</h2>
  <table class="cheat-table">
    <tr><th>Action</th><th>Code</th></tr>
    <tr><td>Navigate</td><td><code>await page.goto('/path')</code></td></tr>
    <tr><td>Click</td><td><code>await page.getByRole('button', { name: 'Submit' }).click()</code></td></tr>
    <tr><td>Fill input</td><td><code>await page.getByLabel('Email').fill('test@test.com')</code></td></tr>
    <tr><td>Assert visible</td><td><code>await expect(element).toBeVisible()</code></td></tr>
    <tr><td>Assert text</td><td><code>await expect(element).toHaveText('Hello')</code></td></tr>
    <tr><td>Assert URL</td><td><code>await expect(page).toHaveURL('/dashboard')</code></td></tr>
    <tr><td>Wait for API</td><td><code>await page.waitForResponse('**/api/data')</code></td></tr>
    <tr><td>Mock API</td><td><code>await page.route('**/api/**', route => route.fulfill({...}))</code></td></tr>
    <tr><td>Screenshot</td><td><code>await expect(page).toHaveScreenshot('name.png')</code></td></tr>
    <tr><td>Take screenshot</td><td><code>await page.screenshot({ path: 'screenshot.png' })</code></td></tr>
    <tr><td>Select by testid</td><td><code>page.getByTestId('element-id')</code></td></tr>
    <tr><td>Multiple elements</td><td><code>await page.getByRole('listitem').count()</code></td></tr>
    <tr><td>Keyboard</td><td><code>await page.keyboard.press('Enter')</code></td></tr>
    <tr><td>Auth state</td><td><code>test.use({ storageState: 'auth.json' })</code></td></tr>
    <tr><td>Mobile viewport</td><td><code>use: { ...devices['iPhone 13'] }</code></td></tr>
  </table>

  <h2>üå≤ Cypress Cheatsheet</h2>
  <table class="cheat-table">
    <tr><th>Action</th><th>Code</th></tr>
    <tr><td>Visit</td><td><code>cy.visit('/path')</code></td></tr>
    <tr><td>Get element</td><td><code>cy.get('[data-testid=btn]')</code></td></tr>
    <tr><td>Type</td><td><code>cy.get('#email').type('test@test.com')</code></td></tr>
    <tr><td>Click</td><td><code>cy.get('#submit').click()</code></td></tr>
    <tr><td>Assert</td><td><code>cy.get('.title').should('contain', 'Welcome')</code></td></tr>
    <tr><td>Intercept API</td><td><code>cy.intercept('GET', '/api/**').as('getData')</code></td></tr>
    <tr><td>Wait for API</td><td><code>cy.wait('@getData')</code></td></tr>
    <tr><td>Mock response</td><td><code>cy.intercept('/api/users', { fixture: 'users.json' })</code></td></tr>
    <tr><td>Session caching</td><td><code>cy.session('name', () => { cy.request(...) })</code></td></tr>
    <tr><td>Custom command</td><td><code>Cypress.Commands.add('login', (email, pass) => {...})</code></td></tr>
    <tr><td>Env variable</td><td><code>Cypress.env('API_URL')</code></td></tr>
    <tr><td>Stub</td><td><code>cy.stub(window, 'fetch').resolves({...})</code></td></tr>
  </table>

  <h2>üëÅÔ∏è Visual Testing</h2>
  <table class="cheat-table">
    <tr><th>Task</th><th>Playwright</th><th>Notes</th></tr>
    <tr><td>Full page screenshot</td><td><code>expect(page).toHaveScreenshot('name.png')</code></td><td>Creates baseline on first run</td></tr>
    <tr><td>Element screenshot</td><td><code>expect(element).toHaveScreenshot('btn.png')</code></td><td>Crop to element bounds</td></tr>
    <tr><td>Disable animations</td><td><code>{ animations: 'disabled' }</code></td><td>Always use this!</td></tr>
    <tr><td>Mask dynamic parts</td><td><code>{ mask: [page.getByTestId('date')] }</code></td><td>Ignore timestamps, avatars</td></tr>
    <tr><td>Pixel threshold</td><td><code>{ maxDiffPixels: 100 }</code></td><td>Allow minor differences</td></tr>
    <tr><td>Color threshold</td><td><code>{ threshold: 0.2 }</code></td><td>0-1 scale per pixel</td></tr>
    <tr><td>Update baselines</td><td><code>npx playwright test --update-snapshots</code></td><td>Only when intentional!</td></tr>
    <tr><td>View report</td><td><code>npx playwright show-report</code></td><td>See visual diffs</td></tr>
  </table>

  <h2>üìä Test Strategy Quick Reference</h2>
  <table class="cheat-table">
    <tr><th>Type</th><th>Speed</th><th>Confidence</th><th>Cost</th><th>Use For</th></tr>
    <tr><td><span class="tag tag-green">Unit</span></td><td>‚ö° ms</td><td>Low-Medium</td><td>Cheap</td><td>Logic, utils, components</td></tr>
    <tr><td><span class="tag tag-purple">Integration</span></td><td>üîÑ seconds</td><td>High</td><td>Medium</td><td>APIs, DB, auth flows</td></tr>
    <tr><td><span class="tag tag-red">E2E</span></td><td>üê¢ minutes</td><td>Highest</td><td>Expensive</td><td>Critical user journeys</td></tr>
    <tr><td><span class="tag tag-blue">Visual</span></td><td>üîÑ seconds</td><td>Medium</td><td>Medium</td><td>UI regressions, design systems</td></tr>
    <tr><td><span class="tag tag-yellow">Contract</span></td><td>‚ö° seconds</td><td>High</td><td>Medium</td><td>Microservices, API consumers</td></tr>
  </table>

  <h2>‚ö° CLI Commands Quick Reference</h2>
  <div class="code-block">
    <div class="code-header"><span>All the commands you need</span></div>
    <pre><span class="cm">## Jest / Vitest</span>
npx jest                          <span class="cm"># Run all tests</span>
npx jest --watch                  <span class="cm"># Watch mode</span>
npx jest --coverage               <span class="cm"># With coverage</span>
npx jest --testNamePattern "auth" <span class="cm"># Run specific test</span>
npx jest --runInBand               <span class="cm"># Sequential (for DB tests)</span>

<span class="cm">## Playwright</span>
npx playwright test               <span class="cm"># Run all E2E tests</span>
npx playwright test --headed      <span class="cm"># With browser visible</span>
npx playwright test --debug       <span class="cm"># Step-through debugger</span>
npx playwright codegen localhost  <span class="cm"># Record test actions</span>
npx playwright test --update-snapshots  <span class="cm"># Update visual baselines</span>
npx playwright show-report        <span class="cm"># Open HTML report</span>
npx playwright test --project=chromium  <span class="cm"># Specific browser</span>

<span class="cm">## Cypress</span>
npx cypress open                  <span class="cm"># Interactive mode</span>
npx cypress run                   <span class="cm"># Headless (CI)</span>
npx cypress run --browser firefox <span class="cm"># Specific browser</span>
npx cypress run --spec "cypress/e2e/login.cy.js"</pre>
  </div>

  <h2>üèÜ Interview Cheatsheet</h2>
  <div class="card-grid">
    <div class="card accent-left">
      <h3 style="margin-top:0;font-size:0.9rem">Key Differences to Know</h3>
      <ul class="checklist">
        <li>Unit: isolated, mocked deps, ms speed</li>
        <li>Integration: multiple units, real DB, seconds</li>
        <li>E2E: real browser, full stack, minutes</li>
        <li>Playwright: multi-browser, auto-waits</li>
        <li>Cypress: JS-native, in-browser, DX-first</li>
      </ul>
    </div>
    <div class="card success-left">
      <h3 style="margin-top:0;font-size:0.9rem">Things To Always Mention</h3>
      <ul class="checklist">
        <li>Test isolation (no state pollution)</li>
        <li>Page Object Model for E2E</li>
        <li>Semantic selectors over CSS</li>
        <li>Avoid hardcoded timeouts</li>
        <li>Coverage ‚â† quality</li>
      </ul>
    </div>
  </div>
</section>

</main>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NAVIGATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  const btns = document.querySelectorAll('nav button');
  btns.forEach(b => { if (b.getAttribute('onclick').includes(id)) b.classList.add('active'); });
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INNER TABS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showInner(group, tab) {
  const allContents = document.querySelectorAll(`[id^="${group}-"]`);
  const allTabs = document.querySelectorAll(`.inner-tab`);
  allContents.forEach(c => c.classList.remove('active'));
  const target = document.getElementById(`${group}-${tab}`);
  if (target) target.classList.add('active');
  // Activate clicked tab button
  event.target.closest('.inner-tabs').querySelectorAll('.inner-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ACCORDION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function toggleAcc(btn) {
  btn.classList.toggle('open');
  btn.nextElementSibling.classList.toggle('open');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INTEGRATION DEMO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const integrationTests = [
  { icon: '‚úÖ', name: 'POST /api/users ‚Üí creates user in DB', time: '127ms', pass: true },
  { icon: '‚úÖ', name: 'POST /api/users ‚Üí rejects duplicate email (409)', time: '83ms', pass: true },
  { icon: '‚úÖ', name: 'GET /api/users/:id ‚Üí returns user object', time: '54ms', pass: true },
  { icon: '‚úÖ', name: 'POST /auth/login ‚Üí returns JWT token', time: '201ms', pass: true },
  { icon: '‚ùå', name: 'DELETE /api/users/:id ‚Üí returns 403 without admin role', time: '91ms', pass: false },
  { icon: '‚úÖ', name: 'PATCH /api/users/:id ‚Üí updates and persists to DB', time: '112ms', pass: true },
];

function runIntegrationDemo() {
  const container = document.getElementById('integrationRunner');
  container.innerHTML = '';
  integrationTests.forEach((t, i) => {
    const row = document.createElement('div');
    row.className = 'test-row';
    row.style.borderLeft = `3px solid ${t.pass ? 'var(--success)' : 'var(--error)'}`;
    row.innerHTML = `<span class="test-icon">${t.icon}</span><span class="test-name">${t.name}</span><span class="test-time">${t.time}</span>`;
    container.appendChild(row);
    setTimeout(() => row.classList.add('visible'), i * 350 + 200);
  });
  const passing = integrationTests.filter(t => t.pass).length;
  setTimeout(() => {
    const summary = document.createElement('div');
    summary.className = 'test-row visible';
    summary.style.background = 'rgba(108,99,255,0.1)';
    summary.style.borderLeft = '3px solid var(--accent)';
    summary.innerHTML = `<span>üìä</span><span class="test-name"><strong>${passing}/${integrationTests.length} tests passed</strong></span><span class="test-time">668ms total</span>`;
    container.appendChild(summary);
  }, integrationTests.length * 350 + 400);
}

function resetIntegration() {
  document.getElementById('integrationRunner').innerHTML = '';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXERCISES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function checkEx(num) {
  const val = document.getElementById(`ex${num}`).value.trim();
  const out = document.getElementById(`ex${num}-out`);
  out.style.display = 'block';
  if (val.length < 80) {
    out.style.color = 'var(--error)';
    out.textContent = '‚ö†Ô∏è Your answer seems too short. Try writing a more complete solution!';
    return;
  }
  const checks = {
    1: ['describe', 'it(', 'request(', 'toBe(201', 'toBe(400', 'toBe(409'],
    2: ['test(', 'getByTestId', 'fill(', 'toHaveCount', 'clear('],
    3: ['class', 'fillCardDetails', 'placeOrder', 'expectSuccess', 'toBeVisible'],
    4: ['toHaveScreenshot', 'animations', 'mask', 'viewport'],
  };
  const required = checks[num] || [];
  const missing = required.filter(kw => !val.includes(kw));
  if (missing.length === 0) {
    out.style.color = 'var(--success)';
    out.textContent = '‚úÖ Great job! Your solution covers the key concepts. Check the model solution for comparison.';
  } else {
    out.style.color = 'var(--warn)';
    out.textContent = `üîç Missing or check: ${missing.join(', ')}. Keep going!`;
  }
}

function showSolution(num) {
  const sol = document.getElementById(`ex${num}-sol`);
  sol.style.display = sol.style.display === 'none' ? 'block' : 'none';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUIZ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const quizData = [
  {
    q: "What is the PRIMARY advantage of integration tests over unit tests?",
    opts: [
      "They run much faster",
      "They test how multiple components work together in real conditions",
      "They require no setup or configuration",
      "They can only be written in TypeScript"
    ],
    correct: 1,
    explain: "Integration tests verify that components actually work together ‚Äî catching bugs at the seams that unit tests with mocks would miss."
  },
  {
    q: "Which Playwright method should you use instead of `page.waitForTimeout(2000)`?",
    opts: [
      "page.waitForSeconds(2)",
      "page.sleep(2000)",
      "await expect(element).toBeVisible() ‚Äî Playwright auto-waits",
      "page.delay(2000)"
    ],
    correct: 2,
    explain: "Playwright has built-in auto-waiting on assertions. `expect(element).toBeVisible()` will automatically wait up to the configured timeout for the element to appear."
  },
  {
    q: "In E2E tests, what's the BEST way to authenticate before each test?",
    opts: [
      "Fill in the login form in beforeEach() for every test",
      "Use pre-saved auth state or login via API, reusing the session",
      "Hard-code the JWT token directly in the test file",
      "Skip authentication in tests"
    ],
    correct: 1,
    explain: "UI login in every test is slow and brittle. Use Playwright's storageState or Cypress's cy.session() to login once via API and reuse the session across tests."
  },
  {
    q: "What does `afterEach(() => db.truncate())` do in integration tests?",
    opts: [
      "Deletes the database permanently",
      "Cleans up test data after each test to prevent state pollution",
      "Rolls back the database schema",
      "Closes the database connection"
    ],
    correct: 1,
    explain: "Truncating after each test ensures no test's data leaks into another test. Without this, tests can fail or pass based on execution order ‚Äî a very common bug."
  },
  {
    q: "Which selector strategy is MOST resilient to UI refactoring in Playwright?",
    opts: [
      "page.locator('.btn-primary-v2 > span')",
      "page.locator('#submit-button-id')",
      "page.getByRole('button', { name: 'Submit Order' })",
      "page.locator('xpath=//div/button[1]')"
    ],
    correct: 2,
    explain: "Role-based selectors mirror how users interact with your app. They survive CSS class renames and DOM restructuring. They also test accessibility as a side effect!"
  },
  {
    q: "Visual regression tests are comparing screenshots against what?",
    opts: [
      "A live production website",
      "Manually designed mockups in Figma",
      "Previously approved 'baseline' screenshots",
      "Another browser's rendering"
    ],
    correct: 2,
    explain: "Visual regression tests take a baseline screenshot on first run (or when you explicitly update them), then compare all future runs against that baseline to detect unintended changes."
  },
  {
    q: "What is the 'Page Object Model' (POM) pattern in E2E testing?",
    opts: [
      "A way to test database schema models",
      "A class that encapsulates page interactions, making tests more maintainable",
      "A built-in Playwright feature for page routing",
      "A pattern for mocking HTTP responses"
    ],
    correct: 1,
    explain: "POM creates a class for each page/component that wraps selectors and interactions. If the UI changes, you update the Page Object ‚Äî not every individual test that uses it."
  },
  {
    q: "When using `toHaveScreenshot()` for a page with timestamps, what should you do?",
    opts: [
      "Replace timestamps with static text before testing",
      "Disable the screenshot test for that page",
      "Use the `mask` option to cover dynamic content",
      "Allow 100% pixel difference"
    ],
    correct: 2,
    explain: "The `mask` option in `toHaveScreenshot({ mask: [page.getByTestId('timestamp')] })` overlays a colored rectangle over dynamic elements, so they're ignored in comparisons."
  },
  {
    q: "Which testing approach does Spotify use (Honeycomb model)?",
    opts: [
      "Heavy focus on E2E tests with very few unit tests",
      "Equal distribution across all test types",
      "Focus on integrated service tests, less on isolated unit tests and E2E",
      "Only unit tests with no E2E testing"
    ],
    correct: 2,
    explain: "Spotify's Honeycomb model emphasizes integrated service tests because their microservice architecture means the interactions between services are where bugs most often occur."
  },
  {
    q: "What is Testcontainers used for in integration testing?",
    opts: [
      "Containerizing your test results for sharing",
      "Running real external services (like PostgreSQL) in Docker during tests",
      "Building Docker images from test code",
      "Testing Kubernetes deployments"
    ],
    correct: 1,
    explain: "Testcontainers spins up real services (PostgreSQL, Redis, Kafka, etc.) in Docker containers during your tests, then cleans them up. This gives you real infrastructure without a persistent test environment."
  },
  {
    q: "Why should E2E tests cover only CRITICAL user journeys rather than everything?",
    opts: [
      "Because E2E tests cannot test complex scenarios",
      "Because they are slow, expensive, and flaky ‚Äî unit/integration tests cover the rest cheaper and faster",
      "Because browsers don't support advanced features",
      "Because Playwright and Cypress have test limits"
    ],
    correct: 1,
    explain: "E2E tests take minutes and are the most fragile. Reserve them for flows that, if broken, would be catastrophic (login, payment, core feature). Everything else should be tested at lower levels."
  },
  {
    q: "What does `{ animations: 'disabled' }` do in a Playwright screenshot test?",
    opts: [
      "Prevents JavaScript animations from loading",
      "Freezes all CSS and JS animations so screenshots are deterministic",
      "Disables video recording",
      "Removes all transition effects from the page permanently"
    ],
    correct: 1,
    explain: "Animations make screenshots non-deterministic ‚Äî a spinner might be at different positions each run. Disabling them ensures the screenshot is always the same, preventing false failures."
  }
];

let answered = [];
let quizRendered = false;

function renderQuiz() {
  if (quizRendered) return;
  quizRendered = true;
  answered = new Array(quizData.length).fill(null);
  const container = document.getElementById('quiz-container');
  container.innerHTML = '';
  quizData.forEach((q, qi) => {
    const card = document.createElement('div');
    card.className = 'quiz-card';
    const letters = ['A','B','C','D'];
    card.innerHTML = `
      <div class="quiz-q"><span style="color:var(--accent)">Q${qi+1}.</span> ${q.q}</div>
      <div class="quiz-options">
        ${q.opts.map((o,oi) => `
          <button class="quiz-opt" id="opt-${qi}-${oi}" onclick="answerQuiz(${qi},${oi})">
            <span class="opt-letter">${letters[oi]}</span>${o}
          </button>`).join('')}
      </div>
      <div class="quiz-feedback" id="fb-${qi}"></div>`;
    container.appendChild(card);
  });
}

function answerQuiz(qi, oi) {
  if (answered[qi] !== null) return;
  answered[qi] = oi;
  const q = quizData[qi];
  const opts = document.querySelectorAll(`[id^="opt-${qi}-"]`);
  opts.forEach((btn, i) => {
    btn.disabled = true;
    if (i === q.correct) btn.classList.add('correct');
    else if (i === oi) btn.classList.add('wrong');
  });
  const fb = document.getElementById(`fb-${qi}`);
  const isCorrect = oi === q.correct;
  fb.className = `quiz-feedback show ${isCorrect ? 'correct' : 'wrong'}`;
  fb.textContent = (isCorrect ? '‚úÖ Correct! ' : '‚ùå Incorrect. ') + q.explain;
  // Check if all answered
  const done = answered.every(a => a !== null);
  if (done) {
    const score = answered.filter((a,i) => a === quizData[i].correct).length;
    const scoreEl = document.getElementById('quiz-score');
    scoreEl.classList.add('show');
    document.getElementById('score-display').textContent = `${score}/${quizData.length}`;
    const pct = Math.round((score/quizData.length)*100);
    const msgs = [
      [100, 'üèÜ Perfect! You\'re ready to ace any testing interview!'],
      [80, 'üéâ Excellent! Strong testing knowledge. Minor review needed.'],
      [60, 'üëç Good effort! Review the sections where you struggled.'],
      [0, 'üìö Keep studying! Go back through the sections and try again.']
    ];
    document.getElementById('score-msg').textContent = msgs.find(([t]) => pct >= t)[1];
  }
}

function resetQuiz() {
  quizRendered = false;
  answered = [];
  document.getElementById('quiz-score').classList.remove('show');
  renderQuiz();
}

// Initialize quiz when tab is clicked
document.querySelectorAll('nav button').forEach(btn => {
  btn.addEventListener('click', () => {
    if (btn.getAttribute('onclick').includes('quiz')) {
      renderQuiz();
    }
  });
});
</script>
</body>
</html>