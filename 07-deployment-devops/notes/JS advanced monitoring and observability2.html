<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JS Monitoring & Observability - Complete Guide</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  :root {
    --bg: #0a0e1a;
    --surface: #111827;
    --surface2: #1a2235;
    --surface3: #1e2d3d;
    --accent: #00d4ff;
    --accent2: #7c3aed;
    --accent3: #10b981;
    --accent4: #f59e0b;
    --danger: #ef4444;
    --warning: #f97316;
    --text: #e2e8f0;
    --text2: #94a3b8;
    --border: #2d3748;
    --code-bg: #0d1117;
  }

  body {
    font-family: 'Segoe UI', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* HEADER */
  .header {
    background: linear-gradient(135deg, #0a0e1a 0%, #1a0533 50%, #0a1628 100%);
    padding: 30px 20px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    position: relative;
    overflow: hidden;
  }

  .header::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(ellipse at center, rgba(0,212,255,0.05) 0%, transparent 70%);
    animation: pulse 4s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.05); }
  }

  .header h1 {
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    background: linear-gradient(135deg, var(--accent), var(--accent2), var(--accent3));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    position: relative;
    z-index: 1;
  }

  .header p {
    color: var(--text2);
    margin-top: 8px;
    font-size: 1rem;
    position: relative;
    z-index: 1;
  }

  .status-bar {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 15px;
    flex-wrap: wrap;
    position: relative;
    z-index: 1;
  }

  .status-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.8rem;
    color: var(--text2);
  }

  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    animation: blink 2s infinite;
  }

  .status-dot.green { background: var(--accent3); }
  .status-dot.blue { background: var(--accent); }
  .status-dot.purple { background: var(--accent2); }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  /* NAV */
  .nav {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 20px;
    display: flex;
    overflow-x: auto;
    gap: 4px;
    scrollbar-width: none;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .nav::-webkit-scrollbar { display: none; }

  .nav-btn {
    padding: 14px 18px;
    background: none;
    border: none;
    color: var(--text2);
    cursor: pointer;
    font-size: 0.85rem;
    white-space: nowrap;
    border-bottom: 3px solid transparent;
    transition: all 0.2s;
    font-weight: 500;
  }

  .nav-btn:hover { color: var(--accent); }
  .nav-btn.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
    background: rgba(0,212,255,0.05);
  }

  /* MAIN */
  .main { max-width: 1200px; margin: 0 auto; padding: 30px 20px; }

  .section { display: none; }
  .section.active { display: block; }

  /* CARDS */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 20px;
    transition: border-color 0.3s;
  }

  .card:hover { border-color: rgba(0,212,255,0.3); }

  .card-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 16px;
  }

  .card-icon {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
  }

  .card h2 {
    font-size: 1.2rem;
    color: var(--text);
  }

  .card h3 {
    font-size: 1rem;
    color: var(--accent);
    margin-bottom: 12px;
  }

  .card p {
    color: var(--text2);
    line-height: 1.7;
    margin-bottom: 12px;
  }

  /* GRID */
  .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
  .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; }

  /* CODE BLOCKS */
  .code-block {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    font-family: 'Courier New', monospace;
    font-size: 0.82rem;
    line-height: 1.7;
    overflow-x: auto;
    position: relative;
    margin: 12px 0;
  }

  .code-block .comment { color: #6b7280; }
  .code-block .keyword { color: #c792ea; }
  .code-block .string { color: #a5d6a7; }
  .code-block .function { color: #82aaff; }
  .code-block .number { color: #f78c6c; }
  .code-block .property { color: #ffcb6b; }
  .code-block .tag { color: var(--accent); }

  .copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: var(--surface3);
    border: 1px solid var(--border);
    color: var(--text2);
    padding: 4px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.75rem;
    transition: all 0.2s;
  }

  .copy-btn:hover { background: var(--accent); color: #000; }

  /* BADGES */
  .badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    margin: 2px;
  }

  .badge-blue { background: rgba(0,212,255,0.15); color: var(--accent); border: 1px solid rgba(0,212,255,0.3); }
  .badge-green { background: rgba(16,185,129,0.15); color: var(--accent3); border: 1px solid rgba(16,185,129,0.3); }
  .badge-purple { background: rgba(124,58,237,0.15); color: #a78bfa; border: 1px solid rgba(124,58,237,0.3); }
  .badge-orange { background: rgba(249,115,22,0.15); color: var(--warning); border: 1px solid rgba(249,115,22,0.3); }
  .badge-red { background: rgba(239,68,68,0.15); color: var(--danger); border: 1px solid rgba(239,68,68,0.3); }
  .badge-yellow { background: rgba(245,158,11,0.15); color: var(--accent4); border: 1px solid rgba(245,158,11,0.3); }

  /* HIGHLIGHT BOXES */
  .highlight-box {
    border-radius: 8px;
    padding: 14px 16px;
    margin: 12px 0;
    border-left: 4px solid;
    font-size: 0.9rem;
    line-height: 1.6;
  }

  .highlight-box.info { background: rgba(0,212,255,0.08); border-color: var(--accent); color: #93c5fd; }
  .highlight-box.success { background: rgba(16,185,129,0.08); border-color: var(--accent3); color: #6ee7b7; }
  .highlight-box.warning { background: rgba(249,115,22,0.08); border-color: var(--warning); color: #fdba74; }
  .highlight-box.danger { background: rgba(239,68,68,0.08); border-color: var(--danger); color: #fca5a5; }

  /* CONCEPT BOXES */
  .concept-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin: 16px 0; }

  .concept-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 18px;
    text-align: center;
    transition: all 0.3s;
  }

  .concept-box:hover { transform: translateY(-2px); border-color: var(--accent); }

  .concept-box .icon { font-size: 2rem; margin-bottom: 10px; }
  .concept-box h4 { color: var(--accent); font-size: 0.95rem; margin-bottom: 6px; }
  .concept-box p { color: var(--text2); font-size: 0.82rem; line-height: 1.5; }

  /* QUIZ */
  .quiz-container { margin: 20px 0; }

  .quiz-question {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 16px;
    transition: all 0.3s;
  }

  .quiz-question.correct { border-color: var(--accent3); background: rgba(16,185,129,0.08); }
  .quiz-question.incorrect { border-color: var(--danger); background: rgba(239,68,68,0.08); }

  .quiz-q { font-weight: 600; margin-bottom: 14px; color: var(--text); line-height: 1.5; }

  .quiz-options { display: grid; gap: 8px; }

  .quiz-option {
    padding: 10px 14px;
    background: var(--surface3);
    border: 1px solid var(--border);
    border-radius: 6px;
    cursor: pointer;
    color: var(--text2);
    font-size: 0.88rem;
    transition: all 0.2s;
    text-align: left;
  }

  .quiz-option:hover:not(:disabled) { border-color: var(--accent); color: var(--text); }
  .quiz-option.correct { background: rgba(16,185,129,0.15); border-color: var(--accent3); color: var(--accent3); }
  .quiz-option.incorrect { background: rgba(239,68,68,0.15); border-color: var(--danger); color: var(--danger); }

  .quiz-feedback {
    margin-top: 10px;
    padding: 10px;
    border-radius: 6px;
    font-size: 0.85rem;
    display: none;
  }

  .quiz-feedback.show { display: block; }

  .quiz-score {
    background: var(--surface2);
    border: 1px solid var(--accent);
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    margin-top: 20px;
    display: none;
  }

  .quiz-score.show { display: block; }
  .quiz-score h3 { color: var(--accent); font-size: 1.3rem; margin-bottom: 8px; }

  /* EXERCISE */
  .exercise-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .exercise-box h4 {
    color: var(--accent4);
    margin-bottom: 10px;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .exercise-box p { color: var(--text2); font-size: 0.9rem; line-height: 1.6; margin-bottom: 12px; }

  .code-editor {
    width: 100%;
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'Courier New', monospace;
    font-size: 0.82rem;
    padding: 14px;
    resize: vertical;
    min-height: 150px;
    line-height: 1.7;
    outline: none;
    transition: border-color 0.2s;
  }

  .code-editor:focus { border-color: var(--accent); }

  .run-btn {
    background: linear-gradient(135deg, var(--accent3), #059669);
    border: none;
    color: #fff;
    padding: 10px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    margin-top: 10px;
    transition: all 0.2s;
  }

  .run-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 15px rgba(16,185,129,0.3); }

  .hint-btn {
    background: transparent;
    border: 1px solid var(--accent4);
    color: var(--accent4);
    padding: 8px 18px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85rem;
    margin-top: 10px;
    margin-left: 10px;
    transition: all 0.2s;
  }

  .hint-btn:hover { background: rgba(245,158,11,0.1); }

  .output-box {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 14px;
    margin-top: 10px;
    font-family: 'Courier New', monospace;
    font-size: 0.82rem;
    min-height: 60px;
    display: none;
    white-space: pre-wrap;
  }

  .output-box.show { display: block; }
  .output-box.error { border-color: var(--danger); color: var(--danger); }
  .output-box.success { border-color: var(--accent3); color: var(--accent3); }

  /* PITFALLS */
  .pitfall-box {
    background: rgba(239,68,68,0.06);
    border: 1px solid rgba(239,68,68,0.3);
    border-radius: 10px;
    padding: 18px;
    margin-bottom: 16px;
  }

  .pitfall-box h4 { color: var(--danger); margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }

  .comparison {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 12px 0;
  }

  @media (max-width: 600px) { .comparison { grid-template-columns: 1fr; } }

  .bad-code { border-color: rgba(239,68,68,0.4); }
  .good-code { border-color: rgba(16,185,129,0.4); }
  .bad-code::before { content: '‚ùå BAD'; display: block; color: var(--danger); font-size: 0.75rem; font-weight: 700; margin-bottom: 8px; }
  .good-code::before { content: '‚úÖ GOOD'; display: block; color: var(--accent3); font-size: 0.75rem; font-weight: 700; margin-bottom: 8px; }

  /* CHEATSHEET */
  .cheat-section {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 18px;
    margin-bottom: 16px;
  }

  .cheat-section h4 {
    color: var(--accent);
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
  }

  .cheat-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 8px 0;
    border-bottom: 1px solid rgba(45,55,72,0.5);
    gap: 16px;
    flex-wrap: wrap;
  }

  .cheat-item:last-child { border-bottom: none; }
  .cheat-label { color: var(--text2); font-size: 0.85rem; flex: 1; min-width: 150px; }
  .cheat-code { font-family: 'Courier New', monospace; font-size: 0.8rem; color: var(--accent4); background: var(--code-bg); padding: 2px 8px; border-radius: 4px; flex: 2; }

  /* LIVE DEMO */
  .demo-container {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin: 16px 0;
    font-family: 'Courier New', monospace;
    font-size: 0.82rem;
  }

  .demo-log {
    height: 200px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 10px;
    background: #060a12;
    margin-top: 10px;
  }

  .log-entry {
    margin: 3px 0;
    padding: 3px 0;
    border-bottom: 1px solid rgba(45,55,72,0.3);
    font-size: 0.8rem;
    display: flex;
    align-items: flex-start;
    gap: 8px;
  }

  .log-time { color: var(--text2); flex-shrink: 0; }
  .log-level { padding: 1px 6px; border-radius: 3px; font-size: 0.7rem; font-weight: 700; flex-shrink: 0; }
  .log-level.error { background: rgba(239,68,68,0.2); color: var(--danger); }
  .log-level.warn { background: rgba(245,158,11,0.2); color: var(--accent4); }
  .log-level.info { background: rgba(0,212,255,0.2); color: var(--accent); }
  .log-level.debug { background: rgba(124,58,237,0.2); color: #a78bfa; }
  .log-msg { color: var(--text2); flex: 1; word-break: break-all; }

  .demo-btn {
    background: var(--surface3);
    border: 1px solid var(--border);
    color: var(--text2);
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.82rem;
    margin: 4px;
    transition: all 0.2s;
  }

  .demo-btn:hover { border-color: var(--accent); color: var(--accent); }
  .demo-btn.active { background: var(--accent); color: #000; border-color: var(--accent); }

  /* PROGRESS */
  .progress-bar {
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    margin: 8px 0;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    border-radius: 2px;
    transition: width 0.5s ease;
  }

  /* METRIC CARDS */
  .metric-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
    transition: all 0.3s;
  }

  .metric-card:hover { border-color: var(--accent); transform: translateY(-2px); }
  .metric-value { font-size: 1.8rem; font-weight: 700; margin: 8px 0; }
  .metric-label { color: var(--text2); font-size: 0.8rem; }
  .metric-trend { font-size: 0.75rem; margin-top: 4px; }
  .trend-up { color: var(--danger); }
  .trend-down { color: var(--accent3); }

  /* TABS within section */
  .section-tabs {
    display: flex;
    gap: 4px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 20px;
    overflow-x: auto;
  }

  .section-tab {
    padding: 10px 18px;
    background: none;
    border: none;
    color: var(--text2);
    cursor: pointer;
    font-size: 0.85rem;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .section-tab.active { color: var(--accent3); border-bottom-color: var(--accent3); }
  .section-tab:hover { color: var(--text); }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* SCROLL */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

  /* TOOLTIP */
  .tooltip-wrap { position: relative; display: inline-block; cursor: help; }
  .tooltip-wrap .tooltip-text {
    display: none;
    position: absolute;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--surface3);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.8rem;
    white-space: nowrap;
    z-index: 999;
  }
  .tooltip-wrap:hover .tooltip-text { display: block; }

  /* ANIMATED PIPELINE */
  .pipeline {
    display: flex;
    align-items: center;
    gap: 0;
    overflow-x: auto;
    padding: 20px 0;
    justify-content: center;
    flex-wrap: wrap;
    gap: 8px;
  }

  .pipeline-step {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    text-align: center;
    min-width: 100px;
    font-size: 0.8rem;
    transition: all 0.3s;
  }

  .pipeline-step.active { border-color: var(--accent); background: rgba(0,212,255,0.08); }
  .pipeline-step .step-icon { font-size: 1.5rem; margin-bottom: 6px; }
  .pipeline-step .step-name { color: var(--text2); }
  .pipeline-arrow { color: var(--text2); font-size: 1.2rem; padding: 0 4px; }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    .main { padding: 16px 12px; }
    .card { padding: 16px; }
  }

  /* TOGGLE */
  .toggle-group { display: flex; flex-direction: column; gap: 8px; margin: 12px 0; }
  .toggle-item {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
  }
  .toggle-header {
    padding: 12px 16px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    color: var(--text);
    transition: background 0.2s;
  }
  .toggle-header:hover { background: var(--surface3); }
  .toggle-body { padding: 16px; display: none; border-top: 1px solid var(--border); }
  .toggle-body.show { display: block; }
  .toggle-arrow { transition: transform 0.3s; }
  .toggle-arrow.open { transform: rotate(180deg); }

  /* SENTRY MOCK */
  .sentry-mock {
    background: #1a0533;
    border: 1px solid #3d1a6e;
    border-radius: 10px;
    padding: 20px;
    margin: 16px 0;
  }

  .sentry-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    flex-wrap: wrap;
    gap: 10px;
  }

  .sentry-logo { color: #f04444; font-weight: 700; font-size: 1.1rem; }

  .sentry-event {
    background: rgba(240,68,68,0.08);
    border: 1px solid rgba(240,68,68,0.2);
    border-radius: 6px;
    padding: 12px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .sentry-event:hover { border-color: rgba(240,68,68,0.5); }
  .sentry-event-title { color: #f04444; font-size: 0.88rem; font-weight: 600; }
  .sentry-event-meta { color: var(--text2); font-size: 0.75rem; margin-top: 4px; }

  /* STEP LIST */
  .step-list { counter-reset: step; }
  .step-item {
    display: flex;
    gap: 14px;
    margin-bottom: 16px;
    align-items: flex-start;
  }
  .step-num {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 700;
    flex-shrink: 0;
  }
  .step-content { flex: 1; }
  .step-content h5 { color: var(--text); margin-bottom: 4px; }
  .step-content p { color: var(--text2); font-size: 0.85rem; line-height: 1.5; }

  /* ALERT SYSTEM */
  .alert-demo {
    position: fixed;
    top: 80px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 8px;
    pointer-events: none;
  }

  .alert-toast {
    background: var(--surface);
    border-left: 4px solid var(--accent3);
    border-radius: 8px;
    padding: 12px 16px;
    min-width: 250px;
    max-width: 320px;
    pointer-events: all;
    animation: slideIn 0.3s ease;
    box-shadow: 0 4px 20px rgba(0,0,0,0.5);
  }

  .alert-toast.error { border-color: var(--danger); }
  .alert-toast.warning { border-color: var(--warning); }
  .alert-toast.info { border-color: var(--accent); }

  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  @keyframes slideOut {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
  }

  .alert-title { font-size: 0.85rem; font-weight: 600; color: var(--text); }
  .alert-msg { font-size: 0.78rem; color: var(--text2); margin-top: 2px; }

  /* Table */
  .comparison-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.85rem;
    margin: 12px 0;
  }

  .comparison-table th {
    background: var(--surface3);
    color: var(--accent);
    padding: 10px 14px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }

  .comparison-table td {
    padding: 10px 14px;
    border-bottom: 1px solid rgba(45,55,72,0.5);
    color: var(--text2);
    vertical-align: top;
  }

  .comparison-table tr:hover td { background: rgba(255,255,255,0.02); }

  /* BUTTON STYLES */
  .btn { padding: 8px 18px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 500; border: none; transition: all 0.2s; }
  .btn-primary { background: var(--accent); color: #000; }
  .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }
  .btn-secondary { background: var(--surface3); color: var(--text2); border: 1px solid var(--border); }
  .btn-secondary:hover { color: var(--text); border-color: var(--accent); }
  .btn-danger { background: var(--danger); color: #fff; }

  .btn-row { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 12px; }

  /* COUNTER */
  .counter-display {
    font-size: 3rem;
    font-weight: 700;
    text-align: center;
    padding: 20px;
    color: var(--accent);
  }

  /* FINGERPRINT */
  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    margin: 8px 0;
  }
  .breadcrumb-item {
    font-size: 0.8rem;
    color: var(--text2);
    background: var(--surface3);
    padding: 4px 8px;
    border-radius: 4px;
  }
  .breadcrumb-arrow { color: var(--text2); font-size: 0.8rem; }

  /* CHECKLIST */
  .checklist { list-style: none; }
  .checklist li {
    padding: 8px 0;
    display: flex;
    align-items: flex-start;
    gap: 10px;
    color: var(--text2);
    font-size: 0.88rem;
    border-bottom: 1px solid rgba(45,55,72,0.3);
  }
  .checklist li:last-child { border-bottom: none; }
  .checklist li::before { content: '‚úì'; color: var(--accent3); font-weight: 700; flex-shrink: 0; margin-top: 1px; }
  .checklist.cross li::before { content: '‚úó'; color: var(--danger); }

  .section-header {
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }

  .section-header h2 {
    font-size: 1.6rem;
    background: linear-gradient(135deg, var(--accent), var(--accent3));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 6px;
  }

  .section-header p { color: var(--text2); }

  /* LIVE PERF MONITOR */
  .perf-bar-container { margin: 8px 0; }
  .perf-bar-label { display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text2); margin-bottom: 4px; }
  .perf-bar { height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; }
  .perf-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s, background 0.5s; }
</style>
</head>
<body>

<!-- ALERT CONTAINER -->
<div class="alert-demo" id="alertContainer"></div>

<!-- HEADER -->
<div class="header">
  <h1>üì° Monitoring & Observability</h1>
  <p>Master Error Tracking, Logging, Performance Monitoring & Alerting for Production JS Apps</p>
  <div class="status-bar">
    <div class="status-indicator"><div class="status-dot green"></div> System Healthy</div>
    <div class="status-indicator"><div class="status-dot blue"></div> Monitoring Active</div>
    <div class="status-indicator"><div class="status-dot purple"></div> Alerts Armed</div>
  </div>
</div>

<!-- NAV -->
<nav class="nav">
  <button class="nav-btn active" onclick="showSection('fundamentals')">üìö Fundamentals</button>
  <button class="nav-btn" onclick="showSection('errortracking')">üö® Error Tracking</button>
  <button class="nav-btn" onclick="showSection('logging')">üìù Logging</button>
  <button class="nav-btn" onclick="showSection('performance')">‚ö° Performance</button>
  <button class="nav-btn" onclick="showSection('alerting')">üîî Alerting</button>
  <button class="nav-btn" onclick="showSection('exercises')">üí™ Exercises</button>
  <button class="nav-btn" onclick="showSection('quiz')">üß† Quiz</button>
  <button class="nav-btn" onclick="showSection('pitfalls')">‚ö†Ô∏è Pitfalls</button>
  <button class="nav-btn" onclick="showSection('cheatsheet')">üìã Cheat Sheet</button>
</nav>

<!-- MAIN -->
<div class="main">

<!-- ==================== FUNDAMENTALS ==================== -->
<section class="section active" id="fundamentals">
  <div class="section-header">
    <h2>üìö What is Monitoring & Observability?</h2>
    <p>Understanding why production applications need eyes and ears</p>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-icon" style="background:rgba(0,212,255,0.1)">üî≠</div>
      <h2>The Simple Explanation</h2>
    </div>
    <p>Imagine you built a car and sold it to 10,000 people. You can't sit in each car watching ‚Äî you need <strong>instruments</strong> that tell you when something goes wrong, <strong>logs</strong> that record what happened, and <strong>alerts</strong> that notify you before it breaks down.</p>
    <p>That's exactly what monitoring & observability does for your JavaScript apps in production.</p>
    
    <div class="concept-grid">
      <div class="concept-box">
        <div class="icon">üö®</div>
        <h4>Error Tracking</h4>
        <p>Catch and record every error that happens in your app, with full context of what caused it</p>
      </div>
      <div class="concept-box">
        <div class="icon">üìù</div>
        <h4>Logging</h4>
        <p>Write structured records of events happening in your app (like a ship's log book)</p>
      </div>
      <div class="concept-box">
        <div class="icon">‚ö°</div>
        <h4>Performance Monitoring</h4>
        <p>Track how fast your app runs, find bottlenecks, measure user experience</p>
      </div>
      <div class="concept-box">
        <div class="icon">üîî</div>
        <h4>Alerting</h4>
        <p>Automatically notify your team when things go wrong, before users complain</p>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-icon" style="background:rgba(124,58,237,0.1)">üîç</div>
      <h2>Monitoring vs Observability ‚Äî What's the Difference?</h2>
    </div>
    
    <div class="comparison" style="grid-template-columns: 1fr 1fr;">
      <div>
        <div class="highlight-box info">
          <strong>üìä Monitoring</strong><br><br>
          "Is my system healthy?"<br><br>
          ‚Ä¢ Pre-defined metrics (CPU, memory, error rate)<br>
          ‚Ä¢ Tells you THAT something is wrong<br>
          ‚Ä¢ Dashboards, charts, alerts<br>
          ‚Ä¢ You know what to look for
        </div>
      </div>
      <div>
        <div class="highlight-box success">
          <strong>üî≠ Observability</strong><br><br>
          "WHY is my system unhealthy?"<br><br>
          ‚Ä¢ Any question you can think of<br>
          ‚Ä¢ Tells you WHY something is wrong<br>
          ‚Ä¢ Logs, traces, metrics together<br>
          ‚Ä¢ Explore unknown unknowns
        </div>
      </div>
    </div>

    <div class="highlight-box warning">
      <strong>üí° Real Talk for Interviews:</strong> Observability = Logs + Metrics + Traces (The Three Pillars). Being able to explain this distinction will impress interviewers at senior companies.
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-icon" style="background:rgba(16,185,129,0.1)">üèóÔ∏è</div>
      <h2>The Three Pillars of Observability</h2>
    </div>

    <div class="grid-3">
      <div class="concept-box">
        <div class="icon">üìù</div>
        <h4>Logs</h4>
        <p>Timestamped records of discrete events. "User logged in at 3:42pm". Searchable, structured text.</p>
        <br>
        <span class="badge badge-blue">What happened</span>
      </div>
      <div class="concept-box">
        <div class="icon">üìä</div>
        <h4>Metrics</h4>
        <p>Numerical measurements over time. Error rate: 0.1%. Response time: 250ms. Aggregated numbers.</p>
        <br>
        <span class="badge badge-green">How much / how often</span>
      </div>
      <div class="concept-box">
        <div class="icon">üîó</div>
        <h4>Traces</h4>
        <p>Follow a request across multiple services. User clicks button ‚Üí API call ‚Üí DB query ‚Üí response.</p>
        <br>
        <span class="badge badge-purple">Where it went</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-icon" style="background:rgba(245,158,11,0.1)">üõ†Ô∏è</div>
      <h2>The Observability Pipeline</h2>
    </div>
    <p>Here's how data flows from your app to your team's alert:</p>
    
    <div class="pipeline">
      <div class="pipeline-step active">
        <div class="step-icon">üíª</div>
        <div class="step-name">Your App</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üì°</div>
        <div class="step-name">SDK / Agent</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üåê</div>
        <div class="step-name">Collector</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üíæ</div>
        <div class="step-name">Storage</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üìä</div>
        <div class="step-name">Dashboard</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üîî</div>
        <div class="step-name">Alert</div>
      </div>
      <div class="pipeline-arrow">‚Üí</div>
      <div class="pipeline-step">
        <div class="step-icon">üë®‚Äçüíª</div>
        <div class="step-name">Your Team</div>
      </div>
    </div>

    <div class="highlight-box info">
      <strong>Popular Tools by Category:</strong><br>
      üö® Error Tracking: Sentry, Bugsnag, Rollbar<br>
      üìù Logging: Winston, Pino, Morgan (Node.js) | Datadog, Splunk, ELK Stack<br>
      ‚ö° Performance: Lighthouse, Web Vitals, New Relic, Datadog APM<br>
      üîî Alerting: PagerDuty, OpsGenie, Grafana Alerts
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-icon" style="background:rgba(239,68,68,0.1)">‚ùì</div>
      <h2>Why Does This Matter for Your Job Search?</h2>
    </div>

    <div class="grid-2">
      <div>
        <h3>Questions You'll Be Asked</h3>
        <ul class="checklist">
          <li>How do you handle errors in production?</li>
          <li>How would you debug a performance issue you can't reproduce?</li>
          <li>What logging strategy do you use?</li>
          <li>How do you know when your app is down before users call?</li>
          <li>Walk me through your observability setup</li>
        </ul>
      </div>
      <div>
        <h3>Companies That Care Most</h3>
        <ul class="checklist">
          <li>FAANG & high-scale startups</li>
          <li>Companies with microservices architecture</li>
          <li>Teams with SLAs (Service Level Agreements)</li>
          <li>Any team with on-call rotations</li>
          <li>Companies running on AWS/GCP/Azure</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- ==================== ERROR TRACKING ==================== -->
<section class="section" id="errortracking">
  <div class="section-header">
    <h2>üö® Error Tracking with Sentry</h2>
    <p>Catch, record, and triage every error in your production app</p>
  </div>

  <div class="section-tabs">
    <button class="section-tab active" onclick="showTab(this, 'et-concepts')">Concepts</button>
    <button class="section-tab" onclick="showTab(this, 'et-sentry')">Sentry Setup</button>
    <button class="section-tab" onclick="showTab(this, 'et-custom')">Custom Errors</button>
    <button class="section-tab" onclick="showTab(this, 'et-breadcrumbs')">Breadcrumbs</button>
    <button class="section-tab" onclick="showTab(this, 'et-demo')">Live Demo</button>
  </div>

  <div class="tab-content active" id="et-concepts">
    <div class="card">
      <h3>What Error Tracking Gives You</h3>
      <p>Without error tracking, you find out about bugs when users email you. With error tracking, you know before they do.</p>
      
      <div class="grid-2">
        <div>
          <h3>Without Error Tracking üò∞</h3>
          <ul class="checklist cross">
            <li>Users report bugs via email/Twitter</li>
            <li>You get "it's broken" with no context</li>
            <li>Can't reproduce the error</li>
            <li>No idea how many users affected</li>
            <li>Errors silently swallowed</li>
          </ul>
        </div>
        <div>
          <h3>With Error Tracking üéâ</h3>
          <ul class="checklist">
            <li>Instant notification on new errors</li>
            <li>Full stack trace + user context</li>
            <li>See exact file, line, column</li>
            <li>Know 1,200 users are affected</li>
            <li>Breadcrumbs show what happened first</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Types of JavaScript Errors</h3>
      <div class="grid-3">
        <div class="concept-box">
          <div class="icon">üí•</div>
          <h4>Unhandled Exceptions</h4>
          <p>TypeError, ReferenceError, etc. that crash your app. Most critical.</p>
        </div>
        <div class="concept-box">
          <div class="icon">ü§´</div>
          <h4>Unhandled Rejections</h4>
          <p>Promises that reject without a .catch(). Silent killers in async code.</p>
        </div>
        <div class="concept-box">
          <div class="icon">üîß</div>
          <h4>Custom Errors</h4>
          <p>Manually captured errors ‚Äî business logic failures you want to track.</p>
        </div>
        <div class="concept-box">
          <div class="icon">üìâ</div>
          <h4>Performance Issues</h4>
          <p>Slow API calls, render blocking, memory leaks tracked as events.</p>
        </div>
        <div class="concept-box">
          <div class="icon">üåê</div>
          <h4>Network Errors</h4>
          <p>Failed API calls, timeouts, CORS issues captured automatically.</p>
        </div>
        <div class="concept-box">
          <div class="icon">‚öõÔ∏è</div>
          <h4>Framework Errors</h4>
          <p>React Error Boundaries, Vue error handlers integrated automatically.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-content" id="et-sentry">
    <div class="card">
      <h3>üîß Sentry Setup ‚Äî Step by Step</h3>
      
      <div class="step-list">
        <div class="step-item">
          <div class="step-num">1</div>
          <div class="step-content">
            <h5>Install Sentry SDK</h5>
            <p>Add Sentry to your project via npm</p>
          </div>
        </div>
      </div>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Install via npm</span>
<span class="comment">// npm install @sentry/browser @sentry/tracing</span>

<span class="comment">// For Node.js</span>
<span class="comment">// npm install @sentry/node @sentry/tracing</span>

<span class="comment">// For React</span>
<span class="comment">// npm install @sentry/react @sentry/tracing</span>
      </div>

      <div class="step-list">
        <div class="step-item">
          <div class="step-num">2</div>
          <div class="step-content">
            <h5>Initialize Sentry (Browser)</h5>
            <p>Do this FIRST, before any other code runs</p>
          </div>
        </div>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/browser'</span>;
<span class="keyword">import</span> { BrowserTracing } <span class="keyword">from</span> <span class="string">'@sentry/tracing'</span>;

<span class="comment">// Initialize BEFORE everything else</span>
Sentry.<span class="function">init</span>({
  dsn: <span class="string">'https://yourkey@sentry.io/yourproject'</span>,
  
  <span class="comment">// Capture 100% of errors, 10% of performance traces</span>
  tracesSampleRate: <span class="number">0.1</span>,
  
  <span class="comment">// Identify which release caused the error</span>
  release: <span class="string">'my-app@1.2.3'</span>,
  
  <span class="comment">// Different behavior per environment</span>
  environment: process.env.<span class="property">NODE_ENV</span>,
  
  <span class="comment">// Filter out errors you don't care about</span>
  <span class="function">beforeSend</span>(event) {
    <span class="comment">// Don't send errors in development</span>
    <span class="keyword">if</span> (process.env.<span class="property">NODE_ENV</span> === <span class="string">'development'</span>) {
      <span class="keyword">return null</span>; <span class="comment">// null = don't send</span>
    }
    <span class="keyword">return</span> event;
  },
  
  <span class="comment">// Don't track these specific errors</span>
  ignoreErrors: [
    <span class="string">'ResizeObserver loop limit exceeded'</span>,
    <span class="string">'Non-Error promise rejection'</span>,
  ],
  
  integrations: [<span class="keyword">new</span> <span class="function">BrowserTracing</span>()],
});
      </div>

      <div class="step-list">
        <div class="step-item">
          <div class="step-num">3</div>
          <div class="step-content">
            <h5>Add User Context</h5>
            <p>Know WHICH user experienced the error</p>
          </div>
        </div>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Set user info after login</span>
<span class="keyword">function</span> <span class="function">onUserLogin</span>(user) {
  Sentry.<span class="function">setUser</span>({
    id: user.id,
    email: user.email,       <span class="comment">// careful with PII/GDPR!</span>
    username: user.name,
    plan: user.subscriptionPlan
  });
}

<span class="comment">// Clear on logout</span>
<span class="keyword">function</span> <span class="function">onUserLogout</span>() {
  Sentry.<span class="function">setUser</span>(<span class="keyword">null</span>);
}

<span class="comment">// Add custom context/tags</span>
Sentry.<span class="function">setTag</span>(<span class="string">'feature_flag'</span>, <span class="string">'new-checkout'</span>);
Sentry.<span class="function">setContext</span>(<span class="string">'cart'</span>, {
  itemCount: <span class="number">3</span>,
  totalValue: <span class="number">99.99</span>,
  currency: <span class="string">'USD'</span>
});
      </div>

      <div class="step-list">
        <div class="step-item">
          <div class="step-num">4</div>
          <div class="step-content">
            <h5>Node.js Setup</h5>
            <p>Server-side error tracking with Express</p>
          </div>
        </div>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="keyword">const</span> Sentry = <span class="function">require</span>(<span class="string">'@sentry/node'</span>);
<span class="keyword">const</span> express = <span class="function">require</span>(<span class="string">'express'</span>);

<span class="keyword">const</span> app = <span class="function">express</span>();

<span class="comment">// Must init BEFORE importing routes</span>
Sentry.<span class="function">init</span>({
  dsn: process.env.<span class="property">SENTRY_DSN</span>,
  tracesSampleRate: <span class="number">0.1</span>,
});

<span class="comment">// Request handler must be FIRST middleware</span>
app.<span class="function">use</span>(Sentry.<span class="property">Handlers</span>.<span class="function">requestHandler</span>());

<span class="comment">// Your routes here</span>
app.<span class="function">get</span>(<span class="string">'/'</span>, (req, res) => {
  <span class="keyword">throw new</span> <span class="function">Error</span>(<span class="string">'This will be caught!'</span>);
});

<span class="comment">// Error handler must be LAST, before other error middleware</span>
app.<span class="function">use</span>(Sentry.<span class="property">Handlers</span>.<span class="function">errorHandler</span>());

<span class="comment">// Optional: your own error handler after Sentry's</span>
app.<span class="function">use</span>(<span class="keyword">function</span>(err, req, res, next) {
  res.<span class="function">status</span>(<span class="number">500</span>).<span class="function">json</span>({
    error: <span class="string">'Internal Server Error'</span>,
    sentryId: res.<span class="property">sentry</span> <span class="comment">// Sentry ID to share with user</span>
  });
});
      </div>
    </div>
  </div>

  <div class="tab-content" id="et-custom">
    <div class="card">
      <h3>Manually Capturing Errors</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ============================================</span>
<span class="comment">// 1. Capture an exception (full stack trace)</span>
<span class="comment">// ============================================</span>
<span class="keyword">try</span> {
  <span class="keyword">const</span> result = JSON.<span class="function">parse</span>(badData);
} <span class="keyword">catch</span> (error) {
  Sentry.<span class="function">captureException</span>(error);
  <span class="comment">// Also show user a friendly message</span>
  showToast(<span class="string">'Something went wrong, we\'re looking into it!'</span>);
}

<span class="comment">// ============================================</span>
<span class="comment">// 2. Capture a message (no stack trace needed)</span>
<span class="comment">// ============================================</span>
Sentry.<span class="function">captureMessage</span>(<span class="string">'User hit rate limit'</span>, <span class="string">'warning'</span>);
Sentry.<span class="function">captureMessage</span>(<span class="string">'Payment failed'</span>, <span class="string">'error'</span>);
Sentry.<span class="function">captureMessage</span>(<span class="string">'Feature flag enabled'</span>, <span class="string">'info'</span>);

<span class="comment">// ============================================</span>
<span class="comment">// 3. Use withScope for one-off context</span>
<span class="comment">// ============================================</span>
Sentry.<span class="function">withScope</span>((scope) => {
  scope.<span class="function">setTag</span>(<span class="string">'payment_method'</span>, <span class="string">'stripe'</span>);
  scope.<span class="function">setExtra</span>(<span class="string">'order_id'</span>, order.id);
  scope.<span class="function">setLevel</span>(<span class="string">'error'</span>);
  Sentry.<span class="function">captureException</span>(paymentError);
});

<span class="comment">// ============================================</span>
<span class="comment">// 4. Create custom error classes</span>
<span class="comment">// ============================================</span>
<span class="keyword">class</span> <span class="function">PaymentError</span> <span class="keyword">extends</span> Error {
  <span class="function">constructor</span>(message, orderId, amount) {
    <span class="keyword">super</span>(message);
    <span class="keyword">this</span>.<span class="property">name</span> = <span class="string">'PaymentError'</span>;
    <span class="keyword">this</span>.<span class="property">orderId</span> = orderId;
    <span class="keyword">this</span>.<span class="property">amount</span> = amount;
  }
}

<span class="keyword">class</span> <span class="function">ValidationError</span> <span class="keyword">extends</span> Error {
  <span class="function">constructor</span>(field, value) {
    <span class="keyword">super</span>(<span class="string">`Invalid value for field: ${field}`</span>);
    <span class="keyword">this</span>.<span class="property">name</span> = <span class="string">'ValidationError'</span>;
    <span class="keyword">this</span>.<span class="property">field</span> = field;
    <span class="keyword">this</span>.<span class="property">value</span> = value;
  }
}

<span class="comment">// These show up with their class name in Sentry!</span>
<span class="keyword">throw new</span> <span class="function">PaymentError</span>(<span class="string">'Insufficient funds'</span>, <span class="string">'ord_123'</span>, <span class="number">99.99</span>);
      </div>
    </div>

    <div class="card">
      <h3>React Error Boundary with Sentry</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/react'</span>;

<span class="comment">// Method 1: Use Sentry's built-in ErrorBoundary component</span>
<span class="keyword">function</span> <span class="function">App</span>() {
  <span class="keyword">return</span> (
    &lt;<span class="tag">Sentry.ErrorBoundary</span>
      fallback={&lt;<span class="tag">p</span>&gt;Something broke! Our team was notified.&lt;/<span class="tag">p</span>&gt;}
      <span class="function">onError</span>={(error, info) => {
        console.<span class="function">error</span>(<span class="string">'Boundary caught:'</span>, error);
      }}
    &gt;
      &lt;<span class="tag">YourApp</span> /&gt;
    &lt;/<span class="tag">Sentry.ErrorBoundary</span>&gt;
  );
}

<span class="comment">// Method 2: Wrap components with profiling</span>
<span class="keyword">export default</span> Sentry.<span class="function">withProfiler</span>(App);

<span class="comment">// Method 3: Manual Error Boundary class</span>
<span class="keyword">class</span> <span class="function">ErrorBoundary</span> <span class="keyword">extends</span> React.Component {
  <span class="function">componentDidCatch</span>(error, errorInfo) {
    Sentry.<span class="function">withScope</span>((scope) => {
      scope.<span class="function">setExtra</span>(<span class="string">'componentStack'</span>, errorInfo.componentStack);
      Sentry.<span class="function">captureException</span>(error);
    });
  }

  <span class="function">render</span>() {
    <span class="keyword">if</span> (<span class="keyword">this</span>.<span class="property">state</span>.hasError) {
      <span class="keyword">return</span> &lt;<span class="tag">FallbackComponent</span> /&gt;;
    }
    <span class="keyword">return this</span>.<span class="property">props</span>.children;
  }
}
      </div>
    </div>
  </div>

  <div class="tab-content" id="et-breadcrumbs">
    <div class="card">
      <h3>üçû Breadcrumbs ‚Äî The Event Trail</h3>
      <p>Breadcrumbs record what happened <em>before</em> an error. Think of them as CCTV footage leading up to the crash.</p>
      
      <div class="breadcrumb">
        <div class="breadcrumb-item">Page loaded</div>
        <div class="breadcrumb-arrow">‚Üí</div>
        <div class="breadcrumb-item">User clicked "Add to Cart"</div>
        <div class="breadcrumb-arrow">‚Üí</div>
        <div class="breadcrumb-item">API call to /cart</div>
        <div class="breadcrumb-arrow">‚Üí</div>
        <div class="breadcrumb-item">Response: 500 error</div>
        <div class="breadcrumb-arrow">‚Üí</div>
        <div class="breadcrumb-item" style="color:var(--danger)">üí• TypeError: Cannot read 'id' of undefined</div>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Sentry automatically captures:</span>
<span class="comment">// - Console logs</span>
<span class="comment">// - Network requests</span>
<span class="comment">// - DOM interactions</span>
<span class="comment">// - Navigation events</span>

<span class="comment">// Add CUSTOM breadcrumbs for business events</span>
Sentry.<span class="function">addBreadcrumb</span>({
  category: <span class="string">'user-action'</span>,
  message: <span class="string">'User clicked checkout button'</span>,
  level: <span class="string">'info'</span>,
  data: {
    cartTotal: <span class="number">99.99</span>,
    itemCount: <span class="number">3</span>
  }
});

Sentry.<span class="function">addBreadcrumb</span>({
  category: <span class="string">'api'</span>,
  message: <span class="string">'POST /api/checkout'</span>,
  level: <span class="string">'info'</span>,
  data: {
    status: <span class="number">200</span>,
    duration: <span class="number">342</span>
  }
});

Sentry.<span class="function">addBreadcrumb</span>({
  category: <span class="string">'auth'</span>,
  message: <span class="string">'User session expired'</span>,
  level: <span class="string">'warning'</span>,
  timestamp: Date.<span class="function">now</span>() / <span class="number">1000</span>
});

<span class="comment">// Create a wrapper that auto-adds breadcrumbs</span>
<span class="keyword">async function</span> <span class="function">trackedFetch</span>(url, options) {
  <span class="keyword">const</span> start = performance.<span class="function">now</span>();
  
  Sentry.<span class="function">addBreadcrumb</span>({
    category: <span class="string">'fetch'</span>,
    message: <span class="string">`Request: ${url}`</span>,
    level: <span class="string">'info'</span>
  });

  <span class="keyword">try</span> {
    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(url, options);
    <span class="keyword">const</span> duration = performance.<span class="function">now</span>() - start;
    
    Sentry.<span class="function">addBreadcrumb</span>({
      category: <span class="string">'fetch'</span>,
      message: <span class="string">`Response: ${url} - ${response.status}`</span>,
      level: response.ok ? <span class="string">'info'</span> : <span class="string">'error'</span>,
      data: { status: response.status, duration: Math.<span class="function">round</span>(duration) }
    });
    
    <span class="keyword">return</span> response;
  } <span class="keyword">catch</span> (error) {
    Sentry.<span class="function">addBreadcrumb</span>({
      category: <span class="string">'fetch'</span>,
      message: <span class="string">`Failed: ${url}`</span>,
      level: <span class="string">'error'</span>
    });
    <span class="keyword">throw</span> error;
  }
}
      </div>
    </div>
  </div>

  <div class="tab-content" id="et-demo">
    <div class="card">
      <h3>üéÆ Interactive Sentry Dashboard Simulation</h3>
      <p>Click the buttons to simulate errors and see how they'd appear in Sentry:</p>
      
      <div class="btn-row">
        <button class="demo-btn" onclick="simulateError('TypeError')">üí• Throw TypeError</button>
        <button class="demo-btn" onclick="simulateError('NetworkError')">üåê Network Error</button>
        <button class="demo-btn" onclick="simulateError('CustomError')">üîß Custom Error</button>
        <button class="demo-btn" onclick="simulateError('UnhandledPromise')">ü§´ Unhandled Promise</button>
        <button class="demo-btn" onclick="clearErrors()">üóëÔ∏è Clear</button>
      </div>

      <div class="sentry-mock" id="sentryDashboard">
        <div class="sentry-header">
          <div class="sentry-logo">‚¨õ SENTRY</div>
          <div>
            <span class="badge badge-red" id="errorCount">0 Events</span>
            <span class="badge badge-purple">Production</span>
          </div>
        </div>
        <div id="sentryEvents">
          <p style="color:var(--text2); font-size:0.85rem; text-align:center; padding: 20px;">No errors yet. Trigger one above ‚Üë</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ==================== LOGGING ==================== -->
<section class="section" id="logging">
  <div class="section-header">
    <h2>üìù Logging Strategies</h2>
    <p>Write logs that actually help you debug production issues</p>
  </div>

  <div class="section-tabs">
    <button class="section-tab active" onclick="showTab(this, 'log-basics')">Log Levels</button>
    <button class="section-tab" onclick="showTab(this, 'log-structured')">Structured Logging</button>
    <button class="section-tab" onclick="showTab(this, 'log-winston')">Winston (Node)</button>
    <button class="section-tab" onclick="showTab(this, 'log-browser')">Browser Logging</button>
    <button class="section-tab" onclick="showTab(this, 'log-live')">Live Logger</button>
  </div>

  <div class="tab-content active" id="log-basics">
    <div class="card">
      <h3>Log Levels ‚Äî The Severity Ladder</h3>
      <p>Not all logs are equal. Log levels help you filter noise from signal:</p>
      
      <div class="comparison-table" style="overflow-x:auto">
        <table class="comparison-table">
          <thead>
            <tr><th>Level</th><th>When to Use</th><th>Example</th><th>Keep in Prod?</th></tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="badge badge-purple">DEBUG</span></td>
              <td>Detailed development info</td>
              <td>"Processing item index 5 of 100"</td>
              <td>‚ùå Usually filtered out</td>
            </tr>
            <tr>
              <td><span class="badge badge-blue">INFO</span></td>
              <td>Normal operational messages</td>
              <td>"User logged in successfully"</td>
              <td>‚úÖ Yes</td>
            </tr>
            <tr>
              <td><span class="badge badge-yellow">WARN</span></td>
              <td>Unexpected but recoverable</td>
              <td>"Rate limit hit, retrying in 2s"</td>
              <td>‚úÖ Yes, always</td>
            </tr>
            <tr>
              <td><span class="badge badge-red">ERROR</span></td>
              <td>Something failed</td>
              <td>"Payment processing failed"</td>
              <td>‚úÖ Yes, always</td>
            </tr>
            <tr>
              <td><span class="badge badge-red">FATAL</span></td>
              <td>App is going down</td>
              <td>"Database connection lost"</td>
              <td>‚úÖ Yes, always + alert!</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Basic usage in Node.js (without a library first)</span>
<span class="keyword">const</span> LOG_LEVELS = { DEBUG: <span class="number">0</span>, INFO: <span class="number">1</span>, WARN: <span class="number">2</span>, ERROR: <span class="number">3</span>, FATAL: <span class="number">4</span> };

<span class="keyword">const</span> CURRENT_LEVEL = process.env.<span class="property">NODE_ENV</span> === <span class="string">'production'</span>
  ? LOG_LEVELS.INFO   <span class="comment">// Production: INFO and above</span>
  : LOG_LEVELS.DEBUG; <span class="comment">// Development: everything</span>

<span class="keyword">function</span> <span class="function">log</span>(level, message, meta = {}) {
  <span class="keyword">if</span> (LOG_LEVELS[level] < CURRENT_LEVEL) <span class="keyword">return</span>;
  
  <span class="keyword">const</span> entry = {
    timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>(),
    level,
    message,
    ...meta
  };
  
  <span class="keyword">if</span> (level === <span class="string">'ERROR'</span> || level === <span class="string">'FATAL'</span>) {
    console.<span class="function">error</span>(JSON.<span class="function">stringify</span>(entry));
  } <span class="keyword">else</span> {
    console.<span class="function">log</span>(JSON.<span class="function">stringify</span>(entry));
  }
}

<span class="comment">// Usage</span>
<span class="function">log</span>(<span class="string">'INFO'</span>, <span class="string">'Server started'</span>, { port: <span class="number">3000</span> });
<span class="function">log</span>(<span class="string">'WARN'</span>, <span class="string">'Slow query detected'</span>, { duration: <span class="number">2100</span>, query: <span class="string">'SELECT *...'</span> });
<span class="function">log</span>(<span class="string">'ERROR'</span>, <span class="string">'Payment failed'</span>, { userId: <span class="number">123</span>, orderId: <span class="string">'ord_456'</span> });
      </div>
    </div>
  </div>

  <div class="tab-content" id="log-structured">
    <div class="card">
      <h3>Structured Logging ‚Äî JSON over Plain Text</h3>
      
      <div class="comparison">
        <div class="code-block bad-code">
<span class="comment">// ‚ùå UNSTRUCTURED - hard to search/parse</span>
console.<span class="function">log</span>(
  <span class="string">'User john@email.com (id: 123) logged in at 2024-01-15 from IP 192.168.1.1'</span>
);
<span class="comment">// Can you filter by user ID? Search by IP? NO!</span>
        </div>
        <div class="code-block good-code">
<span class="comment">// ‚úÖ STRUCTURED - fully queryable JSON</span>
console.<span class="function">log</span>(JSON.<span class="function">stringify</span>({
  <span class="property">timestamp</span>: <span class="string">'2024-01-15T10:30:00Z'</span>,
  <span class="property">level</span>: <span class="string">'info'</span>,
  <span class="property">event</span>: <span class="string">'user.login'</span>,
  <span class="property">userId</span>: <span class="number">123</span>,
  <span class="property">email</span>: <span class="string">'john@email.com'</span>,
  <span class="property">ip</span>: <span class="string">'192.168.1.1'</span>,
  <span class="property">service</span>: <span class="string">'auth-service'</span>
}));
<span class="comment">// Filter by userId=123? YES! Search IP? YES!</span>
        </div>
      </div>

      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Build a structured logger with consistent fields</span>
<span class="keyword">class</span> <span class="function">StructuredLogger</span> {
  <span class="function">constructor</span>(service, defaultMeta = {}) {
    <span class="keyword">this</span>.<span class="property">service</span> = service;
    <span class="keyword">this</span>.<span class="property">defaultMeta</span> = defaultMeta;
  }

  <span class="function">_log</span>(level, event, data = {}) {
    <span class="keyword">const</span> entry = {
      timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>(),
      level,
      service: <span class="keyword">this</span>.<span class="property">service</span>,
      event,
      traceId: <span class="keyword">this</span>.<span class="function">getTraceId</span>(),  <span class="comment">// Link to distributed trace</span>
      ...this.<span class="property">defaultMeta</span>,
      ...data
    };

    <span class="keyword">const</span> output = JSON.<span class="function">stringify</span>(entry);
    
    <span class="keyword">if</span> (level === <span class="string">'error'</span> || level === <span class="string">'fatal'</span>) {
      process.stderr.<span class="function">write</span>(output + <span class="string">'\n'</span>);
    } <span class="keyword">else</span> {
      process.stdout.<span class="function">write</span>(output + <span class="string">'\n'</span>);
    }
  }

  <span class="function">getTraceId</span>() {
    <span class="comment">// In real apps, get from request context (AsyncLocalStorage)</span>
    <span class="keyword">return</span> Math.<span class="function">random</span>().<span class="function">toString</span>(<span class="number">36</span>).<span class="function">slice</span>(<span class="number">2</span>);
  }

  <span class="function">debug</span>(event, data) { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'debug'</span>, event, data); }
  <span class="function">info</span>(event, data)  { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'info'</span>, event, data); }
  <span class="function">warn</span>(event, data)  { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'warn'</span>, event, data); }
  <span class="function">error</span>(event, data) { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'error'</span>, event, data); }
}

<span class="comment">// Usage</span>
<span class="keyword">const</span> logger = <span class="keyword">new</span> <span class="function">StructuredLogger</span>(<span class="string">'payment-service'</span>, {
  version: <span class="string">'2.1.0'</span>,
  env: process.env.<span class="property">NODE_ENV</span>
});

logger.<span class="function">info</span>(<span class="string">'payment.started'</span>, {
  userId: <span class="number">123</span>,
  amount: <span class="number">99.99</span>,
  currency: <span class="string">'USD'</span>,
  paymentMethod: <span class="string">'card'</span>
});

logger.<span class="function">error</span>(<span class="string">'payment.failed'</span>, {
  userId: <span class="number">123</span>,
  error: <span class="string">'insufficient_funds'</span>,
  retryable: <span class="keyword">false</span>
});
      </div>
    </div>
  </div>

  <div class="tab-content" id="log-winston">
    <div class="card">
      <h3>Winston ‚Äî The Standard Node.js Logger</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// npm install winston winston-daily-rotate-file</span>

<span class="keyword">const</span> winston = <span class="function">require</span>(<span class="string">'winston'</span>);
<span class="keyword">const</span> { <span class="function">combine</span>, timestamp, json, printf, colorize } = winston.format;

<span class="comment">// ============================================</span>
<span class="comment">// Custom format for development (pretty print)</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> devFormat = <span class="function">printf</span>(({ level, message, timestamp, ...meta }) => {
  <span class="keyword">const</span> metaStr = Object.<span class="function">keys</span>(meta).<span class="property">length</span>
    ? <span class="string">'\n'</span> + JSON.<span class="function">stringify</span>(meta, <span class="keyword">null</span>, <span class="number">2</span>)
    : <span class="string">''</span>;
  <span class="keyword">return</span> <span class="string">`[${timestamp}] ${level}: ${message}${metaStr}`</span>;
});

<span class="keyword">const</span> logger = winston.<span class="function">createLogger</span>({
  level: process.env.<span class="property">LOG_LEVEL</span> || <span class="string">'info'</span>,
  
  format: <span class="function">combine</span>(
    <span class="function">timestamp</span>(),
    <span class="function">json</span>()   <span class="comment">// Production: JSON for log aggregators</span>
  ),

  <span class="comment">// Add fields to every log</span>
  defaultMeta: {
    service: <span class="string">'user-service'</span>,
    version: process.env.<span class="property">APP_VERSION</span>,
    environment: process.env.<span class="property">NODE_ENV</span>
  },

  transports: [
    <span class="comment">// Console (always)</span>
    <span class="keyword">new</span> winston.transports.<span class="function">Console</span>({
      format: process.env.<span class="property">NODE_ENV</span> !== <span class="string">'production'</span>
        ? <span class="function">combine</span>(<span class="function">colorize</span>(), devFormat)
        : <span class="function">json</span>()
    }),

    <span class="comment">// Error log file (errors only)</span>
    <span class="keyword">new</span> winston.transports.<span class="function">File</span>({
      filename: <span class="string">'logs/error.log'</span>,
      level: <span class="string">'error'</span>,
      maxsize: <span class="number">10485760</span>,  <span class="comment">// 10MB</span>
      maxFiles: <span class="number">5</span>
    }),

    <span class="comment">// Combined log file (everything)</span>
    <span class="keyword">new</span> winston.transports.<span class="function">File</span>({
      filename: <span class="string">'logs/combined.log'</span>,
      maxsize: <span class="number">10485760</span>,
      maxFiles: <span class="number">10</span>
    })
  ],

  <span class="comment">// Handle uncaught exceptions automatically!</span>
  exceptionHandlers: [
    <span class="keyword">new</span> winston.transports.<span class="function">File</span>({ filename: <span class="string">'logs/exceptions.log'</span> })
  ],

  rejectionHandlers: [
    <span class="keyword">new</span> winston.transports.<span class="function">File</span>({ filename: <span class="string">'logs/rejections.log'</span> })
  ]
});

<span class="comment">// ============================================</span>
<span class="comment">// Child loggers for specific contexts</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> requestLogger = logger.<span class="function">child</span>({ component: <span class="string">'http'</span> });
<span class="keyword">const</span> dbLogger = logger.<span class="function">child</span>({ component: <span class="string">'database'</span> });
<span class="keyword">const</span> paymentLogger = logger.<span class="function">child</span>({ component: <span class="string">'payment'</span> });

<span class="comment">// ============================================</span>
<span class="comment">// Express request logging middleware</span>
<span class="comment">// ============================================</span>
<span class="keyword">function</span> <span class="function">requestLoggingMiddleware</span>(req, res, next) {
  <span class="keyword">const</span> start = Date.<span class="function">now</span>();

  res.<span class="function">on</span>(<span class="string">'finish'</span>, () => {
    requestLogger.<span class="function">info</span>(<span class="string">'http.request'</span>, {
      method: req.method,
      url: req.url,
      statusCode: res.statusCode,
      duration: Date.<span class="function">now</span>() - start,
      userAgent: req.<span class="function">get</span>(<span class="string">'User-Agent'</span>),
      ip: req.ip,
      userId: req.user?.id
    });
  });

  <span class="function">next</span>();
}

<span class="comment">// Usage</span>
logger.<span class="function">info</span>(<span class="string">'server.started'</span>, { port: <span class="number">3000</span> });
logger.<span class="function">warn</span>(<span class="string">'cache.miss'</span>, { key: <span class="string">'user:123'</span>, fallback: <span class="string">'database'</span> });
logger.<span class="function">error</span>(<span class="string">'db.query.failed'</span>, { error: err.message, query: <span class="string">'SELECT...'</span> });
      </div>
    </div>
  </div>

  <div class="tab-content" id="log-browser">
    <div class="card">
      <h3>Browser-Side Logging</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ============================================</span>
<span class="comment">// Browser Logger ‚Äî sends logs to your backend</span>
<span class="comment">// ============================================</span>
<span class="keyword">class</span> <span class="function">BrowserLogger</span> {
  <span class="function">constructor</span>(options = {}) {
    <span class="keyword">this</span>.<span class="property">endpoint</span> = options.endpoint || <span class="string">'/api/logs'</span>;
    <span class="keyword">this</span>.<span class="property">buffer</span> = [];
    <span class="keyword">this</span>.<span class="property">flushInterval</span> = options.flushInterval || <span class="number">5000</span>;
    <span class="keyword">this</span>.<span class="property">maxBuffer</span> = options.maxBuffer || <span class="number">100</span>;
    
    <span class="comment">// Batch send every 5 seconds</span>
    <span class="function">setInterval</span>(() => <span class="keyword">this</span>.<span class="function">flush</span>(), <span class="keyword">this</span>.<span class="property">flushInterval</span>);
    
    <span class="comment">// Send remaining logs when user leaves</span>
    window.<span class="function">addEventListener</span>(<span class="string">'beforeunload'</span>, () => <span class="keyword">this</span>.<span class="function">flushSync</span>());
    
    <span class="comment">// Capture uncaught errors</span>
    window.<span class="property">onerror</span> = (msg, src, line, col, error) => {
      <span class="keyword">this</span>.<span class="function">error</span>(<span class="string">'window.error'</span>, { msg, src, line, col, stack: error?.stack });
    };
    
    <span class="comment">// Capture unhandled promise rejections</span>
    window.<span class="function">addEventListener</span>(<span class="string">'unhandledrejection'</span>, (event) => {
      <span class="keyword">this</span>.<span class="function">error</span>(<span class="string">'unhandled.rejection'</span>, { 
        reason: event.reason?.message || String(event.reason)
      });
    });
  }

  <span class="function">_log</span>(level, event, data = {}) {
    <span class="keyword">const</span> entry = {
      timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>(),
      level,
      event,
      url: window.location.href,
      userAgent: navigator.userAgent,
      sessionId: <span class="keyword">this</span>.<span class="function">getSessionId</span>(),
      ...data
    };

    <span class="keyword">this</span>.<span class="property">buffer</span>.<span class="function">push</span>(entry);

    <span class="comment">// Emergency flush if buffer is full</span>
    <span class="keyword">if</span> (<span class="keyword">this</span>.<span class="property">buffer</span>.<span class="property">length</span> >= <span class="keyword">this</span>.<span class="property">maxBuffer</span>) {
      <span class="keyword">this</span>.<span class="function">flush</span>();
    }
    
    <span class="comment">// Always log to console in dev</span>
    <span class="keyword">if</span> (process.env.<span class="property">NODE_ENV</span> !== <span class="string">'production'</span>) {
      console[level === <span class="string">'error'</span> ? <span class="string">'error'</span> : <span class="string">'log'</span>](
        <span class="string">`[${level.toUpperCase()}] ${event}`</span>, data
      );
    }
  }

  <span class="keyword">async</span> <span class="function">flush</span>() {
    <span class="keyword">if</span> (<span class="keyword">this</span>.<span class="property">buffer</span>.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span>;
    
    <span class="keyword">const</span> logs = [...<span class="keyword">this</span>.<span class="property">buffer</span>];
    <span class="keyword">this</span>.<span class="property">buffer</span> = [];

    <span class="keyword">try</span> {
      <span class="keyword">await</span> <span class="function">fetch</span>(<span class="keyword">this</span>.<span class="property">endpoint</span>, {
        method: <span class="string">'POST'</span>,
        headers: { <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> },
        body: JSON.<span class="function">stringify</span>({ logs })
      });
    } <span class="keyword">catch</span> {
      <span class="comment">// Re-queue if send fails (don't lose logs!)</span>
      <span class="keyword">this</span>.<span class="property">buffer</span> = [...logs, ...<span class="keyword">this</span>.<span class="property">buffer</span>];
    }
  }

  <span class="comment">// Use sendBeacon for page unload (reliable!)</span>
  <span class="function">flushSync</span>() {
    <span class="keyword">if</span> (<span class="keyword">this</span>.<span class="property">buffer</span>.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span>;
    navigator.<span class="function">sendBeacon</span>(
      <span class="keyword">this</span>.<span class="property">endpoint</span>,
      JSON.<span class="function">stringify</span>({ logs: <span class="keyword">this</span>.<span class="property">buffer</span> })
    );
  }

  <span class="function">getSessionId</span>() {
    <span class="keyword">if</span> (!sessionStorage.<span class="function">getItem</span>(<span class="string">'logSessionId'</span>)) {
      sessionStorage.<span class="function">setItem</span>(<span class="string">'logSessionId'</span>,
        Math.<span class="function">random</span>().<span class="function">toString</span>(<span class="number">36</span>).<span class="function">slice</span>(<span class="number">2</span>));
    }
    <span class="keyword">return</span> sessionStorage.<span class="function">getItem</span>(<span class="string">'logSessionId'</span>);
  }

  <span class="function">info</span>(event, data) { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'info'</span>, event, data); }
  <span class="function">warn</span>(event, data) { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'warn'</span>, event, data); }
  <span class="function">error</span>(event, data) { <span class="keyword">this</span>.<span class="function">_log</span>(<span class="string">'error'</span>, event, data); }
}

<span class="keyword">const</span> logger = <span class="keyword">new</span> <span class="function">BrowserLogger</span>({ endpoint: <span class="string">'/api/logs'</span> });
logger.<span class="function">info</span>(<span class="string">'page.view'</span>, { page: <span class="string">'checkout'</span>, referrer: document.referrer });
      </div>
    </div>
  </div>

  <div class="tab-content" id="log-live">
    <div class="card">
      <h3>üéÆ Live Logger Demo</h3>
      <p>Watch a simulated log stream with different levels:</p>
      
      <div class="btn-row">
        <button class="demo-btn" id="logStartBtn" onclick="toggleLogStream()">‚ñ∂ Start Log Stream</button>
        <button class="demo-btn" onclick="addManualLog('info')">üìò INFO</button>
        <button class="demo-btn" onclick="addManualLog('warn')">üìô WARN</button>
        <button class="demo-btn" onclick="addManualLog('error')">üìï ERROR</button>
        <button class="demo-btn" onclick="addManualLog('debug')">üìó DEBUG</button>
        <button class="demo-btn" onclick="clearLog()">üóëÔ∏è Clear</button>
      </div>

      <div style="margin: 12px 0; display:flex; gap: 8px; align-items: center; flex-wrap: wrap;">
        <span style="color:var(--text2); font-size:0.82rem;">Filter:</span>
        <button class="demo-btn active" id="filter-all" onclick="setLogFilter('all')">All</button>
        <button class="demo-btn" id="filter-error" onclick="setLogFilter('error')">Errors Only</button>
        <button class="demo-btn" id="filter-warn" onclick="setLogFilter('warn')">Warn+</button>
      </div>

      <div class="demo-container">
        <div class="demo-log" id="demoLog">
          <div style="color:var(--text2); font-size:0.8rem; padding: 8px;">Waiting for logs...</div>
        </div>
      </div>

      <div class="grid-3" style="margin-top: 16px;">
        <div class="metric-card">
          <div class="metric-label">Total Logs</div>
          <div class="metric-value" style="color:var(--accent)" id="metricTotal">0</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">Errors</div>
          <div class="metric-value" style="color:var(--danger)" id="metricErrors">0</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">Warnings</div>
          <div class="metric-value" style="color:var(--accent4)" id="metricWarns">0</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ==================== PERFORMANCE ==================== -->
<section class="section" id="performance">
  <div class="section-header">
    <h2>‚ö° Performance Monitoring</h2>
    <p>Measure, track, and improve your app's speed and user experience</p>
  </div>

  <div class="section-tabs">
    <button class="section-tab active" onclick="showTab(this, 'perf-vitals')">Core Web Vitals</button>
    <button class="section-tab" onclick="showTab(this, 'perf-api')">Performance API</button>
    <button class="section-tab" onclick="showTab(this, 'perf-custom')">Custom Metrics</button>
    <button class="section-tab" onclick="showTab(this, 'perf-live')">Live Monitor</button>
  </div>

  <div class="tab-content active" id="perf-vitals">
    <div class="card">
      <h3>Core Web Vitals ‚Äî Google's User Experience Metrics</h3>
      <p>These metrics directly affect your Google search ranking AND user experience:</p>
      
      <div class="grid-3">
        <div class="concept-box">
          <div class="icon">üé®</div>
          <h4>LCP</h4>
          <p><strong>Largest Contentful Paint</strong><br>How fast does the main content load?</p>
          <br>
          <span class="badge badge-green">Good: &lt;2.5s</span><br>
          <span class="badge badge-yellow">OK: 2.5-4s</span><br>
          <span class="badge badge-red">Bad: &gt;4s</span>
        </div>
        <div class="concept-box">
          <div class="icon">‚ö°</div>
          <h4>FID / INP</h4>
          <p><strong>Interaction to Next Paint</strong><br>How fast does it respond to clicks?</p>
          <br>
          <span class="badge badge-green">Good: &lt;200ms</span><br>
          <span class="badge badge-yellow">OK: 200-500ms</span><br>
          <span class="badge badge-red">Bad: &gt;500ms</span>
        </div>
        <div class="concept-box">
          <div class="icon">üìê</div>
          <h4>CLS</h4>
          <p><strong>Cumulative Layout Shift</strong><br>Does the page jump around?</p>
          <br>
          <span class="badge badge-green">Good: &lt;0.1</span><br>
          <span class="badge badge-yellow">OK: 0.1-0.25</span><br>
          <span class="badge badge-red">Bad: &gt;0.25</span>
        </div>
        <div class="concept-box">
          <div class="icon">üî∑</div>
          <h4>FCP</h4>
          <p><strong>First Contentful Paint</strong><br>When does ANY content appear?</p>
          <br>
          <span class="badge badge-green">Good: &lt;1.8s</span><br>
          <span class="badge badge-yellow">OK: 1.8-3s</span><br>
          <span class="badge badge-red">Bad: &gt;3s</span>
        </div>
        <div class="concept-box">
          <div class="icon">‚è±Ô∏è</div>
          <h4>TTFB</h4>
          <p><strong>Time to First Byte</strong><br>How fast is your server response?</p>
          <br>
          <span class="badge badge-green">Good: &lt;800ms</span><br>
          <span class="badge badge-yellow">OK: 800ms-1.8s</span><br>
          <span class="badge badge-red">Bad: &gt;1.8s</span>
        </div>
        <div class="concept-box">
          <div class="icon">üéØ</div>
          <h4>TTI</h4>
          <p><strong>Time to Interactive</strong><br>When can users actually use it?</p>
          <br>
          <span class="badge badge-green">Good: &lt;3.8s</span><br>
          <span class="badge badge-yellow">OK: 3.8-7.3s</span><br>
          <span class="badge badge-red">Bad: &gt;7.3s</span>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Measuring Core Web Vitals in JavaScript</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// npm install web-vitals</span>
<span class="keyword">import</span> { onCLS, onFID, onFCP, onLCP, onTTFB, onINP } <span class="keyword">from</span> <span class="string">'web-vitals'</span>;

<span class="comment">// ============================================</span>
<span class="comment">// Send vitals to your analytics endpoint</span>
<span class="comment">// ============================================</span>
<span class="keyword">function</span> <span class="function">sendVital</span>({ name, value, rating, id }) {
  <span class="comment">// rating = 'good' | 'needs-improvement' | 'poor'</span>
  
  <span class="comment">// Send to Google Analytics 4</span>
  gtag(<span class="string">'event'</span>, name, {
    value: Math.<span class="function">round</span>(name === <span class="string">'CLS'</span> ? value * <span class="number">1000</span> : value),
    metric_id: id,
    metric_value: value,
    metric_rating: rating
  });

  <span class="comment">// Send to your own backend</span>
  navigator.<span class="function">sendBeacon</span>(<span class="string">'/api/vitals'</span>, JSON.<span class="function">stringify</span>({
    name,
    value,
    rating,
    page: window.location.pathname,
    timestamp: Date.<span class="function">now</span>()
  }));
  
  <span class="comment">// Alert if performance is poor</span>
  <span class="keyword">if</span> (rating === <span class="string">'poor'</span>) {
    console.<span class="function">warn</span>(<span class="string">`‚ö†Ô∏è Poor ${name}: ${value}`</span>);
    Sentry.<span class="function">captureMessage</span>(<span class="string">`Poor ${name}: ${value}`</span>, <span class="string">'warning'</span>);
  }
}

<span class="comment">// Register all vital observers</span>
<span class="function">onCLS</span>(sendVital);   <span class="comment">// Layout shifts</span>
<span class="function">onFCP</span>(sendVital);   <span class="comment">// First content</span>
<span class="function">onLCP</span>(sendVital);   <span class="comment">// Largest content</span>
<span class="function">onINP</span>(sendVital);   <span class="comment">// Interaction delay</span>
<span class="function">onTTFB</span>(sendVital);  <span class="comment">// Server response</span>

<span class="comment">// ============================================</span>
<span class="comment">// Without the library (manual measurement)</span>
<span class="comment">// ============================================</span>

<span class="comment">// Measure LCP manually</span>
<span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="function">PerformanceObserver</span>((list) => {
  <span class="keyword">const</span> entries = list.<span class="function">getEntries</span>();
  <span class="keyword">const</span> lastEntry = entries[entries.length - <span class="number">1</span>];
  console.<span class="function">log</span>(<span class="string">'LCP:'</span>, lastEntry.startTime); <span class="comment">// in ms</span>
});

observer.<span class="function">observe</span>({ type: <span class="string">'largest-contentful-paint'</span>, buffered: <span class="keyword">true</span> });
      </div>
    </div>
  </div>

  <div class="tab-content" id="perf-api">
    <div class="card">
      <h3>Browser Performance API</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ============================================</span>
<span class="comment">// 1. Navigation Timing ‚Äî page load breakdown</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> [navEntry] = performance.<span class="function">getEntriesByType</span>(<span class="string">'navigation'</span>);

console.<span class="function">log</span>({
  <span class="comment">// DNS lookup time</span>
  dns: navEntry.domainLookupEnd - navEntry.domainLookupStart,
  <span class="comment">// TCP connection time</span>
  tcp: navEntry.connectEnd - navEntry.connectStart,
  <span class="comment">// Time to First Byte</span>
  ttfb: navEntry.responseStart - navEntry.requestStart,
  <span class="comment">// Page download time</span>
  download: navEntry.responseEnd - navEntry.responseStart,
  <span class="comment">// DOM parsing time</span>
  domParsing: navEntry.domContentLoadedEventEnd - navEntry.responseEnd,
  <span class="comment">// Total page load</span>
  pageLoad: navEntry.loadEventEnd - navEntry.startTime,
});

<span class="comment">// ============================================</span>
<span class="comment">// 2. Resource Timing ‚Äî individual asset loads</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> resources = performance.<span class="function">getEntriesByType</span>(<span class="string">'resource'</span>);

<span class="comment">// Find slowest resources</span>
<span class="keyword">const</span> slowResources = resources
  .<span class="function">filter</span>(r => r.duration > <span class="number">500</span>)  <span class="comment">// > 500ms</span>
  .<span class="function">map</span>(r => ({
    name: r.name,
    duration: Math.<span class="function">round</span>(r.duration),
    size: r.transferSize,
    type: r.initiatorType
  }))
  .<span class="function">sort</span>((a, b) => b.duration - a.duration);

console.<span class="function">log</span>(<span class="string">'Slow resources:'</span>, slowResources);

<span class="comment">// ============================================</span>
<span class="comment">// 3. User Timing ‚Äî custom measurements</span>
<span class="comment">// ============================================</span>

<span class="comment">// Mark the start of an operation</span>
performance.<span class="function">mark</span>(<span class="string">'checkout:start'</span>);

<span class="keyword">await</span> <span class="function">processCheckout</span>(cart);

<span class="comment">// Mark the end</span>
performance.<span class="function">mark</span>(<span class="string">'checkout:end'</span>);

<span class="comment">// Create a measure between two marks</span>
performance.<span class="function">measure</span>(<span class="string">'checkout-duration'</span>, <span class="string">'checkout:start'</span>, <span class="string">'checkout:end'</span>);

<span class="comment">// Read the measurement</span>
<span class="keyword">const</span> [measure] = performance.<span class="function">getEntriesByName</span>(<span class="string">'checkout-duration'</span>);
console.<span class="function">log</span>(<span class="string">`Checkout took: ${measure.duration}ms`</span>);

<span class="comment">// ============================================</span>
<span class="comment">// 4. Observe long tasks (blocking main thread)</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> longTaskObserver = <span class="keyword">new</span> <span class="function">PerformanceObserver</span>((list) => {
  list.<span class="function">getEntries</span>().<span class="function">forEach</span>((entry) => {
    console.<span class="function">warn</span>(<span class="string">`Long task detected: ${entry.duration}ms`</span>);
    
    <span class="comment">// Report to monitoring</span>
    <span class="keyword">if</span> (entry.duration > <span class="number">200</span>) {
      <span class="function">reportLongTask</span>(entry);
    }
  });
});

longTaskObserver.<span class="function">observe</span>({ type: <span class="string">'longtask'</span>, buffered: <span class="keyword">true</span> });
      </div>
    </div>
  </div>

  <div class="tab-content" id="perf-custom">
    <div class="card">
      <h3>Custom Performance Metrics</h3>
      
      <div class="code-block">
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ============================================</span>
<span class="comment">// Build a performance monitor class</span>
<span class="comment">// ============================================</span>
<span class="keyword">class</span> <span class="function">PerformanceMonitor</span> {
  <span class="function">constructor</span>() {
    <span class="keyword">this</span>.<span class="property">metrics</span> = <span class="keyword">new</span> <span class="function">Map</span>();
    <span class="keyword">this</span>.<span class="property">thresholds</span> = {
      <span class="property">api</span>: <span class="number">1000</span>,         <span class="comment">// 1s for API calls</span>
      <span class="property">render</span>: <span class="number">16</span>,        <span class="comment">// 16ms for render (60fps)</span>
      <span class="property">interaction</span>: <span class="number">100</span>  <span class="comment">// 100ms for interactions</span>
    };
  }

  <span class="comment">// Measure async operations</span>
  <span class="keyword">async</span> <span class="function">measure</span>(name, fn) {
    <span class="keyword">const</span> start = performance.<span class="function">now</span>();
    <span class="keyword">let</span> error = <span class="keyword">null</span>;
    <span class="keyword">let</span> result;

    <span class="keyword">try</span> {
      result = <span class="keyword">await</span> <span class="function">fn</span>();
    } <span class="keyword">catch</span> (e) {
      error = e;
    }

    <span class="keyword">const</span> duration = performance.<span class="function">now</span>() - start;

    <span class="keyword">this</span>.<span class="function">record</span>(name, duration, !!error);

    <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;
    <span class="keyword">return</span> result;
  }

  <span class="function">record</span>(name, duration, isError = <span class="keyword">false</span>) {
    <span class="keyword">if</span> (!<span class="keyword">this</span>.<span class="property">metrics</span>.<span class="function">has</span>(name)) {
      <span class="keyword">this</span>.<span class="property">metrics</span>.<span class="function">set</span>(name, { count: <span class="number">0</span>, total: <span class="number">0</span>, errors: <span class="number">0</span>, samples: [] });
    }

    <span class="keyword">const</span> m = <span class="keyword">this</span>.<span class="property">metrics</span>.<span class="function">get</span>(name);
    m.count++;
    m.total += duration;
    <span class="keyword">if</span> (isError) m.errors++;
    m.samples.<span class="function">push</span>(duration);
    
    <span class="comment">// Keep only last 100 samples</span>
    <span class="keyword">if</span> (m.samples.<span class="property">length</span> > <span class="number">100</span>) m.samples.<span class="function">shift</span>();

    <span class="comment">// Check thresholds</span>
    <span class="keyword">const</span> threshold = <span class="keyword">this</span>.<span class="property">thresholds</span>[name.split(<span class="string">'.'</span>)[<span class="number">0</span>]];
    <span class="keyword">if</span> (threshold && duration > threshold) {
      console.<span class="function">warn</span>(<span class="string">`‚ö†Ô∏è Slow ${name}: ${Math.round(duration)}ms (threshold: ${threshold}ms)`</span>);
    }
  }

  <span class="function">getStats</span>(name) {
    <span class="keyword">const</span> m = <span class="keyword">this</span>.<span class="property">metrics</span>.<span class="function">get</span>(name);
    <span class="keyword">if</span> (!m) <span class="keyword">return null</span>;

    <span class="keyword">const</span> sorted = [...m.samples].<span class="function">sort</span>((a, b) => a - b);
    <span class="keyword">const</span> p = (pct) => sorted[Math.<span class="function">floor</span>(sorted.<span class="property">length</span> * pct)];

    <span class="keyword">return</span> {
      count: m.count,
      avg: Math.<span class="function">round</span>(m.total / m.count),
      p50: Math.<span class="function">round</span>(<span class="function">p</span>(<span class="number">0.5</span>)),
      p75: Math.<span class="function">round</span>(<span class="function">p</span>(<span class="number">0.75</span>)),
      p95: Math.<span class="function">round</span>(<span class="function">p</span>(<span class="number">0.95</span>)),
      p99: Math.<span class="function">round</span>(<span class="function">p</span>(<span class="number">0.99</span>)),
      errorRate: ((m.errors / m.count) * <span class="number">100</span>).<span class="function">toFixed</span>(<span class="number">1</span>) + <span class="string">'%'</span>
    };
  }

  <span class="comment">// Decorator for automatic measuring</span>
  <span class="function">track</span>(name) {
    <span class="keyword">return</span> (target, key, descriptor) => {
      <span class="keyword">const</span> original = descriptor.value;
      descriptor.value = <span class="keyword">async function</span>(...args) {
        <span class="keyword">return</span> monitor.<span class="function">measure</span>(name, () => original.<span class="function">apply</span>(<span class="keyword">this</span>, args));
      };
      <span class="keyword">return</span> descriptor;
    };
  }
}

<span class="keyword">const</span> monitor = <span class="keyword">new</span> <span class="function">PerformanceMonitor</span>();

<span class="comment">// Usage</span>
<span class="keyword">await</span> monitor.<span class="function">measure</span>(<span class="string">'api.fetchUser'</span>, () => <span class="function">fetch</span>(<span class="string">'/api/user'</span>));
<span class="keyword">await</span> monitor.<span class="function">measure</span>(<span class="string">'api.fetchProducts'</span>, () => <span class="function">fetchProducts</span>());

console.<span class="function">log</span>(monitor.<span class="function">getStats</span>(<span class="string">'api.fetchUser'</span>));
<span class="comment">// { count: 50, avg: 243, p50: 210, p75: 320, p95: 850, p99: 1200, errorRate: '2.0%' }</span>
      </div>
    </div>
  </div>

  <div class="tab-content" id="perf-live">
    <div class="card">
      <h3>üéÆ Live Performance Dashboard</h3>
      
      <div class="grid-3" style="margin-bottom:20px">
        <div class="metric-card">
          <div class="metric-label">Page Load (LCP)</div>
          <div class="metric-value" style="color:var(--accent3)" id="pm-lcp">1.8s</div>
          <div class="metric-trend trend-down">‚Üì 0.2s vs last hour</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">API Avg Response</div>
          <div class="metric-value" style="color:var(--accent)" id="pm-api">243ms</div>
          <div class="metric-trend trend-up">‚Üë 12ms vs last hour</div>
        </div>
        <div class="metric-card">
          <div class="metric-label">Error Rate</div>
          <div class="metric-value" style="color:var(--danger)" id="pm-errors">0.3%</div>
          <div class="metric-trend trend-down">‚Üì 0.1% vs last hour</div>
        </div>
      </div>

      <h4 style="color:var(--text2); margin-bottom: 12px; font-size:0.9rem">API Endpoint Performance</h4>
      
      <div id="perfBars">
        <div class="perf-bar-container">
          <div class="perf-bar-label"><span>GET /api/users</span><span id="bar1-val">180ms</span></div>
          <div class="perf-bar"><div class="perf-bar-fill" id="bar1" style="width:18%;background:var(--accent3)"></div></div>
        </div>
        <div class="perf-bar-container">
          <div class="perf-bar-label"><span>POST /api/checkout</span><span id="bar2-val">540ms</span></div>
          <div class="perf-bar"><div class="perf-bar-fill" id="bar2" style="width:54%;background:var(--accent4)"></div></div>
        </div>
        <div class="perf-bar-container">
          <div class="perf-bar-label"><span>GET /api/products</span><span id="bar3-val">320ms</span></div>
          <div class="perf-bar"><div class="perf-bar-fill" id="bar3" style="width:32%;background:var(--accent3)"></div></div>
        </div>
        <div class="perf-bar-container">
          <div class="perf-bar-label"><span>GET /api/inventory</span><span id="bar4-val">890ms</span></div>
          <div class="perf-bar"><div class="perf-bar-fill" id="bar4" style="width:89%;background:var(--danger)"></div></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="demo-btn" onclick="simulateLoad()">üîÑ Simulate Load</button>
        <button class="demo-btn" onclick="simulateSlowdown()">üêå Simulate Slowdown</button>
        <button class="demo-btn" onclick="resetPerf()">‚Ü∫ Reset</button>
      </div>
    </div>
  </div>
</section>

<!-- ==================== ALERTING ==================== -->
<section class="section" id="alerting">
  <div class="section-header">
    <h2>üîî Alerting Systems</h2>
    <p>Get notified about problems before your users do</p>
  </div>

  <div class="card">
    <h3>Alert Design Principles</h3>
    
    <div class="grid-2">
      <div>
        <h3>Good Alerts Should Be...</h3>
        <ul class="checklist">
          <li>Actionable ‚Äî you can DO something about it</li>
          <li>Urgent ‚Äî it actually needs attention now</li>
          <li>Novel ‚Äî not the same alert every 5 minutes</li>
          <li>Contextual ‚Äî include enough info to act</li>
          <li>Routed right ‚Äî sent to the right person</li>
        </ul>
      </div>
      <div>
        <h3>Alert Fatigue Killers</h3>
        <ul class="checklist cross">
          <li>Alerts that fire but never need action</li>
          <li>Duplicate alerts for same issue</li>
          <li>Vague alerts with no context</li>
          <li>Alerts on every tiny spike</li>
          <li>Alerting on symptoms not causes</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>Alert Severity Levels</h3>
    
    <div class="comparison-table" style="overflow-x:auto">
      <table class="comparison-table">
        <thead>
          <tr><th>Severity</th><th>Example</th><th>Response Time</th><th>Wake at Night?</th></tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="badge badge-red">P0 Critical</span></td>
            <td>Site is down, no users can access</td>
            <td>&lt; 5 minutes</td>
            <td>üö® YES</td>
          </tr>
          <tr>
            <td><span class="badge badge-orange">P1 High</span></td>
            <td>Payments failing, major feature broken</td>
            <td>&lt; 30 minutes</td>
            <td>‚ö†Ô∏è Yes, urgent</td>
          </tr>
          <tr>
            <td><span class="badge badge-yellow">P2 Medium</span></td>
            <td>Error rate elevated, slowdown detected</td>
            <td>&lt; 4 hours</td>
            <td>üïê Business hours</td>
          </tr>
          <tr>
            <td><span class="badge badge-blue">P3 Low</span></td>
            <td>Minor bug, non-critical feature issue</td>
            <td>Next business day</td>
            <td>‚ùå No</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card">
    <h3>Implementing Alerts in JavaScript</h3>
    
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ============================================</span>
<span class="comment">// Alerting System ‚Äî complete implementation</span>
<span class="comment">// ============================================</span>
<span class="keyword">class</span> <span class="function">AlertManager</span> {
  <span class="function">constructor</span>() {
    <span class="keyword">this</span>.<span class="property">rules</span> = [];
    <span class="keyword">this</span>.<span class="property">cooldowns</span> = <span class="keyword">new</span> <span class="function">Map</span>();  <span class="comment">// Prevent alert storms</span>
    <span class="keyword">this</span>.<span class="property">channels</span> = {};
  }

  <span class="comment">// Add notification channels</span>
  <span class="function">addChannel</span>(name, handler) {
    <span class="keyword">this</span>.<span class="property">channels</span>[name] = handler;
    <span class="keyword">return this</span>;
  }

  <span class="comment">// Define an alert rule</span>
  <span class="function">addRule</span>(rule) {
    <span class="comment">/*
    rule = {
      name: 'High Error Rate',
      condition: (metrics) => metrics.errorRate > 5,
      severity: 'critical',
      channels: ['slack', 'pagerduty'],
      cooldownMs: 300000,  // 5 min between alerts
      message: (metrics) => `Error rate: ${metrics.errorRate}%`
    }
    */</span>
    <span class="keyword">this</span>.<span class="property">rules</span>.<span class="function">push</span>(rule);
    <span class="keyword">return this</span>;
  }

  <span class="keyword">async</span> <span class="function">evaluate</span>(metrics) {
    <span class="keyword">for</span> (<span class="keyword">const</span> rule <span class="keyword">of</span> <span class="keyword">this</span>.<span class="property">rules</span>) {
      <span class="keyword">if</span> (!rule.<span class="function">condition</span>(metrics)) <span class="keyword">continue</span>;

      <span class="comment">// Check cooldown (don't spam alerts)</span>
      <span class="keyword">const</span> lastFired = <span class="keyword">this</span>.<span class="property">cooldowns</span>.<span class="function">get</span>(rule.name) || <span class="number">0</span>;
      <span class="keyword">const</span> cooldown = rule.cooldownMs || <span class="number">60000</span>;
      <span class="keyword">if</span> (Date.<span class="function">now</span>() - lastFired < cooldown) <span class="keyword">continue</span>;

      <span class="keyword">this</span>.<span class="property">cooldowns</span>.<span class="function">set</span>(rule.name, Date.<span class="function">now</span>());

      <span class="keyword">const</span> alert = {
        name: rule.name,
        severity: rule.severity,
        message: rule.<span class="function">message</span>(metrics),
        timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>(),
        metrics
      };

      <span class="comment">// Fire all configured channels</span>
      <span class="keyword">await</span> Promise.<span class="function">allSettled</span>(
        rule.channels.<span class="function">map</span>(ch =>
          <span class="keyword">this</span>.<span class="property">channels</span>[ch]?.(alert)
        )
      );
    }
  }
}

<span class="comment">// ============================================</span>
<span class="comment">// Channel implementations</span>
<span class="comment">// ============================================</span>

<span class="comment">// Slack webhook</span>
<span class="keyword">async function</span> <span class="function">slackChannel</span>(alert) {
  <span class="keyword">const</span> emoji = { critical: <span class="string">'üö®'</span>, high: <span class="string">'‚ö†Ô∏è'</span>, medium: <span class="string">'‚ö°'</span>, low: <span class="string">'‚ÑπÔ∏è'</span> };
  
  <span class="keyword">await</span> <span class="function">fetch</span>(process.env.<span class="property">SLACK_WEBHOOK</span>, {
    method: <span class="string">'POST'</span>,
    headers: { <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> },
    body: JSON.<span class="function">stringify</span>({
      text: <span class="string">`${emoji[alert.severity]} *${alert.name}*: ${alert.message}`,</span>
      attachments: [{
        color: alert.severity === <span class="string">'critical'</span> ? <span class="string">'danger'</span> : <span class="string">'warning'</span>,
        fields: [
          { title: <span class="string">'Severity'</span>, value: alert.severity, short: <span class="keyword">true</span> },
          { title: <span class="string">'Time'</span>, value: alert.timestamp, short: <span class="keyword">true</span> }
        ]
      }]
    })
  });
}

<span class="comment">// PagerDuty (wake someone up!)</span>
<span class="keyword">async function</span> <span class="function">pagerdutyChannel</span>(alert) {
  <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'https://events.pagerduty.com/v2/enqueue'</span>, {
    method: <span class="string">'POST'</span>,
    headers: {
      <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>,
      <span class="string">'Authorization'</span>: <span class="string">`Token token=${process.env.PAGERDUTY_KEY}`</span>
    },
    body: JSON.<span class="function">stringify</span>({
      routing_key: process.env.<span class="property">PAGERDUTY_ROUTING_KEY</span>,
      event_action: <span class="string">'trigger'</span>,
      payload: {
        summary: <span class="string">`[${alert.severity.toUpperCase()}] ${alert.name}: ${alert.message}`</span>,
        severity: alert.severity === <span class="string">'critical'</span> ? <span class="string">'critical'</span> : <span class="string">'warning'</span>,
        source: <span class="string">'my-app-monitor'</span>,
        timestamp: alert.timestamp
      }
    })
  });
}

<span class="comment">// ============================================</span>
<span class="comment">// Wire it all up</span>
<span class="comment">// ============================================</span>
<span class="keyword">const</span> alertManager = <span class="keyword">new</span> <span class="function">AlertManager</span>()
  .<span class="function">addChannel</span>(<span class="string">'slack'</span>, slackChannel)
  .<span class="function">addChannel</span>(<span class="string">'pagerduty'</span>, pagerdutyChannel)
  .<span class="function">addRule</span>({
    name: <span class="string">'High Error Rate'</span>,
    <span class="function">condition</span>: (m) => m.errorRate > <span class="number">5</span>,
    severity: <span class="string">'critical'</span>,
    channels: [<span class="string">'slack'</span>, <span class="string">'pagerduty'</span>],
    cooldownMs: <span class="number">300000</span>,
    <span class="function">message</span>: (m) => <span class="string">`Error rate is ${m.errorRate}% (threshold: 5%)`</span>
  })
  .<span class="function">addRule</span>({
    name: <span class="string">'Slow API Response'</span>,
    <span class="function">condition</span>: (m) => m.p95ResponseTime > <span class="number">2000</span>,
    severity: <span class="string">'high'</span>,
    channels: [<span class="string">'slack'</span>],
    cooldownMs: <span class="number">600000</span>,
    <span class="function">message</span>: (m) => <span class="string">`P95 response time: ${m.p95ResponseTime}ms`</span>
  });

<span class="comment">// Run every minute</span>
<span class="function">setInterval</span>(<span class="keyword">async</span> () => {
  <span class="keyword">const</span> metrics = <span class="keyword">await</span> <span class="function">collectMetrics</span>();
  <span class="keyword">await</span> alertManager.<span class="function">evaluate</span>(metrics);
}, <span class="number">60000</span>);
    </div>
  </div>

  <div class="card">
    <h3>üéÆ Interactive Alert System Demo</h3>
    
    <div class="grid-3" style="margin-bottom: 16px">
      <div class="metric-card">
        <div class="metric-label">Error Rate</div>
        <div class="metric-value" id="alert-error-rate" style="color:var(--accent3)">0.8%</div>
        <input type="range" min="0" max="20" value="0.8" step="0.1" 
               style="width:100%;margin-top:8px;accent-color:var(--accent)"
               oninput="updateAlertMetric('errorRate', this.value)">
      </div>
      <div class="metric-card">
        <div class="metric-label">Response Time (P95)</div>
        <div class="metric-value" id="alert-resp-time" style="color:var(--accent)">450ms</div>
        <input type="range" min="100" max="5000" value="450" 
               style="width:100%;margin-top:8px;accent-color:var(--accent)"
               oninput="updateAlertMetric('respTime', this.value)">
      </div>
      <div class="metric-card">
        <div class="metric-label">CPU Usage</div>
        <div class="metric-value" id="alert-cpu" style="color:var(--accent4)">35%</div>
        <input type="range" min="0" max="100" value="35"
               style="width:100%;margin-top:8px;accent-color:var(--accent)"
               oninput="updateAlertMetric('cpu', this.value)">
      </div>
    </div>

    <div id="activeAlerts" style="margin-top:16px">
      <h4 style="color:var(--text2); margin-bottom:10px; font-size:0.9rem">Active Alerts</h4>
      <div id="alertList">
        <p style="color:var(--text2); font-size:0.85rem">‚úÖ All systems normal ‚Äî drag sliders to trigger alerts</p>
      </div>
    </div>
  </div>
</section>

<!-- ==================== EXERCISES ==================== -->
<section class="section" id="exercises">
  <div class="section-header">
    <h2>üí™ Practice Exercises</h2>
    <p>Write real code to cement your understanding</p>
  </div>

  <div class="exercise-box">
    <h4>üéØ Exercise 1 ‚Äî Build a Simple Logger</h4>
    <p>Create a logger with DEBUG, INFO, WARN, and ERROR levels. It should only log messages at or above the configured level and output structured JSON with a timestamp.</p>
    
    <textarea class="code-editor" id="ex1-code">// Build your logger here!
// It should work like this:
// const log = createLogger('INFO'); // Only INFO and above
// log.debug('This should NOT print');
// log.info('User logged in', { userId: 123 });  // Should print
// log.warn('Slow query', { ms: 1200 });          // Should print
// log.error('DB failed', { error: 'timeout' });  // Should print

function createLogger(minLevel) {
  const LEVELS = { DEBUG: 0, INFO: 1, WARN: 2, ERROR: 3 };
  
  // YOUR CODE HERE
  
}

// Test it:
const log = createLogger('INFO');
log.debug('hidden');
log.info('server started', { port: 3000 });
log.warn('high memory', { mb: 850 });
log.error('crash!', { code: 500 });</textarea>
    
    <button class="run-btn" onclick="runExercise('ex1')">‚ñ∂ Run Code</button>
    <button class="hint-btn" onclick="showHint('ex1')">üí° Hint</button>
    <div class="output-box" id="ex1-output"></div>
    <div class="highlight-box info" id="ex1-hint" style="display:none">
      <strong>Hint:</strong> Store levels as numbers (DEBUG=0, INFO=1, WARN=2, ERROR=3). Compare the number of the message's level to minLevel's number. Use JSON.stringify() for output. Each method (debug, info, warn, error) is a function that checks if it should log before doing so.
    </div>
  </div>

  <div class="exercise-box">
    <h4>üéØ Exercise 2 ‚Äî Error Boundary Wrapper</h4>
    <p>Create a <code>tryCatch</code> utility function that wraps async operations, captures errors with context, and returns a <code>[result, error]</code> tuple (like Go-style error handling).</p>
    
    <textarea class="code-editor" id="ex2-code">// Create a tryCatch utility that:
// 1. Wraps any async function
// 2. Returns [result, null] on success
// 3. Returns [null, error] on failure
// 4. Logs the error with context

// Usage should be:
// const [user, err] = await tryCatch(fetchUser, { userId: 123 });
// if (err) { console.log('Failed:', err.message); }

async function tryCatch(fn, context = {}) {
  // YOUR CODE HERE
}

// Mock fetch function
async function fetchUser(context) {
  if (Math.random() > 0.5) {
    throw new Error('Network timeout');
  }
  return { id: context.userId, name: 'Alice' };
}

// Test it
async function main() {
  const [user, err] = await tryCatch(() => fetchUser({ userId: 123 }), { userId: 123 });
  if (err) {
    console.log('Error caught:', err.message);
  } else {
    console.log('Success:', JSON.stringify(user));
  }
}

main();</textarea>
    
    <button class="run-btn" onclick="runExercise('ex2')">‚ñ∂ Run Code</button>
    <button class="hint-btn" onclick="showHint('ex2')">üí° Hint</button>
    <div class="output-box" id="ex2-output"></div>
    <div class="highlight-box info" id="ex2-hint" style="display:none">
      <strong>Hint:</strong> Use try/catch inside. On success: return [result, null]. On error: log it with context, then return [null, error]. Call fn() inside the try block (it's async so await it).
    </div>
  </div>

  <div class="exercise-box">
    <h4>üéØ Exercise 3 ‚Äî Performance Timer</h4>
    <p>Build a <code>measureTime</code> decorator/wrapper that measures execution time of any function, warns if it exceeds a threshold, and collects statistics (avg, min, max).</p>
    
    <textarea class="code-editor" id="ex3-code">// Build a performance measurement utility
// It should:
// 1. Wrap any function (sync or async)
// 2. Measure execution time
// 3. Console.warn if over threshold
// 4. Track: count, average, min, max

function measureTime(name, fn, thresholdMs = 100) {
  const stats = { count: 0, total: 0, min: Infinity, max: 0 };
  
  // Return a wrapped function
  return async function(...args) {
    // YOUR CODE HERE
    // Measure time, call fn, update stats
    // Return the result
  };
}

// Test it:
const slowOperation = measureTime('dataProcess', async () => {
  const delay = Math.random() * 300;
  await new Promise(r => setTimeout(r, delay));
  return 'done';
}, 150); // warn if > 150ms

// Run 5 times
async function test() {
  for (let i = 0; i < 5; i++) {
    await slowOperation();
  }
}

test();</textarea>
    
    <button class="run-btn" onclick="runExercise('ex3')">‚ñ∂ Run Code</button>
    <button class="hint-btn" onclick="showHint('ex3')">üí° Hint</button>
    <div class="output-box" id="ex3-output"></div>
    <div class="highlight-box info" id="ex3-hint" style="display:none">
      <strong>Hint:</strong> Use Date.now() or performance.now() to get timestamps before and after calling fn(). Calculate duration = end - start. Update stats.count++, stats.total += duration, stats.min = Math.min(stats.min, duration), stats.max = Math.max(stats.max, duration). If duration > thresholdMs, console.warn().
    </div>
  </div>

  <div class="exercise-box">
    <h4>üéØ Exercise 4 ‚Äî Rate-Limited Alert System</h4>
    <p>Build a simple alert manager that prevents "alert storms" by rate-limiting each alert type to fire at most once every N seconds.</p>
    
    <textarea class="code-editor" id="ex4-code">// Alert Manager with cooldown
// Rules:
// - Each alert type can only fire once per cooldown period
// - Alert should include: name, message, severity, timestamp

class AlertManager {
  constructor() {
    this.lastFired = {};  // Track when each alert last fired
    this.history = [];    // All alerts that fired
  }

  // Check if alert should fire and fire it
  trigger(alertName, message, severity = 'medium', cooldownSeconds = 60) {
    // YOUR CODE HERE
    // 1. Check if this alert is in cooldown
    // 2. If not, record it fired and add to history
    // 3. Return true if alert fired, false if suppressed
  }

  getHistory() {
    return this.history;
  }
}

// Test it:
const manager = new AlertManager();

// These should only fire once per 5 seconds
for (let i = 0; i < 5; i++) {
  const fired = manager.trigger('high-cpu', 'CPU at 95%', 'high', 5);
  console.log(`Alert attempt ${i+1}: ${fired ? 'FIRED' : 'suppressed'}`);
}

// After "5 seconds" (simulate)
manager.lastFired['high-cpu'] = Date.now() - 6000;
const fired = manager.trigger('high-cpu', 'CPU at 95%', 'high', 5);
console.log('After cooldown:', fired ? 'FIRED' : 'suppressed');

console.log('Alert history:', manager.getHistory().length, 'alerts');</textarea>
    
    <button class="run-btn" onclick="runExercise('ex4')">‚ñ∂ Run Code</button>
    <button class="hint-btn" onclick="showHint('ex4')">üí° Hint</button>
    <div class="output-box" id="ex4-output"></div>
    <div class="highlight-box info" id="ex4-hint" style="display:none">
      <strong>Hint:</strong> Store lastFired as an object: { alertName: timestamp }. In trigger(), check if Date.now() - this.lastFired[alertName] < cooldownSeconds * 1000. If in cooldown, return false. Otherwise, update lastFired, add to history, and return true.
    </div>
  </div>
</section>

<!-- ==================== QUIZ ==================== -->
<section class="section" id="quiz">
  <div class="section-header">
    <h2>üß† Knowledge Quiz</h2>
    <p>Test yourself on monitoring & observability concepts</p>
  </div>

  <div class="quiz-container" id="quizContainer">
    <!-- Questions injected by JS -->
  </div>

  <div class="quiz-score" id="quizScore">
    <h3 id="quizScoreText">Score: 0/0</h3>
    <p id="quizFeedback" style="color:var(--text2); margin:8px 0"></p>
    <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top:12px">üîÑ Retake Quiz</button>
  </div>
</section>

<!-- ==================== PITFALLS ==================== -->
<section class="section" id="pitfalls">
  <div class="section-header">
    <h2>‚ö†Ô∏è Common Pitfalls & Mistakes</h2>
    <p>Learn from these mistakes before you make them in production</p>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #1 ‚Äî Logging Sensitive Data</h4>
    <p style="color:var(--text2); margin-bottom:12px">The most dangerous logging mistake. Passwords, tokens, and PII in logs can cause security breaches and GDPR violations.</p>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Logs password in plaintext!</span>
logger.<span class="function">info</span>(<span class="string">'Login attempt'</span>, {
  email: user.email,
  password: user.password,  <span class="comment">// üö® NEVER!</span>
  token: req.headers.authorization,
  creditCard: payment.cardNumber
});
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Sanitize before logging</span>
<span class="keyword">function</span> <span class="function">sanitize</span>(data) {
  <span class="keyword">const</span> sensitive = [<span class="string">'password'</span>, <span class="string">'token'</span>,
    <span class="string">'cardNumber'</span>, <span class="string">'ssn'</span>, <span class="string">'secret'</span>];
  <span class="keyword">return</span> Object.<span class="function">fromEntries</span>(
    Object.<span class="function">entries</span>(data).<span class="function">map</span>(([k,v]) =>
      [k, sensitive.<span class="function">includes</span>(k) ? <span class="string">'[REDACTED]'</span> : v]
    )
  );
}
logger.<span class="function">info</span>(<span class="string">'Login attempt'</span>, <span class="function">sanitize</span>(data));
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #2 ‚Äî Swallowing Errors Silently</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Error completely lost!</span>
<span class="keyword">try</span> {
  <span class="keyword">await</span> <span class="function">saveToDatabase</span>(data);
} <span class="keyword">catch</span> (e) {
  <span class="comment">// This catch does NOTHING</span>
  <span class="comment">// Error disappears into void</span>
}

<span class="comment">// Also bad ‚Äî empty catch</span>
promise.<span class="function">catch</span>(() => {});
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Always handle AND log errors</span>
<span class="keyword">try</span> {
  <span class="keyword">await</span> <span class="function">saveToDatabase</span>(data);
} <span class="keyword">catch</span> (error) {
  logger.<span class="function">error</span>(<span class="string">'db.save.failed'</span>, {
    error: error.message,
    stack: error.stack,
    data: <span class="function">sanitize</span>(data)
  });
  Sentry.<span class="function">captureException</span>(error);
  <span class="keyword">throw</span> error; <span class="comment">// Re-throw if needed</span>
}
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #3 ‚Äî Too Much Logging (Log Noise)</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Logs on every loop iteration!</span>
<span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> items) {
  logger.<span class="function">info</span>(<span class="string">'Processing item'</span>, item);
  <span class="keyword">await</span> <span class="function">processItem</span>(item);
  logger.<span class="function">info</span>(<span class="string">'Item processed'</span>, item);
}
<span class="comment">// 10,000 items = 20,000 log entries!</span>
<span class="comment">// Costs money, hard to find real issues</span>
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Log summaries, not each item</span>
logger.<span class="function">info</span>(<span class="string">'batch.started'</span>, {
  count: items.<span class="property">length</span>
});
<span class="keyword">const</span> failed = [];
<span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> items) {
  <span class="keyword">try</span> {
    <span class="keyword">await</span> <span class="function">processItem</span>(item);
  } <span class="keyword">catch</span> (e) {
    failed.<span class="function">push</span>({ item, error: e.message });
  }
}
logger.<span class="function">info</span>(<span class="string">'batch.complete'</span>, {
  total: items.<span class="property">length</span>,
  failed: failed.<span class="property">length</span>
});
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #4 ‚Äî Initializing Sentry Too Late</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Errors before this line are lost!</span>
<span class="keyword">import</span> { <span class="function">fetchData</span> } <span class="keyword">from</span> <span class="string">'./api'</span>;
<span class="keyword">import</span> { <span class="function">initApp</span> } <span class="keyword">from</span> <span class="string">'./app'</span>;

<span class="comment">// These could throw before Sentry loads</span>
<span class="keyword">await</span> <span class="function">fetchData</span>();
<span class="keyword">await</span> <span class="function">initApp</span>();

<span class="comment">// Sentry initialized too late!</span>
Sentry.<span class="function">init</span>({ dsn: <span class="string">'...'</span> });
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Sentry FIRST, before everything</span>
<span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/browser'</span>;

<span class="comment">// Initialize immediately</span>
Sentry.<span class="function">init</span>({
  dsn: <span class="string">'...'</span>,
  environment: process.env.<span class="property">NODE_ENV</span>
});

<span class="comment">// Now import the rest</span>
<span class="keyword">import</span> { <span class="function">fetchData</span> } <span class="keyword">from</span> <span class="string">'./api'</span>;
<span class="keyword">import</span> { <span class="function">initApp</span> } <span class="keyword">from</span> <span class="string">'./app'</span>;
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #5 ‚Äî Alert Fatigue (Crying Wolf)</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Alert on every tiny spike</span>
<span class="keyword">if</span> (cpu > <span class="number">50</span>) {
  <span class="function">sendAlert</span>(<span class="string">'CPU Warning!'</span>);
}
<span class="comment">// Fires hundreds of times per day</span>
<span class="comment">// Team starts ignoring ALL alerts</span>
<span class="comment">// Then misses the real outage üò±</span>
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Alert on sustained issues</span>
<span class="comment">// Only alert if CPU > 90% for 5+ minutes</span>
<span class="keyword">const</span> highCpuWindow = [];

<span class="function">setInterval</span>(() => {
  highCpuWindow.<span class="function">push</span>(<span class="function">getCPU</span>());
  <span class="keyword">if</span> (highCpuWindow.<span class="property">length</span> > <span class="number">5</span>) highCpuWindow.<span class="function">shift</span>();
  
  <span class="keyword">const</span> allHigh = highCpuWindow.<span class="function">every</span>(v => v > <span class="number">90</span>);
  <span class="keyword">if</span> (allHigh && highCpuWindow.<span class="property">length</span> === <span class="number">5</span>) {
    <span class="function">sendAlert</span>(<span class="string">'CPU sustained high!'</span>);
  }
}, <span class="number">60000</span>);
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #6 ‚Äî Unhandled Promise Rejections in Node.js</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå No global error handling</span>
<span class="comment">// Unhandled rejections crash or silently fail</span>

app.<span class="function">get</span>(<span class="string">'/data'</span>, (req, res) => {
  fetchData()  <span class="comment">// No await, no catch!</span>
    .<span class="function">then</span>(data => res.<span class="function">json</span>(data));
  <span class="comment">// If fetchData rejects: NOTHING happens</span>
  <span class="comment">// Response hangs, error is lost</span>
});
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Global handlers + proper async</span>
process.<span class="function">on</span>(<span class="string">'unhandledRejection'</span>, (reason) => {
  logger.<span class="function">error</span>(<span class="string">'unhandled.rejection'</span>, {
    reason: reason?.message
  });
  Sentry.<span class="function">captureException</span>(reason);
});

process.<span class="function">on</span>(<span class="string">'uncaughtException'</span>, (error) => {
  logger.<span class="function">error</span>(<span class="string">'uncaught.exception'</span>, {
    error: error.message
  });
  Sentry.<span class="function">captureException</span>(error);
  process.<span class="function">exit</span>(<span class="number">1</span>); <span class="comment">// Restart cleanly</span>
});
      </div>
    </div>
  </div>

  <div class="pitfall-box">
    <h4>‚ö†Ô∏è Pitfall #7 ‚Äî Not Adding Correlation IDs</h4>
    <div class="comparison">
      <div class="code-block bad-code">
<span class="comment">// ‚ùå Can't trace a request through logs</span>
logger.<span class="function">info</span>(<span class="string">'Processing order'</span>);
<span class="comment">// ... 10,000 other log lines ...</span>
logger.<span class="function">error</span>(<span class="string">'Payment failed'</span>);
<span class="comment">// Which "Processing order" had the error?</span>
<span class="comment">// WHO was affected? No idea!</span>
      </div>
      <div class="code-block good-code">
<span class="comment">// ‚úÖ Add requestId to every log</span>
<span class="keyword">const</span> { AsyncLocalStorage } = <span class="function">require</span>(<span class="string">'async_hooks'</span>);
<span class="keyword">const</span> store = <span class="keyword">new</span> <span class="function">AsyncLocalStorage</span>();

<span class="comment">// Middleware: generate request ID</span>
app.<span class="function">use</span>((req, res, next) => {
  <span class="keyword">const</span> requestId = crypto.<span class="function">randomUUID</span>();
  store.<span class="function">run</span>({ requestId }, next);
});

<span class="comment">// In your logger: always add requestId</span>
<span class="keyword">function</span> <span class="function">log</span>(level, msg, data) {
  <span class="keyword">const</span> ctx = store.<span class="function">getStore</span>() || {};
  console.<span class="function">log</span>(JSON.<span class="function">stringify</span>({
    ...ctx, level, msg, ...data
  }));
}
      </div>
    </div>
  </div>
</section>

<!-- ==================== CHEATSHEET ==================== -->
<section class="section" id="cheatsheet">
  <div class="section-header">
    <h2>üìã Complete Cheat Sheet</h2>
    <p>Your quick reference for monitoring & observability</p>
  </div>

  <div class="grid-2">
    <div>
      <div class="cheat-section">
        <h4>üö® Sentry Quick Reference</h4>
        <div class="cheat-item">
          <div class="cheat-label">Initialize</div>
          <div class="cheat-code">Sentry.init({ dsn, environment })</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Capture exception</div>
          <div class="cheat-code">Sentry.captureException(error)</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Capture message</div>
          <div class="cheat-code">Sentry.captureMessage(msg, level)</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Set user</div>
          <div class="cheat-code">Sentry.setUser({ id, email })</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Set tag</div>
          <div class="cheat-code">Sentry.setTag(key, value)</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Add breadcrumb</div>
          <div class="cheat-code">Sentry.addBreadcrumb({...})</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Scoped context</div>
          <div class="cheat-code">Sentry.withScope(scope => {...})</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Filter events</div>
          <div class="cheat-code">beforeSend: (event) => event|null</div>
        </div>
      </div>

      <div class="cheat-section">
        <h4>üìù Log Levels (in order)</h4>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-purple">DEBUG</span></div>
          <div class="cheat-code">Dev only, verbose detail</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-blue">INFO</span></div>
          <div class="cheat-code">Normal operation events</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-yellow">WARN</span></div>
          <div class="cheat-code">Unexpected but recoverable</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-red">ERROR</span></div>
          <div class="cheat-code">Something failed</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-red">FATAL</span></div>
          <div class="cheat-code">App going down, page on-call</div>
        </div>
      </div>

      <div class="cheat-section">
        <h4>‚ö° Core Web Vitals Thresholds</h4>
        <div class="cheat-item">
          <div class="cheat-label">LCP (load)</div>
          <div class="cheat-code">Good &lt;2.5s | Poor &gt;4s</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">INP (interaction)</div>
          <div class="cheat-code">Good &lt;200ms | Poor &gt;500ms</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">CLS (stability)</div>
          <div class="cheat-code">Good &lt;0.1 | Poor &gt;0.25</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">FCP (first paint)</div>
          <div class="cheat-code">Good &lt;1.8s | Poor &gt;3s</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">TTFB (server)</div>
          <div class="cheat-code">Good &lt;800ms | Poor &gt;1.8s</div>
        </div>
      </div>
    </div>

    <div>
      <div class="cheat-section">
        <h4>üìä Winston Cheat Sheet</h4>
        <div class="cheat-item">
          <div class="cheat-label">Create logger</div>
          <div class="cheat-code">winston.createLogger({...})</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Console transport</div>
          <div class="cheat-code">new winston.transports.Console()</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">File transport</div>
          <div class="cheat-code">new winston.transports.File({})</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Child logger</div>
          <div class="cheat-code">logger.child({ service: 'db' })</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">JSON format</div>
          <div class="cheat-code">format: combine(timestamp(), json())</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Exception handler</div>
          <div class="cheat-code">exceptionHandlers: [transport]</div>
        </div>
      </div>

      <div class="cheat-section">
        <h4>üåê Performance API</h4>
        <div class="cheat-item">
          <div class="cheat-label">Start timer</div>
          <div class="cheat-code">const t = performance.now()</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Duration</div>
          <div class="cheat-code">performance.now() - t</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Mark event</div>
          <div class="cheat-code">performance.mark('name')</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Measure range</div>
          <div class="cheat-code">performance.measure(name, s, e)</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Get entries</div>
          <div class="cheat-code">performance.getEntriesByType()</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Observe</div>
          <div class="cheat-code">new PerformanceObserver(cb)</div>
        </div>
      </div>

      <div class="cheat-section">
        <h4>üîî Alert Severity Levels</h4>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-red">P0 Critical</span></div>
          <div class="cheat-code">Site down ‚Üí Wake on-call &lt;5min</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-orange">P1 High</span></div>
          <div class="cheat-code">Key feature broken ‚Üí &lt;30min</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-yellow">P2 Medium</span></div>
          <div class="cheat-code">Degraded ‚Üí Next biz hours</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label"><span class="badge badge-blue">P3 Low</span></div>
          <div class="cheat-code">Minor ‚Üí Next sprint</div>
        </div>
      </div>

      <div class="cheat-section">
        <h4>‚úÖ Golden Rules</h4>
        <div class="cheat-item">
          <div class="cheat-label">Never log secrets</div>
          <div class="cheat-code">passwords, tokens ‚Üí [REDACTED]</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Use structured logs</div>
          <div class="cheat-code">JSON not plain strings</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Add request IDs</div>
          <div class="cheat-code">trace requests across services</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Alert on symptoms</div>
          <div class="cheat-code">error rate not individual errors</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Sentry init first</div>
          <div class="cheat-code">before any imports/code</div>
        </div>
        <div class="cheat-item">
          <div class="cheat-label">Handle rejections</div>
          <div class="cheat-code">process.on('unhandledRejection')</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:20px">
    <h3>üèÜ Interview Answer Templates</h3>
    <div class="toggle-group">
      <div class="toggle-item">
        <div class="toggle-header" onclick="toggleAccordion(this)">
          Q: "How do you handle errors in production?" <span class="toggle-arrow">‚ñº</span>
        </div>
        <div class="toggle-body">
          <p style="color:var(--text2); line-height:1.7">"We use a layered approach. On the frontend, we initialize <strong>Sentry</strong> as the first thing before any other code, which automatically captures unhandled exceptions and promise rejections. We add user context and breadcrumbs so every error has full context. On the backend (Node.js), we use Winston for structured JSON logging with correlation request IDs via AsyncLocalStorage, so we can trace any error through our entire system. We also handle global <code>uncaughtException</code> and <code>unhandledRejection</code> events. Errors feed into our alerting system, where P0/P1 severities page our on-call engineer via PagerDuty."</p>
        </div>
      </div>
      <div class="toggle-item">
        <div class="toggle-header" onclick="toggleAccordion(this)">
          Q: "What's the difference between monitoring and observability?" <span class="toggle-arrow">‚ñº</span>
        </div>
        <div class="toggle-body">
          <p style="color:var(--text2); line-height:1.7">"Monitoring tells you <strong>THAT</strong> something is wrong through pre-defined metrics and dashboards. Observability tells you <strong>WHY</strong> it's wrong ‚Äî it's about being able to ask arbitrary questions about your system's internal state. Observability is built on three pillars: <strong>Logs</strong> (what happened), <strong>Metrics</strong> (how much/often), and <strong>Traces</strong> (where a request went). A well-observable system lets you debug issues you didn't predict would happen."</p>
        </div>
      </div>
      <div class="toggle-item">
        <div class="toggle-header" onclick="toggleAccordion(this)">
          Q: "How do you debug a production issue you can't reproduce?" <span class="toggle-arrow">‚ñº</span>
        </div>
        <div class="toggle-body">
          <p style="color:var(--text2); line-height:1.7">"First, I check our error tracker (Sentry) for the full stack trace, affected users, and breadcrumbs showing what happened before the error. I look at our structured logs filtered by the request correlation ID to trace the full request lifecycle. I check our performance metrics to see if there was a slowdown around that time. If needed, I temporarily increase log verbosity for that specific user/feature. The breadcrumbs + structured logs + distributed traces usually give enough context to identify the root cause without reproducing it locally."</p>
        </div>
      </div>
      <div class="toggle-item">
        <div class="toggle-header" onclick="toggleAccordion(this)">
          Q: "How do you prevent alert fatigue?" <span class="toggle-arrow">‚ñº</span>
        </div>
        <div class="toggle-body">
          <p style="color:var(--text2); line-height:1.7">"Alert fatigue kills on-call rotations. My approach: (1) <strong>Alert on symptoms not causes</strong> ‚Äî error rate spikes not individual errors. (2) <strong>Sustained conditions</strong> ‚Äî only alert if CPU is above 90% for 5+ consecutive minutes, not on spikes. (3) <strong>Cooldowns</strong> ‚Äî same alert can't fire more than once per 5 minutes. (4) <strong>Severity routing</strong> ‚Äî P0/P1 wake people up, P2/P3 go to Slack for review. (5) Regular <strong>alert review</strong> ‚Äî if an alert fires and needs no action, it should be fixed or removed. The goal: every alert that fires means 'someone needs to do something right now'."</p>
        </div>
      </div>
    </div>
  </div>
</section>

</div><!-- /main -->

<script>
// ==================== NAVIGATION ====================
function showSection(name) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(name).classList.add('active');
  event.target.classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function showTab(btn, tabId) {
  const parent = btn.closest('.section');
  parent.querySelectorAll('.section-tab').forEach(t => t.classList.remove('active'));
  parent.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

function toggleAccordion(header) {
  const body = header.nextElementSibling;
  const arrow = header.querySelector('.toggle-arrow');
  body.classList.toggle('show');
  arrow.classList.toggle('open');
}

// ==================== COPY CODE ====================
function copyCode(btn) {
  const block = btn.parentElement;
  const text = block.innerText.replace('Copy\n', '').replace('Copy', '');
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'Copied!';
    btn.style.background = 'var(--accent3)';
    btn.style.color = '#000';
    setTimeout(() => {
      btn.textContent = 'Copy';
      btn.style.background = '';
      btn.style.color = '';
    }, 2000);
  });
}

// ==================== SENTRY DEMO ====================
let sentryErrorCount = 0;

const errorTypes = {
  TypeError: {
    title: 'TypeError: Cannot read properties of undefined (reading "id")',
    meta: 'at checkout.js:142 | user: #4521 | 12 occurrences in last hour',
    breadcrumbs: ['Page loaded', 'Add to Cart clicked', 'POST /api/cart ‚Üí 200', 'Render CartSummary ‚Üí CRASH']
  },
  NetworkError: {
    title: 'NetworkError: Failed to fetch /api/payments',
    meta: 'at paymentService.js:89 | 34 occurrences | affecting 23 users',
    breadcrumbs: ['User clicked Checkout', 'GET /api/cart ‚Üí 200', 'POST /api/payments ‚Üí Network Error']
  },
  CustomError: {
    title: 'PaymentError: Insufficient funds (stripe_decline_code: insufficient_funds)',
    meta: 'at stripe.js:56 | order: #8834 | amount: $99.99 | user: john@email.com',
    breadcrumbs: ['Cart: 3 items ($99.99)', 'Stripe charge attempted', 'Card declined']
  },
  UnhandledPromise: {
    title: 'UnhandledPromiseRejectionWarning: TypeError: data.map is not a function',
    meta: 'at userList.js:34 | Unhandled promise rejection | 5 occurrences',
    breadcrumbs: ['GET /api/users', 'Response received', 'Parsing response ‚Üí ERROR']
  }
};

function simulateError(type) {
  sentryErrorCount++;
  document.getElementById('errorCount').textContent = sentryErrorCount + ' Events';
  
  const error = errorTypes[type];
  const container = document.getElementById('sentryEvents');
  
  if (container.querySelector('p')) container.innerHTML = '';
  
  const now = new Date().toLocaleTimeString();
  const div = document.createElement('div');
  div.className = 'sentry-event';
  div.innerHTML = `
    <div class="sentry-event-title">üí• ${error.title}</div>
    <div class="sentry-event-meta">üïê ${now} | ${error.meta}</div>
    <div class="breadcrumb" style="margin-top:8px">
      ${error.breadcrumbs.map((b,i) => 
        `${i > 0 ? '<div class="breadcrumb-arrow">‚Üí</div>' : ''}
         <div class="breadcrumb-item" style="${i===error.breadcrumbs.length-1?'color:var(--danger)':''}">${b}</div>`
      ).join('')}
    </div>
  `;
  container.insertBefore(div, container.firstChild);
  
  showToast(error.title.substring(0, 60) + '...', 'error', 'üö® Sentry Alert');
}

function clearErrors() {
  sentryErrorCount = 0;
  document.getElementById('errorCount').textContent = '0 Events';
  document.getElementById('sentryEvents').innerHTML = '<p style="color:var(--text2); font-size:0.85rem; text-align:center; padding: 20px;">No errors yet. Trigger one above ‚Üë</p>';
}

// ==================== TOAST ALERTS ====================
function showToast(message, type = 'info', title = 'Alert') {
  const container = document.getElementById('alertContainer');
  const toast = document.createElement('div');
  toast.className = `alert-toast ${type}`;
  toast.innerHTML = `
    <div class="alert-title">${title}</div>
    <div class="alert-msg">${message}</div>
  `;
  container.appendChild(toast);
  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease forwards';
    setTimeout(() => toast.remove(), 300);
  }, 4000);
}

// ==================== LIVE LOGGER ====================
let logInterval = null;
let logRunning = false;
let logFilter = 'all';
let logCounts = { total: 0, errors: 0, warns: 0 };

const logMessages = [
  { level: 'info', msg: 'GET /api/users 200 45ms', freq: 0.4 },
  { level: 'info', msg: 'POST /api/cart 201 123ms', freq: 0.3 },
  { level: 'info', msg: 'User session refreshed', freq: 0.2 },
  { level: 'debug', msg: 'Cache HIT: user:4521', freq: 0.5 },
  { level: 'debug', msg: 'DB query executed in 12ms', freq: 0.3 },
  { level: 'warn', msg: 'Slow DB query: 1234ms', freq: 0.1 },
  { level: 'warn', msg: 'Rate limit approaching for IP 10.0.0.1', freq: 0.08 },
  { level: 'warn', msg: 'Memory usage at 78%', freq: 0.05 },
  { level: 'error', msg: 'Failed to connect to Redis: ECONNREFUSED', freq: 0.03 },
  { level: 'error', msg: 'Unhandled exception in route /checkout', freq: 0.02 },
  { level: 'info', msg: 'Health check passed', freq: 0.4 },
];

function toggleLogStream() {
  logRunning = !logRunning;
  const btn = document.getElementById('logStartBtn');
  
  if (logRunning) {
    btn.textContent = '‚è∏ Pause Log Stream';
    btn.classList.add('active');
    logInterval = setInterval(() => {
      const rand = Math.random();
      const msg = logMessages.find(m => rand < m.freq) || logMessages[0];
      addLogEntry(msg.level, msg.msg);
    }, 800);
  } else {
    btn.textContent = '‚ñ∂ Start Log Stream';
    btn.classList.remove('active');
    clearInterval(logInterval);
  }
}

function addLogEntry(level, message) {
  const container = document.getElementById('demoLog');
  const now = new Date().toLocaleTimeString();
  
  logCounts.total++;
  if (level === 'error') logCounts.errors++;
  if (level === 'warn') logCounts.warns++;
  
  document.getElementById('metricTotal').textContent = logCounts.total;
  document.getElementById('metricErrors').textContent = logCounts.errors;
  document.getElementById('metricWarns').textContent = logCounts.warns;
  
  const show = logFilter === 'all' || 
               (logFilter === 'error' && level === 'error') ||
               (logFilter === 'warn' && (level === 'warn' || level === 'error'));
  
  if (!show) return;
  
  // Remove placeholder
  if (container.querySelector('div[style*="color:var(--text2)"]')) {
    container.innerHTML = '';
  }
  
  const entry = document.createElement('div');
  entry.className = 'log-entry';
  entry.innerHTML = `
    <span class="log-time">${now}</span>
    <span class="log-level ${level}">${level.toUpperCase()}</span>
    <span class="log-msg">${message}</span>
  `;
  container.insertBefore(entry, container.firstChild);
  
  // Keep max 50 entries
  while (container.children.length > 50) {
    container.removeChild(container.lastChild);
  }
  
  if (level === 'error') {
    showToast(message, 'error', 'üî¥ Error Detected');
  }
}

function addManualLog(level) {
  const messages = {
    info: ['User logged in', 'Cache refreshed', 'API request completed', 'Session extended'],
    warn: ['High memory usage', 'Slow query detected', 'Retry attempt 2/3', 'Rate limit hit'],
    error: ['Database timeout!', 'Payment failed!', 'Auth service down!', 'Stack overflow!'],
    debug: ['Processing item 5/100', 'Cache key: user:123', 'Query took 8ms', 'Mutex acquired']
  };
  const msgs = messages[level];
  addLogEntry(level, msgs[Math.floor(Math.random() * msgs.length)]);
}

function clearLog() {
  document.getElementById('demoLog').innerHTML = '<div style="color:var(--text2); font-size:0.8rem; padding: 8px;">Log cleared</div>';
  logCounts = { total: 0, errors: 0, warns: 0 };
  document.getElementById('metricTotal').textContent = '0';
  document.getElementById('metricErrors').textContent = '0';
  document.getElementById('metricWarns').textContent = '0';
}

function setLogFilter(filter) {
  logFilter = filter;
  document.querySelectorAll('[id^="filter-"]').forEach(b => b.classList.remove('active'));
  document.getElementById('filter-' + filter).classList.add('active');
}

// ==================== PERFORMANCE DEMO ====================
function simulateLoad() {
  const bars = [
    { id: 'bar1', id2: 'bar1-val', base: 180 },
    { id: 'bar2', id2: 'bar2-val', base: 540 },
    { id: 'bar3', id2: 'bar3-val', base: 320 },
    { id: 'bar4', id2: 'bar4-val', base: 890 },
  ];
  
  bars.forEach(bar => {
    const val = Math.floor(bar.base * (0.7 + Math.random() * 0.6));
    const pct = Math.min(val / 10, 100);
    const color = pct > 80 ? 'var(--danger)' : pct > 50 ? 'var(--accent4)' : 'var(--accent3)';
    document.getElementById(bar.id).style.width = pct + '%';
    document.getElementById(bar.id).style.background = color;
    document.getElementById(bar.id2).textContent = val + 'ms';
  });
  
  document.getElementById('pm-api').textContent = Math.floor(200 + Math.random() * 200) + 'ms';
  document.getElementById('pm-errors').textContent = (Math.random() * 2).toFixed(1) + '%';
}

function simulateSlowdown() {
  const bars = [
    { id: 'bar1', id2: 'bar1-val', val: 800 },
    { id: 'bar2', id2: 'bar2-val', val: 3200 },
    { id: 'bar3', id2: 'bar3-val', val: 1800 },
    { id: 'bar4', id2: 'bar4-val', val: 4900 },
  ];
  
  bars.forEach(bar => {
    document.getElementById(bar.id).style.width = Math.min(bar.val / 50, 100) + '%';
    document.getElementById(bar.id).style.background = 'var(--danger)';
    document.getElementById(bar.id2).textContent = bar.val + 'ms';
  });
  
  document.getElementById('pm-api').textContent = '2,400ms';
  document.getElementById('pm-errors').textContent = '8.3%';
  document.getElementById('pm-lcp').textContent = '5.2s';
  document.getElementById('pm-lcp').style.color = 'var(--danger)';
  
  showToast('P95 response time: 4,900ms (threshold: 2,000ms)', 'error', '‚ö° Performance Alert');
  showToast('Error rate: 8.3% (threshold: 5%)', 'error', 'üö® Critical Alert');
}

function resetPerf() {
  document.getElementById('bar1').style.cssText = 'width:18%;background:var(--accent3)';
  document.getElementById('bar2').style.cssText = 'width:54%;background:var(--accent4)';
  document.getElementById('bar3').style.cssText = 'width:32%;background:var(--accent3)';
  document.getElementById('bar4').style.cssText = 'width:89%;background:var(--danger)';
  document.getElementById('bar1-val').textContent = '180ms';
  document.getElementById('bar2-val').textContent = '540ms';
  document.getElementById('bar3-val').textContent = '320ms';
  document.getElementById('bar4-val').textContent = '890ms';
  document.getElementById('pm-api').textContent = '243ms';
  document.getElementById('pm-errors').textContent = '0.3%';
  document.getElementById('pm-lcp').textContent = '1.8s';
  document.getElementById('pm-lcp').style.color = 'var(--accent3)';
}

// ==================== ALERT DEMO ====================
const alertMetrics = { errorRate: 0.8, respTime: 450, cpu: 35 };

const alertRules = [
  {
    name: 'üö® Critical: High Error Rate',
    check: m => m.errorRate > 10,
    msg: m => `Error rate is ${m.errorRate}% ‚Äî exceeds critical threshold of 10%`,
    severity: 'danger'
  },
  {
    name: '‚ö†Ô∏è High: Elevated Error Rate',
    check: m => m.errorRate > 5 && m.errorRate <= 10,
    msg: m => `Error rate is ${m.errorRate}% ‚Äî exceeds warning threshold of 5%`,
    severity: 'warning'
  },
  {
    name: 'üêå High: Slow API Response',
    check: m => m.respTime > 2000,
    msg: m => `P95 response time is ${m.respTime}ms ‚Äî exceeds 2000ms threshold`,
    severity: 'warning'
  },
  {
    name: 'üî• Critical: High CPU',
    check: m => m.cpu > 90,
    msg: m => `CPU usage is ${m.cpu}% ‚Äî server may become unresponsive`,
    severity: 'danger'
  },
  {
    name: '‚ö° Medium: Elevated CPU',
    check: m => m.cpu > 70 && m.cpu <= 90,
    msg: m => `CPU usage is ${m.cpu}% ‚Äî monitor closely`,
    severity: 'info'
  }
];

function updateAlertMetric(type, value) {
  value = parseFloat(value);
  if (type === 'errorRate') {
    alertMetrics.errorRate = value;
    const color = value > 10 ? 'var(--danger)' : value > 5 ? 'var(--warning)' : 'var(--accent3)';
    document.getElementById('alert-error-rate').style.color = color;
    document.getElementById('alert-error-rate').textContent = value.toFixed(1) + '%';
  } else if (type === 'respTime') {
    alertMetrics.respTime = Math.floor(value);
    const color = value > 2000 ? 'var(--danger)' : value > 1000 ? 'var(--accent4)' : 'var(--accent)';
    document.getElementById('alert-resp-time').style.color = color;
    document.getElementById('alert-resp-time').textContent = Math.floor(value) + 'ms';
  } else if (type === 'cpu') {
    alertMetrics.cpu = Math.floor(value);
    const color = value > 90 ? 'var(--danger)' : value > 70 ? 'var(--accent4)' : 'var(--accent3)';
    document.getElementById('alert-cpu').style.color = color;
    document.getElementById('alert-cpu').textContent = Math.floor(value) + '%';
  }
  
  evaluateAlerts();
}

function evaluateAlerts() {
  const list = document.getElementById('alertList');
  const active = alertRules.filter(r => r.check(alertMetrics));
  
  if (active.length === 0) {
    list.innerHTML = '<p style="color:var(--accent3); font-size:0.85rem">‚úÖ All systems normal ‚Äî drag sliders to trigger alerts</p>';
    return;
  }
  
  list.innerHTML = active.map(r => `
    <div class="highlight-box ${r.severity === 'danger' ? 'danger' : r.severity === 'warning' ? 'warning' : 'info'}" style="margin:6px 0">
      <strong>${r.name}</strong><br>
      <span style="font-size:0.85rem">${r.msg(alertMetrics)}</span>
    </div>
  `).join('');
}

// ==================== EXERCISES ====================
function runExercise(id) {
  const code = document.getElementById(id + '-code').value;
  const output = document.getElementById(id + '-output');
  output.classList.add('show');
  
  const logs = [];
  const mockConsole = {
    log: (...args) => logs.push(args.map(a => 
      typeof a === 'object' ? JSON.stringify(a, null, 2) : String(a)).join(' ')),
    warn: (...args) => logs.push('‚ö†Ô∏è WARN: ' + args.map(a => 
      typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),
    error: (...args) => logs.push('‚ùå ERROR: ' + args.map(a => 
      typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),
    info: (...args) => logs.push('‚ÑπÔ∏è INFO: ' + args.map(a => 
      typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),
  };
  
  try {
    const fn = new Function('console', code);
    const result = fn(mockConsole);
    if (result && typeof result.then === 'function') {
      result.then(() => {
        output.textContent = logs.join('\n') || 'No output';
        output.className = 'output-box show success';
      }).catch(e => {
        output.textContent = logs.join('\n') + '\n‚ùå Error: ' + e.message;
        output.className = 'output-box show error';
      });
    } else {
      output.textContent = logs.join('\n') || 'Code ran with no output';
      output.className = 'output-box show success';
    }
  } catch (e) {
    output.textContent = '‚ùå Syntax Error: ' + e.message;
    output.className = 'output-box show error';
  }
}

function showHint(id) {
  const hint = document.getElementById(id + '-hint');
  hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
}

// ==================== QUIZ ====================
const quizQuestions = [
  {
    q: "What are the Three Pillars of Observability?",
    opts: [
      "Logs, Metrics, Traces",
      "Errors, Alerts, Dashboards",
      "Debug, Info, Error",
      "Sentry, Datadog, Splunk"
    ],
    answer: 0,
    explanation: "The Three Pillars of Observability are: Logs (what happened), Metrics (how much/often), and Traces (where a request traveled). Together they let you understand ANY system state."
  },
  {
    q: "When should you call Sentry.init() in your application?",
    opts: [
      "After all your routes are set up",
      "When the first error occurs",
      "FIRST, before any other imports or code",
      "Only in production builds"
    ],
    answer: 2,
    explanation: "Sentry.init() must be called FIRST before anything else. If you initialize it later, any errors that occur before initialization are lost and never captured."
  },
  {
    q: "What does a Sentry 'Breadcrumb' represent?",
    opts: [
      "The error message itself",
      "A trail of events that happened before an error occurred",
      "A category/tag for organizing errors",
      "The affected user's navigation history"
    ],
    answer: 1,
    explanation: "Breadcrumbs are a trail of events (user actions, API calls, navigation) that happened BEFORE the error. Like CCTV footage leading up to an incident, they help you understand what caused the error."
  },
  {
    q: "Which log level should you use when something failed but your app recovered?",
    opts: [
      "DEBUG - it's not critical",
      "INFO - it's informational",
      "WARN - unexpected but recoverable",
      "ERROR - any failure is an error"
    ],
    answer: 2,
    explanation: "WARN is for unexpected situations your app can recover from (retry succeeded, fallback used, rate limit hit). ERROR is when something genuinely failed and requires attention."
  },
  {
    q: "What's the main benefit of structured logging (JSON) over plain text?",
    opts: [
      "It's faster to write",
      "It takes less storage space",
      "It can be queried and filtered by any field",
      "It's more human readable"
    ],
    answer: 2,
    explanation: "Structured JSON logs let you query by ANY field (userId, errorType, duration). Plain text logs can only be searched by string matching. With JSON, log aggregators (Datadog, Splunk) can filter, aggregate, and alert on specific fields."
  },
  {
    q: "What is 'alert fatigue' and how do you prevent it?",
    opts: [
      "When alerts are too quiet ‚Äî add more alerts",
      "When too many alerts fire, causing the team to ignore them ‚Äî use sustained conditions, cooldowns, and severity routing",
      "When alerts are sent to the wrong people ‚Äî fix routing rules",
      "When monitoring tools become slow ‚Äî upgrade servers"
    ],
    answer: 1,
    explanation: "Alert fatigue happens when too many alerts fire (especially false positives), causing engineers to ignore ALL alerts ‚Äî including real emergencies. Prevent it by alerting on sustained conditions (not spikes), using cooldowns, routing by severity, and regularly pruning alerts that don't require action."
  },
  {
    q: "What is LCP (Largest Contentful Paint) and what's a 'Good' threshold?",
    opts: [
      "First content shown ‚Äî Good < 1s",
      "Largest element loaded ‚Äî Good < 2.5s",
      "Layout stability score ‚Äî Good < 0.1",
      "Server response time ‚Äî Good < 800ms"
    ],
    answer: 1,
        explanation: "LCP measures how long it takes for the largest visible element (hero image, video, etc.) to render. Good threshold is <2.5 seconds."
  }
];

// Quiz state
let userAnswers = new Array(quizQuestions.length).fill(null);
let quizSubmitted = false;

// Render quiz
function renderQuiz() {
  const container = document.getElementById('quizContainer');
  if (!container) return;
  
  let html = '';
  quizQuestions.forEach((q, idx) => {
    const answered = userAnswers[idx] !== null;
    const selected = userAnswers[idx];
    const isCorrect = selected === q.answer;
    const questionClass = answered ? (isCorrect ? 'correct' : 'incorrect') : '';
    
    html += `
      <div class="quiz-question ${questionClass}" data-q="${idx}">
        <div class="quiz-q">${idx+1}. ${q.q}</div>
        <div class="quiz-options">
    `;
    
    q.opts.forEach((opt, optIdx) => {
      const optionClass = answered ? (optIdx === q.answer ? 'correct' : (optIdx === selected ? 'incorrect' : '')) : '';
      html += `
        <button class="quiz-option ${optionClass}" onclick="checkAnswer(${idx}, ${optIdx})" ${answered ? 'disabled' : ''}>
          ${opt}
        </button>
      `;
    });
    
    html += `
        </div>
        <div class="quiz-feedback ${answered ? 'show' : ''}" id="feedback-${idx}">
          ${answered ? (isCorrect ? '‚úÖ Correct! ' : '‚ùå Incorrect. ') + q.explanation : ''}
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
  
  // Update score
  updateScore();
}

// Check answer
function checkAnswer(qIdx, optIdx) {
  if (userAnswers[qIdx] !== null) return; // Already answered
  userAnswers[qIdx] = optIdx;
  
  // Re-render the quiz to update styles and feedback
  renderQuiz();
  
  // Show toast if desired
  if (optIdx === quizQuestions[qIdx].answer) {
    showToast('Correct!', 'success', 'üéâ Quiz');
  } else {
    showToast('Incorrect. Check the explanation.', 'error', '‚ùå Quiz');
  }
  
  // Check if all answered
  if (userAnswers.every(a => a !== null)) {
    // All answered, maybe show final score?
    document.getElementById('quizScore').classList.add('show');
    const correctCount = userAnswers.filter((a, i) => a === quizQuestions[i].answer).length;
    document.getElementById('quizScoreText').textContent = `Score: ${correctCount}/${quizQuestions.length}`;
    let feedback = '';
    if (correctCount === quizQuestions.length) feedback = 'Perfect! You\'re a monitoring expert!';
    else if (correctCount >= quizQuestions.length - 2) feedback = 'Great job! Almost there.';
    else feedback = 'Keep studying, you\'ll get there!';
    document.getElementById('quizFeedback').textContent = feedback;
  }
}

// Reset quiz
function resetQuiz() {
  userAnswers = new Array(quizQuestions.length).fill(null);
  document.getElementById('quizScore').classList.remove('show');
  renderQuiz();
}

// Update score display (optional)
function updateScore() {
  const answeredCount = userAnswers.filter(a => a !== null).length;
  if (answeredCount === quizQuestions.length) {
    const correctCount = userAnswers.filter((a, i) => a === quizQuestions[i].answer).length;
    document.getElementById('quizScoreText').textContent = `Score: ${correctCount}/${quizQuestions.length}`;
    document.getElementById('quizScore').classList.add('show');
  } else {
    document.getElementById('quizScore').classList.remove('show');
  }
}

// Fix showSection to work without relying on event.target
// Override the previous definition
function showSection(name) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(name).classList.add('active');
  // Find the button that has an onclick attribute containing this name
  const buttons = document.querySelectorAll('.nav-btn');
  for (let btn of buttons) {
    if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes(`'${name}'`)) {
      btn.classList.add('active');
      break;
    }
  }
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Initialize quiz on page load
document.addEventListener('DOMContentLoaded', () => {
  renderQuiz();
});

</script>
</body>
</html>