<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Testing in JavaScript - Complete Guide</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  :root {
    --bg: #0a0e1a;
    --surface: #111827;
    --surface2: #1e2d3d;
    --surface3: #243447;
    --accent: #00d4ff;
    --accent2: #7c3aed;
    --accent3: #10b981;
    --accent4: #f59e0b;
    --danger: #ef4444;
    --text: #e2e8f0;
    --text2: #94a3b8;
    --border: #2d3748;
    --success: #10b981;
    --warning: #f59e0b;
    --code-bg: #0d1117;
  }

  body {
    font-family: 'Segoe UI', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* NAV */
  .top-nav {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 20px;
    display: flex;
    align-items: center;
    gap: 8px;
    overflow-x: auto;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 20px rgba(0,0,0,0.5);
  }

  .nav-brand {
    font-size: 14px;
    font-weight: 700;
    color: var(--accent);
    white-space: nowrap;
    padding: 14px 10px 14px 0;
    border-right: 1px solid var(--border);
    margin-right: 4px;
  }

  .nav-btn {
    background: none;
    border: none;
    color: var(--text2);
    padding: 14px 12px;
    cursor: pointer;
    white-space: nowrap;
    font-size: 13px;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
  }

  .nav-btn:hover { color: var(--text); }
  .nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

  /* PROGRESS BAR */
  .progress-bar {
    background: var(--surface);
    padding: 8px 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 1px solid var(--border);
    font-size: 12px;
    color: var(--text2);
  }

  .progress-track {
    flex: 1;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    border-radius: 2px;
    transition: width 0.5s ease;
  }

  /* MAIN LAYOUT */
  .main { padding: 24px 20px; max-width: 1100px; margin: 0 auto; }

  /* SECTIONS */
  .section { display: none; }
  .section.active { display: block; }

  /* CARDS */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 20px;
  }

  .card-title {
    font-size: 18px;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card-subtitle {
    font-size: 14px;
    color: var(--text2);
    margin-bottom: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* HERO */
  .hero {
    background: linear-gradient(135deg, var(--surface) 0%, #1a1f3a 100%);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 40px;
    text-align: center;
    margin-bottom: 28px;
    position: relative;
    overflow: hidden;
  }

  .hero::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(0,212,255,0.05) 0%, transparent 60%);
    animation: pulse 4s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  .hero h1 { font-size: 32px; font-weight: 800; margin-bottom: 12px; }
  .hero h1 span { color: var(--accent); }
  .hero p { color: var(--text2); font-size: 16px; max-width: 600px; margin: 0 auto 20px; }

  .badge-row {
    display: flex;
    gap: 8px;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 16px;
  }

  .badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
  }

  .badge-blue { background: rgba(0,212,255,0.15); color: var(--accent); border: 1px solid rgba(0,212,255,0.3); }
  .badge-purple { background: rgba(124,58,237,0.15); color: #a78bfa; border: 1px solid rgba(124,58,237,0.3); }
  .badge-green { background: rgba(16,185,129,0.15); color: var(--accent3); border: 1px solid rgba(16,185,129,0.3); }
  .badge-yellow { background: rgba(245,158,11,0.15); color: var(--accent4); border: 1px solid rgba(245,158,11,0.3); }

  /* PYRAMID */
  .pyramid-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    margin: 20px 0;
  }

  .pyramid-level {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    gap: 8px;
  }

  .pyramid-level:hover { transform: scaleX(1.02); filter: brightness(1.2); }

  .pyr-e2e { width: 200px; height: 56px; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
  .pyr-integration { width: 320px; height: 56px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
  .pyr-unit { width: 440px; height: 56px; background: linear-gradient(135deg, #10b981, #059669); color: white; }

  .pyramid-label {
    text-align: center;
    font-size: 11px;
    color: var(--text2);
    margin-top: -4px;
  }

  /* CODE BLOCKS */
  .code-block {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.6;
    overflow-x: auto;
    margin: 12px 0;
    position: relative;
  }

  .code-block .comment { color: #6b7280; }
  .code-block .keyword { color: #c084fc; }
  .code-block .string { color: #86efac; }
  .code-block .fn { color: #60a5fa; }
  .code-block .num { color: #fb923c; }
  .code-block .tag { color: #f87171; }
  .code-block .prop { color: #7dd3fc; }
  .code-block .const { color: #fbbf24; }

  .copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text2);
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .copy-btn:hover { color: var(--accent); border-color: var(--accent); }

  /* TABS */
  .tab-row {
    display: flex;
    gap: 4px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 20px;
    overflow-x: auto;
  }

  .tab-btn {
    padding: 10px 16px;
    background: none;
    border: none;
    color: var(--text2);
    cursor: pointer;
    font-size: 13px;
    border-bottom: 2px solid transparent;
    white-space: nowrap;
    transition: all 0.2s;
  }

  .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }
  .tab-btn:hover:not(.active) { color: var(--text); }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* COMPARISON TABLE */
  .compare-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    margin: 16px 0;
  }

  .compare-table th {
    background: var(--surface2);
    padding: 12px;
    text-align: left;
    font-weight: 600;
    color: var(--accent);
    border: 1px solid var(--border);
  }

  .compare-table td {
    padding: 10px 12px;
    border: 1px solid var(--border);
    color: var(--text2);
    vertical-align: top;
  }

  .compare-table tr:hover td { background: var(--surface2); }

  /* INFO BOXES */
  .info-box {
    border-radius: 8px;
    padding: 14px 16px;
    margin: 12px 0;
    display: flex;
    gap: 12px;
    align-items: flex-start;
    font-size: 14px;
  }

  .info-box.tip { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); color: #6ee7b7; }
  .info-box.warn { background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); color: #fcd34d; }
  .info-box.danger { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); color: #fca5a5; }
  .info-box.info { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); color: #7dd3fc; }

  .info-icon { font-size: 18px; flex-shrink: 0; }

  /* QUIZ */
  .quiz-container { margin: 20px 0; }

  .quiz-question {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 16px;
  }

  .quiz-q-text {
    font-size: 15px;
    font-weight: 600;
    margin-bottom: 14px;
    line-height: 1.5;
  }

  .quiz-options { display: flex; flex-direction: column; gap: 8px; }

  .quiz-option {
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    transition: all 0.2s;
    background: var(--surface3);
    text-align: left;
    color: var(--text);
  }

  .quiz-option:hover:not(:disabled) { border-color: var(--accent); color: var(--accent); }
  .quiz-option.correct { background: rgba(16,185,129,0.2); border-color: var(--success); color: var(--success); }
  .quiz-option.wrong { background: rgba(239,68,68,0.2); border-color: var(--danger); color: var(--danger); }
  .quiz-option:disabled { cursor: not-allowed; }

  .quiz-feedback {
    margin-top: 10px;
    padding: 10px;
    border-radius: 6px;
    font-size: 13px;
    display: none;
  }

  .quiz-feedback.show { display: block; }
  .quiz-feedback.correct { background: rgba(16,185,129,0.1); color: var(--success); }
  .quiz-feedback.wrong { background: rgba(239,68,68,0.1); color: var(--danger); }

  /* EXERCISE */
  .exercise-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 16px;
  }

  .exercise-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .exercise-label {
    font-size: 13px;
    font-weight: 700;
    color: var(--accent2);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .difficulty {
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 600;
  }

  .diff-easy { background: rgba(16,185,129,0.2); color: var(--success); }
  .diff-medium { background: rgba(245,158,11,0.2); color: var(--warning); }
  .diff-hard { background: rgba(239,68,68,0.2); color: var(--danger); }

  .exercise-prompt {
    font-size: 14px;
    margin-bottom: 14px;
    line-height: 1.6;
    color: var(--text);
  }

  .code-editor {
    width: 100%;
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 14px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    color: var(--text);
    resize: vertical;
    min-height: 140px;
    outline: none;
    line-height: 1.6;
    transition: border-color 0.2s;
  }

  .code-editor:focus { border-color: var(--accent); }

  .btn {
    padding: 8px 18px;
    border-radius: 8px;
    border: none;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-primary { background: var(--accent); color: var(--bg); }
  .btn-primary:hover { background: #00b8d9; transform: translateY(-1px); }
  .btn-secondary { background: var(--surface3); color: var(--text); border: 1px solid var(--border); }
  .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }
  .btn-green { background: var(--accent3); color: white; }
  .btn-green:hover { background: #059669; }
  .btn-purple { background: var(--accent2); color: white; }
  .btn-purple:hover { background: #6d28d9; }

  .btn-row { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; }

  .result-box {
    margin-top: 12px;
    padding: 12px;
    border-radius: 8px;
    font-size: 13px;
    font-family: 'Courier New', monospace;
    display: none;
  }

  .result-box.show { display: block; }
  .result-box.success { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); color: var(--success); }
  .result-box.error { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); color: var(--danger); }
  .result-box.info { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); color: var(--accent); }

  /* FLOW DIAGRAM */
  .flow {
    display: flex;
    align-items: center;
    gap: 0;
    flex-wrap: wrap;
    margin: 16px 0;
  }

  .flow-box {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    min-width: 80px;
  }

  .flow-arrow {
    color: var(--accent);
    font-size: 20px;
    padding: 0 6px;
  }

  /* PITFALLS */
  .pitfall {
    background: rgba(239,68,68,0.08);
    border: 1px solid rgba(239,68,68,0.3);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 12px;
  }

  .pitfall-title {
    color: var(--danger);
    font-weight: 700;
    font-size: 14px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .fix {
    background: rgba(16,185,129,0.08);
    border: 1px solid rgba(16,185,129,0.3);
    border-radius: 10px;
    padding: 16px;
    margin-top: 8px;
  }

  .fix-title {
    color: var(--success);
    font-weight: 700;
    font-size: 13px;
    margin-bottom: 8px;
  }

  /* CHEATSHEET */
  .cheat-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 16px;
    margin: 16px 0;
  }

  .cheat-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
  }

  .cheat-card-title {
    font-size: 13px;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
  }

  .cheat-item {
    display: flex;
    gap: 8px;
    margin-bottom: 6px;
    font-size: 12px;
    align-items: flex-start;
  }

  .cheat-key {
    background: var(--code-bg);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
    color: var(--accent4);
    white-space: nowrap;
    flex-shrink: 0;
    font-size: 11px;
  }

  .cheat-desc { color: var(--text2); line-height: 1.4; }

  /* SCORE */
  .score-display {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .score-num {
    font-size: 32px;
    font-weight: 800;
    color: var(--accent);
  }

  .score-label { font-size: 12px; color: var(--text2); }

  /* STRATEGY CARDS */
  .strategy-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 16px;
    margin: 16px 0;
  }

  .strategy-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 18px;
    transition: all 0.2s;
  }

  .strategy-card:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
  }

  .strategy-icon { font-size: 28px; margin-bottom: 10px; }
  .strategy-name { font-weight: 700; font-size: 15px; margin-bottom: 6px; }
  .strategy-desc { font-size: 13px; color: var(--text2); line-height: 1.5; }

  /* INTERACTIVE DEMO */
  .demo-container {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    overflow: hidden;
    margin: 16px 0;
  }

  .demo-toolbar {
    background: var(--surface2);
    padding: 8px 14px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 1px solid var(--border);
    font-size: 12px;
    color: var(--text2);
  }

  .demo-dot { width: 10px; height: 10px; border-radius: 50%; }
  .demo-body { padding: 16px; }

  /* TIMELINE */
  .timeline {
    position: relative;
    padding-left: 24px;
    margin: 16px 0;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 8px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: linear-gradient(180deg, var(--accent), var(--accent2));
  }

  .timeline-item {
    position: relative;
    margin-bottom: 20px;
  }

  .timeline-item::before {
    content: '';
    position: absolute;
    left: -20px;
    top: 4px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--accent);
    border: 2px solid var(--bg);
  }

  .timeline-item h4 { font-size: 14px; font-weight: 700; margin-bottom: 4px; color: var(--text); }
  .timeline-item p { font-size: 13px; color: var(--text2); line-height: 1.5; }

  /* GRID HELPERS */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  @media (max-width: 640px) { .grid-2 { grid-template-columns: 1fr; } }

  /* SCROLLABLE */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

  /* CONFETTI ANIMATION */
  @keyframes confetti-fall {
    0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }

  .confetti-piece {
    position: fixed;
    width: 10px;
    height: 10px;
    border-radius: 2px;
    animation: confetti-fall 2s ease-in forwards;
    z-index: 9999;
    pointer-events: none;
  }

  /* HIGHLIGHT */
  .highlight { color: var(--accent); font-weight: 700; }
  .highlight-green { color: var(--accent3); font-weight: 700; }
  .highlight-yellow { color: var(--accent4); font-weight: 700; }
  .highlight-red { color: var(--danger); font-weight: 700; }

  p { margin-bottom: 10px; line-height: 1.6; font-size: 14px; color: var(--text2); }
  h2 { font-size: 22px; font-weight: 700; margin-bottom: 8px; }
  h3 { font-size: 16px; font-weight: 700; margin: 16px 0 8px; color: var(--text); }
  ul, ol { margin-left: 20px; margin-bottom: 10px; }
  li { font-size: 14px; color: var(--text2); line-height: 1.7; }
  strong { color: var(--text); }
</style>
</head>
<body>

<!-- NAV -->
<nav class="top-nav">
  <div class="nav-brand">üß™ Advanced Testing</div>
  <button class="nav-btn active" onclick="showSection('intro')">üìö Intro</button>
  <button class="nav-btn" onclick="showSection('integration')">üîó Integration</button>
  <button class="nav-btn" onclick="showSection('e2e')">üé≠ E2E</button>
  <button class="nav-btn" onclick="showSection('visual')">üëÅÔ∏è Visual</button>
  <button class="nav-btn" onclick="showSection('strategies')">üó∫Ô∏è Strategies</button>
  <button class="nav-btn" onclick="showSection('exercises')">üí™ Exercises</button>
  <button class="nav-btn" onclick="showSection('quiz')">üß† Quiz</button>
  <button class="nav-btn" onclick="showSection('pitfalls')">‚ö†Ô∏è Pitfalls</button>
  <button class="nav-btn" onclick="showSection('cheatsheet')">üìã Cheatsheet</button>
</nav>

<div class="progress-bar">
  <span>Progress</span>
  <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:11%"></div></div>
  <span id="progressLabel">1/9 sections</span>
</div>

<div class="main">

<!-- ============================================================ INTRO -->
<div class="section active" id="intro">
  <div class="hero">
    <h1>Advanced <span>Testing</span> in JavaScript</h1>
    <p>Master Integration Testing, End-to-End Testing, Visual Regression, and Test Strategies to build bulletproof applications and impress in competitive tech interviews.</p>
    <div class="badge-row">
      <span class="badge badge-blue">Integration Tests</span>
      <span class="badge badge-purple">E2E Testing</span>
      <span class="badge badge-green">Visual Regression</span>
      <span class="badge badge-yellow">Test Strategy</span>
    </div>
  </div>

  <div class="card">
    <div class="card-title">ü§î Why Advanced Testing Matters</div>
    <p>Unit tests alone are not enough. Advanced testing catches bugs that only appear when <strong>multiple parts work together</strong> or when users actually <strong>interact with the UI</strong>.</p>

    <div class="info-box info">
      <span class="info-icon">üí°</span>
      <div><strong>Famous Quote:</strong> "Unit tests are like checking if each brick is solid. Integration tests check if the wall stands. E2E tests check if you can actually live in the house."</div>
    </div>

    <h3>The Testing Pyramid ‚Äî Your Mental Model</h3>
    <p>Always think in this pyramid: many fast unit tests at the base, fewer integration tests, and even fewer E2E tests at the top.</p>

    <div class="pyramid-container">
      <div class="pyramid-level pyr-e2e" onclick="showPyrInfo('e2e')">üé≠ E2E Tests <span>~10%</span></div>
      <div class="pyramid-label">Slow, expensive, full browser ‚Äî use sparingly</div>
      <div class="pyramid-level pyr-integration" onclick="showPyrInfo('int')">üîó Integration Tests <span>~30%</span></div>
      <div class="pyramid-label">Medium speed ‚Äî test modules working together</div>
      <div class="pyramid-level pyr-unit" onclick="showPyrInfo('unit')">‚ö° Unit Tests <span>~60%</span></div>
      <div class="pyramid-label">Fast, isolated ‚Äî test individual functions</div>
    </div>

    <div id="pyrInfoBox" class="info-box info" style="display:none;margin-top:12px;">
      <span class="info-icon">‚ÑπÔ∏è</span>
      <div id="pyrInfoText"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üìä Types Compared At A Glance</div>
    <table class="compare-table">
      <tr>
        <th>Type</th>
        <th>What It Tests</th>
        <th>Speed</th>
        <th>Tools</th>
        <th>Catches</th>
      </tr>
      <tr>
        <td><span class="highlight-green">Unit</span></td>
        <td>Single function/component</td>
        <td>‚ö° Very Fast</td>
        <td>Jest, Vitest</td>
        <td>Logic bugs</td>
      </tr>
      <tr>
        <td><span class="highlight-yellow">Integration</span></td>
        <td>Multiple modules together</td>
        <td>üîÑ Medium</td>
        <td>Jest + SuperTest, RTL</td>
        <td>Contract bugs, DB issues</td>
      </tr>
      <tr>
        <td><span class="highlight-red">E2E</span></td>
        <td>Full user flow in browser</td>
        <td>üê¢ Slow</td>
        <td>Playwright, Cypress</td>
        <td>UX bugs, integration</td>
      </tr>
      <tr>
        <td><span style="color:#a78bfa">Visual</span></td>
        <td>UI appearance/layout</td>
        <td>üîÑ Medium</td>
        <td>Percy, Storybook</td>
        <td>CSS regressions</td>
      </tr>
    </table>
  </div>

  <div class="card">
    <div class="card-title">üó∫Ô∏è Learning Roadmap</div>
    <div class="timeline">
      <div class="timeline-item">
        <h4>Step 1: Understand Integration Testing</h4>
        <p>Learn how to test multiple modules/API routes working together using real databases or mocks.</p>
      </div>
      <div class="timeline-item">
        <h4>Step 2: Master E2E with Playwright & Cypress</h4>
        <p>Write tests that launch a real browser and simulate user clicks, form fills, navigation.</p>
      </div>
      <div class="timeline-item">
        <h4>Step 3: Add Visual Regression</h4>
        <p>Capture screenshots and compare them to catch unintended UI changes.</p>
      </div>
      <div class="timeline-item">
        <h4>Step 4: Build a Test Strategy</h4>
        <p>Know when to use which test type, how to structure CI/CD, and how to balance coverage vs speed.</p>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ INTEGRATION -->
<div class="section" id="integration">
  <div class="card">
    <div class="card-title">üîó Integration Testing</div>
    <p>Integration tests verify that <strong>multiple units work correctly together</strong>. Unlike unit tests that mock everything, integration tests use real (or near-real) collaborators.</p>

    <div class="tab-row">
      <button class="tab-btn active" onclick="switchTab('int','concept')">Core Concept</button>
      <button class="tab-btn" onclick="switchTab('int','api')">API Testing</button>
      <button class="tab-btn" onclick="switchTab('int','db')">DB Testing</button>
      <button class="tab-btn" onclick="switchTab('int','rtl')">RTL (React)</button>
      <button class="tab-btn" onclick="switchTab('int','mocking')">Smart Mocking</button>
    </div>

    <div class="tab-content active" id="int-concept">
      <h3>What Changes in Integration Tests?</h3>
      <div class="info-box info">
        <span class="info-icon">üîë</span>
        <div>The key difference: you let real modules talk to each other. You only mock things <em>outside your control</em> (external APIs, email services, payment processors).</div>
      </div>

      <div class="flow">
        <div class="flow-box" style="border-color:var(--accent3)">HTTP Request</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent3)">Router</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent3)">Controller</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent3)">Service</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent4)">DB (real/test)</div>
      </div>

      <p style="margin-top:8px">In integration tests, you test the entire chain above ‚Äî not just one box.</p>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ‚úÖ INTEGRATION TEST ‚Äî testing real module collaboration</span>
<span class="comment">// tests/integration/user.test.js</span>

<span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'supertest'</span>;
<span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'../src/app'</span>;
<span class="keyword">import</span> { db } <span class="keyword">from</span> <span class="string">'../src/database'</span>;

<span class="comment">// Setup: use a test database, not production!</span>
<span class="fn">beforeAll</span>(<span class="keyword">async</span> () => {
  <span class="keyword">await</span> db.<span class="fn">migrate</span>.<span class="fn">latest</span>();   <span class="comment">// run migrations</span>
});

<span class="fn">afterEach</span>(<span class="keyword">async</span> () => {
  <span class="keyword">await</span> db.<span class="fn">raw</span>(<span class="string">'TRUNCATE TABLE users'</span>);  <span class="comment">// clean state</span>
});

<span class="fn">afterAll</span>(<span class="keyword">async</span> () => {
  <span class="keyword">await</span> db.<span class="fn">destroy</span>();  <span class="comment">// close connection</span>
});

<span class="fn">describe</span>(<span class="string">'POST /api/users'</span>, () => {
  <span class="fn">it</span>(<span class="string">'creates a user and returns 201'</span>, <span class="keyword">async</span> () => {
    <span class="const">const</span> response = <span class="keyword">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="string">'/api/users'</span>)
      .<span class="fn">send</span>({ name: <span class="string">'Alice'</span>, email: <span class="string">'alice@test.com'</span> });

    <span class="fn">expect</span>(response.status).<span class="fn">toBe</span>(<span class="num">201</span>);
    <span class="fn">expect</span>(response.body).<span class="fn">toMatchObject</span>({
      name: <span class="string">'Alice'</span>,
      email: <span class="string">'alice@test.com'</span>,
      id: <span class="fn">expect</span>.<span class="fn">any</span>(Number)
    });

    <span class="comment">// Verify it actually hit the DB!</span>
    <span class="const">const</span> user = <span class="keyword">await</span> db(<span class="string">'users'</span>).<span class="fn">where</span>({ email: <span class="string">'alice@test.com'</span> }).<span class="fn">first</span>();
    <span class="fn">expect</span>(user).<span class="fn">toBeDefined</span>();
  });
});
      </div>
    </div>

    <div class="tab-content" id="int-api">
      <h3>API Integration Testing with SuperTest</h3>
      <p><strong>SuperTest</strong> lets you make HTTP requests to your Express app without starting a real server.</p>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Setup: npm install --save-dev supertest jest</span>

<span class="comment">// src/app.js ‚Äî Express app (don't call app.listen here!)</span>
<span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">'express'</span>;
<span class="keyword">import</span> userRouter <span class="keyword">from</span> <span class="string">'./routes/users'</span>;

<span class="const">const</span> app = <span class="fn">express</span>();
app.<span class="fn">use</span>(express.<span class="fn">json</span>());
app.<span class="fn">use</span>(<span class="string">'/api/users'</span>, userRouter);
<span class="keyword">export default</span> app;

<span class="comment">// src/server.js ‚Äî only start here</span>
<span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'./app'</span>;
app.<span class="fn">listen</span>(<span class="num">3000</span>);

<span class="comment">// tests/integration/users.test.js</span>
<span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'supertest'</span>;
<span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'../../src/app'</span>;

<span class="fn">describe</span>(<span class="string">'Users API'</span>, () => {
  <span class="fn">it</span>(<span class="string">'GET /api/users ‚Äî returns array'</span>, <span class="keyword">async</span> () => {
    <span class="const">const</span> res = <span class="keyword">await</span> <span class="fn">request</span>(app).<span class="fn">get</span>(<span class="string">'/api/users'</span>);
    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(Array.<span class="fn">isArray</span>(res.body)).<span class="fn">toBe</span>(<span class="keyword">true</span>);
  });

  <span class="fn">it</span>(<span class="string">'POST /api/users ‚Äî validates email'</span>, <span class="keyword">async</span> () => {
    <span class="const">const</span> res = <span class="keyword">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="string">'/api/users'</span>)
      .<span class="fn">send</span>({ name: <span class="string">'Bob'</span>, email: <span class="string">'not-an-email'</span> });

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">400</span>);
    <span class="fn">expect</span>(res.body.error).<span class="fn">toMatch</span>(<span class="string">/email/i</span>);
  });

  <span class="fn">it</span>(<span class="string">'DELETE /api/users/:id ‚Äî 404 for missing user'</span>, <span class="keyword">async</span> () => {
    <span class="const">const</span> res = <span class="keyword">await</span> <span class="fn">request</span>(app).<span class="fn">delete</span>(<span class="string">'/api/users/99999'</span>);
    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">404</span>);
  });

  <span class="fn">it</span>(<span class="string">'GET /api/users/:id ‚Äî returns user with orders'</span>, <span class="keyword">async</span> () => {
    <span class="comment">// Create user first, then fetch</span>
    <span class="const">const</span> created = <span class="keyword">await</span> <span class="fn">request</span>(app)
      .<span class="fn">post</span>(<span class="string">'/api/users'</span>)
      .<span class="fn">send</span>({ name: <span class="string">'Carol'</span>, email: <span class="string">'carol@test.com'</span> });

    <span class="const">const</span> res = <span class="keyword">await</span> <span class="fn">request</span>(app)
      .<span class="fn">get</span>(<span class="string">`/api/users/${created.body.id}`</span>);

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(res.body).<span class="fn">toHaveProperty</span>(<span class="string">'orders'</span>);
  });
});
      </div>
    </div>

    <div class="tab-content" id="int-db">
      <h3>Database Integration Testing</h3>
      <div class="info-box warn">
        <span class="info-icon">‚ö†Ô∏è</span>
        <div><strong>Never use production DB for tests!</strong> Use a separate test database, Docker container, or in-memory DB (SQLite for testing SQL, mongodb-memory-server for Mongo).</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Option 1: SQLite in-memory (fast, for SQL apps)</span>
<span class="comment">// jest.config.js</span>
<span class="keyword">export default</span> {
  <span class="prop">testEnvironment</span>: <span class="string">'node'</span>,
  <span class="prop">globalSetup</span>: <span class="string">'./tests/setup/globalSetup.js'</span>,
  <span class="prop">globalTeardown</span>: <span class="string">'./tests/setup/globalTeardown.js'</span>
};

<span class="comment">// tests/setup/globalSetup.js</span>
<span class="keyword">export default async function</span> <span class="fn">setup</span>() {
  process.env.DATABASE_URL = <span class="string">'sqlite::memory:'</span>;
  process.env.NODE_ENV = <span class="string">'test'</span>;
}

<span class="comment">// Option 2: MongoDB in-memory server</span>
<span class="keyword">import</span> { MongoMemoryServer } <span class="keyword">from</span> <span class="string">'mongodb-memory-server'</span>;
<span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">'mongoose'</span>;

<span class="keyword">let</span> mongoServer;

<span class="fn">beforeAll</span>(<span class="keyword">async</span> () => {
  mongoServer = <span class="keyword">await</span> MongoMemoryServer.<span class="fn">create</span>();
  <span class="keyword">await</span> mongoose.<span class="fn">connect</span>(mongoServer.<span class="fn">getUri</span>());
});

<span class="fn">afterAll</span>(<span class="keyword">async</span> () => {
  <span class="keyword">await</span> mongoose.connection.<span class="fn">dropDatabase</span>();
  <span class="keyword">await</span> mongoose.connection.<span class="fn">close</span>();
  <span class="keyword">await</span> mongoServer.<span class="fn">stop</span>();
});

<span class="fn">afterEach</span>(<span class="keyword">async</span> () => {
  <span class="comment">// Clear all collections between tests</span>
  <span class="const">const</span> collections = mongoose.connection.collections;
  <span class="keyword">for</span> (<span class="const">const</span> key <span class="keyword">in</span> collections) {
    <span class="keyword">await</span> collections[key].<span class="fn">deleteMany</span>({});
  }
});

<span class="comment">// Option 3: Docker + real DB (most realistic)</span>
<span class="comment">// docker-compose.test.yml</span>
<span class="comment">// services:</span>
<span class="comment">//   postgres-test:</span>
<span class="comment">//     image: postgres:15</span>
<span class="comment">//     environment:</span>
<span class="comment">//       POSTGRES_DB: myapp_test</span>
<span class="comment">//       POSTGRES_USER: test</span>
<span class="comment">//       POSTGRES_PASSWORD: test</span>
      </div>
    </div>

    <div class="tab-content" id="int-rtl">
      <h3>React Testing Library (RTL) Integration Tests</h3>
      <p>RTL encourages testing components the way users actually use them ‚Äî through the DOM.</p>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// npm install --save-dev @testing-library/react @testing-library/user-event msw</span>

<span class="comment">// tests/integration/LoginForm.test.jsx</span>
<span class="keyword">import</span> { render, screen, waitFor } <span class="keyword">from</span> <span class="string">'@testing-library/react'</span>;
<span class="keyword">import</span> userEvent <span class="keyword">from</span> <span class="string">'@testing-library/user-event'</span>;
<span class="keyword">import</span> { setupServer } <span class="keyword">from</span> <span class="string">'msw/node'</span>;
<span class="keyword">import</span> { http, HttpResponse } <span class="keyword">from</span> <span class="string">'msw'</span>;
<span class="keyword">import</span> LoginForm <span class="keyword">from</span> <span class="string">'../../src/components/LoginForm'</span>;

<span class="comment">// Mock network layer (MSW intercepts real fetch calls!)</span>
<span class="const">const</span> server = <span class="fn">setupServer</span>(
  http.<span class="fn">post</span>(<span class="string">'/api/login'</span>, ({ request }) => {
    <span class="keyword">return</span> HttpResponse.<span class="fn">json</span>({ token: <span class="string">'abc123'</span>, user: { name: <span class="string">'Alice'</span> } });
  })
);

<span class="fn">beforeAll</span>(() => server.<span class="fn">listen</span>());
<span class="fn">afterEach</span>(() => server.<span class="fn">resetHandlers</span>());
<span class="fn">afterAll</span>(() => server.<span class="fn">close</span>());

<span class="fn">it</span>(<span class="string">'logs in user on valid credentials'</span>, <span class="keyword">async</span> () => {
  <span class="fn">render</span>(<LoginForm />);

  <span class="comment">// Simulate user typing</span>
  <span class="keyword">await</span> userEvent.<span class="fn">type</span>(screen.<span class="fn">getByLabelText</span>(<span class="string">/email/i</span>), <span class="string">'alice@test.com'</span>);
  <span class="keyword">await</span> userEvent.<span class="fn">type</span>(screen.<span class="fn">getByLabelText</span>(<span class="string">/password/i</span>), <span class="string">'secret123'</span>);
  <span class="keyword">await</span> userEvent.<span class="fn">click</span>(screen.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">/log in/i</span> }));

  <span class="comment">// Wait for async response</span>
  <span class="keyword">await</span> <span class="fn">waitFor</span>(() => {
    <span class="fn">expect</span>(screen.<span class="fn">getByText</span>(<span class="string">/welcome, alice/i</span>)).<span class="fn">toBeInTheDocument</span>();
  });
});

<span class="fn">it</span>(<span class="string">'shows error on failed login'</span>, <span class="keyword">async</span> () => {
  <span class="comment">// Override handler for this one test</span>
  server.<span class="fn">use</span>(
    http.<span class="fn">post</span>(<span class="string">'/api/login'</span>, () =>
      HttpResponse.<span class="fn">json</span>({ error: <span class="string">'Invalid credentials'</span> }, { status: <span class="num">401</span> })
    )
  );

  <span class="fn">render</span>(<LoginForm />);
  <span class="keyword">await</span> userEvent.<span class="fn">click</span>(screen.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">/log in/i</span> }));

  <span class="keyword">await</span> <span class="fn">waitFor</span>(() => {
    <span class="fn">expect</span>(screen.<span class="fn">getByText</span>(<span class="string">/invalid credentials/i</span>)).<span class="fn">toBeInTheDocument</span>();
  });
});
      </div>
    </div>

    <div class="tab-content" id="int-mocking">
      <h3>Smart Mocking Strategy</h3>
      <div class="info-box tip">
        <span class="info-icon">‚úÖ</span>
        <div><strong>Rule of thumb:</strong> Mock at the boundary of your system. External APIs, file system, time, email services. Don't mock your own code in integration tests!</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ‚ùå BAD ‚Äî mocking your own service (defeats the purpose)</span>
jest.<span class="fn">mock</span>(<span class="string">'./userService'</span>);  <span class="comment">// Don't do this in integration tests!</span>

<span class="comment">// ‚úÖ GOOD ‚Äî mock only external things</span>
jest.<span class="fn">mock</span>(<span class="string">'nodemailer'</span>);     <span class="comment">// External email provider</span>
jest.<span class="fn">mock</span>(<span class="string">'stripe'</span>);         <span class="comment">// Payment processor</span>
jest.<span class="fn">mock</span>(<span class="string">'aws-sdk'</span>);        <span class="comment">// Cloud services</span>

<span class="comment">// Mocking time (for date-dependent tests)</span>
<span class="fn">beforeEach</span>(() => {
  jest.<span class="fn">useFakeTimers</span>();
  jest.<span class="fn">setSystemTime</span>(<span class="keyword">new</span> <span class="fn">Date</span>(<span class="string">'2024-01-15'</span>));
});

<span class="fn">afterEach</span>(() => {
  jest.<span class="fn">useRealTimers</span>();
});

<span class="comment">// Mocking environment variables</span>
<span class="fn">beforeAll</span>(() => {
  process.env.STRIPE_SECRET = <span class="string">'test_sk_...'</span>;
  process.env.JWT_SECRET = <span class="string">'test-secret'</span>;
});
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ E2E -->
<div class="section" id="e2e">
  <div class="card">
    <div class="card-title">üé≠ End-to-End (E2E) Testing</div>
    <p>E2E tests simulate a <strong>real user in a real browser</strong>. They launch your app, click buttons, fill forms, and assert what appears on screen.</p>

    <div class="tab-row">
      <button class="tab-btn active" onclick="switchTab('e2e','playwright')">Playwright</button>
      <button class="tab-btn" onclick="switchTab('e2e','cypress')">Cypress</button>
      <button class="tab-btn" onclick="switchTab('e2e','compare')">Compare</button>
      <button class="tab-btn" onclick="switchTab('e2e','patterns')">Patterns</button>
      <button class="tab-btn" onclick="switchTab('e2e','ci')">CI Setup</button>
    </div>

    <div class="tab-content active" id="e2e-playwright">
      <h3>Playwright ‚Äî The Modern Choice</h3>
      <div class="info-box info">
        <span class="info-icon">üé≠</span>
        <div>Playwright supports Chrome, Firefox, and Safari. It's faster than Cypress, has better async handling, and is the current industry favourite for new projects.</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Install: npm init playwright@latest</span>
<span class="comment">// playwright.config.ts</span>

<span class="keyword">import</span> { defineConfig } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

<span class="keyword">export default</span> <span class="fn">defineConfig</span>({
  <span class="prop">testDir</span>: <span class="string">'./e2e'</span>,
  <span class="prop">timeout</span>: <span class="num">30_000</span>,
  <span class="prop">retries</span>: process.env.CI ? <span class="num">2</span> : <span class="num">0</span>,   <span class="comment">// retry on CI only</span>
  <span class="prop">fullyParallel</span>: <span class="keyword">true</span>,
  <span class="prop">reporter</span>: <span class="string">'html'</span>,
  <span class="prop">use</span>: {
    <span class="prop">baseURL</span>: <span class="string">'http://localhost:3000'</span>,
    <span class="prop">trace</span>: <span class="string">'on-first-retry'</span>,    <span class="comment">// capture trace on failure</span>
    <span class="prop">screenshot</span>: <span class="string">'only-on-failure'</span>,
    <span class="prop">video</span>: <span class="string">'retain-on-failure'</span>,
  },
  <span class="prop">projects</span>: [
    { name: <span class="string">'chromium'</span>, use: { ...devices[<span class="string">'Desktop Chrome'</span>] } },
    { name: <span class="string">'firefox'</span>,  use: { ...devices[<span class="string">'Desktop Firefox'</span>] } },
    { name: <span class="string">'mobile'</span>,   use: { ...devices[<span class="string">'iPhone 13'</span>] } },
  ],
  <span class="prop">webServer</span>: {               <span class="comment">// auto-start your dev server!</span>
    <span class="prop">command</span>: <span class="string">'npm run dev'</span>,
    <span class="prop">url</span>: <span class="string">'http://localhost:3000'</span>,
    <span class="prop">reuseExistingServer</span>: !process.env.CI,
  },
});
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// e2e/auth.spec.ts ‚Äî Full login/logout flow</span>
<span class="keyword">import</span> { test, expect } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

test.<span class="fn">describe</span>(<span class="string">'Authentication'</span>, () => {
  test.<span class="fn">beforeEach</span>(<span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
  });

  <span class="fn">test</span>(<span class="string">'user can log in with valid credentials'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/login'</span>);

    <span class="comment">// Locate by accessible role (best practice!)</span>
    <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Email'</span>).<span class="fn">fill</span>(<span class="string">'alice@example.com'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Password'</span>).<span class="fn">fill</span>(<span class="string">'password123'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Log In'</span> }).<span class="fn">click</span>();

    <span class="comment">// Assert redirect to dashboard</span>
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/dashboard'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="string">'Welcome, Alice!'</span>)).<span class="fn">toBeVisible</span>();
  });

  <span class="fn">test</span>(<span class="string">'shows error for invalid credentials'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/login'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Email'</span>).<span class="fn">fill</span>(<span class="string">'bad@example.com'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Password'</span>).<span class="fn">fill</span>(<span class="string">'wrongpass'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Log In'</span> }).<span class="fn">click</span>();

    <span class="keyword">await</span> <span class="fn">expect</span>(page.<span class="fn">getByRole</span>(<span class="string">'alert'</span>)).<span class="fn">toContainText</span>(<span class="string">'Invalid credentials'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/login'</span>);  <span class="comment">// stayed on login</span>
  });

  <span class="fn">test</span>(<span class="string">'user can log out'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="comment">// Use API to pre-authenticate (faster than UI login!)</span>
    <span class="keyword">await</span> page.<span class="fn">request</span>.<span class="fn">post</span>(<span class="string">'/api/test/login'</span>, {
      data: { email: <span class="string">'alice@example.com'</span>, password: <span class="string">'password123'</span> }
    });

    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/dashboard'</span>);
    <span class="keyword">await</span> page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Logout'</span> }).<span class="fn">click</span>();
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/login'</span>);
  });
});
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Advanced: Page Object Model pattern</span>
<span class="comment">// e2e/pages/LoginPage.ts</span>

<span class="keyword">import</span> { Page, Locator } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

<span class="keyword">export class</span> <span class="fn">LoginPage</span> {
  <span class="keyword">readonly</span> emailInput: Locator;
  <span class="keyword">readonly</span> passwordInput: Locator;
  <span class="keyword">readonly</span> submitBtn: Locator;
  <span class="keyword">readonly</span> errorMsg: Locator;

  <span class="fn">constructor</span>(<span class="keyword">private</span> page: Page) {
    <span class="keyword">this</span>.emailInput = page.<span class="fn">getByLabel</span>(<span class="string">'Email'</span>);
    <span class="keyword">this</span>.passwordInput = page.<span class="fn">getByLabel</span>(<span class="string">'Password'</span>);
    <span class="keyword">this</span>.submitBtn = page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Log In'</span> });
    <span class="keyword">this</span>.errorMsg = page.<span class="fn">getByRole</span>(<span class="string">'alert'</span>);
  }

  <span class="keyword">async</span> <span class="fn">goto</span>() { <span class="keyword">await this</span>.page.<span class="fn">goto</span>(<span class="string">'/login'</span>); }

  <span class="keyword">async</span> <span class="fn">login</span>(email: string, password: string) {
    <span class="keyword">await this</span>.emailInput.<span class="fn">fill</span>(email);
    <span class="keyword">await this</span>.passwordInput.<span class="fn">fill</span>(password);
    <span class="keyword">await this</span>.submitBtn.<span class="fn">click</span>();
  }
}

<span class="comment">// e2e/auth.spec.ts ‚Äî using Page Object Model</span>
<span class="fn">test</span>(<span class="string">'login flow'</span>, <span class="keyword">async</span> ({ page }) => {
  <span class="const">const</span> loginPage = <span class="keyword">new</span> <span class="fn">LoginPage</span>(page);
  <span class="keyword">await</span> loginPage.<span class="fn">goto</span>();
  <span class="keyword">await</span> loginPage.<span class="fn">login</span>(<span class="string">'alice@test.com'</span>, <span class="string">'pass123'</span>);
  <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/dashboard'</span>);
});
      </div>
    </div>

    <div class="tab-content" id="e2e-cypress">
      <h3>Cypress ‚Äî The Developer Favourite</h3>
      <div class="info-box info">
        <span class="info-icon">üå≤</span>
        <div>Cypress runs inside the browser, giving you time travel debugging, automatic waiting, and a brilliant developer experience. Great for React/Vue/Angular apps.</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// Install: npm install --save-dev cypress</span>
<span class="comment">// cypress.config.js</span>

<span class="keyword">const</span> { <span class="fn">defineConfig</span> } = require(<span class="string">'cypress'</span>);

module.exports = <span class="fn">defineConfig</span>({
  e2e: {
    <span class="prop">baseUrl</span>: <span class="string">'http://localhost:3000'</span>,
    <span class="prop">viewportWidth</span>: <span class="num">1280</span>,
    <span class="prop">viewportHeight</span>: <span class="num">720</span>,
    <span class="prop">video</span>: <span class="keyword">false</span>,
    <span class="prop">retries</span>: {
      <span class="prop">runMode</span>: <span class="num">2</span>,   <span class="comment">// CI</span>
      <span class="prop">openMode</span>: <span class="num">0</span>   <span class="comment">// local dev</span>
    }
  }
});

<span class="comment">// cypress/e2e/checkout.cy.js</span>
<span class="fn">describe</span>(<span class="string">'Shopping Cart Checkout'</span>, () => {
  <span class="fn">beforeEach</span>(() => {
    <span class="comment">// Custom command: login via API, skip UI</span>
    cy.<span class="fn">loginByApi</span>(<span class="string">'alice@test.com'</span>, <span class="string">'password123'</span>);
    cy.<span class="fn">visit</span>(<span class="string">'/shop'</span>);
  });

  <span class="fn">it</span>(<span class="string">'adds item to cart and checks out'</span>, () => {
    <span class="comment">// Cypress auto-waits for elements!</span>
    cy.<span class="fn">contains</span>(<span class="string">'Add to Cart'</span>).<span class="fn">first</span>().<span class="fn">click</span>();
    cy.<span class="fn">get</span>(<span class="string">'[data-testid="cart-count"]'</span>).<span class="fn">should</span>(<span class="string">'contain'</span>, <span class="string">'1'</span>);

    cy.<span class="fn">get</span>(<span class="string">'[data-testid="checkout-btn"]'</span>).<span class="fn">click</span>();
    cy.<span class="fn">url</span>().<span class="fn">should</span>(<span class="string">'include'</span>, <span class="string">'/checkout'</span>);

    <span class="comment">// Intercept the payment API call</span>
    cy.<span class="fn">intercept</span>(<span class="string">'POST'</span>, <span class="string">'/api/payment'</span>, { statusCode: <span class="num">200</span>, body: { success: <span class="keyword">true</span> } })
      .<span class="keyword">as</span>(<span class="string">'paymentRequest'</span>);

    cy.<span class="fn">get</span>(<span class="string">'[data-testid="pay-btn"]'</span>).<span class="fn">click</span>();
    cy.<span class="fn">wait</span>(<span class="string">'@paymentRequest'</span>);
    cy.<span class="fn">contains</span>(<span class="string">'Order confirmed!'</span>).<span class="fn">should</span>(<span class="string">'be.visible'</span>);
  });

  <span class="fn">it</span>(<span class="string">'handles payment failure gracefully'</span>, () => {
    cy.<span class="fn">intercept</span>(<span class="string">'POST'</span>, <span class="string">'/api/payment'</span>,
      { statusCode: <span class="num">402</span>, body: { error: <span class="string">'Card declined'</span> } }
    );

    <span class="comment">// ... rest of flow</span>
    cy.<span class="fn">get</span>(<span class="string">'[data-testid="pay-btn"]'</span>).<span class="fn">click</span>();
    cy.<span class="fn">contains</span>(<span class="string">'Card declined'</span>).<span class="fn">should</span>(<span class="string">'be.visible'</span>);
  });
});

<span class="comment">// cypress/support/commands.js ‚Äî custom commands</span>
Cypress.Commands.<span class="fn">add</span>(<span class="string">'loginByApi'</span>, (email, password) => {
  cy.<span class="fn">request</span>(<span class="string">'POST'</span>, <span class="string">'/api/auth/login'</span>, { email, password })
    .<span class="fn">then</span>(({ body }) => {
      window.localStorage.<span class="fn">setItem</span>(<span class="string">'token'</span>, body.token);
    });
});
      </div>
    </div>

    <div class="tab-content" id="e2e-compare">
      <h3>Playwright vs Cypress ‚Äî Detailed Comparison</h3>
      <table class="compare-table">
        <tr>
          <th>Feature</th>
          <th>üé≠ Playwright</th>
          <th>üå≤ Cypress</th>
        </tr>
        <tr>
          <td>Browser Support</td>
          <td class="highlight-green">Chrome, Firefox, Safari, Edge</td>
          <td>Chrome, Firefox, Edge (Safari limited)</td>
        </tr>
        <tr>
          <td>Language</td>
          <td>JS, TS, Python, Java, C#</td>
          <td>JS, TS only</td>
        </tr>
        <tr>
          <td>Multiple Tabs</td>
          <td class="highlight-green">‚úÖ Supported</td>
          <td class="highlight-red">Limited (experimental)</td>
        </tr>
        <tr>
          <td>Speed</td>
          <td class="highlight-green">Faster (parallel by default)</td>
          <td>Slower without dashboard</td>
        </tr>
        <tr>
          <td>DX / Debugging</td>
          <td>Good (trace viewer)</td>
          <td class="highlight-green">Excellent (time travel)</td>
        </tr>
        <tr>
          <td>Auto-Wait</td>
          <td class="highlight-green">Smart auto-wait</td>
          <td class="highlight-green">Auto-retry</td>
        </tr>
        <tr>
          <td>iframes</td>
          <td class="highlight-green">‚úÖ Easy</td>
          <td>Awkward</td>
        </tr>
        <tr>
          <td>Network Intercept</td>
          <td class="highlight-green">‚úÖ Powerful</td>
          <td class="highlight-green">‚úÖ cy.intercept</td>
        </tr>
        <tr>
          <td>Component Testing</td>
          <td>‚úÖ Experimental</td>
          <td class="highlight-green">‚úÖ Mature</td>
        </tr>
        <tr>
          <td>When to Choose</td>
          <td>Multi-browser, complex flows, CI speed</td>
          <td>React apps, great DX, component tests</td>
        </tr>
      </table>
    </div>

    <div class="tab-content" id="e2e-patterns">
      <h3>E2E Best Practices & Patterns</h3>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// ‚úÖ Pattern 1: Use test IDs ‚Äî never rely on CSS classes!</span>
<span class="comment">// In your component:</span>
<span class="tag">&lt;button</span> <span class="prop">data-testid</span>=<span class="string">"submit-btn"</span><span class="tag">&gt;</span>Submit<span class="tag">&lt;/button&gt;</span>

<span class="comment">// In Playwright:</span>
page.<span class="fn">getByTestId</span>(<span class="string">'submit-btn'</span>)  <span class="comment">// ‚úÖ stable</span>
page.<span class="fn">locator</span>(<span class="string">'.btn-blue'</span>)       <span class="comment">// ‚ùå breaks if CSS changes</span>

<span class="comment">// ‚úÖ Pattern 2: Prefer accessible selectors</span>
page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Submit'</span> })  <span class="comment">// best</span>
page.<span class="fn">getByLabel</span>(<span class="string">'Email address'</span>)              <span class="comment">// great</span>
page.<span class="fn">getByPlaceholder</span>(<span class="string">'Enter email'</span>)           <span class="comment">// ok</span>
page.<span class="fn">getByText</span>(<span class="string">'Welcome back!'</span>)               <span class="comment">// ok for text content</span>

<span class="comment">// ‚úÖ Pattern 3: Authenticate via API, not UI (speed!)</span>
test.<span class="fn">beforeEach</span>(<span class="keyword">async</span> ({ page, request }) => {
  <span class="const">const</span> token = <span class="keyword">await</span> <span class="fn">getAuthToken</span>(request);
  <span class="keyword">await</span> page.<span class="fn">addInitScript</span>(t => {
    window.localStorage.<span class="fn">setItem</span>(<span class="string">'authToken'</span>, t);
  }, token);
});

<span class="comment">// ‚úÖ Pattern 4: Test isolation ‚Äî reset state between tests</span>
test.<span class="fn">afterEach</span>(<span class="keyword">async</span> ({ request }) => {
  <span class="keyword">await</span> request.<span class="fn">delete</span>(<span class="string">'/api/test/cleanup'</span>); <span class="comment">// test-only endpoint</span>
});

<span class="comment">// ‚úÖ Pattern 5: Wait smartly, never sleep!</span>
<span class="keyword">await</span> page.<span class="fn">waitForURL</span>(<span class="string">'/dashboard'</span>);          <span class="comment">// ‚úÖ</span>
<span class="keyword">await</span> page.<span class="fn">waitForSelector</span>(<span class="string">'[data-loaded]'</span>);    <span class="comment">// ‚úÖ</span>
<span class="keyword">await</span> page.<span class="fn">waitForResponse</span>(<span class="string">'/api/users'</span>);        <span class="comment">// ‚úÖ</span>
<span class="keyword">await</span> page.<span class="fn">waitForTimeout</span>(<span class="num">3000</span>);                 <span class="comment">// ‚ùå NEVER do this!</span>
      </div>
    </div>

    <div class="tab-content" id="e2e-ci">
      <h3>Running E2E in CI/CD</h3>
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment"># .github/workflows/e2e.yml</span>
name: E2E Tests

on: [push, pull_request]

jobs:
  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright browsers
        run: npx playwright install --with-deps

      - name: Start test database
        run: docker compose -f docker-compose.test.yml up -d

      - name: Run database migrations
        run: npm run db:migrate:test

      - name: Run E2E tests
        run: npx playwright test
        env:
          DATABASE_URL: postgresql://test:test@localhost:5432/testdb
          BASE_URL: http://localhost:3000

      - name: Upload test results
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: playwright-report
          path: playwright-report/
          retention-days: 7
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ VISUAL -->
<div class="section" id="visual">
  <div class="card">
    <div class="card-title">üëÅÔ∏è Visual Regression Testing</div>
    <p>Visual regression testing catches <strong>unintended UI changes</strong> by comparing screenshots pixel-by-pixel against approved baselines.</p>

    <div class="info-box tip">
      <span class="info-icon">üí°</span>
      <div><strong>Example:</strong> A developer changes a padding from <code>16px</code> to <code>8px</code> in a shared component. Your visual tests catch this even if all functional tests pass!</div>
    </div>

    <div class="tab-row">
      <button class="tab-btn active" onclick="switchTab('vis','concept')">How It Works</button>
      <button class="tab-btn" onclick="switchTab('vis','playwright')">Playwright Screenshots</button>
      <button class="tab-btn" onclick="switchTab('vis','storybook')">Storybook / Chromatic</button>
      <button class="tab-btn" onclick="switchTab('vis','percy')">Percy</button>
    </div>

    <div class="tab-content active" id="vis-concept">
      <h3>The Visual Testing Workflow</h3>

      <div class="flow" style="flex-wrap:wrap; gap:8px;">
        <div class="flow-box" style="border-color:var(--accent)">üì∏ Take screenshot</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent)">üìÅ Save as baseline</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent)">üîÑ Code changes</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent3)">üì∏ New screenshot</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent3)">üîç Compare pixels</div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-box" style="border-color:var(--accent4)">‚úÖ Pass / ‚ùå Fail</div>
      </div>

      <div class="grid-2" style="margin-top:16px;">
        <div>
          <h3 style="color:var(--success)">‚úÖ When Visual Tests Shine</h3>
          <ul>
            <li>CSS/layout regressions</li>
            <li>Font changes</li>
            <li>Responsive breakpoints</li>
            <li>Design system components</li>
            <li>Theming (dark/light mode)</li>
          </ul>
        </div>
        <div>
          <h3 style="color:var(--danger)">‚ùå When They Struggle</h3>
          <ul>
            <li>Dynamic content (dates, random IDs)</li>
            <li>Animations</li>
            <li>Anti-aliasing differences across OS</li>
            <li>Third-party widgets</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="tab-content" id="vis-playwright">
      <h3>Playwright Built-in Screenshot Comparison</h3>
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// e2e/visual.spec.ts</span>
<span class="keyword">import</span> { test, expect } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

test.<span class="fn">describe</span>(<span class="string">'Visual Regression'</span>, () => {
  <span class="fn">test</span>(<span class="string">'homepage looks correct'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
    <span class="keyword">await</span> page.<span class="fn">waitForLoadState</span>(<span class="string">'networkidle'</span>);  <span class="comment">// wait for all requests</span>

    <span class="comment">// Compares to stored screenshot in e2e/__screenshots__/</span>
    <span class="comment">// First run: creates the baseline</span>
    <span class="comment">// Subsequent runs: compares to baseline</span>
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'homepage.png'</span>, {
      <span class="prop">maxDiffPixels</span>: <span class="num">100</span>,        <span class="comment">// allow 100px difference</span>
      <span class="prop">threshold</span>: <span class="num">0.2</span>,             <span class="comment">// 20% color difference tolerance</span>
    });
  });

  <span class="fn">test</span>(<span class="string">'button component states'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/components/button'</span>);

    <span class="comment">// Screenshot specific element, not full page</span>
    <span class="const">const</span> button = page.<span class="fn">getByTestId</span>(<span class="string">'primary-button'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(button).<span class="fn">toHaveScreenshot</span>(<span class="string">'button-default.png'</span>);

    <span class="keyword">await</span> button.<span class="fn">hover</span>();
    <span class="keyword">await</span> <span class="fn">expect</span>(button).<span class="fn">toHaveScreenshot</span>(<span class="string">'button-hover.png'</span>);
  });

  <span class="fn">test</span>(<span class="string">'dark mode'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="comment">// Test with specific color scheme</span>
    <span class="keyword">await</span> page.<span class="fn">emulateMedia</span>({ colorScheme: <span class="string">'dark'</span> });
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'homepage-dark.png'</span>);
  });

  <span class="fn">test</span>(<span class="string">'responsive ‚Äî mobile view'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">setViewportSize</span>({ width: <span class="num">375</span>, height: <span class="num">812</span> });
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'homepage-mobile.png'</span>);
  });

  <span class="fn">test</span>(<span class="string">'mask dynamic content'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/dashboard'</span>);
    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'dashboard.png'</span>, {
      <span class="comment">// Mask elements that change every run</span>
      <span class="prop">mask</span>: [
        page.<span class="fn">getByTestId</span>(<span class="string">'current-date'</span>),
        page.<span class="fn">getByTestId</span>(<span class="string">'user-avatar'</span>),
        page.<span class="fn">locator</span>(<span class="string">'.ad-banner'</span>),
      ],
    });
  });
});

<span class="comment">// Update baselines when changes are intentional:</span>
<span class="comment">// npx playwright test --update-snapshots</span>
      </div>
    </div>

    <div class="tab-content" id="vis-storybook">
      <h3>Storybook + Chromatic</h3>
      <div class="info-box info">
        <span class="info-icon">üìñ</span>
        <div><strong>Chromatic</strong> is a visual testing cloud service by the Storybook team. It tests every story in your Storybook automatically on each PR.</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// 1. Create stories for your components</span>
<span class="comment">// src/components/Button/Button.stories.ts</span>

<span class="keyword">import type</span> { Meta, StoryObj } <span class="keyword">from</span> <span class="string">'@storybook/react'</span>;
<span class="keyword">import</span> { Button } <span class="keyword">from</span> <span class="string">'./Button'</span>;

<span class="const">const</span> meta: Meta<typeof Button> = {
  <span class="prop">component</span>: Button,
};
<span class="keyword">export default</span> meta;

<span class="keyword">type</span> Story = StoryObj<typeof Button>;

<span class="comment">// Each exported const = one visual test!</span>
<span class="keyword">export const</span> Primary: Story = {
  args: { label: <span class="string">'Click me'</span>, variant: <span class="string">'primary'</span> }
};

<span class="keyword">export const</span> Secondary: Story = {
  args: { label: <span class="string">'Cancel'</span>, variant: <span class="string">'secondary'</span> }
};

<span class="keyword">export const</span> Loading: Story = {
  args: { label: <span class="string">'Submit'</span>, loading: <span class="keyword">true</span> }
};

<span class="keyword">export const</span> Disabled: Story = {
  args: { label: <span class="string">'Can\'t click'</span>, disabled: <span class="keyword">true</span> }
};

<span class="comment">// 2. Add Chromatic to CI</span>
<span class="comment"># .github/workflows/chromatic.yml</span>
<span class="comment"># - name: Run Chromatic</span>
<span class="comment">#   run: npx chromatic --project-token=${{ secrets.CHROMATIC_PROJECT_TOKEN }}</span>
      </div>
    </div>

    <div class="tab-content" id="vis-percy">
      <h3>Percy (BrowserStack)</h3>
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// npm install --save-dev @percy/playwright</span>
<span class="comment">// e2e/visual.percy.spec.ts</span>

<span class="keyword">import</span> { test } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;
<span class="keyword">import</span> percySnapshot <span class="keyword">from</span> <span class="string">'@percy/playwright'</span>;

<span class="fn">test</span>(<span class="string">'Product listing page'</span>, <span class="keyword">async</span> ({ page }) => {
  <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/products'</span>);
  <span class="keyword">await</span> page.<span class="fn">waitForSelector</span>(<span class="string">'.product-card'</span>);

  <span class="comment">// Percy uploads to cloud, shows visual diff in UI</span>
  <span class="keyword">await</span> <span class="fn">percySnapshot</span>(page, <span class="string">'Product Listing'</span>);
});

<span class="comment">// Percy advantages over built-in:</span>
<span class="comment">// - Cross-browser rendering comparison</span>
<span class="comment">// - Beautiful UI for reviewing diffs</span>
<span class="comment">// - Team approval workflow (PR review-like)</span>
<span class="comment">// - Responsive snapshot (multiple widths in one test)</span>

<span class="keyword">await</span> <span class="fn">percySnapshot</span>(page, <span class="string">'Homepage'</span>, {
  widths: [<span class="num">375</span>, <span class="num">768</span>, <span class="num">1280</span>]  <span class="comment">// test 3 breakpoints at once!</span>
});
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ STRATEGIES -->
<div class="section" id="strategies">
  <div class="card">
    <div class="card-title">üó∫Ô∏è Test Strategies</div>
    <p>Having the right strategy is more important than any individual test. Know <strong>what to test, when, and how much</strong>.</p>

    <div class="strategy-grid">
      <div class="strategy-card">
        <div class="strategy-icon">üèîÔ∏è</div>
        <div class="strategy-name">Test Pyramid</div>
        <div class="strategy-desc">60% unit, 30% integration, 10% E2E. Classic strategy. Fast feedback. Best for most applications.</div>
      </div>
      <div class="strategy-card">
        <div class="strategy-icon">üèÜ</div>
        <div class="strategy-name">Test Trophy</div>
        <div class="strategy-desc">Heavy emphasis on integration tests. Popularized by Kent C. Dodds. "The more your tests resemble the way your software is used, the more confidence they give."</div>
      </div>
      <div class="strategy-card">
        <div class="strategy-icon">üçØ</div>
        <div class="strategy-name">Test Honeycomb</div>
        <div class="strategy-desc">Spotify's approach. Heavy integration tests for microservices, minimal E2E. Focus on service contracts.</div>
      </div>
      <div class="strategy-card">
        <div class="strategy-icon">ü¶Ä</div>
        <div class="strategy-name">Testing Crab</div>
        <div class="strategy-desc">Equal mix of unit and E2E, fewer integration. Good when your services have clear boundaries already tested by contracts.</div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üéØ What to Test ‚Äî Priority Rules</div>

    <div class="tab-row">
      <button class="tab-btn active" onclick="switchTab('strat','priority')">Priority Rules</button>
      <button class="tab-btn" onclick="switchTab('strat','coverage')">Code Coverage</button>
      <button class="tab-btn" onclick="switchTab('strat','cicd')">CI/CD Pipeline</button>
      <button class="tab-btn" onclick="switchTab('strat','tdd')">TDD Flow</button>
    </div>

    <div class="tab-content active" id="strat-priority">
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// üéØ PRIORITY 1: Critical user paths (always E2E)</span>
<span class="comment">// - User registration/login</span>
<span class="comment">// - Checkout/payment flow</span>
<span class="comment">// - Core feature your product is built on</span>

<span class="comment">// üéØ PRIORITY 2: Business logic (integration + unit)</span>
<span class="comment">// - Pricing calculations</span>
<span class="comment">// - Authorization/permissions</span>
<span class="comment">// - Data transformations</span>

<span class="comment">// üéØ PRIORITY 3: Error handling (unit + integration)</span>
<span class="comment">// - Empty states</span>
<span class="comment">// - Network failures</span>
<span class="comment">// - Validation errors</span>

<span class="comment">// üéØ PRIORITY 4: UI appearance (visual)</span>
<span class="comment">// - Only for stable, shipped components</span>
<span class="comment">// - Design system / shared components</span>

<span class="comment">// ‚ùå LOW VALUE (avoid over-testing)</span>
<span class="comment">// - Third party library internals</span>
<span class="comment">// - Implementation details</span>
<span class="comment">// - Getters/setters with no logic</span>
<span class="comment">// - Tests that duplicate each other</span>

<span class="comment">// üí° The "Whack-a-Mole" rule:</span>
<span class="comment">// Every time a bug hits production, write a test that</span>
<span class="comment">// would have caught it BEFORE writing the fix!</span>
      </div>

      <div class="info-box tip">
        <span class="info-icon">üèÜ</span>
        <div><strong>Interview answer:</strong> "I follow the test pyramid but adapt it. I prioritise high-value integration tests for critical flows, use unit tests for complex business logic, and E2E for the top 5 user journeys."</div>
      </div>
    </div>

    <div class="tab-content" id="strat-coverage">
      <h3>Code Coverage ‚Äî Done Right</h3>
      <div class="info-box warn">
        <span class="info-icon">‚ö†Ô∏è</span>
        <div><strong>100% coverage is not the goal!</strong> 100% coverage with bad tests is worse than 70% coverage with excellent tests. Coverage shows what code was run, not that it works correctly.</div>
      </div>

      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// jest.config.js ‚Äî coverage configuration</span>
<span class="keyword">export default</span> {
  <span class="prop">collectCoverageFrom</span>: [
    <span class="string">'src/**/*.{js,ts,jsx,tsx}'</span>,
    <span class="string">'!src/**/*.stories.*'</span>,      <span class="comment">// exclude stories</span>
    <span class="string">'!src/**/*.d.ts'</span>,            <span class="comment">// exclude types</span>
    <span class="string">'!src/**/index.ts'</span>,          <span class="comment">// exclude barrel files</span>
    <span class="string">'!src/migrations/**'</span>,        <span class="comment">// exclude DB migrations</span>
  ],
  <span class="prop">coverageThresholds</span>: {
    global: {
      <span class="prop">lines</span>: <span class="num">70</span>,      <span class="comment">// fail CI if below 70%</span>
      <span class="prop">branches</span>: <span class="num">60</span>,
      <span class="prop">functions</span>: <span class="num">70</span>,
    },
    <span class="comment">// Per-file thresholds for critical code</span>
    <span class="string">'./src/utils/payment.ts'</span>: {
      <span class="prop">lines</span>: <span class="num">95</span>,
      <span class="prop">branches</span>: <span class="num">90</span>,
    }
  },
  <span class="prop">coverageReporters</span>: [<span class="string">'text'</span>, <span class="string">'lcov'</span>, <span class="string">'html'</span>],
};

<span class="comment">// npm test -- --coverage</span>

<span class="comment">// ‚úÖ Coverage types explained:</span>
<span class="comment">// Statement: was each line executed?</span>
<span class="comment">// Branch: was each if/else branch taken?</span>
<span class="comment">// Function: was each function called?</span>
<span class="comment">// Line: was each line executed? (similar to statement)</span>
      </div>
    </div>

    <div class="tab-content" id="strat-cicd">
      <h3>Complete CI/CD Pipeline</h3>
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment"># .github/workflows/full-ci.yml</span>
name: Full Test Suite

on:
  pull_request:
    branches: [main, develop]
  push:
    branches: [main]

jobs:
  <span class="comment"># Stage 1: Fast checks (run first, fail fast!)</span>
  lint-and-types:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npm run lint
      - run: npm run typecheck

  <span class="comment"># Stage 2: Unit tests (fast, run in parallel)</span>
  unit-tests:
    needs: lint-and-types
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npm test -- --coverage
      - uses: actions/upload-artifact@v4
        with:
          name: coverage-report
          path: coverage/

  <span class="comment"># Stage 3: Integration tests (with real DB)</span>
  integration-tests:
    needs: lint-and-types
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: testdb
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        ports: ['5432:5432']
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npm run test:integration
        env:
          DATABASE_URL: postgresql://test:test@localhost:5432/testdb

  <span class="comment"># Stage 4: E2E tests (slow, after everything passes)</span>
  e2e-tests:
    needs: [unit-tests, integration-tests]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npx playwright install --with-deps
      - run: npm run build
      - run: npx playwright test --shard=1/3  <span class="comment"># split into 3!</span>

  <span class="comment"># Stage 5: Visual regression (on PRs only)</span>
  visual-tests:
    needs: e2e-tests
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: npx chromatic --project-token=${{ secrets.CHROMATIC_TOKEN }}
      </div>
    </div>

    <div class="tab-content" id="strat-tdd">
      <h3>Test-Driven Development (TDD) Flow</h3>
      <div class="code-block">
<button class="copy-btn" onclick="copyCode(this)">Copy</button>
<span class="comment">// TDD Cycle: Red ‚Üí Green ‚Üí Refactor</span>

<span class="comment">// STEP 1: üî¥ RED ‚Äî Write a failing test FIRST</span>
<span class="fn">describe</span>(<span class="string">'calculateDiscount'</span>, () => {
  <span class="fn">it</span>(<span class="string">'applies 10% discount for premium users'</span>, () => {
    <span class="fn">expect</span>(<span class="fn">calculateDiscount</span>(<span class="num">100</span>, <span class="string">'premium'</span>)).<span class="fn">toBe</span>(<span class="num">90</span>);
  });

  <span class="fn">it</span>(<span class="string">'applies 20% for VIP users'</span>, () => {
    <span class="fn">expect</span>(<span class="fn">calculateDiscount</span>(<span class="num">100</span>, <span class="string">'vip'</span>)).<span class="fn">toBe</span>(<span class="num">80</span>);
  });

  <span class="fn">it</span>(<span class="string">'no discount for regular users'</span>, () => {
    <span class="fn">expect</span>(<span class="fn">calculateDiscount</span>(<span class="num">100</span>, <span class="string">'regular'</span>)).<span class="fn">toBe</span>(<span class="num">100</span>);
  });

  <span class="fn">it</span>(<span class="string">'throws for negative amount'</span>, () => {
    <span class="fn">expect</span>(() => <span class="fn">calculateDiscount</span>(-<span class="num">10</span>, <span class="string">'premium'</span>)).<span class="fn">toThrow</span>(<span class="string">'Amount must be positive'</span>);
  });
});

<span class="comment">// STEP 2: üü¢ GREEN ‚Äî Write minimal code to pass</span>
<span class="keyword">function</span> <span class="fn">calculateDiscount</span>(amount, userType) {
  <span class="keyword">if</span> (amount < <span class="num">0</span>) <span class="keyword">throw new</span> <span class="fn">Error</span>(<span class="string">'Amount must be positive'</span>);
  <span class="const">const</span> discounts = { premium: <span class="num">0.1</span>, vip: <span class="num">0.2</span>, regular: <span class="num">0</span> };
  <span class="keyword">return</span> amount * (<span class="num">1</span> - (discounts[userType] ?? <span class="num">0</span>));
}

<span class="comment">// STEP 3: üîµ REFACTOR ‚Äî improve without breaking tests</span>
<span class="comment">// Maybe extract DISCOUNT_RATES to a constant,</span>
<span class="comment">// add TypeScript types, improve error messages...</span>
<span class="comment">// Tests ensure you don't break behaviour!</span>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ EXERCISES -->
<div class="section" id="exercises">
  <div class="card">
    <div class="card-title">üí™ Practice Exercises</div>
    <p>Write your answers in the code editors. Click "Show Solution" when ready to compare.</p>

    <!-- Exercise 1 -->
    <div class="exercise-box">
      <div class="exercise-title">
        <span class="exercise-label">Exercise 1 ‚Äî API Integration Test</span>
        <span class="difficulty diff-easy">Easy</span>
      </div>
      <div class="exercise-prompt">
        Write an integration test for a <code>GET /api/products</code> endpoint that should:
        <ul style="margin:8px 0 0 16px;">
          <li>Return status 200</li>
          <li>Return an array of products</li>
          <li>Each product should have an <code>id</code>, <code>name</code>, and <code>price</code></li>
        </ul>
      </div>
      <textarea class="code-editor" id="ex1-input" spellcheck="false" placeholder="import request from 'supertest';
import app from '../src/app';

describe('GET /api/products', () => {
  // Write your test here...
});">
      </textarea>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="showSolution('ex1')">Show Solution</button>
        <button class="btn btn-primary" onclick="checkEx1()">Check My Answer</button>
      </div>
      <div class="result-box" id="ex1-result"></div>
      <div class="code-block" id="ex1-solution" style="display:none; margin-top:12px;">
<span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'supertest'</span>;
<span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'../src/app'</span>;

<span class="fn">describe</span>(<span class="string">'GET /api/products'</span>, () => {
  <span class="fn">it</span>(<span class="string">'returns 200 with array of products'</span>, <span class="keyword">async</span> () => {
    <span class="const">const</span> res = <span class="keyword">await</span> <span class="fn">request</span>(app).<span class="fn">get</span>(<span class="string">'/api/products'</span>);

    <span class="fn">expect</span>(res.status).<span class="fn">toBe</span>(<span class="num">200</span>);
    <span class="fn">expect</span>(Array.<span class="fn">isArray</span>(res.body)).<span class="fn">toBe</span>(<span class="keyword">true</span>);

    <span class="keyword">if</span> (res.body.length > <span class="num">0</span>) {
      <span class="fn">expect</span>(res.body[<span class="num">0</span>]).<span class="fn">toMatchObject</span>({
        id: <span class="fn">expect</span>.<span class="fn">any</span>(Number),
        name: <span class="fn">expect</span>.<span class="fn">any</span>(String),
        price: <span class="fn">expect</span>.<span class="fn">any</span>(Number),
      });
    }
  });
});
      </div>
    </div>

    <!-- Exercise 2 -->
    <div class="exercise-box">
      <div class="exercise-title">
        <span class="exercise-label">Exercise 2 ‚Äî Playwright Login Test</span>
        <span class="difficulty diff-medium">Medium</span>
      </div>
      <div class="exercise-prompt">
        Write a Playwright test that:
        <ul style="margin:8px 0 0 16px;">
          <li>Navigates to <code>/login</code></li>
          <li>Fills in email and password using accessible selectors</li>
          <li>Clicks submit</li>
          <li>Asserts user is redirected to <code>/dashboard</code></li>
          <li>Asserts "Welcome" text is visible</li>
        </ul>
      </div>
      <textarea class="code-editor" id="ex2-input" spellcheck="false" placeholder="import { test, expect } from '@playwright/test';

test('user can login', async ({ page }) => {
  // Write your Playwright test here...
});">
      </textarea>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="showSolution('ex2')">Show Solution</button>
        <button class="btn btn-primary" onclick="checkEx2()">Check My Answer</button>
      </div>
      <div class="result-box" id="ex2-result"></div>
      <div class="code-block" id="ex2-solution" style="display:none; margin-top:12px;">
<span class="keyword">import</span> { test, expect } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

<span class="fn">test</span>(<span class="string">'user can login successfully'</span>, <span class="keyword">async</span> ({ page }) => {
  <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/login'</span>);

  <span class="comment">// Use accessible labels for form fields</span>
  <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Email'</span>).<span class="fn">fill</span>(<span class="string">'alice@example.com'</span>);
  <span class="keyword">await</span> page.<span class="fn">getByLabel</span>(<span class="string">'Password'</span>).<span class="fn">fill</span>(<span class="string">'password123'</span>);
  <span class="keyword">await</span> page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Log In'</span> }).<span class="fn">click</span>();

  <span class="comment">// Verify redirect and welcome message</span>
  <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/dashboard'</span>);
  <span class="keyword">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="string">/welcome/i</span>)).<span class="fn">toBeVisible</span>();
});
      </div>
    </div>

    <!-- Exercise 3 -->
    <div class="exercise-box">
      <div class="exercise-title">
        <span class="exercise-label">Exercise 3 ‚Äî Visual Regression Test</span>
        <span class="difficulty diff-medium">Medium</span>
      </div>
      <div class="exercise-prompt">
        Write a Playwright visual regression test that:
        <ul style="margin:8px 0 0 16px;">
          <li>Takes a screenshot of the homepage in both light and dark mode</li>
          <li>Masks any element with class <code>.dynamic-content</code></li>
          <li>Allows 50 pixels of difference</li>
        </ul>
      </div>
      <textarea class="code-editor" id="ex3-input" spellcheck="false" placeholder="import { test, expect } from '@playwright/test';

test.describe('Visual Regression', () => {
  // Write your visual tests here...
});">
      </textarea>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="showSolution('ex3')">Show Solution</button>
        <button class="btn btn-primary" onclick="checkEx3()">Check My Answer</button>
      </div>
      <div class="result-box" id="ex3-result"></div>
      <div class="code-block" id="ex3-solution" style="display:none; margin-top:12px;">
<span class="keyword">import</span> { test, expect } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

test.<span class="fn">describe</span>(<span class="string">'Visual Regression'</span>, () => {
  <span class="fn">test</span>(<span class="string">'homepage ‚Äî light mode'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">emulateMedia</span>({ colorScheme: <span class="string">'light'</span> });
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
    <span class="keyword">await</span> page.<span class="fn">waitForLoadState</span>(<span class="string">'networkidle'</span>);

    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'homepage-light.png'</span>, {
      <span class="prop">maxDiffPixels</span>: <span class="num">50</span>,
      <span class="prop">mask</span>: [page.<span class="fn">locator</span>(<span class="string">'.dynamic-content'</span>)],
    });
  });

  <span class="fn">test</span>(<span class="string">'homepage ‚Äî dark mode'</span>, <span class="keyword">async</span> ({ page }) => {
    <span class="keyword">await</span> page.<span class="fn">emulateMedia</span>({ colorScheme: <span class="string">'dark'</span> });
    <span class="keyword">await</span> page.<span class="fn">goto</span>(<span class="string">'/'</span>);
    <span class="keyword">await</span> page.<span class="fn">waitForLoadState</span>(<span class="string">'networkidle'</span>);

    <span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'homepage-dark.png'</span>, {
      <span class="prop">maxDiffPixels</span>: <span class="num">50</span>,
      <span class="prop">mask</span>: [page.<span class="fn">locator</span>(<span class="string">'.dynamic-content'</span>)],
    });
  });
});
      </div>
    </div>

    <!-- Exercise 4 -->
    <div class="exercise-box">
      <div class="exercise-title">
        <span class="exercise-label">Exercise 4 ‚Äî Page Object Model</span>
        <span class="difficulty diff-hard">Hard</span>
      </div>
      <div class="exercise-prompt">
        Create a <strong>Page Object Model</strong> class for a checkout form with: email, address, card number fields, and a "Place Order" button. Then write a test using this class that submits the form and asserts the order confirmation page.
      </div>
      <textarea class="code-editor" id="ex4-input" spellcheck="false" placeholder="// CheckoutPage class + test using it
import { Page, Locator } from '@playwright/test';

export class CheckoutPage {
  // Define your locators here...
  
  async fillDetails(details) {
    // Fill the form...
  }
  
  async placeOrder() {
    // Click submit...
  }
}

// test('checkout flow', ...)
">
      </textarea>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="showSolution('ex4')">Show Solution</button>
      </div>
      <div class="code-block" id="ex4-solution" style="display:none; margin-top:12px;">
<span class="comment">// e2e/pages/CheckoutPage.ts</span>
<span class="keyword">import</span> { Page, Locator } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;

<span class="keyword">export class</span> <span class="fn">CheckoutPage</span> {
  <span class="keyword">readonly</span> emailInput: Locator;
  <span class="keyword">readonly</span> addressInput: Locator;
  <span class="keyword">readonly</span> cardInput: Locator;
  <span class="keyword">readonly</span> placeOrderBtn: Locator;

  <span class="fn">constructor</span>(<span class="keyword">private</span> page: Page) {
    <span class="keyword">this</span>.emailInput   = page.<span class="fn">getByLabel</span>(<span class="string">'Email'</span>);
    <span class="keyword">this</span>.addressInput = page.<span class="fn">getByLabel</span>(<span class="string">'Address'</span>);
    <span class="keyword">this</span>.cardInput    = page.<span class="fn">getByLabel</span>(<span class="string">'Card Number'</span>);
    <span class="keyword">this</span>.placeOrderBtn = page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Place Order'</span> });
  }

  <span class="keyword">async</span> <span class="fn">goto</span>() {
    <span class="keyword">await this</span>.page.<span class="fn">goto</span>(<span class="string">'/checkout'</span>);
  }

  <span class="keyword">async</span> <span class="fn">fillDetails</span>(details: {
    email: <span class="keyword">string</span>;
    address: <span class="keyword">string</span>;
    cardNumber: <span class="keyword">string</span>;
  }) {
    <span class="keyword">await this</span>.emailInput.<span class="fn">fill</span>(details.email);
    <span class="keyword">await this</span>.addressInput.<span class="fn">fill</span>(details.address);
    <span class="keyword">await this</span>.cardInput.<span class="fn">fill</span>(details.cardNumber);
  }

  <span class="keyword">async</span> <span class="fn">placeOrder</span>() {
    <span class="keyword">await this</span>.placeOrderBtn.<span class="fn">click</span>();
    <span class="keyword">await this</span>.page.<span class="fn">waitForURL</span>(<span class="string">'**/order-confirmation/**'</span>);
  }
}

<span class="comment">// e2e/checkout.spec.ts</span>
<span class="keyword">import</span> { test, expect } <span class="keyword">from</span> <span class="string">'@playwright/test'</span>;
<span class="keyword">import</span> { CheckoutPage } <span class="keyword">from</span> <span class="string">'./pages/CheckoutPage'</span>;

<span class="fn">test</span>(<span class="string">'checkout flow completes successfully'</span>, <span class="keyword">async</span> ({ page }) => {
  <span class="const">const</span> checkout = <span class="keyword">new</span> <span class="fn">CheckoutPage</span>(page);
  <span class="keyword">await</span> checkout.<span class="fn">goto</span>();

  <span class="keyword">await</span> checkout.<span class="fn">fillDetails</span>({
    email: <span class="string">'alice@test.com'</span>,
    address: <span class="string">'123 Main St, London'</span>,
    cardNumber: <span class="string">'4111 1111 1111 1111'</span>,
  });

  <span class="keyword">await</span> checkout.<span class="fn">placeOrder</span>();

  <span class="keyword">await</span> <span class="fn">expect</span>(page.<span class="fn">getByText</span>(<span class="string">/order confirmed/i</span>)).<span class="fn">toBeVisible</span>();
  <span class="keyword">await</span> <span class="fn">expect</span>(page.<span class="fn">getByTestId</span>(<span class="string">'order-number'</span>)).<span class="fn">toBeVisible</span>();
});
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ QUIZ -->
<div class="section" id="quiz">
  <div class="card">
    <div class="card-title">üß† Knowledge Quiz</div>
    <div class="score-display">
      <div>
        <div class="score-num" id="quizScore">0</div>
        <div class="score-label">correct answers</div>
      </div>
      <div>
        <div class="score-num" id="quizTotal" style="color:var(--text2)">0</div>
        <div class="score-label">answered</div>
      </div>
      <div>
        <button class="btn btn-secondary" onclick="resetQuiz()">üîÑ Reset Quiz</button>
      </div>
    </div>

    <div class="quiz-container" id="quizContainer">

      <div class="quiz-question" id="q1">
        <div class="quiz-q-text">1. In the testing pyramid, which type of test should you have the MOST of?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q1', this, false)">E2E tests</button>
          <button class="quiz-option" onclick="answerQuiz('q1', this, false)">Integration tests</button>
          <button class="quiz-option" onclick="answerQuiz('q1', this, true)">Unit tests</button>
          <button class="quiz-option" onclick="answerQuiz('q1', this, false)">Visual regression tests</button>
        </div>
        <div class="quiz-feedback" id="q1-fb">‚úÖ Unit tests are the base of the pyramid ‚Äî fast, cheap, numerous. They should make up ~60% of your test suite.</div>
      </div>

      <div class="quiz-question" id="q2">
        <div class="quiz-q-text">2. What is SuperTest used for in JavaScript testing?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q2', this, false)">Visual regression testing</button>
          <button class="quiz-option" onclick="answerQuiz('q2', this, true)">Making HTTP requests to an Express app without starting a real server</button>
          <button class="quiz-option" onclick="answerQuiz('q2', this, false)">Mocking database connections</button>
          <button class="quiz-option" onclick="answerQuiz('q2', this, false)">End-to-end browser testing</button>
        </div>
        <div class="quiz-feedback" id="q2-fb">‚úÖ SuperTest wraps your Express app and lets you send HTTP requests in tests without binding to a port. Perfect for API integration tests.</div>
      </div>

      <div class="quiz-question" id="q3">
        <div class="quiz-q-text">3. What should you use instead of `await page.waitForTimeout(3000)` in Playwright?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q3', this, false)">await sleep(3000)</button>
          <button class="quiz-option" onclick="answerQuiz('q3', this, true)">await page.waitForSelector() or await expect(locator).toBeVisible()</button>
          <button class="quiz-option" onclick="answerQuiz('q3', this, false)">await new Promise(r => setTimeout(r, 3000))</button>
          <button class="quiz-option" onclick="answerQuiz('q3', this, false)">Nothing ‚Äî timeouts are necessary</button>
        </div>
        <div class="quiz-feedback" id="q3-fb">‚úÖ Hard-coded timeouts make tests flaky. Always wait for a specific condition: element visible, URL changed, network request completed, etc.</div>
      </div>

      <div class="quiz-question" id="q4">
        <div class="quiz-q-text">4. What is the Page Object Model (POM) pattern used for?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q4', this, false)">Storing test screenshots</button>
          <button class="quiz-option" onclick="answerQuiz('q4', this, false)">Mocking API responses</button>
          <button class="quiz-option" onclick="answerQuiz('q4', this, true)">Encapsulating page interactions into reusable classes to reduce duplication</button>
          <button class="quiz-option" onclick="answerQuiz('q4', this, false)">Running tests in parallel</button>
        </div>
        <div class="quiz-feedback" id="q4-fb">‚úÖ POM groups all selectors and interactions for a page into a class. When the UI changes, you update one class, not every test that uses it.</div>
      </div>

      <div class="quiz-question" id="q5">
        <div class="quiz-q-text">5. In integration tests, what should you generally NOT mock?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q5', this, false)">External email services (SendGrid, Mailgun)</button>
          <button class="quiz-option" onclick="answerQuiz('q5', this, false)">Third-party payment APIs (Stripe)</button>
          <button class="quiz-option" onclick="answerQuiz('q5', this, true)">Your own application's services and modules</button>
          <button class="quiz-option" onclick="answerQuiz('q5', this, false)">AWS S3 file uploads</button>
        </div>
        <div class="quiz-feedback" id="q5-fb">‚úÖ The point of integration tests is to test your code working together. Mocking your own modules defeats the purpose. Only mock external dependencies.</div>
      </div>

      <div class="quiz-question" id="q6">
        <div class="quiz-q-text">6. What does `toHaveScreenshot()` do in Playwright on the FIRST run?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q6', this, false)">Fails the test ‚Äî no baseline exists</button>
          <button class="quiz-option" onclick="answerQuiz('q6', this, true)">Creates the baseline screenshot file</button>
          <button class="quiz-option" onclick="answerQuiz('q6', this, false)">Uploads to Percy cloud</button>
          <button class="quiz-option" onclick="answerQuiz('q6', this, false)">Skips the visual assertion</button>
        </div>
        <div class="quiz-feedback" id="q6-fb">‚úÖ On first run, Playwright creates the baseline. On subsequent runs, it compares against it. Use --update-snapshots to intentionally update baselines.</div>
      </div>

      <div class="quiz-question" id="q7">
        <div class="quiz-q-text">7. What is MSW (Mock Service Worker) used for?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q7', this, false)">Running service workers in test environments</button>
          <button class="quiz-option" onclick="answerQuiz('q7', this, true)">Intercepting real fetch/axios requests at the network level in tests</button>
          <button class="quiz-option" onclick="answerQuiz('q7', this, false)">Mocking database queries</button>
          <button class="quiz-option" onclick="answerQuiz('q7', this, false)">Creating test servers</button>
        </div>
        <div class="quiz-feedback" id="q7-fb">‚úÖ MSW intercepts HTTP requests at the network level using Service Workers (browser) or interceptors (Node). Your code makes real fetch calls; MSW intercepts them.</div>
      </div>

      <div class="quiz-question" id="q8">
        <div class="quiz-q-text">8. Which Playwright selector is MOST resilient to UI changes?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q8', this, false)">page.locator('.submit-btn')</button>
          <button class="quiz-option" onclick="answerQuiz('q8', this, false)">page.locator('#btn-submit')</button>
          <button class="quiz-option" onclick="answerQuiz('q8', this, true)">page.getByRole('button', { name: 'Submit' })</button>
          <button class="quiz-option" onclick="answerQuiz('q8', this, false)">page.locator('button:nth-child(2)')</button>
        </div>
        <div class="quiz-feedback" id="q8-fb">‚úÖ Role + name selectors are resilient because they query based on semantics. CSS classes and IDs change during refactors. Positional selectors are extremely fragile.</div>
      </div>

      <div class="quiz-question" id="q9">
        <div class="quiz-q-text">9. When should E2E tests be added to a CI pipeline?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q9', this, false)">First ‚Äî before unit and integration tests</button>
          <button class="quiz-option" onclick="answerQuiz('q9', this, false)">They shouldn't run in CI ‚Äî too slow</button>
          <button class="quiz-option" onclick="answerQuiz('q9', this, true)">Last ‚Äî after lint, unit, and integration tests pass</button>
          <button class="quiz-option" onclick="answerQuiz('q9', this, false)">At the same time as unit tests</button>
        </div>
        <div class="quiz-feedback" id="q9-fb">‚úÖ Run fast things first. If lint fails in 10s, don't waste 5 minutes on E2E. The pipeline order should be: lint ‚Üí types ‚Üí unit ‚Üí integration ‚Üí E2E.</div>
      </div>

      <div class="quiz-question" id="q10">
        <div class="quiz-q-text">10. What is the TDD cycle in order?</div>
        <div class="quiz-options">
          <button class="quiz-option" onclick="answerQuiz('q10', this, false)">Green ‚Üí Red ‚Üí Refactor</button>
          <button class="quiz-option" onclick="answerQuiz('q10', this, true)">Red ‚Üí Green ‚Üí Refactor</button>
          <button class="quiz-option" onclick="answerQuiz('q10', this, false)">Refactor ‚Üí Red ‚Üí Green</button>
          <button class="quiz-option" onclick="answerQuiz('q10', this, false)">Write code ‚Üí Write test ‚Üí Deploy</button>
        </div>
        <div class="quiz-feedback" id="q10-fb">‚úÖ Red: write a failing test. Green: write minimal code to pass it. Refactor: improve the code while keeping tests green. Always in that order!</div>
      </div>

    </div>
  </div>
</div>

<!-- ============================================================ PITFALLS -->
<div class="section" id="pitfalls">
  <div class="card">
    <div class="card-title">‚ö†Ô∏è Common Mistakes & Pitfalls</div>
    <p>These are the mistakes that separate junior developers from senior ones in interviews and on the job.</p>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #1 ‚Äî Hard-coded time delays</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå TERRIBLE ‚Äî breaks on slow machines/CI</span>
<span class="keyword">await</span> page.<span class="fn">click</span>(<span class="string">'#submit'</span>);
<span class="keyword">await</span> page.<span class="fn">waitForTimeout</span>(<span class="num">3000</span>);  <span class="comment">// ‚Üê arbitrary wait!</span>
<span class="fn">expect</span>(page.<span class="fn">url</span>()).<span class="fn">toBe</span>(<span class="string">'/dashboard'</span>);
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî wait for a condition</div>
        <div class="code-block">
<span class="keyword">await</span> page.<span class="fn">click</span>(<span class="string">'#submit'</span>);
<span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveURL</span>(<span class="string">'/dashboard'</span>);  <span class="comment">// waits automatically</span>
<span class="comment">// or: await page.waitForURL('/dashboard');</span>
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #2 ‚Äî Tests sharing state / not cleaning up</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå Test 1 creates a user</span>
<span class="fn">it</span>(<span class="string">'creates user'</span>, <span class="keyword">async</span> () => {
  <span class="keyword">await</span> db.<span class="fn">insert</span>({ name: <span class="string">'Alice'</span> });
});
<span class="comment">// ‚ùå Test 2 assumes Alice doesn't exist ‚Äî FAILS randomly!</span>
<span class="fn">it</span>(<span class="string">'no users exist initially'</span>, <span class="keyword">async</span> () => {
  <span class="fn">expect</span>(<span class="keyword">await</span> db.<span class="fn">count</span>()).<span class="fn">toBe</span>(<span class="num">0</span>);  <span class="comment">// fails if test 1 ran first</span>
});
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî clean up after each test</div>
        <div class="code-block">
<span class="fn">afterEach</span>(<span class="keyword">async</span> () => {
  <span class="keyword">await</span> db.<span class="fn">raw</span>(<span class="string">'TRUNCATE TABLE users CASCADE'</span>);
  <span class="comment">// or: await db('users').delete()</span>
});
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #3 ‚Äî Using CSS classes as selectors in E2E</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå CSS class might change during refactor</span>
page.<span class="fn">locator</span>(<span class="string">'.btn-primary-v2'</span>).<span class="fn">click</span>();
page.<span class="fn">locator</span>(<span class="string">'button:nth-child(3)'</span>).<span class="fn">click</span>();  <span class="comment">// worse!</span>
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî use role, label, or data-testid</div>
        <div class="code-block">
page.<span class="fn">getByRole</span>(<span class="string">'button'</span>, { name: <span class="string">'Submit Order'</span> }).<span class="fn">click</span>();
page.<span class="fn">getByTestId</span>(<span class="string">'submit-btn'</span>).<span class="fn">click</span>();  <span class="comment">// data-testid in HTML</span>
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #4 ‚Äî Running E2E against production database</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå DISASTER ‚Äî deleting real data in tests!</span>
<span class="comment">// DATABASE_URL=postgresql://prod:pass@prod.db.com/proddb</span>
<span class="fn">it</span>(<span class="string">'deletes all users'</span>, <span class="keyword">async</span> () => {
  <span class="keyword">await</span> request(app).<span class="fn">delete</span>(<span class="string">'/api/admin/users/all'</span>);
});
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî always use a test database</div>
        <div class="code-block">
<span class="comment">// .env.test (never commit real credentials!)</span>
DATABASE_URL=postgresql://test:test@localhost:5432/myapp_test

<span class="comment">// In CI, start fresh test DB with Docker</span>
<span class="comment">// services: postgres-test: image: postgres:15</span>
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #5 ‚Äî Calling app.listen() in test imports</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå If app.js calls listen(), each test file starts a server</span>
<span class="comment">// ‚Üí port conflicts, hanging tests, memory leaks</span>
<span class="keyword">const</span> app = express();
app.<span class="fn">listen</span>(<span class="num">3000</span>, () => console.<span class="fn">log</span>(<span class="string">'Server started'</span>));
<span class="keyword">module</span>.exports = app;  <span class="comment">// ‚Üê server starts on import!</span>
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî separate app from server</div>
        <div class="code-block">
<span class="comment">// app.js ‚Äî configure only, no listen()</span>
<span class="keyword">const</span> app = express();
<span class="comment">// ... middleware, routes ...</span>
module.exports = app;

<span class="comment">// server.js ‚Äî only file that calls listen()</span>
<span class="keyword">const</span> app = require(<span class="string">'./app'</span>);
app.<span class="fn">listen</span>(<span class="num">3000</span>);
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #6 ‚Äî Over-relying on code coverage</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå 100% coverage but this test is USELESS:</span>
<span class="fn">it</span>(<span class="string">'function exists'</span>, () => {
  <span class="fn">expect</span>(<span class="keyword">typeof</span> calculateTax).<span class="fn">toBe</span>(<span class="string">'function'</span>);
  <span class="fn">calculateTax</span>();  <span class="comment">// called but not asserted!</span>
});
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî test behaviour, not existence</div>
        <div class="code-block">
<span class="fn">it</span>(<span class="string">'calculates correct tax for UK'</span>, () => {
  <span class="fn">expect</span>(<span class="fn">calculateTax</span>(<span class="num">100</span>, <span class="string">'UK'</span>)).<span class="fn">toBe</span>(<span class="num">20</span>);  <span class="comment">// 20% VAT</span>
});
<span class="fn">it</span>(<span class="string">'throws for unsupported country'</span>, () => {
  <span class="fn">expect</span>(() => <span class="fn">calculateTax</span>(<span class="num">100</span>, <span class="string">'ZZ'</span>)).<span class="fn">toThrow</span>();
});
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #7 ‚Äî Not resetting MSW handlers between tests</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå One test adds a handler override</span>
<span class="fn">it</span>(<span class="string">'handles 500 error'</span>, () => {
  server.<span class="fn">use</span>(http.<span class="fn">get</span>(<span class="string">'/api/users'</span>, () => HttpResponse.<span class="fn">error</span>()));
  <span class="comment">// ‚Üê This handler persists to the NEXT test!</span>
});
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî reset handlers after each test</div>
        <div class="code-block">
<span class="fn">beforeAll</span>(() => server.<span class="fn">listen</span>());
<span class="fn">afterEach</span>(() => server.<span class="fn">resetHandlers</span>());  <span class="comment">// ‚Üê essential!</span>
<span class="fn">afterAll</span>(() => server.<span class="fn">close</span>());
        </div>
      </div>
    </div>

    <div class="pitfall">
      <div class="pitfall-title">‚ò†Ô∏è #8 ‚Äî Visual tests failing due to dynamic content</div>
      <div class="code-block" style="margin:8px 0;">
<span class="comment">// ‚ùå Page shows current time ‚Äî fails every minute!</span>
<span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'dashboard.png'</span>);
<span class="comment">// "Last updated: 2:34 PM" ‚Üí "Last updated: 2:35 PM" ‚Üê FAIL!</span>
      </div>
      <div class="fix">
        <div class="fix-title">‚úÖ FIX ‚Äî mask dynamic elements</div>
        <div class="code-block">
<span class="keyword">await</span> <span class="fn">expect</span>(page).<span class="fn">toHaveScreenshot</span>(<span class="string">'dashboard.png'</span>, {
  mask: [
    page.<span class="fn">getByTestId</span>(<span class="string">'last-updated'</span>),
    page.<span class="fn">getByTestId</span>(<span class="string">'live-chart'</span>),
    page.<span class="fn">locator</span>(<span class="string">'.timestamp'</span>),
  ]
});
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ============================================================ CHEATSHEET -->
<div class="section" id="cheatsheet">
  <div class="card">
    <div class="card-title">üìã Advanced Testing Cheatsheet</div>
    <p>Keep this open during interviews and development. Print it out!</p>

    <div class="cheat-grid">
      <div class="cheat-card">
        <div class="cheat-card-title">üîó Integration Test Setup</div>
        <div class="cheat-item">
          <span class="cheat-key">supertest</span>
          <span class="cheat-desc">HTTP test client for Express APIs</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">beforeAll</span>
          <span class="cheat-desc">Run migrations, connect DB</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">afterEach</span>
          <span class="cheat-desc">Truncate tables / clear state</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">afterAll</span>
          <span class="cheat-desc">Close DB connection</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">msw</span>
          <span class="cheat-desc">Intercept HTTP at network level</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üé≠ Playwright Commands</div>
        <div class="cheat-item">
          <span class="cheat-key">page.goto('/path')</span>
          <span class="cheat-desc">Navigate to URL</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">getByRole('button')</span>
          <span class="cheat-desc">Select by ARIA role ‚≠ê</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">getByLabel('Email')</span>
          <span class="cheat-desc">Select by form label</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">getByTestId('id')</span>
          <span class="cheat-desc">Select by data-testid</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">.fill('text')</span>
          <span class="cheat-desc">Type into input</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">.click()</span>
          <span class="cheat-desc">Click element</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">.hover()</span>
          <span class="cheat-desc">Mouse hover</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üé≠ Playwright Assertions</div>
        <div class="cheat-item">
          <span class="cheat-key">toHaveURL('/path')</span>
          <span class="cheat-desc">Assert current URL</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">toBeVisible()</span>
          <span class="cheat-desc">Element is visible</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">toContainText('x')</span>
          <span class="cheat-desc">Element has text</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">toHaveValue('x')</span>
          <span class="cheat-desc">Input has value</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">toBeChecked()</span>
          <span class="cheat-desc">Checkbox is checked</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">toHaveScreenshot()</span>
          <span class="cheat-desc">Visual regression check</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üå≤ Cypress Commands</div>
        <div class="cheat-item">
          <span class="cheat-key">cy.visit('/path')</span>
          <span class="cheat-desc">Navigate to URL</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">cy.get('[data-testid]')</span>
          <span class="cheat-desc">Select element</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">cy.contains('text')</span>
          <span class="cheat-desc">Find by text content</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">cy.intercept()</span>
          <span class="cheat-desc">Mock network request</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">cy.wait('@alias')</span>
          <span class="cheat-desc">Wait for intercepted request</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">.should('be.visible')</span>
          <span class="cheat-desc">Assert visibility</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">.should('contain', 'x')</span>
          <span class="cheat-desc">Assert text</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üëÅÔ∏è Visual Testing</div>
        <div class="cheat-item">
          <span class="cheat-key">toHaveScreenshot()</span>
          <span class="cheat-desc">Playwright built-in visual test</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">--update-snapshots</span>
          <span class="cheat-desc">Regenerate baselines</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">maxDiffPixels</span>
          <span class="cheat-desc">Allow N pixels difference</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">mask: [locators]</span>
          <span class="cheat-desc">Hide dynamic areas</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">emulateMedia()</span>
          <span class="cheat-desc">Test dark/light mode</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Chromatic</span>
          <span class="cheat-desc">Storybook visual CI service</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Percy</span>
          <span class="cheat-desc">BrowserStack visual cloud</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üìê Test Strategy Rules</div>
        <div class="cheat-item">
          <span class="cheat-key">Pyramid</span>
          <span class="cheat-desc">Many unit, some integration, few E2E</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Trophy</span>
          <span class="cheat-desc">Focus on integration tests</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Red-Green-Refactor</span>
          <span class="cheat-desc">TDD cycle order</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Test isolation</span>
          <span class="cheat-desc">Each test is independent</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Fast first in CI</span>
          <span class="cheat-desc">Lint ‚Üí Unit ‚Üí Integration ‚Üí E2E</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Whack-a-mole</span>
          <span class="cheat-desc">Write test before fixing production bugs</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">üõ†Ô∏è Key Tools</div>
        <div class="cheat-item">
          <span class="cheat-key">SuperTest</span>
          <span class="cheat-desc">API integration testing</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">RTL</span>
          <span class="cheat-desc">React component testing</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">MSW</span>
          <span class="cheat-desc">Network mocking (browser+Node)</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Playwright</span>
          <span class="cheat-desc">E2E + visual testing</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">Cypress</span>
          <span class="cheat-desc">E2E + component testing</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key">mongo-memory-server</span>
          <span class="cheat-desc">In-memory MongoDB for tests</span>
        </div>
      </div>

      <div class="cheat-card">
        <div class="cheat-card-title">‚ö†Ô∏è Never Do This</div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">waitForTimeout()</span>
          <span class="cheat-desc">Use conditions instead</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">'.css-class'</span>
          <span class="cheat-desc">Use role/testid instead</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">prod DB in tests</span>
          <span class="cheat-desc">Use test DB always</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">app.listen() in app.js</span>
          <span class="cheat-desc">Separate app from server</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">mock own modules</span>
          <span class="cheat-desc">Only mock external deps</span>
        </div>
        <div class="cheat-item">
          <span class="cheat-key" style="color:var(--danger)">100% coverage goal</span>
          <span class="cheat-desc">Quality > quantity</span>
        </div>
      </div>
    </div>

    <!-- Interview Q&A -->
    <div class="card" style="margin-top:8px;">
      <div class="card-title">üé§ Top Interview Q&A</div>

      <div style="margin-bottom:16px;">
        <div style="font-weight:700; color:var(--accent); margin-bottom:6px; font-size:14px;">Q: How do you decide what to test?</div>
        <div style="background:var(--surface2); padding:12px; border-radius:8px; font-size:13px; color:var(--text2); line-height:1.6;">
          "I follow the testing pyramid. Unit tests for complex business logic and edge cases, integration tests for API contracts and database interactions, and E2E tests for the 5-10 most critical user journeys. I always write a test for every production bug before fixing it."
        </div>
      </div>

      <div style="margin-bottom:16px;">
        <div style="font-weight:700; color:var(--accent); margin-bottom:6px; font-size:14px;">Q: Playwright vs Cypress ‚Äî which do you prefer?</div>
        <div style="background:var(--surface2); padding:12px; border-radius:8px; font-size:13px; color:var(--text2); line-height:1.6;">
          "Both are excellent. I'd choose Playwright for new projects needing cross-browser testing, parallel execution, and TypeScript-first support. I'd choose Cypress for React component testing and teams that value the exceptional developer experience with time-travel debugging."
        </div>
      </div>

      <div style="margin-bottom:16px;">
        <div style="font-weight:700; color:var(--accent); margin-bottom:6px; font-size:14px;">Q: What's the difference between integration and E2E tests?</div>
        <div style="background:var(--surface2); padding:12px; border-radius:8px; font-size:13px; color:var(--text2); line-height:1.6;">
          "Integration tests verify that your code modules work correctly together ‚Äî for example, testing an API endpoint that queries a real database. They run in Node.js without a browser. E2E tests launch a real browser and simulate actual user interactions across the full stack."
        </div>
      </div>

      <div>
        <div style="font-weight:700; color:var(--accent); margin-bottom:6px; font-size:14px;">Q: How do you prevent flaky tests?</div>
        <div style="background:var(--surface2); padding:12px; border-radius:8px; font-size:13px; color:var(--text2); line-height:1.6;">
          "Key strategies: never use time.sleep() or fixed timeouts, use deterministic selectors (roles, test IDs) not CSS, ensure test isolation by cleaning up state, use stable mock data, wait for specific conditions not arbitrary delays, and run tests in isolation (not order-dependent)."
        </div>
      </div>
    </div>
  </div>
</div>

</div><!-- /main -->

<script>
// ============================================================
// NAVIGATION
// ============================================================
const sections = ['intro','integration','e2e','visual','strategies','exercises','quiz','pitfalls','cheatsheet'];
let visitedSections = new Set(['intro']);

function showSection(name) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));

  document.getElementById(name).classList.add('active');
  const navBtns = document.querySelectorAll('.nav-btn');
  navBtns.forEach(b => {
    if (b.textContent.toLowerCase().includes(name.substring(0,4)) ||
        b.onclick?.toString().includes(name)) {
      b.classList.add('active');
    }
  });

  // Mark correct nav button
  const allNavBtns = document.querySelectorAll('.nav-btn');
  allNavBtns.forEach(b => {
    if (b.getAttribute('onclick') && b.getAttribute('onclick').includes(`'${name}'`)) {
      b.classList.add('active');
    } else {
      b.classList.remove('active');
    }
  });

  visitedSections.add(name);
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const pct = Math.round((visitedSections.size / sections.length) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = `${visitedSections.size}/${sections.length} sections`;
}

// ============================================================
// TABS
// ============================================================
function switchTab(group, name) {
  // Find all tab buttons and contents within the parent card
  const allContents = document.querySelectorAll(`[id^="${group}-"]`);
  const allBtns = document.querySelectorAll('.tab-btn');

  allContents.forEach(c => c.classList.remove('active'));
  const targetContent = document.getElementById(`${group}-${name}`);
  if (targetContent) targetContent.classList.add('active');

  // Update button state ‚Äî find buttons in same tab-row
  allBtns.forEach(b => {
    if (b.getAttribute('onclick') && b.getAttribute('onclick').includes(`'${group}'`)) {
      b.classList.remove('active');
      if (b.getAttribute('onclick').includes(`'${name}'`)) {
        b.classList.add('active');
      }
    }
  });
}

// ============================================================
// PYRAMID INFO
// ============================================================
const pyrInfo = {
  'unit': '‚ö° <strong>Unit Tests:</strong> Test individual functions in isolation. Fastest to run (milliseconds), cheapest to write, should be most numerous. Great for algorithms, business logic, utilities.',
  'int': 'üîó <strong>Integration Tests:</strong> Test multiple modules working together ‚Äî routes, controllers, services, databases. Medium speed. Catch contract bugs that unit tests miss.',
  'e2e': 'üé≠ <strong>E2E Tests:</strong> Full user journey in a real browser. Slowest and most expensive. Only test the critical 5-10 user paths. Tools: Playwright, Cypress.'
};

function showPyrInfo(type) {
  const box = document.getElementById('pyrInfoBox');
  const text = document.getElementById('pyrInfoText');
  box.style.display = 'flex';
  text.innerHTML = pyrInfo[type];
}

// ============================================================
// QUIZ
// ============================================================
let quizScore = 0;
let quizAnswered = 0;

function answerQuiz(questionId, button, isCorrect) {
  const options = button.parentElement.querySelectorAll('.quiz-option');
  options.forEach(opt => {
    opt.disabled = true;
    if (opt === button && isCorrect) opt.classList.add('correct');
    else if (opt === button && !isCorrect) opt.classList.add('wrong');
  });

  if (isCorrect) {
    button.classList.add('correct');
    quizScore++;
    confetti();
  } else {
    button.classList.add('wrong');
    // Show correct answer
    options.forEach(opt => {
      if (opt.getAttribute('onclick') && opt.getAttribute('onclick').includes('true')) {
        opt.classList.add('correct');
      }
    });
  }

  quizAnswered++;
  document.getElementById('quizScore').textContent = quizScore;
  document.getElementById('quizTotal').textContent = quizAnswered;

  const fb = document.getElementById(`${questionId}-fb`);
  if (fb) {
    fb.classList.add('show');
    fb.classList.add(isCorrect ? 'correct' : 'wrong');
    if (!isCorrect) {
      fb.textContent = '‚ùå ' + fb.textContent.replace('‚úÖ ', '').replace('‚ùå ', '');
    }
  }
}

function resetQuiz() {
  quizScore = 0;
  quizAnswered = 0;
  document.getElementById('quizScore').textContent = '0';
  document.getElementById('quizTotal').textContent = '0';

  document.querySelectorAll('.quiz-option').forEach(opt => {
    opt.disabled = false;
    opt.classList.remove('correct', 'wrong');
  });

  document.querySelectorAll('.quiz-feedback').forEach(fb => {
    fb.classList.remove('show', 'correct', 'wrong');
    if (!fb.textContent.startsWith('‚úÖ')) {
      fb.textContent = '‚úÖ ' + fb.textContent.replace('‚ùå ', '');
    }
  });
}

// ============================================================
// CONFETTI
// ============================================================
function confetti() {
  const colors = ['#00d4ff','#7c3aed','#10b981','#f59e0b','#ef4444'];
  for (let i = 0; i < 15; i++) {
    const piece = document.createElement('div');
    piece.className = 'confetti-piece';
    piece.style.left = Math.random() * 100 + 'vw';
    piece.style.top = '-20px';
    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
    piece.style.animationDuration = (1 + Math.random()) + 's';
    piece.style.animationDelay = Math.random() * 0.5 + 's';
    document.body.appendChild(piece);
    setTimeout(() => piece.remove(), 2500);
  }
}

// ============================================================
// EXERCISES
// ============================================================
function showSolution(exId) {
  const sol = document.getElementById(`${exId}-solution`);
  sol.style.display = sol.style.display === 'none' ? 'block' : 'none';
}

function checkEx1() {
  const input = document.getElementById('ex1-input').value.trim();
  const result = document.getElementById('ex1-result');
  result.classList.add('show');

  const keywords = ['request', 'supertest', 'get', '/api/products', 'toBe(200)', 'isArray'];
  const found = keywords.filter(k => input.includes(k));
  const score = found.length;

  if (score >= 5) {
    result.className = 'result-box show success';
    result.textContent = `‚úÖ Excellent! You used ${score}/${keywords.length} key concepts. Great integration test!`;
  } else if (score >= 3) {
    result.className = 'result-box show info';
    result.textContent = `üîÑ Good start! Missing: ${keywords.filter(k => !input.includes(k)).join(', ')}`;
  } else {
    result.className = 'result-box show error';
    result.textContent = `‚ùå Keep trying! Remember to: use supertest to make a GET request and assert status 200 and that body is an array.`;
  }
}

function checkEx2() {
  const input = document.getElementById('ex2-input').value.trim();
  const result = document.getElementById('ex2-result');
  result.classList.add('show');

  const keywords = ['page.goto', '/login', 'getByLabel', 'fill', 'getByRole', 'click', 'toHaveURL', '/dashboard'];
  const found = keywords.filter(k => input.includes(k));
  const score = found.length;

  if (score >= 7) {
    result.className = 'result-box show success';
    result.textContent = `‚úÖ Perfect Playwright test! ${score}/${keywords.length} concepts used correctly.`;
  } else if (score >= 4) {
    result.className = 'result-box show info';
    result.textContent = `üîÑ Getting there! Make sure to use: getByLabel for inputs, getByRole for button, toHaveURL for redirect assertion.`;
  } else {
    result.className = 'result-box show error';
    result.textContent = `‚ùå Review the Playwright tab. Use page.goto('/login'), getByLabel for inputs, click submit, then toHaveURL('/dashboard').`;
  }
}

function checkEx3() {
  const input = document.getElementById('ex3-input').value.trim();
  const result = document.getElementById('ex3-result');
  result.classList.add('show');

  const keywords = ['emulateMedia', 'colorScheme', 'light', 'dark', 'toHaveScreenshot', 'maxDiffPixels', '50', 'mask', '.dynamic-content'];
  const found = keywords.filter(k => input.includes(k));
  const score = found.length;

  if (score >= 8) {
    result.className = 'result-box show success';
    result.textContent = `‚úÖ Excellent visual test! You got ${score}/${keywords.length} requirements right!`;
  } else if (score >= 5) {
    result.className = 'result-box show info';
    result.textContent = `üîÑ Close! Missing: ${keywords.filter(k => !input.includes(k)).join(', ')}`;
  } else {
    result.className = 'result-box show error';
    result.textContent = `‚ùå Remember: emulateMedia for dark/light mode, toHaveScreenshot with maxDiffPixels: 50, and mask for .dynamic-content`;
  }
}

// ============================================================
// COPY CODE
// ============================================================
function copyCode(btn) {
  const block = btn.parentElement;
  const text = block.innerText.replace('Copy\n', '').replace(/\n$/, '');
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = '‚úÖ Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}

// ============================================================
// KEYBOARD NAV
// ============================================================
document.addEventListener('keydown', (e) => {
  if (e.target.tagName === 'TEXTAREA') return;
  const idx = sections.indexOf(document.querySelector('.section.active')?.id);
  if (e.key === 'ArrowRight' && idx < sections.length - 1) showSection(sections[idx + 1]);
  if (e.key === 'ArrowLeft' && idx > 0) showSection(sections[idx - 1]);
});

// init
updateProgress();
</script>
</body>
</html>